/*!
 * w-statistic v1.0.9
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(r,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((r="undefined"!=typeof globalThis?globalThis:r||self)["w-statistic"]={})}(this,(function(r){"use strict";var n=Object.prototype;var t=function(r){var t=r&&r.constructor;return r===("function"==typeof t&&t.prototype||n)};var e=function(r,n){return function(t){return r(n(t))}},a=e(Object.keys,Object),o=Object.prototype.hasOwnProperty;var u=function(r){if(!t(r))return a(r);var n=[];for(var e in Object(r))o.call(r,e)&&"constructor"!=e&&n.push(e);return n};function i(r){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},i(r)}var f="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function c(r){var n={exports:{}};return r(n,n.exports),n.exports}var s="object"==i(f)&&f&&f.Object===Object&&f,l="object"==("undefined"==typeof self?"undefined":i(self))&&self&&self.Object===Object&&self,p=s||l||Function("return this")(),h=p.Symbol,v=Object.prototype,m=v.hasOwnProperty,d=v.toString,g=h?h.toStringTag:void 0;var b=function(r){var n=m.call(r,g),t=r[g];try{r[g]=void 0;var e=!0}catch(r){}var a=d.call(r);return e&&(n?r[g]=t:delete r[g]),a},y=Object.prototype.toString;var w=function(r){return y.call(r)},x=h?h.toStringTag:void 0;var j=function(r){return null==r?void 0===r?"[object Undefined]":"[object Null]":x&&x in Object(r)?b(r):w(r)};var _=function(r){var n=i(r);return null!=r&&("object"==n||"function"==n)};var M,k=function(r){if(!_(r))return!1;var n=j(r);return"[object Function]"==n||"[object GeneratorFunction]"==n||"[object AsyncFunction]"==n||"[object Proxy]"==n},q=p["__core-js_shared__"],A=(M=/[^.]+$/.exec(q&&q.keys&&q.keys.IE_PROTO||""))?"Symbol(src)_1."+M:"";var P=function(r){return!!A&&A in r},E=Function.prototype.toString;var O=function(r){if(null!=r){try{return E.call(r)}catch(r){}try{return r+""}catch(r){}}return""},S=/^\[object .+?Constructor\]$/,N=Function.prototype,I=Object.prototype,T=N.toString,F=I.hasOwnProperty,z=RegExp("^"+T.call(F).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var L=function(r){return!(!_(r)||P(r))&&(k(r)?z:S).test(O(r))};var R=function(r,n){return null==r?void 0:r[n]};var C=function(r,n){var t=R(r,n);return L(t)?t:void 0},D=C(p,"DataView"),G=C(p,"Map"),U=C(p,"Promise"),B=C(p,"Set"),V=C(p,"WeakMap"),W="[object Map]",$="[object Promise]",X="[object Set]",Y="[object WeakMap]",H="[object DataView]",Q=O(D),K=O(G),Z=O(U),J=O(B),rr=O(V),nr=j;(D&&nr(new D(new ArrayBuffer(1)))!=H||G&&nr(new G)!=W||U&&nr(U.resolve())!=$||B&&nr(new B)!=X||V&&nr(new V)!=Y)&&(nr=function(r){var n=j(r),t="[object Object]"==n?r.constructor:void 0,e=t?O(t):"";if(e)switch(e){case Q:return H;case K:return W;case Z:return $;case J:return X;case rr:return Y}return n});var tr=nr;var er=function(r){return"number"==typeof r&&r>-1&&r%1==0&&r<=9007199254740991};var ar=function(r){return null!=r&&er(r.length)&&!k(r)},or=Array.isArray;var ur=function(r){return null!=r&&"object"==i(r)};var ir=function(r){return"string"==typeof r||!or(r)&&ur(r)&&"[object String]"==j(r)};var fr=function(r){return function(n){return null==n?void 0:n[r]}},cr=fr("length"),sr=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var lr=function(r){return sr.test(r)},pr="[\\ud800-\\udfff]",hr="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",vr="\\ud83c[\\udffb-\\udfff]",mr="[^\\ud800-\\udfff]",dr="(?:\\ud83c[\\udde6-\\uddff]){2}",gr="[\\ud800-\\udbff][\\udc00-\\udfff]",br="(?:"+hr+"|"+vr+")"+"?",yr="[\\ufe0e\\ufe0f]?",wr=yr+br+("(?:\\u200d(?:"+[mr,dr,gr].join("|")+")"+yr+br+")*"),xr="(?:"+[mr+hr+"?",hr,dr,gr,pr].join("|")+")",jr=RegExp(vr+"(?="+vr+")|"+xr+wr,"g");var _r=function(r){for(var n=jr.lastIndex=0;jr.test(r);)++n;return n};var Mr=function(r){return lr(r)?_r(r):cr(r)};var kr=function(r){if(null==r)return 0;if(ar(r))return ir(r)?Mr(r):r.length;var n=tr(r);return"[object Map]"==n||"[object Set]"==n?r.size:u(r).length};var qr=function(r,n){for(var t,e=-1,a=r.length;++e<a;){var o=n(r[e]);void 0!==o&&(t=void 0===t?o:t+o)}return t};var Ar=function(r,n){var t=null==r?0:r.length;return t?qr(r,n)/t:NaN};var Pr=function(r){return r};var Er=function(r){return Ar(r,Pr)};function Or(r){return"[object Array]"===Object.prototype.toString.call(r)}var Sr=function(r,n){for(var t=-1,e=null==r?0:r.length,a=Array(e);++t<e;)a[t]=n(r[t],t,r);return a};var Nr=function(){this.__data__=[],this.size=0};var Ir=function(r,n){return r===n||r!=r&&n!=n};var Tr=function(r,n){for(var t=r.length;t--;)if(Ir(r[t][0],n))return t;return-1},Fr=Array.prototype.splice;var zr=function(r){var n=this.__data__,t=Tr(n,r);return!(t<0)&&(t==n.length-1?n.pop():Fr.call(n,t,1),--this.size,!0)};var Lr=function(r){var n=this.__data__,t=Tr(n,r);return t<0?void 0:n[t][1]};var Rr=function(r){return Tr(this.__data__,r)>-1};var Cr=function(r,n){var t=this.__data__,e=Tr(t,r);return e<0?(++this.size,t.push([r,n])):t[e][1]=n,this};function Dr(r){var n=-1,t=null==r?0:r.length;for(this.clear();++n<t;){var e=r[n];this.set(e[0],e[1])}}Dr.prototype.clear=Nr,Dr.prototype.delete=zr,Dr.prototype.get=Lr,Dr.prototype.has=Rr,Dr.prototype.set=Cr;var Gr=Dr;var Ur=function(){this.__data__=new Gr,this.size=0};var Br=function(r){var n=this.__data__,t=n.delete(r);return this.size=n.size,t};var Vr=function(r){return this.__data__.get(r)};var Wr=function(r){return this.__data__.has(r)},$r=C(Object,"create");var Xr=function(){this.__data__=$r?$r(null):{},this.size=0};var Yr=function(r){var n=this.has(r)&&delete this.__data__[r];return this.size-=n?1:0,n},Hr=Object.prototype.hasOwnProperty;var Qr=function(r){var n=this.__data__;if($r){var t=n[r];return"__lodash_hash_undefined__"===t?void 0:t}return Hr.call(n,r)?n[r]:void 0},Kr=Object.prototype.hasOwnProperty;var Zr=function(r){var n=this.__data__;return $r?void 0!==n[r]:Kr.call(n,r)};var Jr=function(r,n){var t=this.__data__;return this.size+=this.has(r)?0:1,t[r]=$r&&void 0===n?"__lodash_hash_undefined__":n,this};function rn(r){var n=-1,t=null==r?0:r.length;for(this.clear();++n<t;){var e=r[n];this.set(e[0],e[1])}}rn.prototype.clear=Xr,rn.prototype.delete=Yr,rn.prototype.get=Qr,rn.prototype.has=Zr,rn.prototype.set=Jr;var nn=rn;var tn=function(){this.size=0,this.__data__={hash:new nn,map:new(G||Gr),string:new nn}};var en=function(r){var n=i(r);return"string"==n||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r};var an=function(r,n){var t=r.__data__;return en(n)?t["string"==typeof n?"string":"hash"]:t.map};var on=function(r){var n=an(this,r).delete(r);return this.size-=n?1:0,n};var un=function(r){return an(this,r).get(r)};var fn=function(r){return an(this,r).has(r)};var cn=function(r,n){var t=an(this,r),e=t.size;return t.set(r,n),this.size+=t.size==e?0:1,this};function sn(r){var n=-1,t=null==r?0:r.length;for(this.clear();++n<t;){var e=r[n];this.set(e[0],e[1])}}sn.prototype.clear=tn,sn.prototype.delete=on,sn.prototype.get=un,sn.prototype.has=fn,sn.prototype.set=cn;var ln=sn;var pn=function(r,n){var t=this.__data__;if(t instanceof Gr){var e=t.__data__;if(!G||e.length<199)return e.push([r,n]),this.size=++t.size,this;t=this.__data__=new ln(e)}return t.set(r,n),this.size=t.size,this};function hn(r){var n=this.__data__=new Gr(r);this.size=n.size}hn.prototype.clear=Ur,hn.prototype.delete=Br,hn.prototype.get=Vr,hn.prototype.has=Wr,hn.prototype.set=pn;var vn=hn;var mn=function(r){return this.__data__.set(r,"__lodash_hash_undefined__"),this};var dn=function(r){return this.__data__.has(r)};function gn(r){var n=-1,t=null==r?0:r.length;for(this.__data__=new ln;++n<t;)this.add(r[n])}gn.prototype.add=gn.prototype.push=mn,gn.prototype.has=dn;var bn=gn;var yn=function(r,n){for(var t=-1,e=null==r?0:r.length;++t<e;)if(n(r[t],t,r))return!0;return!1};var wn=function(r,n){return r.has(n)};var xn=function(r,n,t,e,a,o){var u=1&t,i=r.length,f=n.length;if(i!=f&&!(u&&f>i))return!1;var c=o.get(r),s=o.get(n);if(c&&s)return c==n&&s==r;var l=-1,p=!0,h=2&t?new bn:void 0;for(o.set(r,n),o.set(n,r);++l<i;){var v=r[l],m=n[l];if(e)var d=u?e(m,v,l,n,r,o):e(v,m,l,r,n,o);if(void 0!==d){if(d)continue;p=!1;break}if(h){if(!yn(n,(function(r,n){if(!wn(h,n)&&(v===r||a(v,r,t,e,o)))return h.push(n)}))){p=!1;break}}else if(v!==m&&!a(v,m,t,e,o)){p=!1;break}}return o.delete(r),o.delete(n),p},jn=p.Uint8Array;var _n=function(r){var n=-1,t=Array(r.size);return r.forEach((function(r,e){t[++n]=[e,r]})),t};var Mn=function(r){var n=-1,t=Array(r.size);return r.forEach((function(r){t[++n]=r})),t},kn=h?h.prototype:void 0,qn=kn?kn.valueOf:void 0;var An=function(r,n,t,e,a,o,u){switch(t){case"[object DataView]":if(r.byteLength!=n.byteLength||r.byteOffset!=n.byteOffset)return!1;r=r.buffer,n=n.buffer;case"[object ArrayBuffer]":return!(r.byteLength!=n.byteLength||!o(new jn(r),new jn(n)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Ir(+r,+n);case"[object Error]":return r.name==n.name&&r.message==n.message;case"[object RegExp]":case"[object String]":return r==n+"";case"[object Map]":var i=_n;case"[object Set]":var f=1&e;if(i||(i=Mn),r.size!=n.size&&!f)return!1;var c=u.get(r);if(c)return c==n;e|=2,u.set(r,n);var s=xn(i(r),i(n),e,a,o,u);return u.delete(r),s;case"[object Symbol]":if(qn)return qn.call(r)==qn.call(n)}return!1};var Pn=function(r,n){for(var t=-1,e=n.length,a=r.length;++t<e;)r[a+t]=n[t];return r};var En=function(r,n,t){var e=n(r);return or(r)?e:Pn(e,t(r))};var On=function(r,n){for(var t=-1,e=null==r?0:r.length,a=0,o=[];++t<e;){var u=r[t];n(u,t,r)&&(o[a++]=u)}return o};var Sn=function(){return[]},Nn=Object.prototype.propertyIsEnumerable,In=Object.getOwnPropertySymbols,Tn=In?function(r){return null==r?[]:(r=Object(r),On(In(r),(function(n){return Nn.call(r,n)})))}:Sn;var Fn=function(r,n){for(var t=-1,e=Array(r);++t<r;)e[t]=n(t);return e};var zn=function(r){return ur(r)&&"[object Arguments]"==j(r)},Ln=Object.prototype,Rn=Ln.hasOwnProperty,Cn=Ln.propertyIsEnumerable,Dn=zn(function(){return arguments}())?zn:function(r){return ur(r)&&Rn.call(r,"callee")&&!Cn.call(r,"callee")},Gn=Dn;var Un=function(){return!1},Bn=c((function(r,n){var t=n&&!n.nodeType&&n,e=t&&r&&!r.nodeType&&r,a=e&&e.exports===t?p.Buffer:void 0,o=(a?a.isBuffer:void 0)||Un;r.exports=o})),Vn=/^(?:0|[1-9]\d*)$/;var Wn=function(r,n){var t=i(r);return!!(n=null==n?9007199254740991:n)&&("number"==t||"symbol"!=t&&Vn.test(r))&&r>-1&&r%1==0&&r<n},$n={};$n["[object Float32Array]"]=$n["[object Float64Array]"]=$n["[object Int8Array]"]=$n["[object Int16Array]"]=$n["[object Int32Array]"]=$n["[object Uint8Array]"]=$n["[object Uint8ClampedArray]"]=$n["[object Uint16Array]"]=$n["[object Uint32Array]"]=!0,$n["[object Arguments]"]=$n["[object Array]"]=$n["[object ArrayBuffer]"]=$n["[object Boolean]"]=$n["[object DataView]"]=$n["[object Date]"]=$n["[object Error]"]=$n["[object Function]"]=$n["[object Map]"]=$n["[object Number]"]=$n["[object Object]"]=$n["[object RegExp]"]=$n["[object Set]"]=$n["[object String]"]=$n["[object WeakMap]"]=!1;var Xn=function(r){return ur(r)&&er(r.length)&&!!$n[j(r)]};var Yn=function(r){return function(n){return r(n)}},Hn=c((function(r,n){var t=n&&!n.nodeType&&n,e=t&&r&&!r.nodeType&&r,a=e&&e.exports===t&&s.process,o=function(){try{var r=e&&e.require&&e.require("util").types;return r||a&&a.binding&&a.binding("util")}catch(r){}}();r.exports=o})),Qn=Hn&&Hn.isTypedArray,Kn=Qn?Yn(Qn):Xn,Zn=Object.prototype.hasOwnProperty;var Jn=function(r,n){var t=or(r),e=!t&&Gn(r),a=!t&&!e&&Bn(r),o=!t&&!e&&!a&&Kn(r),u=t||e||a||o,i=u?Fn(r.length,String):[],f=i.length;for(var c in r)!n&&!Zn.call(r,c)||u&&("length"==c||a&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Wn(c,f))||i.push(c);return i};var rt=function(r){return ar(r)?Jn(r):u(r)};var nt=function(r){return En(r,rt,Tn)},tt=Object.prototype.hasOwnProperty;var et=function(r,n,t,e,a,o){var u=1&t,i=nt(r),f=i.length;if(f!=nt(n).length&&!u)return!1;for(var c=f;c--;){var s=i[c];if(!(u?s in n:tt.call(n,s)))return!1}var l=o.get(r),p=o.get(n);if(l&&p)return l==n&&p==r;var h=!0;o.set(r,n),o.set(n,r);for(var v=u;++c<f;){var m=r[s=i[c]],d=n[s];if(e)var g=u?e(d,m,s,n,r,o):e(m,d,s,r,n,o);if(!(void 0===g?m===d||a(m,d,t,e,o):g)){h=!1;break}v||(v="constructor"==s)}if(h&&!v){var b=r.constructor,y=n.constructor;b==y||!("constructor"in r)||!("constructor"in n)||"function"==typeof b&&b instanceof b&&"function"==typeof y&&y instanceof y||(h=!1)}return o.delete(r),o.delete(n),h},at="[object Arguments]",ot="[object Array]",ut="[object Object]",it=Object.prototype.hasOwnProperty;var ft=function(r,n,t,e,a,o){var u=or(r),i=or(n),f=u?ot:tr(r),c=i?ot:tr(n),s=(f=f==at?ut:f)==ut,l=(c=c==at?ut:c)==ut,p=f==c;if(p&&Bn(r)){if(!Bn(n))return!1;u=!0,s=!1}if(p&&!s)return o||(o=new vn),u||Kn(r)?xn(r,n,t,e,a,o):An(r,n,f,t,e,a,o);if(!(1&t)){var h=s&&it.call(r,"__wrapped__"),v=l&&it.call(n,"__wrapped__");if(h||v){var m=h?r.value():r,d=v?n.value():n;return o||(o=new vn),a(m,d,t,e,o)}}return!!p&&(o||(o=new vn),et(r,n,t,e,a,o))};var ct=function r(n,t,e,a,o){return n===t||(null==n||null==t||!ur(n)&&!ur(t)?n!=n&&t!=t:ft(n,t,e,a,r,o))};var st=function(r,n,t,e){var a=t.length,o=a,u=!e;if(null==r)return!o;for(r=Object(r);a--;){var i=t[a];if(u&&i[2]?i[1]!==r[i[0]]:!(i[0]in r))return!1}for(;++a<o;){var f=(i=t[a])[0],c=r[f],s=i[1];if(u&&i[2]){if(void 0===c&&!(f in r))return!1}else{var l=new vn;if(e)var p=e(c,s,f,r,n,l);if(!(void 0===p?ct(s,c,3,e,l):p))return!1}}return!0};var lt=function(r){return r==r&&!_(r)};var pt=function(r){for(var n=rt(r),t=n.length;t--;){var e=n[t],a=r[e];n[t]=[e,a,lt(a)]}return n};var ht=function(r,n){return function(t){return null!=t&&(t[r]===n&&(void 0!==n||r in Object(t)))}};var vt=function(r){var n=pt(r);return 1==n.length&&n[0][2]?ht(n[0][0],n[0][1]):function(t){return t===r||st(t,r,n)}};var mt=function(r){return"symbol"==i(r)||ur(r)&&"[object Symbol]"==j(r)},dt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,gt=/^\w*$/;var bt=function(r,n){if(or(r))return!1;var t=i(r);return!("number"!=t&&"symbol"!=t&&"boolean"!=t&&null!=r&&!mt(r))||(gt.test(r)||!dt.test(r)||null!=n&&r in Object(n))};function yt(r,n){if("function"!=typeof r||null!=n&&"function"!=typeof n)throw new TypeError("Expected a function");var t=function t(){var e=arguments,a=n?n.apply(this,e):e[0],o=t.cache;if(o.has(a))return o.get(a);var u=r.apply(this,e);return t.cache=o.set(a,u)||o,u};return t.cache=new(yt.Cache||ln),t}yt.Cache=ln;var wt=yt;var xt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,jt=/\\(\\)?/g,_t=function(r){var n=wt(r,(function(r){return 500===t.size&&t.clear(),r})),t=n.cache;return n}((function(r){var n=[];return 46===r.charCodeAt(0)&&n.push(""),r.replace(xt,(function(r,t,e,a){n.push(e?a.replace(jt,"$1"):t||r)})),n})),Mt=h?h.prototype:void 0,kt=Mt?Mt.toString:void 0;var qt=function r(n){if("string"==typeof n)return n;if(or(n))return Sr(n,r)+"";if(mt(n))return kt?kt.call(n):"";var t=n+"";return"0"==t&&1/n==-Infinity?"-0":t};var At=function(r){return null==r?"":qt(r)};var Pt=function(r,n){return or(r)?r:bt(r,n)?[r]:_t(At(r))};var Et=function(r){if("string"==typeof r||mt(r))return r;var n=r+"";return"0"==n&&1/r==-Infinity?"-0":n};var Ot=function(r,n){for(var t=0,e=(n=Pt(n,r)).length;null!=r&&t<e;)r=r[Et(n[t++])];return t&&t==e?r:void 0};var St=function(r,n,t){var e=null==r?void 0:Ot(r,n);return void 0===e?t:e};var Nt=function(r,n){return null!=r&&n in Object(r)};var It=function(r,n,t){for(var e=-1,a=(n=Pt(n,r)).length,o=!1;++e<a;){var u=Et(n[e]);if(!(o=null!=r&&t(r,u)))break;r=r[u]}return o||++e!=a?o:!!(a=null==r?0:r.length)&&er(a)&&Wn(u,a)&&(or(r)||Gn(r))};var Tt=function(r,n){return null!=r&&It(r,n,Nt)};var Ft=function(r,n){return bt(r)&&lt(n)?ht(Et(r),n):function(t){var e=St(t,r);return void 0===e&&e===n?Tt(t,r):ct(n,e,3)}};var zt=function(r){return function(n){return Ot(n,r)}};var Lt=function(r){return bt(r)?fr(Et(r)):zt(r)};var Rt=function(r){return"function"==typeof r?r:null==r?Pr:"object"==i(r)?or(r)?Ft(r[0],r[1]):vt(r):Lt(r)};var Ct=function(r){return function(n,t,e){for(var a=-1,o=Object(n),u=e(n),i=u.length;i--;){var f=u[r?i:++a];if(!1===t(o[f],f,o))break}return n}}();var Dt=function(r,n){return function(t,e){if(null==t)return t;if(!ar(t))return r(t,e);for(var a=t.length,o=n?a:-1,u=Object(t);(n?o--:++o<a)&&!1!==e(u[o],o,u););return t}}((function(r,n){return r&&Ct(r,n,rt)}));var Gt=function(r,n){var t=-1,e=ar(r)?Array(r.length):[];return Dt(r,(function(r,a,o){e[++t]=n(r,a,o)})),e};var Ut=function(r,n){return(or(r)?Sr:Gt)(r,Rt(n))};var Bt=function(r,n){var t=[];return Dt(r,(function(r,e,a){n(r,e,a)&&t.push(r)})),t};var Vt=function(r,n){return(or(r)?On:Bt)(r,Rt(n))};var Wt=function(r,n){for(var t=-1,e=null==r?0:r.length;++t<e&&!1!==n(r[t],t,r););return r},$t=function(){try{var r=C(Object,"defineProperty");return r({},"",{}),r}catch(r){}}();var Xt=function(r,n,t){"__proto__"==n&&$t?$t(r,n,{configurable:!0,enumerable:!0,value:t,writable:!0}):r[n]=t},Yt=Object.prototype.hasOwnProperty;var Ht=function(r,n,t){var e=r[n];Yt.call(r,n)&&Ir(e,t)&&(void 0!==t||n in r)||Xt(r,n,t)};var Qt=function(r,n,t,e){var a=!t;t||(t={});for(var o=-1,u=n.length;++o<u;){var i=n[o],f=e?e(t[i],r[i],i,t,r):void 0;void 0===f&&(f=r[i]),a?Xt(t,i,f):Ht(t,i,f)}return t};var Kt=function(r,n){return r&&Qt(n,rt(n),r)};var Zt=function(r){var n=[];if(null!=r)for(var t in Object(r))n.push(t);return n},Jt=Object.prototype.hasOwnProperty;var re=function(r){if(!_(r))return Zt(r);var n=t(r),e=[];for(var a in r)("constructor"!=a||!n&&Jt.call(r,a))&&e.push(a);return e};var ne=function(r){return ar(r)?Jn(r,!0):re(r)};var te=function(r,n){return r&&Qt(n,ne(n),r)},ee=c((function(r,n){var t=n&&!n.nodeType&&n,e=t&&r&&!r.nodeType&&r,a=e&&e.exports===t?p.Buffer:void 0,o=a?a.allocUnsafe:void 0;r.exports=function(r,n){if(n)return r.slice();var t=r.length,e=o?o(t):new r.constructor(t);return r.copy(e),e}}));var ae=function(r,n){var t=-1,e=r.length;for(n||(n=Array(e));++t<e;)n[t]=r[t];return n};var oe=function(r,n){return Qt(r,Tn(r),n)},ue=e(Object.getPrototypeOf,Object),ie=Object.getOwnPropertySymbols?function(r){for(var n=[];r;)Pn(n,Tn(r)),r=ue(r);return n}:Sn;var fe=function(r,n){return Qt(r,ie(r),n)};var ce=function(r){return En(r,ne,ie)},se=Object.prototype.hasOwnProperty;var le=function(r){var n=r.length,t=new r.constructor(n);return n&&"string"==typeof r[0]&&se.call(r,"index")&&(t.index=r.index,t.input=r.input),t};var pe=function(r){var n=new r.constructor(r.byteLength);return new jn(n).set(new jn(r)),n};var he=function(r,n){var t=n?pe(r.buffer):r.buffer;return new r.constructor(t,r.byteOffset,r.byteLength)},ve=/\w*$/;var me=function(r){var n=new r.constructor(r.source,ve.exec(r));return n.lastIndex=r.lastIndex,n},de=h?h.prototype:void 0,ge=de?de.valueOf:void 0;var be=function(r){return ge?Object(ge.call(r)):{}};var ye=function(r,n){var t=n?pe(r.buffer):r.buffer;return new r.constructor(t,r.byteOffset,r.length)};var we=function(r,n,t){var e=r.constructor;switch(n){case"[object ArrayBuffer]":return pe(r);case"[object Boolean]":case"[object Date]":return new e(+r);case"[object DataView]":return he(r,t);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return ye(r,t);case"[object Map]":case"[object Set]":return new e;case"[object Number]":case"[object String]":return new e(r);case"[object RegExp]":return me(r);case"[object Symbol]":return be(r)}},xe=Object.create,je=function(){function r(){}return function(n){if(!_(n))return{};if(xe)return xe(n);r.prototype=n;var t=new r;return r.prototype=void 0,t}}();var _e=function(r){return"function"!=typeof r.constructor||t(r)?{}:je(ue(r))};var Me=function(r){return ur(r)&&"[object Map]"==tr(r)},ke=Hn&&Hn.isMap,qe=ke?Yn(ke):Me;var Ae=function(r){return ur(r)&&"[object Set]"==tr(r)},Pe=Hn&&Hn.isSet,Ee=Pe?Yn(Pe):Ae,Oe="[object Arguments]",Se="[object Function]",Ne="[object Object]",Ie={};Ie[Oe]=Ie["[object Array]"]=Ie["[object ArrayBuffer]"]=Ie["[object DataView]"]=Ie["[object Boolean]"]=Ie["[object Date]"]=Ie["[object Float32Array]"]=Ie["[object Float64Array]"]=Ie["[object Int8Array]"]=Ie["[object Int16Array]"]=Ie["[object Int32Array]"]=Ie["[object Map]"]=Ie["[object Number]"]=Ie[Ne]=Ie["[object RegExp]"]=Ie["[object Set]"]=Ie["[object String]"]=Ie["[object Symbol]"]=Ie["[object Uint8Array]"]=Ie["[object Uint8ClampedArray]"]=Ie["[object Uint16Array]"]=Ie["[object Uint32Array]"]=!0,Ie["[object Error]"]=Ie[Se]=Ie["[object WeakMap]"]=!1;var Te=function r(n,t,e,a,o,u){var i,f=1&t,c=2&t,s=4&t;if(e&&(i=o?e(n,a,o,u):e(n)),void 0!==i)return i;if(!_(n))return n;var l=or(n);if(l){if(i=le(n),!f)return ae(n,i)}else{var p=tr(n),h=p==Se||"[object GeneratorFunction]"==p;if(Bn(n))return ee(n,f);if(p==Ne||p==Oe||h&&!o){if(i=c||h?{}:_e(n),!f)return c?fe(n,te(i,n)):oe(n,Kt(i,n))}else{if(!Ie[p])return o?n:{};i=we(n,p,f)}}u||(u=new vn);var v=u.get(n);if(v)return v;u.set(n,i),Ee(n)?n.forEach((function(a){i.add(r(a,t,e,a,n,u))})):qe(n)&&n.forEach((function(a,o){i.set(o,r(a,t,e,o,n,u))}));var m=l?void 0:(s?c?ce:nt:c?ne:rt)(n);return Wt(m||n,(function(a,o){m&&(a=n[o=a]),Ht(i,o,r(a,t,e,o,n,u))})),i};var Fe=function(r){return Te(r,5)};function ze(r){return"[object Object]"===Object.prototype.toString.call(r)}function Le(r){return"[object String]"===Object.prototype.toString.call(r)}function Re(r){return!!function(r){return"[object Undefined]"===Object.prototype.toString.call(r)}(r)||(!!function(r){return"[object Null]"===Object.prototype.toString.call(r)}(r)||(!!function(r){if(ze(r)){for(var n in r)return!1;return!0}return!1}(r)||(!!function(r){return!(!Le(r)||""!==r)}(r)||!!function(r){return!!Or(r)&&0===r.length}(r))))}function Ce(r){return!!Or(r)&&(0!==r.length&&(1!==r.length||!Re(r[0])))}function De(r){return!(!Le(r)||""===r)}function Ge(r){var n=!1;return De(r)?n=!isNaN(Number(r)):function(r){return"[object Number]"===Object.prototype.toString.call(r)}(r)&&(n=!0),n}var Ue=/\s/;var Be=function(r){for(var n=r.length;n--&&Ue.test(r.charAt(n)););return n},Ve=/^\s+/;var We=function(r){return r?r.slice(0,Be(r)+1).replace(Ve,""):r},$e=/^[-+]0x[0-9a-f]+$/i,Xe=/^0b[01]+$/i,Ye=/^0o[0-7]+$/i,He=parseInt;var Qe=function(r){if("number"==typeof r)return r;if(mt(r))return NaN;if(_(r)){var n="function"==typeof r.valueOf?r.valueOf():r;r=_(n)?n+"":n}if("string"!=typeof r)return 0===r?r:+r;r=We(r);var t=Xe.test(r);return t||Ye.test(r)?He(r.slice(2),t?2:8):$e.test(r)?NaN:+r},Ke=1/0;var Ze=function(r){return r?(r=Qe(r))===Ke||r===-1/0?17976931348623157e292*(r<0?-1:1):r==r?r:0:0===r?r:0};function Je(r){return Ge(r)?Ze(r):0}function ra(r){return Ce(r)?(r=Fe(r),r=Vt(r,Ge),r=Ut(r,Je)):[]}function na(r){if(!Or(r))return null;if(0===kr(r))return null;var n=ra(r);return 0===kr(n)?null:Er(n)}function ta(r,n,t,e,a,o,u){try{var i=r[o](u),f=i.value}catch(r){return void t(r)}i.done?n(f):Promise.resolve(f).then(e,a)}function ea(r){return function(){var n=this,t=arguments;return new Promise((function(e,a){var o=r.apply(n,t);function u(r){ta(o,e,a,u,i,"next",r)}function i(r){ta(o,e,a,u,i,"throw",r)}u(void 0)}))}}var aa=c((function(r){var n=function(r){var n,t=Object.prototype,e=t.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",f=a.toStringTag||"@@toStringTag";function c(r,n,t){return Object.defineProperty(r,n,{value:t,enumerable:!0,configurable:!0,writable:!0}),r[n]}try{c({},"")}catch(r){c=function(r,n,t){return r[n]=t}}function s(r,n,t,e){var a=n&&n.prototype instanceof g?n:g,o=Object.create(a.prototype),u=new E(e||[]);return o._invoke=function(r,n,t){var e=p;return function(a,o){if(e===v)throw new Error("Generator is already running");if(e===m){if("throw"===a)throw o;return S()}for(t.method=a,t.arg=o;;){var u=t.delegate;if(u){var i=q(u,t);if(i){if(i===d)continue;return i}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if(e===p)throw e=m,t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);e=v;var f=l(r,n,t);if("normal"===f.type){if(e=t.done?m:h,f.arg===d)continue;return{value:f.arg,done:t.done}}"throw"===f.type&&(e=m,t.method="throw",t.arg=f.arg)}}}(r,t,u),o}function l(r,n,t){try{return{type:"normal",arg:r.call(n,t)}}catch(r){return{type:"throw",arg:r}}}r.wrap=s;var p="suspendedStart",h="suspendedYield",v="executing",m="completed",d={};function g(){}function b(){}function y(){}var w={};c(w,o,(function(){return this}));var x=Object.getPrototypeOf,j=x&&x(x(O([])));j&&j!==t&&e.call(j,o)&&(w=j);var _=y.prototype=g.prototype=Object.create(w);function M(r){["next","throw","return"].forEach((function(n){c(r,n,(function(r){return this._invoke(n,r)}))}))}function k(r,n){function t(a,o,u,f){var c=l(r[a],r,o);if("throw"!==c.type){var s=c.arg,p=s.value;return p&&"object"===i(p)&&e.call(p,"__await")?n.resolve(p.__await).then((function(r){t("next",r,u,f)}),(function(r){t("throw",r,u,f)})):n.resolve(p).then((function(r){s.value=r,u(s)}),(function(r){return t("throw",r,u,f)}))}f(c.arg)}var a;this._invoke=function(r,e){function o(){return new n((function(n,a){t(r,e,n,a)}))}return a=a?a.then(o,o):o()}}function q(r,t){var e=r.iterator[t.method];if(e===n){if(t.delegate=null,"throw"===t.method){if(r.iterator.return&&(t.method="return",t.arg=n,q(r,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var a=l(e,r.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,d;var o=a.arg;return o?o.done?(t[r.resultName]=o.value,t.next=r.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function A(r){var n={tryLoc:r[0]};1 in r&&(n.catchLoc=r[1]),2 in r&&(n.finallyLoc=r[2],n.afterLoc=r[3]),this.tryEntries.push(n)}function P(r){var n=r.completion||{};n.type="normal",delete n.arg,r.completion=n}function E(r){this.tryEntries=[{tryLoc:"root"}],r.forEach(A,this),this.reset(!0)}function O(r){if(r){var t=r[o];if(t)return t.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var a=-1,u=function t(){for(;++a<r.length;)if(e.call(r,a))return t.value=r[a],t.done=!1,t;return t.value=n,t.done=!0,t};return u.next=u}}return{next:S}}function S(){return{value:n,done:!0}}return b.prototype=y,c(_,"constructor",y),c(y,"constructor",b),b.displayName=c(y,f,"GeneratorFunction"),r.isGeneratorFunction=function(r){var n="function"==typeof r&&r.constructor;return!!n&&(n===b||"GeneratorFunction"===(n.displayName||n.name))},r.mark=function(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,y):(r.__proto__=y,c(r,f,"GeneratorFunction")),r.prototype=Object.create(_),r},r.awrap=function(r){return{__await:r}},M(k.prototype),c(k.prototype,u,(function(){return this})),r.AsyncIterator=k,r.async=function(n,t,e,a,o){void 0===o&&(o=Promise);var u=new k(s(n,t,e,a),o);return r.isGeneratorFunction(t)?u:u.next().then((function(r){return r.done?r.value:u.next()}))},M(_),c(_,f,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),r.keys=function(r){var n=[];for(var t in r)n.push(t);return n.reverse(),function t(){for(;n.length;){var e=n.pop();if(e in r)return t.value=e,t.done=!1,t}return t.done=!0,t}},r.values=O,E.prototype={constructor:E,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(P),!r)for(var t in this)"t"===t.charAt(0)&&e.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var r=this.tryEntries[0].completion;if("throw"===r.type)throw r.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var t=this;function a(e,a){return i.type="throw",i.arg=r,t.next=e,a&&(t.method="next",t.arg=n),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var u=this.tryEntries[o],i=u.completion;if("root"===u.tryLoc)return a("end");if(u.tryLoc<=this.prev){var f=e.call(u,"catchLoc"),c=e.call(u,"finallyLoc");if(f&&c){if(this.prev<u.catchLoc)return a(u.catchLoc,!0);if(this.prev<u.finallyLoc)return a(u.finallyLoc)}else if(f){if(this.prev<u.catchLoc)return a(u.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<u.finallyLoc)return a(u.finallyLoc)}}}},abrupt:function(r,n){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc<=this.prev&&e.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===r||"continue"===r)&&o.tryLoc<=n&&n<=o.finallyLoc&&(o=null);var u=o?o.completion:{};return u.type=r,u.arg=n,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(u)},complete:function(r,n){if("throw"===r.type)throw r.arg;return"break"===r.type||"continue"===r.type?this.next=r.arg:"return"===r.type?(this.rval=this.arg=r.arg,this.method="return",this.next="end"):"normal"===r.type&&n&&(this.next=n),d},finish:function(r){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.finallyLoc===r)return this.complete(t.completion,t.afterLoc),P(t),d}},catch:function(r){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.tryLoc===r){var e=t.completion;if("throw"===e.type){var a=e.arg;P(t)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(r,t,e){return this.delegate={iterator:O(r),resultName:t,nextLoc:e},"next"===this.method&&(this.arg=n),d}},r}(r.exports);try{regeneratorRuntime=n}catch(r){"object"===("undefined"==typeof globalThis?"undefined":i(globalThis))?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}})),oa=aa;function ua(r){return!!Ge(r)&&Je(r)>0}function ia(r){return Ce(r)?(r=Fe(r),r=Vt(r,ua),r=Ut(r,Je)):[]}function fa(r){return Ce(r)?(r=ia(r),r=Ut(r,Math.log)):[]}var ca=function(r){return"number"==typeof r||ur(r)&&"[object Number]"==j(r)},sa=c((function(r,n){r.exports=function(){var r=function(r,n){var t=Array.prototype.concat,e=Array.prototype.slice,a=Object.prototype.toString;function o(n,t){var e=n>t?n:t;return r.pow(10,17-~~(r.log(e>0?e:-e)*r.LOG10E))}var u=Array.isArray||function(r){return"[object Array]"===a.call(r)};function i(r){return"[object Function]"===a.call(r)}function f(r){return"number"==typeof r&&r-r==0}function c(r){return t.apply([],r)}function s(){return new s._init(arguments)}function l(){return 0}function p(){return 1}function h(r,n){return r===n?1:0}s.fn=s.prototype,s._init=function(r){if(u(r[0]))if(u(r[0][0])){i(r[1])&&(r[0]=s.map(r[0],r[1]));for(var n=0;n<r[0].length;n++)this[n]=r[0][n];this.length=r[0].length}else this[0]=i(r[1])?s.map(r[0],r[1]):r[0],this.length=1;else if(f(r[0]))this[0]=s.seq.apply(null,r),this.length=1;else{if(r[0]instanceof s)return s(r[0].toArray());this[0]=[],this.length=1}return this},s._init.prototype=s.prototype,s._init.constructor=s,s.utils={calcRdx:o,isArray:u,isFunction:i,isNumber:f,toVector:c},s._random_fn=r.random,s.setRandom=function(r){if("function"!=typeof r)throw new TypeError("fn is not a function");s._random_fn=r},s.extend=function(r){var n,t;if(1===arguments.length){for(t in r)s[t]=r[t];return this}for(n=1;n<arguments.length;n++)for(t in arguments[n])r[t]=arguments[n][t];return r},s.rows=function(r){return r.length||1},s.cols=function(r){return r[0].length||1},s.dimensions=function(r){return{rows:s.rows(r),cols:s.cols(r)}},s.row=function(r,n){return u(n)?n.map((function(n){return s.row(r,n)})):r[n]},s.rowa=function(r,n){return s.row(r,n)},s.col=function(r,n){if(u(n)){var t=s.arange(r.length).map((function(){return new Array(n.length)}));return n.forEach((function(n,e){s.arange(r.length).forEach((function(a){t[a][e]=r[a][n]}))})),t}for(var e=new Array(r.length),a=0;a<r.length;a++)e[a]=[r[a][n]];return e},s.cola=function(r,n){return s.col(r,n).map((function(r){return r[0]}))},s.diag=function(r){for(var n=s.rows(r),t=new Array(n),e=0;e<n;e++)t[e]=[r[e][e]];return t},s.antidiag=function(r){for(var n=s.rows(r)-1,t=new Array(n),e=0;n>=0;n--,e++)t[e]=[r[e][n]];return t},s.transpose=function(r){var n,t,e,a,o,i=[];for(u(r[0])||(r=[r]),t=r.length,e=r[0].length,o=0;o<e;o++){for(n=new Array(t),a=0;a<t;a++)n[a]=r[a][o];i.push(n)}return 1===i.length?i[0]:i},s.map=function(r,n,t){var e,a,o,i,f;for(u(r[0])||(r=[r]),a=r.length,o=r[0].length,i=t?r:new Array(a),e=0;e<a;e++)for(i[e]||(i[e]=new Array(o)),f=0;f<o;f++)i[e][f]=n(r[e][f],e,f);return 1===i.length?i[0]:i},s.cumreduce=function(r,n,t){var e,a,o,i,f;for(u(r[0])||(r=[r]),a=r.length,o=r[0].length,i=t?r:new Array(a),e=0;e<a;e++)for(i[e]||(i[e]=new Array(o)),o>0&&(i[e][0]=r[e][0]),f=1;f<o;f++)i[e][f]=n(i[e][f-1],r[e][f]);return 1===i.length?i[0]:i},s.alter=function(r,n){return s.map(r,n,!0)},s.create=function(r,n,t){var e,a,o=new Array(r);for(i(n)&&(t=n,n=r),e=0;e<r;e++)for(o[e]=new Array(n),a=0;a<n;a++)o[e][a]=t(e,a);return o},s.zeros=function(r,n){return f(n)||(n=r),s.create(r,n,l)},s.ones=function(r,n){return f(n)||(n=r),s.create(r,n,p)},s.rand=function(r,n){return f(n)||(n=r),s.create(r,n,s._random_fn)},s.identity=function(r,n){return f(n)||(n=r),s.create(r,n,h)},s.symmetric=function(r){var n,t,e=r.length;if(r.length!==r[0].length)return!1;for(n=0;n<e;n++)for(t=0;t<e;t++)if(r[t][n]!==r[n][t])return!1;return!0},s.clear=function(r){return s.alter(r,l)},s.seq=function(r,n,t,e){i(e)||(e=!1);var a,u=[],f=o(r,n),c=(n*f-r*f)/((t-1)*f),s=r;for(a=0;s<=n&&a<t;s=(r*f+c*f*++a)/f)u.push(e?e(s,a):s);return u},s.arange=function(r,t,e){var a,o=[];if(e=e||1,t===n&&(t=r,r=0),r===t||0===e)return[];if(r<t&&e<0)return[];if(r>t&&e>0)return[];if(e>0)for(a=r;a<t;a+=e)o.push(a);else for(a=r;a>t;a+=e)o.push(a);return o},s.slice=function(){function r(r,t,e,a){var o,u=[],i=r.length;if(t===n&&e===n&&a===n)return s.copy(r);if(a=a||1,(t=(t=t||0)>=0?t:i+t)===(e=(e=e||r.length)>=0?e:i+e)||0===a)return[];if(t<e&&a<0)return[];if(t>e&&a>0)return[];if(a>0)for(o=t;o<e;o+=a)u.push(r[o]);else for(o=t;o>e;o+=a)u.push(r[o]);return u}function t(n,t){var e,a;return f((t=t||{}).row)?f(t.col)?n[t.row][t.col]:r(s.rowa(n,t.row),(e=t.col||{}).start,e.end,e.step):f(t.col)?r(s.cola(n,t.col),(a=t.row||{}).start,a.end,a.step):(a=t.row||{},e=t.col||{},r(n,a.start,a.end,a.step).map((function(n){return r(n,e.start,e.end,e.step)})))}return t}(),s.sliceAssign=function(t,e,a){var o,u;if(f(e.row)){if(f(e.col))return t[e.row][e.col]=a;e.col=e.col||{},e.col.start=e.col.start||0,e.col.end=e.col.end||t[0].length,e.col.step=e.col.step||1,o=s.arange(e.col.start,r.min(t.length,e.col.end),e.col.step);var i=e.row;return o.forEach((function(r,n){t[i][r]=a[n]})),t}if(f(e.col)){e.row=e.row||{},e.row.start=e.row.start||0,e.row.end=e.row.end||t.length,e.row.step=e.row.step||1,u=s.arange(e.row.start,r.min(t[0].length,e.row.end),e.row.step);var c=e.col;return u.forEach((function(r,n){t[r][c]=a[n]})),t}return a[0].length===n&&(a=[a]),e.row.start=e.row.start||0,e.row.end=e.row.end||t.length,e.row.step=e.row.step||1,e.col.start=e.col.start||0,e.col.end=e.col.end||t[0].length,e.col.step=e.col.step||1,u=s.arange(e.row.start,r.min(t.length,e.row.end),e.row.step),o=s.arange(e.col.start,r.min(t[0].length,e.col.end),e.col.step),u.forEach((function(r,n){o.forEach((function(e,o){t[r][e]=a[n][o]}))})),t},s.diagonal=function(r){var n=s.zeros(r.length,r.length);return r.forEach((function(r,t){n[t][t]=r})),n},s.copy=function(r){return r.map((function(r){return f(r)?r:r.map((function(r){return r}))}))};var v=s.prototype;return v.length=0,v.push=Array.prototype.push,v.sort=Array.prototype.sort,v.splice=Array.prototype.splice,v.slice=Array.prototype.slice,v.toArray=function(){return this.length>1?e.call(this):e.call(this)[0]},v.map=function(r,n){return s(s.map(this,r,n))},v.cumreduce=function(r,n){return s(s.cumreduce(this,r,n))},v.alter=function(r){return s.alter(this,r),this},function(r){for(var n=0;n<r.length;n++)!function(r){v[r]=function(n){var t,e=this;return n?(setTimeout((function(){n.call(e,v[r].call(e))})),this):(t=s[r](this),u(t)?s(t):t)}}(r[n])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(r){for(var n=0;n<r.length;n++)!function(r){v[r]=function(n,t){var e=this;return t?(setTimeout((function(){t.call(e,v[r].call(e,n))})),this):s(s[r](this,n))}}(r[n])}("row col".split(" ")),function(r){for(var n=0;n<r.length;n++)!function(r){v[r]=function(){return s(s[r].apply(null,arguments))}}(r[n])}("create zeros ones rand identity".split(" ")),s}(Math);return function(r,n){var t=r.utils.isFunction;function e(r,n){return r-n}function a(r,t,e){return n.max(t,n.min(r,e))}r.sum=function(r){for(var n=0,t=r.length;--t>=0;)n+=r[t];return n},r.sumsqrd=function(r){for(var n=0,t=r.length;--t>=0;)n+=r[t]*r[t];return n},r.sumsqerr=function(n){for(var t,e=r.mean(n),a=0,o=n.length;--o>=0;)a+=(t=n[o]-e)*t;return a},r.sumrow=function(r){for(var n=0,t=r.length;--t>=0;)n+=r[t];return n},r.product=function(r){for(var n=1,t=r.length;--t>=0;)n*=r[t];return n},r.min=function(r){for(var n=r[0],t=0;++t<r.length;)r[t]<n&&(n=r[t]);return n},r.max=function(r){for(var n=r[0],t=0;++t<r.length;)r[t]>n&&(n=r[t]);return n},r.unique=function(r){for(var n={},t=[],e=0;e<r.length;e++)n[r[e]]||(n[r[e]]=!0,t.push(r[e]));return t},r.mean=function(n){return r.sum(n)/n.length},r.meansqerr=function(n){return r.sumsqerr(n)/n.length},r.geomean=function(t){return n.pow(r.product(t),1/t.length)},r.median=function(r){var n=r.length,t=r.slice().sort(e);return 1&n?t[n/2|0]:(t[n/2-1]+t[n/2])/2},r.cumsum=function(n){return r.cumreduce(n,(function(r,n){return r+n}))},r.cumprod=function(n){return r.cumreduce(n,(function(r,n){return r*n}))},r.diff=function(r){var n,t=[],e=r.length;for(n=1;n<e;n++)t.push(r[n]-r[n-1]);return t},r.rank=function(r){var n,t=[],a={};for(n=0;n<r.length;n++)a[f=r[n]]?a[f]++:(a[f]=1,t.push(f));var o=t.sort(e),u={},i=1;for(n=0;n<o.length;n++){var f,c=a[f=o[n]],s=(i+(i+c-1))/2;u[f]=s,i+=c}return r.map((function(r){return u[r]}))},r.mode=function(r){var n,t=r.length,a=r.slice().sort(e),o=1,u=0,i=0,f=[];for(n=0;n<t;n++)a[n]===a[n+1]?o++:(o>u?(f=[a[n]],u=o,i=0):o===u&&(f.push(a[n]),i++),o=1);return 0===i?f[0]:f},r.range=function(n){return r.max(n)-r.min(n)},r.variance=function(n,t){return r.sumsqerr(n)/(n.length-(t?1:0))},r.pooledvariance=function(n){return n.reduce((function(n,t){return n+r.sumsqerr(t)}),0)/(n.reduce((function(r,n){return r+n.length}),0)-n.length)},r.deviation=function(n){for(var t=r.mean(n),e=n.length,a=new Array(e),o=0;o<e;o++)a[o]=n[o]-t;return a},r.stdev=function(t,e){return n.sqrt(r.variance(t,e))},r.pooledstdev=function(t){return n.sqrt(r.pooledvariance(t))},r.meandev=function(t){for(var e=r.mean(t),a=[],o=t.length-1;o>=0;o--)a.push(n.abs(t[o]-e));return r.mean(a)},r.meddev=function(t){for(var e=r.median(t),a=[],o=t.length-1;o>=0;o--)a.push(n.abs(t[o]-e));return r.median(a)},r.coeffvar=function(n){return r.stdev(n)/r.mean(n)},r.quartiles=function(r){var t=r.length,a=r.slice().sort(e);return[a[n.round(t/4)-1],a[n.round(t/2)-1],a[n.round(3*t/4)-1]]},r.quantiles=function(r,t,o,u){var i,f,c,s,l,p=r.slice().sort(e),h=[t.length],v=r.length;for(void 0===o&&(o=3/8),void 0===u&&(u=3/8),i=0;i<t.length;i++)c=v*(f=t[i])+(o+f*(1-o-u)),s=n.floor(a(c,1,v-1)),l=a(c-s,0,1),h[i]=(1-l)*p[s-1]+l*p[s];return h},r.percentile=function(r,n,t){var a=r.slice().sort(e),o=n*(a.length+(t?1:-1))+(t?0:1),u=parseInt(o),i=o-u;return u+1<a.length?a[u-1]+i*(a[u]-a[u-1]):a[u-1]},r.percentileOfScore=function(r,n,t){var e,a,o=0,u=r.length,i=!1;for("strict"===t&&(i=!0),a=0;a<u;a++)e=r[a],(i&&e<n||!i&&e<=n)&&o++;return o/u},r.histogram=function(t,e){e=e||4;var a,o=r.min(t),u=(r.max(t)-o)/e,i=t.length,f=[];for(a=0;a<e;a++)f[a]=0;for(a=0;a<i;a++)f[n.min(n.floor((t[a]-o)/u),e-1)]+=1;return f},r.covariance=function(n,t){var e,a=r.mean(n),o=r.mean(t),u=n.length,i=new Array(u);for(e=0;e<u;e++)i[e]=(n[e]-a)*(t[e]-o);return r.sum(i)/(u-1)},r.corrcoeff=function(n,t){return r.covariance(n,t)/r.stdev(n,1)/r.stdev(t,1)},r.spearmancoeff=function(n,t){return n=r.rank(n),t=r.rank(t),r.corrcoeff(n,t)},r.stanMoment=function(t,e){for(var a=r.mean(t),o=r.stdev(t),u=t.length,i=0,f=0;f<u;f++)i+=n.pow((t[f]-a)/o,e);return i/t.length},r.skewness=function(n){return r.stanMoment(n,3)},r.kurtosis=function(n){return r.stanMoment(n,4)-3};var o=r.prototype;!function(n){for(var e=0;e<n.length;e++)!function(n){o[n]=function(e,a){var u=[],i=0,f=this;if(t(e)&&(a=e,e=!1),a)return setTimeout((function(){a.call(f,o[n].call(f,e))})),this;if(this.length>1){for(f=!0===e?this:this.transpose();i<f.length;i++)u[i]=r[n](f[i]);return u}return r[n](this[0],e)}}(n[e])}("cumsum cumprod".split(" ")),function(n){for(var e=0;e<n.length;e++)!function(n){o[n]=function(e,a){var u=[],i=0,f=this;if(t(e)&&(a=e,e=!1),a)return setTimeout((function(){a.call(f,o[n].call(f,e))})),this;if(this.length>1){for("sumrow"!==n&&(f=!0===e?this:this.transpose());i<f.length;i++)u[i]=r[n](f[i]);return!0===e?r[n](r.utils.toVector(u)):u}return r[n](this[0],e)}}(n[e])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(n){for(var e=0;e<n.length;e++)!function(n){o[n]=function(){var e,a=[],u=0,i=this,f=Array.prototype.slice.call(arguments);if(t(f[f.length-1])){e=f[f.length-1];var c=f.slice(0,f.length-1);return setTimeout((function(){e.call(i,o[n].apply(i,c))})),this}e=void 0;var s=function(t){return r[n].apply(i,[t].concat(f))};if(this.length>1){for(i=i.transpose();u<i.length;u++)a[u]=s(i[u]);return a}return s(this[0])}}(n[e])}("quantiles percentileOfScore".split(" "))}(r,Math),function(r,n){r.gammaln=function(r){var t,e,a,o=0,u=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],i=1.000000000190015;for(a=(e=t=r)+5.5,a-=(t+.5)*n.log(a);o<6;o++)i+=u[o]/++e;return n.log(2.5066282746310007*i/t)-a},r.loggam=function(r){var t,e,a,o,u,i,f,c=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(t=r,f=0,1==r||2==r)return 0;for(r<=7&&(t=r+(f=n.floor(7-r))),e=1/(t*t),a=2*n.PI,u=c[9],i=8;i>=0;i--)u*=e,u+=c[i];if(o=u/t+.5*n.log(a)+(t-.5)*n.log(t)-t,r<=7)for(i=1;i<=f;i++)o-=n.log(t-1),t-=1;return o},r.gammafn=function(r){var t,e,a,o,u=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],i=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],f=!1,c=0,s=0,l=0,p=r;if(r>171.6243769536076)return 1/0;if(p<=0){if(!(o=p%1+36e-17))return 1/0;f=(1&p?-1:1)*n.PI/n.sin(n.PI*o),p=1-p}for(a=p,e=p<1?p++:(p-=c=(0|p)-1)-1,t=0;t<8;++t)l=(l+u[t])*e,s=s*e+i[t];if(o=l/s+1,a<p)o/=a;else if(a>p)for(t=0;t<c;++t)o*=p,p++;return f&&(o=f/o),o},r.gammap=function(n,t){return r.lowRegGamma(n,t)*r.gammafn(n)},r.lowRegGamma=function(t,e){var a,o=r.gammaln(t),u=t,i=1/t,f=i,c=e+1-t,s=1/1e-30,l=1/c,p=l,h=1,v=-~(8.5*n.log(t>=1?t:1/t)+.4*t+17);if(e<0||t<=0)return NaN;if(e<t+1){for(;h<=v;h++)i+=f*=e/++u;return i*n.exp(-e+t*n.log(e)-o)}for(;h<=v;h++)p*=(l=1/(l=(a=-h*(h-t))*l+(c+=2)))*(s=c+a/s);return 1-p*n.exp(-e+t*n.log(e)-o)},r.factorialln=function(n){return n<0?NaN:r.gammaln(n+1)},r.factorial=function(n){return n<0?NaN:r.gammafn(n+1)},r.combination=function(t,e){return t>170||e>170?n.exp(r.combinationln(t,e)):r.factorial(t)/r.factorial(e)/r.factorial(t-e)},r.combinationln=function(n,t){return r.factorialln(n)-r.factorialln(t)-r.factorialln(n-t)},r.permutation=function(n,t){return r.factorial(n)/r.factorial(n-t)},r.betafn=function(t,e){if(!(t<=0||e<=0))return t+e>170?n.exp(r.betaln(t,e)):r.gammafn(t)*r.gammafn(e)/r.gammafn(t+e)},r.betaln=function(n,t){return r.gammaln(n)+r.gammaln(t)-r.gammaln(n+t)},r.betacf=function(r,t,e){var a,o,u,i,f=1e-30,c=1,s=t+e,l=t+1,p=t-1,h=1,v=1-s*r/l;for(n.abs(v)<f&&(v=f),i=v=1/v;c<=100&&(v=1+(o=c*(e-c)*r/((p+(a=2*c))*(t+a)))*v,n.abs(v)<f&&(v=f),h=1+o/h,n.abs(h)<f&&(h=f),i*=(v=1/v)*h,v=1+(o=-(t+c)*(s+c)*r/((t+a)*(l+a)))*v,n.abs(v)<f&&(v=f),h=1+o/h,n.abs(h)<f&&(h=f),i*=u=(v=1/v)*h,!(n.abs(u-1)<3e-7));c++);return i},r.gammapinv=function(t,e){var a,o,u,i,f,c,s=0,l=e-1,p=1e-8,h=r.gammaln(e);if(t>=1)return n.max(100,e+100*n.sqrt(e));if(t<=0)return 0;for(e>1?(f=n.log(l),c=n.exp(l*(f-1)-h),i=t<.5?t:1-t,a=(2.30753+.27061*(o=n.sqrt(-2*n.log(i))))/(1+o*(.99229+.04481*o))-o,t<.5&&(a=-a),a=n.max(.001,e*n.pow(1-1/(9*e)-a/(3*n.sqrt(e)),3))):a=t<(o=1-e*(.253+.12*e))?n.pow(t/o,1/e):1-n.log(1-(t-o)/(1-o));s<12;s++){if(a<=0)return 0;if((a-=o=(u=(r.lowRegGamma(e,a)-t)/(o=e>1?c*n.exp(-(a-l)+l*(n.log(a)-f)):n.exp(-a+l*n.log(a)-h)))/(1-.5*n.min(1,u*((e-1)/a-1))))<=0&&(a=.5*(a+o)),n.abs(o)<p*a)break}return a},r.erf=function(r){var t,e,a,o,u=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],i=u.length-1,f=!1,c=0,s=0;for(r<0&&(r=-r,f=!0),e=4*(t=2/(2+r))-2;i>0;i--)a=c,c=e*c-s+u[i],s=a;return o=t*n.exp(-r*r+.5*(u[0]+e*c)-s),f?o-1:1-o},r.erfc=function(n){return 1-r.erf(n)},r.erfcinv=function(t){var e,a,o,u,i=0;if(t>=2)return-100;if(t<=0)return 100;for(u=t<1?t:2-t,e=-.70711*((2.30753+.27061*(o=n.sqrt(-2*n.log(u/2))))/(1+o*(.99229+.04481*o))-o);i<2;i++)e+=(a=r.erfc(e)-u)/(1.1283791670955126*n.exp(-e*e)-e*a);return t<1?e:-e},r.ibetainv=function(t,e,a){var o,u,i,f,c,s,l,p,h,v,m=1e-8,d=e-1,g=a-1,b=0;if(t<=0)return 0;if(t>=1)return 1;for(e>=1&&a>=1?(i=t<.5?t:1-t,s=(2.30753+.27061*(f=n.sqrt(-2*n.log(i))))/(1+f*(.99229+.04481*f))-f,t<.5&&(s=-s),l=(s*s-3)/6,p=2/(1/(2*e-1)+1/(2*a-1)),h=s*n.sqrt(l+p)/p-(1/(2*a-1)-1/(2*e-1))*(l+5/6-2/(3*p)),s=e/(e+a*n.exp(2*h))):(o=n.log(e/(e+a)),u=n.log(a/(e+a)),s=t<(f=n.exp(e*o)/e)/(h=f+(c=n.exp(a*u)/a))?n.pow(e*h*t,1/e):1-n.pow(a*h*(1-t),1/a)),v=-r.gammaln(e)-r.gammaln(a)+r.gammaln(e+a);b<10;b++){if(0===s||1===s)return s;if((s-=f=(c=(r.ibeta(s,e,a)-t)/(f=n.exp(d*n.log(s)+g*n.log(1-s)+v)))/(1-.5*n.min(1,c*(d/s-g/(1-s)))))<=0&&(s=.5*(s+f)),s>=1&&(s=.5*(s+f+1)),n.abs(f)<m*s&&b>0)break}return s},r.ibeta=function(t,e,a){var o=0===t||1===t?0:n.exp(r.gammaln(e+a)-r.gammaln(e)-r.gammaln(a)+e*n.log(t)+a*n.log(1-t));return!(t<0||t>1)&&(t<(e+1)/(e+a+2)?o*r.betacf(t,e,a)/e:1-o*r.betacf(1-t,a,e)/a)},r.randn=function(t,e){var a,o,u,i,f;if(e||(e=t),t)return r.create(t,e,(function(){return r.randn()}));do{a=r._random_fn(),o=1.7156*(r._random_fn()-.5),f=(u=a-.449871)*u+(i=n.abs(o)+.386595)*(.196*i-.25472*u)}while(f>.27597&&(f>.27846||o*o>-4*n.log(a)*a*a));return o/a},r.randg=function(t,e,a){var o,u,i,f,c,s,l=t;if(a||(a=e),t||(t=1),e)return(s=r.zeros(e,a)).alter((function(){return r.randg(t)})),s;t<1&&(t+=1),o=t-1/3,u=1/n.sqrt(9*o);do{do{f=1+u*(c=r.randn())}while(f<=0);f*=f*f,i=r._random_fn()}while(i>1-.331*n.pow(c,4)&&n.log(i)>.5*c*c+o*(1-f+n.log(f)));if(t==l)return o*f;do{i=r._random_fn()}while(0===i);return n.pow(i,1/l)*o*f},function(n){for(var t=0;t<n.length;t++)!function(n){r.fn[n]=function(){return r(r.map(this,(function(t){return r[n](t)})))}}(n[t])}("gammaln gammafn factorial factorialln".split(" ")),function(n){for(var t=0;t<n.length;t++)!function(n){r.fn[n]=function(){return r(r[n].apply(null,arguments))}}(n[t])}("randn".split(" "))}(r,Math),function(r,n){function t(r,t,e,a){for(var o,u=0,i=1,f=1,c=1,s=0,l=0;n.abs((f-l)/f)>a;)l=f,i=c+(o=-(t+s)*(t+e+s)*r/(t+2*s)/(t+2*s+1))*i,f=(u=f+o*u)+(o=(s+=1)*(e-s)*r/(t+2*s-1)/(t+2*s))*f,u/=c=i+o*c,i/=c,f/=c,c=1;return f/t}function e(r){return r/n.abs(r)}function a(t,e,a){var o=12,u=6,i=-30,f=-50,c=60,s=8,l=3,p=2,h=3,v=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],m=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],d=.5*t;if(d>=s)return 1;var g,b=2*r.normal.cdf(d,0,1,1,0)-1;b=b>=n.exp(f/a)?n.pow(b,a):0;for(var y=d,w=(s-d)/(g=t>l?p:h),x=y+w,j=0,_=a-1,M=1;M<=g;M++){for(var k=0,q=.5*(x+y),A=.5*(x-y),P=1;P<=o;P++){var E,O=q+A*(u<P?v[(E=o-P+1)-1]:-v[(E=P)-1]),S=O*O;if(S>c)break;var N=2*r.normal.cdf(O,0,1,1,0)*.5-2*r.normal.cdf(O,t,1,1,0)*.5;N>=n.exp(i/_)&&(k+=N=m[E-1]*n.exp(-.5*S)*n.pow(N,_))}j+=k*=2*A*a/n.sqrt(2*n.PI),y=x,x+=w}return(b+=j)<=n.exp(i/e)?0:(b=n.pow(b,e))>=1?1:b}function o(r,t,e){var a=.322232421088,o=.099348462606,u=-1,i=.588581570495,f=-.342242088547,c=.531103462366,s=-.204231210125,l=.10353775285,p=-453642210148e-16,h=.0038560700634,v=.8832,m=.2368,d=1.214,g=1.208,b=1.4142,y=120,w=.5-.5*r,x=n.sqrt(n.log(1/(w*w))),j=x+((((x*p+s)*x+f)*x+u)*x+a)/((((x*h+l)*x+c)*x+i)*x+o);e<y&&(j+=(j*j*j+j)/e/4);var _=v-m*j;return e<y&&(_+=-d/e+g*j/e),j*(_*n.log(t-1)+b)}!function(n){for(var t=0;t<n.length;t++)!function(n){r[n]=function r(n,t,e){return this instanceof r?(this._a=n,this._b=t,this._c=e,this):new r(n,t,e)},r.fn[n]=function(t,e,a){var o=r[n](t,e,a);return o.data=this,o},r[n].prototype.sample=function(t){var e=this._a,a=this._b,o=this._c;return t?r.alter(t,(function(){return r[n].sample(e,a,o)})):r[n].sample(e,a,o)},function(t){for(var e=0;e<t.length;e++)!function(t){r[n].prototype[t]=function(e){var a=this._a,o=this._b,u=this._c;return e||0===e||(e=this.data),"number"!=typeof e?r.fn.map.call(e,(function(e){return r[n][t](e,a,o,u)})):r[n][t](e,a,o,u)}}(t[e])}("pdf cdf inv".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){r[n].prototype[t]=function(){return r[n][t](this._a,this._b,this._c)}}(t[e])}("mean median mode variance".split(" "))}(n[t])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),r.extend(r.beta,{pdf:function(t,e,a){return t>1||t<0?0:1==e&&1==a?1:e<512&&a<512?n.pow(t,e-1)*n.pow(1-t,a-1)/r.betafn(e,a):n.exp((e-1)*n.log(t)+(a-1)*n.log(1-t)-r.betaln(e,a))},cdf:function(n,t,e){return n>1||n<0?1*(n>1):r.ibeta(n,t,e)},inv:function(n,t,e){return r.ibetainv(n,t,e)},mean:function(r,n){return r/(r+n)},median:function(n,t){return r.ibetainv(.5,n,t)},mode:function(r,n){return(r-1)/(r+n-2)},sample:function(n,t){var e=r.randg(n);return e/(e+r.randg(t))},variance:function(r,t){return r*t/(n.pow(r+t,2)*(r+t+1))}}),r.extend(r.centralF,{pdf:function(t,e,a){var o;return t<0?0:e<=2?0===t&&e<2?1/0:0===t&&2===e?1:1/r.betafn(e/2,a/2)*n.pow(e/a,e/2)*n.pow(t,e/2-1)*n.pow(1+e/a*t,-(e+a)/2):(o=e*t/(a+t*e),e*(a/(a+t*e))/2*r.binomial.pdf((e-2)/2,(e+a-2)/2,o))},cdf:function(n,t,e){return n<0?0:r.ibeta(t*n/(t*n+e),t/2,e/2)},inv:function(n,t,e){return e/(t*(1/r.ibetainv(n,t/2,e/2)-1))},mean:function(r,n){return n>2?n/(n-2):void 0},mode:function(r,n){return r>2?n*(r-2)/(r*(n+2)):void 0},sample:function(n,t){return 2*r.randg(n/2)/n/(2*r.randg(t/2)/t)},variance:function(r,n){if(!(n<=4))return 2*n*n*(r+n-2)/(r*(n-2)*(n-2)*(n-4))}}),r.extend(r.cauchy,{pdf:function(r,t,e){return e<0?0:e/(n.pow(r-t,2)+n.pow(e,2))/n.PI},cdf:function(r,t,e){return n.atan((r-t)/e)/n.PI+.5},inv:function(r,t,e){return t+e*n.tan(n.PI*(r-.5))},median:function(r){return r},mode:function(r){return r},sample:function(t,e){return r.randn()*n.sqrt(1/(2*r.randg(.5)))*e+t}}),r.extend(r.chisquare,{pdf:function(t,e){return t<0?0:0===t&&2===e?.5:n.exp((e/2-1)*n.log(t)-t/2-e/2*n.log(2)-r.gammaln(e/2))},cdf:function(n,t){return n<0?0:r.lowRegGamma(t/2,n/2)},inv:function(n,t){return 2*r.gammapinv(n,.5*t)},mean:function(r){return r},median:function(r){return r*n.pow(1-2/(9*r),3)},mode:function(r){return r-2>0?r-2:0},sample:function(n){return 2*r.randg(n/2)},variance:function(r){return 2*r}}),r.extend(r.exponential,{pdf:function(r,t){return r<0?0:t*n.exp(-t*r)},cdf:function(r,t){return r<0?0:1-n.exp(-t*r)},inv:function(r,t){return-n.log(1-r)/t},mean:function(r){return 1/r},median:function(r){return 1/r*n.log(2)},mode:function(){return 0},sample:function(t){return-1/t*n.log(r._random_fn())},variance:function(r){return n.pow(r,-2)}}),r.extend(r.gamma,{pdf:function(t,e,a){return t<0?0:0===t&&1===e?1/a:n.exp((e-1)*n.log(t)-t/a-r.gammaln(e)-e*n.log(a))},cdf:function(n,t,e){return n<0?0:r.lowRegGamma(t,n/e)},inv:function(n,t,e){return r.gammapinv(n,t)*e},mean:function(r,n){return r*n},mode:function(r,n){if(r>1)return(r-1)*n},sample:function(n,t){return r.randg(n)*t},variance:function(r,n){return r*n*n}}),r.extend(r.invgamma,{pdf:function(t,e,a){return t<=0?0:n.exp(-(e+1)*n.log(t)-a/t-r.gammaln(e)+e*n.log(a))},cdf:function(n,t,e){return n<=0?0:1-r.lowRegGamma(t,e/n)},inv:function(n,t,e){return e/r.gammapinv(1-n,t)},mean:function(r,n){return r>1?n/(r-1):void 0},mode:function(r,n){return n/(r+1)},sample:function(n,t){return t/r.randg(n)},variance:function(r,n){if(!(r<=2))return n*n/((r-1)*(r-1)*(r-2))}}),r.extend(r.kumaraswamy,{pdf:function(r,t,e){return 0===r&&1===t?e:1===r&&1===e?t:n.exp(n.log(t)+n.log(e)+(t-1)*n.log(r)+(e-1)*n.log(1-n.pow(r,t)))},cdf:function(r,t,e){return r<0?0:r>1?1:1-n.pow(1-n.pow(r,t),e)},inv:function(r,t,e){return n.pow(1-n.pow(1-r,1/e),1/t)},mean:function(n,t){return t*r.gammafn(1+1/n)*r.gammafn(t)/r.gammafn(1+1/n+t)},median:function(r,t){return n.pow(1-n.pow(2,-1/t),1/r)},mode:function(r,t){if(r>=1&&t>=1&&1!==r&&1!==t)return n.pow((r-1)/(r*t-1),1/r)},variance:function(){throw new Error("variance not yet implemented")}}),r.extend(r.lognormal,{pdf:function(r,t,e){return r<=0?0:n.exp(-n.log(r)-.5*n.log(2*n.PI)-n.log(e)-n.pow(n.log(r)-t,2)/(2*e*e))},cdf:function(t,e,a){return t<0?0:.5+.5*r.erf((n.log(t)-e)/n.sqrt(2*a*a))},inv:function(t,e,a){return n.exp(-1.4142135623730951*a*r.erfcinv(2*t)+e)},mean:function(r,t){return n.exp(r+t*t/2)},median:function(r){return n.exp(r)},mode:function(r,t){return n.exp(r-t*t)},sample:function(t,e){return n.exp(r.randn()*e+t)},variance:function(r,t){return(n.exp(t*t)-1)*n.exp(2*r+t*t)}}),r.extend(r.noncentralt,{pdf:function(t,e,a){var o=1e-14;return n.abs(a)<o?r.studentt.pdf(t,e):n.abs(t)<o?n.exp(r.gammaln((e+1)/2)-a*a/2-.5*n.log(n.PI*e)-r.gammaln(e/2)):e/t*(r.noncentralt.cdf(t*n.sqrt(1+2/e),e+2,a)-r.noncentralt.cdf(t,e,a))},cdf:function(t,e,a){var o=1e-14,u=200;if(n.abs(a)<o)return r.studentt.cdf(t,e);var i=!1;t<0&&(i=!0,a=-a);for(var f=r.normal.cdf(-a,0,1),c=o+1,s=c,l=t*t/(t*t+e),p=0,h=n.exp(-a*a/2),v=n.exp(-a*a/2-.5*n.log(2)-r.gammaln(1.5))*a;p<u||s>o||c>o;)s=c,p>0&&(h*=a*a/(2*p),v*=a*a/(2*(p+.5))),f+=.5*(c=h*r.beta.cdf(l,p+.5,e/2)+v*r.beta.cdf(l,p+1,e/2)),p++;return i?1-f:f}}),r.extend(r.normal,{pdf:function(r,t,e){return n.exp(-.5*n.log(2*n.PI)-n.log(e)-n.pow(r-t,2)/(2*e*e))},cdf:function(t,e,a){return.5*(1+r.erf((t-e)/n.sqrt(2*a*a)))},inv:function(n,t,e){return-1.4142135623730951*e*r.erfcinv(2*n)+t},mean:function(r){return r},median:function(r){return r},mode:function(r){return r},sample:function(n,t){return r.randn()*t+n},variance:function(r,n){return n*n}}),r.extend(r.pareto,{pdf:function(r,t,e){return r<t?0:e*n.pow(t,e)/n.pow(r,e+1)},cdf:function(r,t,e){return r<t?0:1-n.pow(t/r,e)},inv:function(r,t,e){return t/n.pow(1-r,1/e)},mean:function(r,t){if(!(t<=1))return t*n.pow(r,t)/(t-1)},median:function(r,t){return r*(t*n.SQRT2)},mode:function(r){return r},variance:function(r,t){if(!(t<=2))return r*r*t/(n.pow(t-1,2)*(t-2))}}),r.extend(r.studentt,{pdf:function(t,e){return e=e>1e100?1e100:e,1/(n.sqrt(e)*r.betafn(.5,e/2))*n.pow(1+t*t/e,-(e+1)/2)},cdf:function(t,e){var a=e/2;return r.ibeta((t+n.sqrt(t*t+e))/(2*n.sqrt(t*t+e)),a,a)},inv:function(t,e){var a=r.ibetainv(2*n.min(t,1-t),.5*e,.5);return a=n.sqrt(e*(1-a)/a),t>.5?a:-a},mean:function(r){return r>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(t){return r.randn()*n.sqrt(t/(2*r.randg(t/2)))},variance:function(r){return r>2?r/(r-2):r>1?1/0:void 0}}),r.extend(r.weibull,{pdf:function(r,t,e){return r<0||t<0||e<0?0:e/t*n.pow(r/t,e-1)*n.exp(-n.pow(r/t,e))},cdf:function(r,t,e){return r<0?0:1-n.exp(-n.pow(r/t,e))},inv:function(r,t,e){return t*n.pow(-n.log(1-r),1/e)},mean:function(n,t){return n*r.gammafn(1+1/t)},median:function(r,t){return r*n.pow(n.log(2),1/t)},mode:function(r,t){return t<=1?0:r*n.pow((t-1)/t,1/t)},sample:function(t,e){return t*n.pow(-n.log(r._random_fn()),1/e)},variance:function(t,e){return t*t*r.gammafn(1+2/e)-n.pow(r.weibull.mean(t,e),2)}}),r.extend(r.uniform,{pdf:function(r,n,t){return r<n||r>t?0:1/(t-n)},cdf:function(r,n,t){return r<n?0:r<t?(r-n)/(t-n):1},inv:function(r,n,t){return n+r*(t-n)},mean:function(r,n){return.5*(r+n)},median:function(n,t){return r.mean(n,t)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(n,t){return n/2+t/2+(t/2-n/2)*(2*r._random_fn()-1)},variance:function(r,t){return n.pow(t-r,2)/12}}),r.extend(r.binomial,{pdf:function(t,e,a){return 0===a||1===a?e*a===t?1:0:r.combination(e,t)*n.pow(a,t)*n.pow(1-a,e-t)},cdf:function(e,a,o){var u,i=1e-10;if(e<0)return 0;if(e>=a)return 1;if(o<0||o>1||a<=0)return NaN;var f=o,c=(e=n.floor(e))+1,s=a-e,l=c+s,p=n.exp(r.gammaln(l)-r.gammaln(s)-r.gammaln(c)+c*n.log(f)+s*n.log(1-f));return u=f<(c+1)/(l+2)?p*t(f,c,s,i):1-p*t(1-f,s,c,i),n.round(1/i*(1-u))/(1/i)}}),r.extend(r.negbin,{pdf:function(t,e,a){return t===t>>>0&&(t<0?0:r.combination(t+e-1,e-1)*n.pow(1-a,t)*n.pow(a,e))},cdf:function(n,t,e){var a=0,o=0;if(n<0)return 0;for(;o<=n;o++)a+=r.negbin.pdf(o,t,e);return a}}),r.extend(r.hypgeom,{pdf:function(t,e,a,o){if(t!=t|0)return!1;if(t<0||t<a-(e-o))return 0;if(t>o||t>a)return 0;if(2*a>e)return 2*o>e?r.hypgeom.pdf(e-a-o+t,e,e-a,e-o):r.hypgeom.pdf(o-t,e,e-a,o);if(2*o>e)return r.hypgeom.pdf(a-t,e,a,e-o);if(a<o)return r.hypgeom.pdf(t,e,o,a);for(var u=1,i=0,f=0;f<t;f++){for(;u>1&&i<o;)u*=1-a/(e-i),i++;u*=(o-f)*(a-f)/((f+1)*(e-a-o+f+1))}for(;i<o;i++)u*=1-a/(e-i);return n.min(1,n.max(0,u))},cdf:function(t,e,a,o){if(t<0||t<a-(e-o))return 0;if(t>=o||t>=a)return 1;if(2*a>e)return 2*o>e?r.hypgeom.cdf(e-a-o+t,e,e-a,e-o):1-r.hypgeom.cdf(o-t-1,e,e-a,o);if(2*o>e)return 1-r.hypgeom.cdf(a-t-1,e,a,e-o);if(a<o)return r.hypgeom.cdf(t,e,o,a);for(var u=1,i=1,f=0,c=0;c<t;c++){for(;u>1&&f<o;){var s=1-a/(e-f);i*=s,u*=s,f++}u+=i*=(o-c)*(a-c)/((c+1)*(e-a-o+c+1))}for(;f<o;f++)u*=1-a/(e-f);return n.min(1,n.max(0,u))}}),r.extend(r.poisson,{pdf:function(t,e){return e<0||t%1!=0||t<0?0:n.pow(e,t)*n.exp(-e)/r.factorial(t)},cdf:function(n,t){var e=[],a=0;if(n<0)return 0;for(;a<=n;a++)e.push(r.poisson.pdf(a,t));return r.sum(e)},mean:function(r){return r},variance:function(r){return r},sampleSmall:function(t){var e=1,a=0,o=n.exp(-t);do{a++,e*=r._random_fn()}while(e>o);return a-1},sampleLarge:function(t){var e,a,o,u,i,f,c,s,l,p,h=t;for(u=n.sqrt(h),i=n.log(h),f=.02483*(c=.931+2.53*u)-.059,s=1.1239+1.1328/(c-3.4),l=.9277-3.6224/(c-2);;){if(a=n.random()-.5,o=n.random(),p=.5-n.abs(a),e=n.floor((2*f/p+c)*a+h+.43),p>=.07&&o<=l)return e;if(!(e<0||p<.013&&o>p)&&n.log(o)+n.log(s)-n.log(f/(p*p)+c)<=e*i-h-r.loggam(e+1))return e}},sample:function(r){return r<10?this.sampleSmall(r):this.sampleLarge(r)}}),r.extend(r.triangular,{pdf:function(r,n,t,e){return t<=n||e<n||e>t?NaN:r<n||r>t?0:r<e?2*(r-n)/((t-n)*(e-n)):r===e?2/(t-n):2*(t-r)/((t-n)*(t-e))},cdf:function(r,t,e,a){return e<=t||a<t||a>e?NaN:r<=t?0:r>=e?1:r<=a?n.pow(r-t,2)/((e-t)*(a-t)):1-n.pow(e-r,2)/((e-t)*(e-a))},inv:function(r,t,e,a){return e<=t||a<t||a>e?NaN:r<=(a-t)/(e-t)?t+(e-t)*n.sqrt(r*((a-t)/(e-t))):t+(e-t)*(1-n.sqrt((1-r)*(1-(a-t)/(e-t))))},mean:function(r,n,t){return(r+n+t)/3},median:function(r,t,e){return e<=(r+t)/2?t-n.sqrt((t-r)*(t-e))/n.sqrt(2):e>(r+t)/2?r+n.sqrt((t-r)*(e-r))/n.sqrt(2):void 0},mode:function(r,n,t){return t},sample:function(t,e,a){var o=r._random_fn();return o<(a-t)/(e-t)?t+n.sqrt(o*(e-t)*(a-t)):e-n.sqrt((1-o)*(e-t)*(e-a))},variance:function(r,n,t){return(r*r+n*n+t*t-r*n-r*t-n*t)/18}}),r.extend(r.arcsine,{pdf:function(r,t,e){return e<=t?NaN:r<=t||r>=e?0:2/n.PI*n.pow(n.pow(e-t,2)-n.pow(2*r-t-e,2),-.5)},cdf:function(r,t,e){return r<t?0:r<e?2/n.PI*n.asin(n.sqrt((r-t)/(e-t))):1},inv:function(r,t,e){return t+(.5-.5*n.cos(n.PI*r))*(e-t)},mean:function(r,n){return n<=r?NaN:(r+n)/2},median:function(r,n){return n<=r?NaN:(r+n)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(t,e){return(t+e)/2+(e-t)/2*n.sin(2*n.PI*r.uniform.sample(0,1))},variance:function(r,t){return t<=r?NaN:n.pow(t-r,2)/8}}),r.extend(r.laplace,{pdf:function(r,t,e){return e<=0?0:n.exp(-n.abs(r-t)/e)/(2*e)},cdf:function(r,t,e){return e<=0?0:r<t?.5*n.exp((r-t)/e):1-.5*n.exp(-(r-t)/e)},mean:function(r){return r},median:function(r){return r},mode:function(r){return r},variance:function(r,n){return 2*n*n},sample:function(t,a){var o=r._random_fn()-.5;return t-a*e(o)*n.log(1-2*n.abs(o))}}),r.extend(r.tukey,{cdf:function(t,e,o){var u=1,i=e,f=16,c=8,s=-30,l=1e-14,p=100,h=800,v=5e3,m=25e3,d=1,g=.5,b=.25,y=.125,w=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],x=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(t<=0)return 0;if(o<2||u<1||i<2)return NaN;if(!Number.isFinite(t))return 1;if(o>m)return a(t,u,i);var j,_=.5*o,M=_*n.log(o)-o*n.log(2)-r.gammaln(_),k=_-1,q=.25*o;j=o<=p?d:o<=h?g:o<=v?b:y,M+=n.log(j);for(var A=0,P=1;P<=50;P++){for(var E=0,O=(2*P-1)*j,S=1;S<=f;S++){var N,I;c<S?(N=S-c-1,I=M+k*n.log(O+w[N]*j)-(w[N]*j+O)*q):(N=S-1,I=M+k*n.log(O-w[N]*j)+(w[N]*j-O)*q),I>=s&&(E+=a(c<S?t*n.sqrt(.5*(w[N]*j+O)):t*n.sqrt(.5*(-w[N]*j+O)),u,i)*x[N]*n.exp(I))}if(P*j>=1&&E<=l)break;A+=E}if(E>l)throw new Error("tukey.cdf failed to converge");return A>1&&(A=1),A},inv:function(t,e,a){var u=1e-4,i=50;if(a<2||e<2)return NaN;if(t<0||t>1)return NaN;if(0===t)return 0;if(1===t)return 1/0;var f,c=o(t,e,a),s=r.tukey.cdf(c,e,a)-t;f=s>0?n.max(0,c-1):c+1;for(var l,p=r.tukey.cdf(f,e,a)-t,h=1;h<i;h++)if(l=f-p*(f-c)/(p-s),s=p,c=f,l<0&&(l=0,p=-t),p=r.tukey.cdf(l,e,a)-t,f=l,n.abs(f-c)<u)return l;throw new Error("tukey.inv failed to converge")}})}(r,Math),function(r,n){var t=Array.prototype.push,e=r.utils.isArray;function a(n){return e(n)||n instanceof r}r.extend({add:function(n,t){return a(t)?(a(t[0])||(t=[t]),r.map(n,(function(r,n,e){return r+t[n][e]}))):r.map(n,(function(r){return r+t}))},subtract:function(n,t){return a(t)?(a(t[0])||(t=[t]),r.map(n,(function(r,n,e){return r-t[n][e]||0}))):r.map(n,(function(r){return r-t}))},divide:function(n,t){return a(t)?(a(t[0])||(t=[t]),r.multiply(n,r.inv(t))):r.map(n,(function(r){return r/t}))},multiply:function(n,t){var e,o,u,i,f,c,s,l;if(void 0===n.length&&void 0===t.length)return n*t;if(f=n.length,c=n[0].length,s=r.zeros(f,u=a(t)?t[0].length:c),l=0,a(t)){for(;l<u;l++)for(e=0;e<f;e++){for(i=0,o=0;o<c;o++)i+=n[e][o]*t[o][l];s[e][l]=i}return 1===f&&1===l?s[0][0]:s}return r.map(n,(function(r){return r*t}))},outer:function(n,t){return r.multiply(n.map((function(r){return[r]})),[t])},dot:function(n,t){a(n[0])||(n=[n]),a(t[0])||(t=[t]);for(var e,o,u=1===n[0].length&&1!==n.length?r.transpose(n):n,i=1===t[0].length&&1!==t.length?r.transpose(t):t,f=[],c=0,s=u.length,l=u[0].length;c<s;c++){for(f[c]=[],e=0,o=0;o<l;o++)e+=u[c][o]*i[c][o];f[c]=e}return 1===f.length?f[0]:f},pow:function(t,e){return r.map(t,(function(r){return n.pow(r,e)}))},exp:function(t){return r.map(t,(function(r){return n.exp(r)}))},log:function(t){return r.map(t,(function(r){return n.log(r)}))},abs:function(t){return r.map(t,(function(r){return n.abs(r)}))},norm:function(r,t){var e=0,o=0;for(isNaN(t)&&(t=2),a(r[0])&&(r=r[0]);o<r.length;o++)e+=n.pow(n.abs(r[o]),t);return n.pow(e,1/t)},angle:function(t,e){return n.acos(r.dot(t,e)/(r.norm(t)*r.norm(e)))},aug:function(r,n){var e,a=[];for(e=0;e<r.length;e++)a.push(r[e].slice());for(e=0;e<a.length;e++)t.apply(a[e],n[e]);return a},inv:function(n){for(var t,e=n.length,a=n[0].length,o=r.identity(e,a),u=r.gauss_jordan(n,o),i=[],f=0;f<e;f++)for(i[f]=[],t=a;t<u[0].length;t++)i[f][t-a]=u[f][t];return i},det:function(r){var n,t=r.length,e=2*t,a=new Array(e),o=t-1,u=e-1,i=o-t+1,f=u,c=0,s=0;if(2===t)return r[0][0]*r[1][1]-r[0][1]*r[1][0];for(;c<e;c++)a[c]=1;for(c=0;c<t;c++){for(n=0;n<t;n++)a[i<0?i+t:i]*=r[c][n],a[f<t?f+t:f]*=r[c][n],i++,f--;i=--o-t+1,f=--u}for(c=0;c<t;c++)s+=a[c];for(;c<e;c++)s-=a[c];return s},gauss_elimination:function(t,e){var a,o,u,i,f=0,c=0,s=t.length,l=t[0].length,p=1,h=0,v=[];for(a=(t=r.aug(t,e))[0].length,f=0;f<s;f++){for(o=t[f][f],c=f,i=f+1;i<l;i++)o<n.abs(t[i][f])&&(o=t[i][f],c=i);if(c!=f)for(i=0;i<a;i++)u=t[f][i],t[f][i]=t[c][i],t[c][i]=u;for(c=f+1;c<s;c++)for(p=t[c][f]/t[f][f],i=f;i<a;i++)t[c][i]=t[c][i]-p*t[f][i]}for(f=s-1;f>=0;f--){for(h=0,c=f+1;c<=s-1;c++)h+=v[c]*t[f][c];v[f]=(t[f][a-1]-h)/t[f][f]}return v},gauss_jordan:function(t,e){var a,o,u,i=r.aug(t,e),f=i.length,c=i[0].length,s=0;for(o=0;o<f;o++){var l=o;for(u=o+1;u<f;u++)n.abs(i[u][o])>n.abs(i[l][o])&&(l=u);var p=i[o];for(i[o]=i[l],i[l]=p,u=o+1;u<f;u++)for(s=i[u][o]/i[o][o],a=o;a<c;a++)i[u][a]-=i[o][a]*s}for(o=f-1;o>=0;o--){for(s=i[o][o],u=0;u<o;u++)for(a=c-1;a>o-1;a--)i[u][a]-=i[o][a]*i[u][o]/s;for(i[o][o]/=s,a=f;a<c;a++)i[o][a]/=s}return i},triaUpSolve:function(n,t){var e,a=n[0].length,o=r.zeros(1,a)[0],u=!1;return null!=t[0].length&&(t=t.map((function(r){return r[0]})),u=!0),r.arange(a-1,-1,-1).forEach((function(u){e=r.arange(u+1,a).map((function(r){return o[r]*n[u][r]})),o[u]=(t[u]-r.sum(e))/n[u][u]})),u?o.map((function(r){return[r]})):o},triaLowSolve:function(n,t){var e,a=n[0].length,o=r.zeros(1,a)[0],u=!1;return null!=t[0].length&&(t=t.map((function(r){return r[0]})),u=!0),r.arange(a).forEach((function(a){e=r.arange(a).map((function(r){return n[a][r]*o[r]})),o[a]=(t[a]-r.sum(e))/n[a][a]})),u?o.map((function(r){return[r]})):o},lu:function(n){var t,e=n.length,a=r.identity(e),o=r.zeros(n.length,n[0].length);return r.arange(e).forEach((function(r){o[0][r]=n[0][r]})),r.arange(1,e).forEach((function(u){r.arange(u).forEach((function(e){t=r.arange(e).map((function(r){return a[u][r]*o[r][e]})),a[u][e]=(n[u][e]-r.sum(t))/o[e][e]})),r.arange(u,e).forEach((function(e){t=r.arange(u).map((function(r){return a[u][r]*o[r][e]})),o[u][e]=n[t.length][e]-r.sum(t)}))})),[a,o]},cholesky:function(t){var e,a=t.length,o=r.zeros(t.length,t[0].length);return r.arange(a).forEach((function(u){e=r.arange(u).map((function(r){return n.pow(o[u][r],2)})),o[u][u]=n.sqrt(t[u][u]-r.sum(e)),r.arange(u+1,a).forEach((function(n){e=r.arange(u).map((function(r){return o[u][r]*o[n][r]})),o[n][u]=(t[u][n]-r.sum(e))/o[u][u]}))})),o},gauss_jacobi:function(t,e,a,o){for(var u,i,f,c,s=0,l=0,p=t.length,h=[],v=[],m=[];s<p;s++)for(h[s]=[],v[s]=[],m[s]=[],l=0;l<p;l++)s>l?(h[s][l]=t[s][l],v[s][l]=m[s][l]=0):s<l?(v[s][l]=t[s][l],h[s][l]=m[s][l]=0):(m[s][l]=t[s][l],h[s][l]=v[s][l]=0);for(f=r.multiply(r.multiply(r.inv(m),r.add(h,v)),-1),i=r.multiply(r.inv(m),e),u=a,c=r.add(r.multiply(f,a),i),s=2;n.abs(r.norm(r.subtract(c,u)))>o;)u=c,c=r.add(r.multiply(f,u),i),s++;return c},gauss_seidel:function(t,e,a,o){for(var u,i,f,c,s,l=0,p=t.length,h=[],v=[],m=[];l<p;l++)for(h[l]=[],v[l]=[],m[l]=[],u=0;u<p;u++)l>u?(h[l][u]=t[l][u],v[l][u]=m[l][u]=0):l<u?(v[l][u]=t[l][u],h[l][u]=m[l][u]=0):(m[l][u]=t[l][u],h[l][u]=v[l][u]=0);for(c=r.multiply(r.multiply(r.inv(r.add(m,h)),v),-1),f=r.multiply(r.inv(r.add(m,h)),e),i=a,s=r.add(r.multiply(c,a),f),l=2;n.abs(r.norm(r.subtract(s,i)))>o;)i=s,s=r.add(r.multiply(c,i),f),l+=1;return s},SOR:function(t,e,a,o,u){for(var i,f,c,s,l,p=0,h=t.length,v=[],m=[],d=[];p<h;p++)for(v[p]=[],m[p]=[],d[p]=[],i=0;i<h;i++)p>i?(v[p][i]=t[p][i],m[p][i]=d[p][i]=0):p<i?(m[p][i]=t[p][i],v[p][i]=d[p][i]=0):(d[p][i]=t[p][i],v[p][i]=m[p][i]=0);for(s=r.multiply(r.inv(r.add(d,r.multiply(v,u))),r.subtract(r.multiply(d,1-u),r.multiply(m,u))),c=r.multiply(r.multiply(r.inv(r.add(d,r.multiply(v,u))),e),u),f=a,l=r.add(r.multiply(s,a),c),p=2;n.abs(r.norm(r.subtract(l,f)))>o;)f=l,l=r.add(r.multiply(s,f),c),p++;return l},householder:function(t){for(var e,a,o,u,i=t.length,f=t[0].length,c=0,s=[],l=[];c<i-1;c++){for(e=0,u=c+1;u<f;u++)e+=t[u][c]*t[u][c];for(e=(t[c+1][c]>0?-1:1)*n.sqrt(e),a=n.sqrt((e*e-t[c+1][c]*e)/2),(s=r.zeros(i,1))[c+1][0]=(t[c+1][c]-e)/(2*a),o=c+2;o<i;o++)s[o][0]=t[o][c]/(2*a);l=r.subtract(r.identity(i,f),r.multiply(r.multiply(s,r.transpose(s)),2)),t=r.multiply(l,r.multiply(t,l))}return t},QR:function(){var t=r.sum,e=r.arange;function a(a){var o,u,i,f=a.length,c=a[0].length,s=r.zeros(c,c);for(a=r.copy(a),u=0;u<c;u++){for(s[u][u]=n.sqrt(t(e(f).map((function(r){return a[r][u]*a[r][u]})))),o=0;o<f;o++)a[o][u]=a[o][u]/s[u][u];for(i=u+1;i<c;i++)for(s[u][i]=t(e(f).map((function(r){return a[r][u]*a[r][i]}))),o=0;o<f;o++)a[o][i]=a[o][i]-a[o][u]*s[u][i]}return[a,s]}return a}(),lstsq:function(){function n(n){var t=(n=r.copy(n)).length,e=r.identity(t);return r.arange(t-1,-1,-1).forEach((function(t){r.sliceAssign(e,{row:t},r.divide(r.slice(e,{row:t}),n[t][t])),r.sliceAssign(n,{row:t},r.divide(r.slice(n,{row:t}),n[t][t])),r.arange(t).forEach((function(a){var o=r.multiply(n[a][t],-1),u=r.slice(n,{row:a}),i=r.multiply(r.slice(n,{row:t}),o);r.sliceAssign(n,{row:a},r.add(u,i));var f=r.slice(e,{row:a}),c=r.multiply(r.slice(e,{row:t}),o);r.sliceAssign(e,{row:a},r.add(f,c))}))})),e}function t(t,e){var a=!1;void 0===e[0].length&&(e=e.map((function(r){return[r]})),a=!0);var o=r.QR(t),u=o[0],i=o[1],f=t[0].length,c=r.slice(u,{col:{end:f}}),s=n(r.slice(i,{row:{end:f}})),l=r.transpose(c);void 0===l[0].length&&(l=[l]);var p=r.multiply(r.multiply(s,l),e);return void 0===p.length&&(p=[[p]]),a?p.map((function(r){return r[0]})):p}return t}(),jacobi:function(t){for(var e,a,o,u,i,f,c,s=1,l=t.length,p=r.identity(l,l),h=[];1===s;){for(i=t[0][1],o=0,u=1,e=0;e<l;e++)for(a=0;a<l;a++)e!=a&&i<n.abs(t[e][a])&&(i=n.abs(t[e][a]),o=e,u=a);for(f=t[o][o]===t[u][u]?t[o][u]>0?n.PI/4:-n.PI/4:n.atan(2*t[o][u]/(t[o][o]-t[u][u]))/2,(c=r.identity(l,l))[o][o]=n.cos(f),c[o][u]=-n.sin(f),c[u][o]=n.sin(f),c[u][u]=n.cos(f),p=r.multiply(p,c),t=r.multiply(r.multiply(r.inv(c),t),c),s=0,e=1;e<l;e++)for(a=1;a<l;a++)e!=a&&n.abs(t[e][a])>.001&&(s=1)}for(e=0;e<l;e++)h.push(t[e][e]);return[p,h]},rungekutta:function(r,n,t,e,a,o){var u,i,f;if(2===o)for(;e<=t;)a+=((u=n*r(e,a))+(i=n*r(e+n,a+u)))/2,e+=n;if(4===o)for(;e<=t;)a+=((u=n*r(e,a))+2*(i=n*r(e+n/2,a+u/2))+2*(f=n*r(e+n/2,a+i/2))+n*r(e+n,a+f))/6,e+=n;return a},romberg:function(r,t,e,a){for(var o,u,i,f,c,s=0,l=(e-t)/2,p=[],h=[],v=[];s<a/2;){for(c=r(t),i=t,f=0;i<=e;i+=l,f++)p[f]=i;for(o=p.length,i=1;i<o-1;i++)c+=(i%2!=0?4:2)*r(p[i]);c=l/3*(c+r(e)),v[s]=c,l/=2,s++}for(u=v.length,o=1;1!==u;){for(i=0;i<u-1;i++)h[i]=(n.pow(4,o)*v[i+1]-v[i])/(n.pow(4,o)-1);u=h.length,v=h,h=[],o++}return v},richardson:function(r,t,e,a){function o(r,n){for(var t,e=0,a=r.length;e<a;e++)r[e]===n&&(t=e);return t}for(var u,i,f,c,s,l=n.abs(e-r[o(r,e)+1]),p=0,h=[],v=[];a>=l;)u=o(r,e+a),i=o(r,e),h[p]=(t[u]-2*t[i]+t[2*i-u])/(a*a),a/=2,p++;for(c=h.length,f=1;1!=c;){for(s=0;s<c-1;s++)v[s]=(n.pow(4,f)*h[s+1]-h[s])/(n.pow(4,f)-1);c=v.length,h=v,v=[],f++}return h},simpson:function(r,n,t,e){for(var a,o=(t-n)/e,u=r(n),i=[],f=n,c=0,s=1;f<=t;f+=o,c++)i[c]=f;for(a=i.length;s<a-1;s++)u+=(s%2!=0?4:2)*r(i[s]);return o/3*(u+r(t))},hermite:function(r,n,t,e){for(var a,o=r.length,u=0,i=0,f=[],c=[],s=[],l=[];i<o;i++){for(f[i]=1,a=0;a<o;a++)i!=a&&(f[i]*=(e-r[a])/(r[i]-r[a]));for(c[i]=0,a=0;a<o;a++)i!=a&&(c[i]+=1/(r[i]-r[a]));s[i]=(1-2*(e-r[i])*c[i])*(f[i]*f[i]),l[i]=(e-r[i])*(f[i]*f[i]),u+=s[i]*n[i]+l[i]*t[i]}return u},lagrange:function(r,n,t){for(var e,a,o=0,u=0,i=r.length;u<i;u++){for(a=n[u],e=0;e<i;e++)u!=e&&(a*=(t-r[e])/(r[u]-r[e]));o+=a}return o},cubic_spline:function(n,t,e){for(var a,o=n.length,u=0,i=[],f=[],c=[],s=[],l=[],p=[],h=[];u<o-1;u++)l[u]=n[u+1]-n[u];for(c[0]=0,u=1;u<o-1;u++)c[u]=3/l[u]*(t[u+1]-t[u])-3/l[u-1]*(t[u]-t[u-1]);for(u=1;u<o-1;u++)i[u]=[],f[u]=[],i[u][u-1]=l[u-1],i[u][u]=2*(l[u-1]+l[u]),i[u][u+1]=l[u],f[u][0]=c[u];for(s=r.multiply(r.inv(i),f),a=0;a<o-1;a++)p[a]=(t[a+1]-t[a])/l[a]-l[a]*(s[a+1][0]+2*s[a][0])/3,h[a]=(s[a+1][0]-s[a][0])/(3*l[a]);for(a=0;a<o&&!(n[a]>e);a++);return t[a-=1]+(e-n[a])*p[a]+r.sq(e-n[a])*s[a]+(e-n[a])*r.sq(e-n[a])*h[a]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(n){var t,e,a=n.length,o=n[0].length,u=0,i=[],f=[],c=[],s=[],l=[],p=[],h=[],v=[],m=[],d=[];for(u=0;u<a;u++)i[u]=r.sum(n[u])/o;for(u=0;u<o;u++)for(h[u]=[],t=0;t<a;t++)h[u][t]=n[t][u]-i[t];for(h=r.transpose(h),u=0;u<a;u++)for(v[u]=[],t=0;t<a;t++)v[u][t]=r.dot([h[u]],[h[t]])/(o-1);for(m=(c=r.jacobi(v))[0],f=c[1],d=r.transpose(m),u=0;u<f.length;u++)for(t=u;t<f.length;t++)f[u]<f[t]&&(e=f[u],f[u]=f[t],f[t]=e,s=d[u],d[u]=d[t],d[t]=s);for(p=r.transpose(h),u=0;u<a;u++)for(l[u]=[],t=0;t<p.length;t++)l[u][t]=r.dot([d[u]],[p[t]]);return[n,f,d,l]}}),function(n){for(var t=0;t<n.length;t++)!function(n){r.fn[n]=function(t,e){var a=this;return e?(setTimeout((function(){e.call(a,r.fn[n].call(a,t))}),15),this):"number"==typeof r[n](this,t)?r[n](this,t):r(r[n](this,t))}}(n[t])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(r,Math),function(r,n){var t=[].slice,e=r.utils.isNumber,a=r.utils.isArray;function o(r,t,e,a){if(r>1||e>1||r<=0||e<=0)throw new Error("Proportions should be greater than 0 and less than 1");var o=(r*t+e*a)/(t+a);return(r-e)/n.sqrt(o*(1-o)*(1/t+1/a))}r.extend({zscore:function(){var n=t.call(arguments);return e(n[1])?(n[0]-n[1])/n[2]:(n[0]-r.mean(n[1]))/r.stdev(n[1],n[2])},ztest:function(){var e,o=t.call(arguments);return a(o[1])?(e=r.zscore(o[0],o[1],o[3]),1===o[2]?r.normal.cdf(-n.abs(e),0,1):2*r.normal.cdf(-n.abs(e),0,1)):o.length>2?(e=r.zscore(o[0],o[1],o[2]),1===o[3]?r.normal.cdf(-n.abs(e),0,1):2*r.normal.cdf(-n.abs(e),0,1)):(e=o[0],1===o[1]?r.normal.cdf(-n.abs(e),0,1):2*r.normal.cdf(-n.abs(e),0,1))}}),r.extend(r.fn,{zscore:function(r,n){return(r-this.mean())/this.stdev(n)},ztest:function(t,e,a){var o=n.abs(this.zscore(t,a));return 1===e?r.normal.cdf(-o,0,1):2*r.normal.cdf(-o,0,1)}}),r.extend({tscore:function(){var e=t.call(arguments);return 4===e.length?(e[0]-e[1])/(e[2]/n.sqrt(e[3])):(e[0]-r.mean(e[1]))/(r.stdev(e[1],!0)/n.sqrt(e[1].length))},ttest:function(){var a,o=t.call(arguments);return 5===o.length?(a=n.abs(r.tscore(o[0],o[1],o[2],o[3])),1===o[4]?r.studentt.cdf(-a,o[3]-1):2*r.studentt.cdf(-a,o[3]-1)):e(o[1])?(a=n.abs(o[0]),1==o[2]?r.studentt.cdf(-a,o[1]-1):2*r.studentt.cdf(-a,o[1]-1)):(a=n.abs(r.tscore(o[0],o[1])),1==o[2]?r.studentt.cdf(-a,o[1].length-1):2*r.studentt.cdf(-a,o[1].length-1))}}),r.extend(r.fn,{tscore:function(r){return(r-this.mean())/(this.stdev(!0)/n.sqrt(this.cols()))},ttest:function(t,e){return 1===e?1-r.studentt.cdf(n.abs(this.tscore(t)),this.cols()-1):2*r.studentt.cdf(-n.abs(this.tscore(t)),this.cols()-1)}}),r.extend({anovafscore:function(){var e,a,o,u,i,f,c,s,l=t.call(arguments);if(1===l.length){for(i=new Array(l[0].length),c=0;c<l[0].length;c++)i[c]=l[0][c];l=i}for(a=new Array,c=0;c<l.length;c++)a=a.concat(l[c]);for(o=r.mean(a),e=0,c=0;c<l.length;c++)e+=l[c].length*n.pow(r.mean(l[c])-o,2);for(e/=l.length-1,f=0,c=0;c<l.length;c++)for(u=r.mean(l[c]),s=0;s<l[c].length;s++)f+=n.pow(l[c][s]-u,2);return e/(f/=a.length-l.length)},anovaftest:function(){var n,a,o,u,i=t.call(arguments);if(e(i[0]))return 1-r.centralF.cdf(i[0],i[1],i[2]);var f=r.anovafscore(i);for(n=i.length-1,o=0,u=0;u<i.length;u++)o+=i[u].length;return a=o-n-1,1-r.centralF.cdf(f,n,a)},ftest:function(n,t,e){return 1-r.centralF.cdf(n,t,e)}}),r.extend(r.fn,{anovafscore:function(){return r.anovafscore(this.toArray())},anovaftes:function(){var n,t=0;for(n=0;n<this.length;n++)t+=this[n].length;return r.ftest(this.anovafscore(),this.length-1,t-this.length)}}),r.extend({qscore:function(){var a,o,u,i,f,c=t.call(arguments);return e(c[0])?(a=c[0],o=c[1],u=c[2],i=c[3],f=c[4]):(a=r.mean(c[0]),o=r.mean(c[1]),u=c[0].length,i=c[1].length,f=c[2]),n.abs(a-o)/(f*n.sqrt((1/u+1/i)/2))},qtest:function(){var n,e=t.call(arguments);3===e.length?(n=e[0],e=e.slice(1)):7===e.length?(n=r.qscore(e[0],e[1],e[2],e[3],e[4]),e=e.slice(5)):(n=r.qscore(e[0],e[1],e[2]),e=e.slice(3));var a=e[0],o=e[1];return 1-r.tukey.cdf(n,o,a-o)},tukeyhsd:function(n){for(var t=r.pooledstdev(n),e=n.map((function(n){return r.mean(n)})),a=n.reduce((function(r,n){return r+n.length}),0),o=[],u=0;u<n.length;++u)for(var i=u+1;i<n.length;++i){var f=r.qtest(e[u],e[i],n[u].length,n[i].length,t,a,n.length);o.push([[u,i],f])}return o}}),r.extend({normalci:function(){var e,a=t.call(arguments),o=new Array(2);return e=4===a.length?n.abs(r.normal.inv(a[1]/2,0,1)*a[2]/n.sqrt(a[3])):n.abs(r.normal.inv(a[1]/2,0,1)*r.stdev(a[2])/n.sqrt(a[2].length)),o[0]=a[0]-e,o[1]=a[0]+e,o},tci:function(){var e,a=t.call(arguments),o=new Array(2);return e=4===a.length?n.abs(r.studentt.inv(a[1]/2,a[3]-1)*a[2]/n.sqrt(a[3])):n.abs(r.studentt.inv(a[1]/2,a[2].length-1)*r.stdev(a[2],!0)/n.sqrt(a[2].length)),o[0]=a[0]-e,o[1]=a[0]+e,o},significant:function(r,n){return r<n}}),r.extend(r.fn,{normalci:function(n,t){return r.normalci(n,t,this.toArray())},tci:function(n,t){return r.tci(n,t,this.toArray())}}),r.extend(r.fn,{oneSidedDifferenceOfProportions:function(n,t,e,a){var u=o(n,t,e,a);return r.ztest(u,1)},twoSidedDifferenceOfProportions:function(n,t,e,a){var u=o(n,t,e,a);return r.ztest(u,2)}})}(r,Math),r.models=function(){function n(n){var e=n[0].length;return r.arange(e).map((function(a){var o=r.arange(e).filter((function(r){return r!==a}));return t(r.col(n,a).map((function(r){return r[0]})),r.col(n,o))}))}function t(n,t){var e=n.length,a=t[0].length-1,o=e-a-1,u=r.lstsq(t,n),i=r.multiply(t,u.map((function(r){return[r]}))).map((function(r){return r[0]})),f=r.subtract(n,i),c=r.mean(n),s=r.sum(i.map((function(r){return Math.pow(r-c,2)}))),l=r.sum(n.map((function(r,n){return Math.pow(r-i[n],2)}))),p=s+l;return{exog:t,endog:n,nobs:e,df_model:a,df_resid:o,coef:u,predict:i,resid:f,ybar:c,SST:p,SSE:s,SSR:l,R2:s/p}}function e(t){var e=n(t.exog),a=Math.sqrt(t.SSR/t.df_resid),o=e.map((function(r){var n=r.SST,t=r.R2;return a/Math.sqrt(n*(1-t))})),u=t.coef.map((function(r,n){return(r-0)/o[n]})),i=u.map((function(n){var e=r.studentt.cdf(n,t.df_resid);return 2*(e>.5?1-e:e)})),f=r.studentt.inv(.975,t.df_resid),c=t.coef.map((function(r,n){var t=f*o[n];return[r-t,r+t]}));return{se:o,t:u,p:i,sigmaHat:a,interval95:c}}function a(n){var t,e,a,o=n.R2/n.df_model/((1-n.R2)/n.df_resid);return{F_statistic:o,pvalue:1-(t=o,e=n.df_model,a=n.df_resid,r.beta.cdf(t/(a/e+t),e/2,a/2))}}function o(r,n){var o=t(r,n),u=e(o),i=a(o),f=1-(1-o.R2)*((o.nobs-1)/o.df_resid);return o.t=u,o.f=i,o.adjust_R2=f,o}return{ols:o}}(),r.extend({buildxmatrix:function(){for(var n=new Array(arguments.length),t=0;t<arguments.length;t++){var e=[1];n[t]=e.concat(arguments[t])}return r(n)},builddxmatrix:function(){for(var n=new Array(arguments[0].length),t=0;t<arguments[0].length;t++){var e=[1];n[t]=e.concat(arguments[0][t])}return r(n)},buildjxmatrix:function(n){for(var t=new Array(n.length),e=0;e<n.length;e++)t[e]=n[e];return r.builddxmatrix(t)},buildymatrix:function(n){return r(n).transpose()},buildjymatrix:function(r){return r.transpose()},matrixmult:function(n,t){var e,a,o,u,i;if(n.cols()==t.rows()){if(t.rows()>1){for(u=[],e=0;e<n.rows();e++)for(u[e]=[],a=0;a<t.cols();a++){for(i=0,o=0;o<n.cols();o++)i+=n.toArray()[e][o]*t.toArray()[o][a];u[e][a]=i}return r(u)}for(u=[],e=0;e<n.rows();e++)for(u[e]=[],a=0;a<t.cols();a++){for(i=0,o=0;o<n.cols();o++)i+=n.toArray()[e][o]*t.toArray()[a];u[e][a]=i}return r(u)}},regress:function(n,t){var e=r.xtranspxinv(n),a=n.transpose(),o=r.matrixmult(r(e),a);return r.matrixmult(o,t)},regresst:function(n,t,e){var a=r.regress(n,t),o={anova:{}},u=r.jMatYBar(n,a);o.yBar=u;var i=t.mean();o.anova.residuals=r.residuals(t,u),o.anova.ssr=r.ssr(u,i),o.anova.msr=o.anova.ssr/(n[0].length-1),o.anova.sse=r.sse(t,u),o.anova.mse=o.anova.sse/(t.length-(n[0].length-1)-1),o.anova.sst=r.sst(t,i),o.anova.mst=o.anova.sst/(t.length-1),o.anova.r2=1-o.anova.sse/o.anova.sst,o.anova.r2<0&&(o.anova.r2=0),o.anova.fratio=o.anova.msr/o.anova.mse,o.anova.pvalue=r.anovaftest(o.anova.fratio,n[0].length-1,t.length-(n[0].length-1)-1),o.anova.rmse=Math.sqrt(o.anova.mse),o.anova.r2adj=1-o.anova.mse/o.anova.mst,o.anova.r2adj<0&&(o.anova.r2adj=0),o.stats=new Array(n[0].length);for(var f,c,s,l=r.xtranspxinv(n),p=0;p<a.length;p++)f=Math.sqrt(o.anova.mse*Math.abs(l[p][p])),c=Math.abs(a[p]/f),s=r.ttest(c,t.length-n[0].length-1,e),o.stats[p]=[a[p],f,c,s];return o.regress=a,o},xtranspx:function(n){return r.matrixmult(n.transpose(),n)},xtranspxinv:function(n){var t=r.matrixmult(n.transpose(),n);return r.inv(t)},jMatYBar:function(n,t){var e=r.matrixmult(n,t);return new r(e)},residuals:function(n,t){return r.matrixsubtract(n,t)},ssr:function(r,n){for(var t=0,e=0;e<r.length;e++)t+=Math.pow(r[e]-n,2);return t},sse:function(r,n){for(var t=0,e=0;e<r.length;e++)t+=Math.pow(r[e]-n[e],2);return t},sst:function(r,n){for(var t=0,e=0;e<r.length;e++)t+=Math.pow(r[e]-n,2);return t},matrixsubtract:function(n,t){for(var e=new Array(n.length),a=0;a<n.length;a++){e[a]=new Array(n[a].length);for(var o=0;o<n[a].length;o++)e[a][o]=n[a][o]-t[a][o]}return r(e)}}),r.jStat=r,r}()})),la=sa.jStat,pa={beta:{pdf:la.beta.pdf,cdf:la.beta.cdf,inv:la.beta.inv,sample:la.beta.sample},centralF:{pdf:la.centralF.pdf,cdf:la.centralF.cdf,inv:la.centralF.inv,sample:la.centralF.sample},cauchy:{pdf:la.cauchy.pdf,cdf:la.cauchy.cdf,inv:la.cauchy.inv,sample:la.cauchy.sample},chisquare:{pdf:la.chisquare.pdf,cdf:la.chisquare.cdf,inv:la.chisquare.inv,sample:la.chisquare.sample},exponential:{pdf:la.exponential.pdf,cdf:la.exponential.cdf,inv:la.exponential.inv,sample:la.exponential.sample},gamma:{pdf:la.gamma.pdf,cdf:la.gamma.cdf,inv:la.gamma.inv,sample:la.gamma.sample},invgamma:{pdf:la.invgamma.pdf,cdf:la.invgamma.cdf,inv:la.invgamma.inv,sample:la.invgamma.sample},kumaraswamy:{pdf:la.kumaraswamy.pdf,cdf:la.kumaraswamy.cdf,inv:la.kumaraswamy.inv,sample:la.kumaraswamy.sample},lognormal:{pdf:la.lognormal.pdf,cdf:la.lognormal.cdf,inv:la.lognormal.inv,sample:la.lognormal.sample},normal:{pdf:la.normal.pdf,cdf:la.normal.cdf,inv:la.normal.inv,sample:la.normal.sample},pareto:{pdf:la.pareto.pdf,cdf:la.pareto.cdf,inv:la.pareto.inv,sample:function(r,n){throw new Error("invalid pareto.sample")}},studentt:{pdf:la.studentt.pdf,cdf:la.studentt.cdf,inv:la.studentt.inv,sample:la.studentt.sample},tukey:{pdf:function(r,n,t){throw new Error("invalid tukey.pdf")},cdf:la.tukey.cdf,inv:la.tukey.inv,sample:function(r,n){throw new Error("invalid tukey.sample")}},weibull:{pdf:la.weibull.pdf,cdf:la.weibull.cdf,inv:la.weibull.inv,sample:la.weibull.sample},uniform:{pdf:la.uniform.pdf,cdf:la.uniform.cdf,inv:la.uniform.inv,sample:la.uniform.sample},binomial:{pdf:la.binomial.pdf,cdf:la.binomial.cdf,inv:function(r,n,t){throw new Error("invalid binomial.inv")},sample:function(r,n){throw new Error("invalid binomial.sample")}},negbin:{pdf:la.negbin.pdf,cdf:la.negbin.cdf,inv:function(r,n,t){throw new Error("invalid negbin.inv")},sample:function(r,n){throw new Error("invalid negbin.sample")}},hypgeom:{pdf:la.hypgeom.pdf,cdf:la.hypgeom.cdf,inv:function(r,n,t,e){throw new Error("invalid hypgeom.inv")},sample:function(r,n,t){throw new Error("invalid hypgeom.sample")}},poisson:{pdf:la.poisson.pdf,cdf:la.poisson.cdf,inv:function(r,n){throw new Error("invalid poisson.inv")},sample:la.poisson.sample},triangular:{pdf:la.triangular.pdf,cdf:la.triangular.cdf,inv:function(r,n,t,e){throw new Error("invalid triangular.inv")},sample:la.triangular.sample},arcsine:{pdf:la.arcsine.pdf,cdf:la.arcsine.cdf,inv:la.arcsine.inv,sample:la.arcsine.sample},std:function(r){return la.stdev(r,!1)},sampleStd:function(r){return la.stdev(r,!0)},emquantile:function(r,n){return la.quantiles(r,[n],.4,.4)[0]},emquantiles:la.quantiles,percentile:la.percentile};function ha(r){return Or(r)?0===kr(r)?null:(r=Vt(r,(function(r){return Ge(r)})),r=Ut(r,Je),kr(r)<=1?null:pa.sampleStd(r)):null}var va=function(r){var n=Ze(r),t=n%1;return n==n?t?n-t:n:0};var ma=function(r){return"number"==typeof r&&r==va(r)};function da(r){return!!Ge(r)&&(r=Je(r),ma(r))}var ga=p.isFinite,ba=Math.min;var ya=function(r){var n=Math[r];return function(r,t){if(r=Qe(r),(t=null==t?0:ba(va(t),292))&&ga(r)){var e=(At(r)+"e").split("e"),a=n(e[0]+"e"+(+e[1]+t));return+((e=(At(a)+"e").split("e"))[0]+"e"+(+e[1]-t))}return n(r)}},wa=ya("round");function xa(r){if(!Ge(r))return 0;r=Je(r);var n=wa(r);return"0"===String(n)?0:n}function ja(r){return!!da(r)&&xa(r)>0}function _a(r,n){return Ma.apply(this,arguments)}function Ma(){return(Ma=ea(oa.mark((function r(n,t){var e,a;return oa.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(ja(n)){r.next=2;break}return r.abrupt("return",Promise.reject("n[".concat(n,"] is not positive integer")));case 2:if(!((n=xa(n))<=1)){r.next=5;break}return r.abrupt("return",Promise.reject("n[".concat(n,"] <= 1")));case 5:if(Ge(t)||(t=.95),!((t=Je(t))<0)){r.next=9;break}return r.abrupt("return",Promise.reject("p[".concat(t,"] < 0")));case 9:if(!(t>1)){r.next=11;break}return r.abrupt("return",Promise.reject("p[".concat(t,"] > 1")));case 11:return e=n-1,a=pa.studentt.inv(t,e),r.abrupt("return",a);case 14:case"end":return r.stop()}}),r)})))).apply(this,arguments)}function ka(r,n){return qa.apply(this,arguments)}function qa(){return qa=ea(oa.mark((function r(n,t){var e,a,o,u,i,f,c,s,l,p,h=arguments;return oa.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e=h.length>2&&void 0!==h[2]?h[2]:"two-tailed",Or(n)){r.next=3;break}return r.abrupt("return",Promise.reject("arr is not an array"));case 3:if(0!==kr(n)){r.next=5;break}return r.abrupt("return",Promise.reject("arr is not an effective array"));case 5:if(Ge(t)){r.next=7;break}return r.abrupt("return",Promise.reject("p[".concat(t,"] is not a number")));case 7:if(!((t=Je(t))<0)){r.next=10;break}return r.abrupt("return",Promise.reject("p[".concat(t,"] < 0")));case 10:if(!(t>1)){r.next=12;break}return r.abrupt("return",Promise.reject("p[".concat(t,"] > 1")));case 12:if("two-tailed"===e||"upper-tail"===e||"lower-tail"===e){r.next=14;break}return r.abrupt("return",Promise.reject("mode[".concat(e,"] is not 'two-tailed', 'upper-tail' or 'lower-tail'")));case 14:if(a=ra(n),0!==(o=kr(a))){r.next=18;break}return r.abrupt("return",Promise.reject("no effective data"));case 18:if(u=na(n),i=ha(n),ca(u)){r.next=22;break}return r.abrupt("return",Promise.reject("avg[".concat(u,"] is not a number")));case 22:if(ca(i)){r.next=24;break}return r.abrupt("return",Promise.reject("sigma[".concat(i,"] is not a number")));case 24:if(f=null,"upper-tail"!==e&&"lower-tail"!==e){r.next=32;break}return r.next=28,_a(o,t);case 28:c=r.sent,f="upper-tail"===e?u+c*i/Math.sqrt(o):u-c*i/Math.sqrt(o),r.next=39;break;case 32:if("two-tailed"!==e){r.next=39;break}return r.next=35,_a(o,t/2);case 35:s=r.sent,l=u-s*i/Math.sqrt(o),p=u+s*i/Math.sqrt(o),f=[l,p];case 39:return r.abrupt("return",f);case 40:case"end":return r.stop()}}),r)}))),qa.apply(this,arguments)}function Aa(){return Aa=ea(oa.mark((function r(n,t){var e,a,o,u=arguments;return oa.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e=u.length>2&&void 0!==u[2]?u[2]:"two-tailed",Or(n)){r.next=3;break}return r.abrupt("return",Promise.reject("arr is not an array"));case 3:if(0!==kr(n)){r.next=5;break}return r.abrupt("return",Promise.reject("arr is not an effective array"));case 5:if(Ge(t)){r.next=7;break}return r.abrupt("return",Promise.reject("p[".concat(t,"] is not a number")));case 7:if(!((t=Je(t))<0)){r.next=10;break}return r.abrupt("return",Promise.reject("p[".concat(t,"] < 0")));case 10:if(!(t>1)){r.next=12;break}return r.abrupt("return",Promise.reject("p[".concat(t,"] > 1")));case 12:if("two-tailed"===e||"upper-tail"===e||"lower-tail"===e){r.next=14;break}return r.abrupt("return",Promise.reject("mode[".concat(e,"] is not 'two-tailed', 'upper-tail' or 'lower-tail'")));case 14:if(a=fa(n),0!==kr(a)){r.next=18;break}return r.abrupt("return",Promise.reject("no effective data"));case 18:return r.next=20,ka(a,t,e);case 20:return o=Or(o=r.sent)?[Math.exp(o[0]),Math.exp(o[1])]:Math.exp(o),r.abrupt("return",o);case 23:case"end":return r.stop()}}),r)}))),Aa.apply(this,arguments)}var Pa=function(r){return"function"==typeof r?r:Pr};var Ea=function(r,n){return(or(r)?Wt:Dt)(r,Pa(n))};var Oa=function(r,n,t,e){for(var a=-1,o=null==r?0:r.length;++a<o;){var u=r[a];n(e,u,t(u),r)}return e};var Sa=function(r,n,t,e){return Dt(r,(function(r,a,o){n(e,r,t(r),o)})),e};var Na=function(r,n){return function(t,e){var a=or(t)?Oa:Sa,o=n?n():{};return a(t,r,Rt(e),o)}},Ia=Object.prototype.hasOwnProperty,Ta=Na((function(r,n,t){Ia.call(r,t)?r[t].push(n):Xt(r,t,[n])})),Fa=h?h.isConcatSpreadable:void 0;var za=function(r){return or(r)||Gn(r)||!!(Fa&&r&&r[Fa])};var La=function r(n,t,e,a,o){var u=-1,i=n.length;for(e||(e=za),o||(o=[]);++u<i;){var f=n[u];t>0&&e(f)?t>1?r(f,t-1,e,a,o):Pn(o,f):a||(o[o.length]=f)}return o};var Ra=function(r,n){var t=r.length;for(r.sort(n);t--;)r[t]=r[t].value;return r};var Ca=function(r,n){if(r!==n){var t=void 0!==r,e=null===r,a=r==r,o=mt(r),u=void 0!==n,i=null===n,f=n==n,c=mt(n);if(!i&&!c&&!o&&r>n||o&&u&&f&&!i&&!c||e&&u&&f||!t&&f||!a)return 1;if(!e&&!o&&!c&&r<n||c&&t&&a&&!e&&!o||i&&t&&a||!u&&a||!f)return-1}return 0};var Da=function(r,n,t){for(var e=-1,a=r.criteria,o=n.criteria,u=a.length,i=t.length;++e<u;){var f=Ca(a[e],o[e]);if(f)return e>=i?f:f*("desc"==t[e]?-1:1)}return r.index-n.index};var Ga=function(r,n,t){n=n.length?Sr(n,(function(r){return or(r)?function(n){return Ot(n,1===r.length?r[0]:r)}:r})):[Pr];var e=-1;n=Sr(n,Yn(Rt));var a=Gt(r,(function(r,t,a){return{criteria:Sr(n,(function(n){return n(r)})),index:++e,value:r}}));return Ra(a,(function(r,n){return Da(r,n,t)}))};var Ua=function(r,n,t){switch(t.length){case 0:return r.call(n);case 1:return r.call(n,t[0]);case 2:return r.call(n,t[0],t[1]);case 3:return r.call(n,t[0],t[1],t[2])}return r.apply(n,t)},Ba=Math.max;var Va=function(r,n,t){return n=Ba(void 0===n?r.length-1:n,0),function(){for(var e=arguments,a=-1,o=Ba(e.length-n,0),u=Array(o);++a<o;)u[a]=e[n+a];a=-1;for(var i=Array(n+1);++a<n;)i[a]=e[a];return i[n]=t(u),Ua(r,this,i)}};var Wa=function(r){return function(){return r}},$a=$t?function(r,n){return $t(r,"toString",{configurable:!0,enumerable:!1,value:Wa(n),writable:!0})}:Pr,Xa=Date.now;var Ya=function(r){var n=0,t=0;return function(){var e=Xa(),a=16-(e-t);if(t=e,a>0){if(++n>=800)return arguments[0]}else n=0;return r.apply(void 0,arguments)}},Ha=Ya($a);var Qa=function(r,n,t){if(!_(t))return!1;var e=i(n);return!!("number"==e?ar(t)&&Wn(n,t.length):"string"==e&&n in t)&&Ir(t[n],r)},Ka=function(r,n){return Ha(Va(r,n,Pr),r+"")}((function(r,n){if(null==r)return[];var t=n.length;return t>1&&Qa(r,n[0],n[1])?n=[]:t>2&&Qa(n[0],n[1],n[2])&&(n=[n[0]]),Ga(r,La(n,1),[])})),Za=Array.prototype.reverse;var Ja=function(r){return null==r?r:Za.call(r)};var ro=function(r){return r&&r.length?qr(r,Pr):0};function no(r){var n=Object.prototype.toString.call(r);return"[object Function]"===n||"[object AsyncFunction]"===n}function to(r){var n,t=Object.prototype.toString.call(r);if(n="[object Promise]"===t)return!0;if("[object Function]"!==t)return!1;try{n="function"!=typeof r.subscribe&&"function"==typeof r.then}catch(r){}return n}function eo(r,n,t,e,a){for(var o=0;o<r.length;++o)r[o]=n*t[o]+e*a[o]}function ao(r,n){return r.y-n.y}function oo(r,n){return uo.apply(this,arguments)}function uo(){return uo=ea(oa.mark((function r(n,t){var e,a,o,u,i,f,c,s,l,p,h,v,m,d,g,b,y,w,x,j,_,M,k,q,A,P,E,O,S,N,I,T,F,z=arguments;return oa.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(d=function(){return d=ea(oa.mark((function r(){var t,e=arguments;return oa.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!to(t=n.apply(void 0,e))){r.next=5;break}return r.next=4,t;case 4:t=r.sent;case 5:return v++,r.abrupt("return",t);case 7:case"end":return r.stop()}}),r)}))),d.apply(this,arguments)},m=function(){return d.apply(this,arguments)},e=z.length>2&&void 0!==z[2]?z[2]:{},no(n)){r.next=5;break}return r.abrupt("return",Promise.reject("invalid fun"));case 5:if(Ce(t)){r.next=7;break}return r.abrupt("return",Promise.reject("params is not an effective array"));case 7:return a=kr(t),Ge(o=St(e,"maxIterations"))||(o=200*a),o=Je(o),Ge(u=St(e,"nonZeroDelta"))||(u=1.05),u=Je(u),Ge(i=St(e,"delta"))||(i=.001),i=Je(i),Ge(f=St(e,"minErrorDelta"))||(f=1e-6),f=Je(f),Ge(c=St(e,"minTolerance"))||(c=1e-5),c=Je(c),Ge(s=St(e,"rho"))||(s=1),s=Je(s),Ge(l=St(e,"chi"))||(l=2),l=Je(l),Ge(p=St(e,"psi"))||(p=-.5),p=Je(p),Ge(h=St(e,"sigma"))||(h=.5),h=Je(h),v=0,(g=new Array(a+1))[0]=t,r.next=40,m(t);case 40:g[0].y=r.sent,g[0].id=0,b=0;case 43:if(!(b<a)){r.next=54;break}return(y=t.slice())[b]=y[b]?y[b]*u:i,g[b+1]=y,r.next=49,m(y);case 49:g[b+1].y=r.sent,g[b+1].id=b+1;case 51:++b,r.next=43;break;case 54:w=function(r){for(var n=0;n<r.length;n++)g[a][n]=r[n];g[a].y=r.y},j=t.slice(),_=t.slice(),M=t.slice(),k=t.slice(),q=0;case 60:if(!(q<o)){r.next=113;break}for(g.sort(ao),x=0,A=0;A<a;++A)x=Math.max(x,Math.abs(g[0][A]-g[1][A]));if(!(Math.abs(g[0].y-g[a].y)<f&&x<c)){r.next=66;break}return r.abrupt("break",113);case 66:for(P=0;P<a;++P){for(j[P]=0,E=0;E<a;++E)j[P]+=g[E][P];j[P]/=a}return O=g[a],eo(_,1+s,j,-s,O),r.next=71,m(_);case 71:if(_.y=r.sent,!(_.y<g[0].y)){r.next=80;break}return eo(k,1+l,j,-l,O),r.next=76,m(k);case 76:k.y=r.sent,k.y<_.y?w(k):w(_),r.next=110;break;case 80:if(!(_.y>=g[a-1].y)){r.next=109;break}if(S=!1,!(_.y>O.y)){r.next=90;break}return eo(M,1+p,j,-p,O),r.next=86,m(M);case 86:M.y=r.sent,M.y<O.y?w(M):S=!0,r.next=95;break;case 90:return eo(M,1-p*s,j,p*s,O),r.next=93,m(M);case 93:M.y=r.sent,M.y<_.y?w(M):S=!0;case 95:if(!S){r.next=107;break}if(!(h>=1)){r.next=98;break}return r.abrupt("break",113);case 98:N=1;case 99:if(!(N<g.length)){r.next=107;break}return eo(g[N],1-h,g[0],h,g[N]),r.next=103,m(g[N]);case 103:g[N].y=r.sent;case 104:++N,r.next=99;break;case 107:r.next=110;break;case 109:w(_);case 110:++q,r.next=60;break;case 113:for(g.sort(ao),I=[],T=g[0],F=0;F<a;F++)I.push(T[F]);return r.abrupt("return",{count:v,y:g[0].y,x:I});case 118:case"end":return r.stop()}}),r)}))),uo.apply(this,arguments)}var io=function(r,n,t){for(var e=-1,a=r.length;++e<a;){var o=r[e],u=n(o);if(null!=u&&(void 0===i?u==u&&!mt(u):t(u,i)))var i=u,f=o}return f};var fo=function(r,n){return r<n};var co=function(r){return r&&r.length?io(r,Pr,fo):void 0};var so=function(r,n){return r>n};var lo=function(r){return r&&r.length?io(r,Pr,so):void 0};function po(r,n){return!!ze(r)&&(!(!De(n)&&!Ge(n))&&n in r)}function ho(r,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},e=St(t,"keyMax");De(e)||(e="max");var a=St(t,"keyMin");De(a)||(a="min");var o=St(t,"keyValue");De(o)||(o="value");var u=St(t,"keyItems");if(De(u)||(u="items"),!Ce(r))return[];if(!Ce(n))return[];var i=Fe(n);return Ea(r,(function(r,t){var f=St(r,o);Ge(f)?f=Je(f):Ge(r)&&(f=Je(r)),ca(f)&&Ea(n,(function(n,t){var o=St(n,e,null),c=St(n,a,null);if(null!==o&&null!==c&&Ge(o)&&Ge(c)){var s=St(n,"maxType");"<="!==s&&"<"!==s&&(s="<=");var l,p=St(n,"minType");">="!==p&&">"!==p&&(p=">="),o=Je(o),c=Je(c),l="<="===s?f<=o:f<o,(">="===p?f>=c:f>c)&&l&&(po(i[t],u)||(i[t][u]=[]),i[t][u].push(r))}}))})),i}function vo(r,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(!Ge(r))return[];if(r=Je(r),!Ge(n))return[];n=Je(n),ja(t)||(t=1);for(var e=(n-r)/(t=xa(t)),a=r,o=[],u=0;u<=t;u++)o.push(a),a+=e;return o}function mo(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};ja(n)||(n=30),n=xa(n);var e=ra(r);if(0===kr(e))return[];var a=St(t,"min",null);Ge(a)||(a=co(e)),a=Je(a);var o=St(t,"max",null);Ge(o)||(o=lo(e));for(var u=vo(a,o=Je(o),n),i=[],f=0;f<kr(u)-1;f++){var c=0===f?">=":">",s="<=",l={min:u[f],max:u[f+1],avg:(u[f]+u[f+1])/2,minType:c,maxType:s};i.push(l)}var p=ho(e,i),h=Ut(p,(function(r){return{min:r.min,max:r.max,avg:r.avg,arr:St(r,"items",[])}}));return h}function go(r){return bo.apply(this,arguments)}function bo(){return bo=ea(oa.mark((function r(n){var t,e,a,o,u,i,f,c,s,l,p,h,v,m,d,g,b=arguments;return oa.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=b.length>1&&void 0!==b[1]?b[1]:{},Or(n)){r.next=3;break}return r.abrupt("return",Promise.reject("arr is not an array"));case 3:if(0!==kr(n)){r.next=5;break}return r.abrupt("return",Promise.reject("arr is not an effective array"));case 5:if(ja(e=St(t,"n"))||(e=30),e=xa(e),a=St(t,"min",null),o=St(t,"max",null),u=ra(n),u=Vt(u,(function(r){return r>0})),0!==kr(u)){r.next=15;break}return r.abrupt("return",Promise.reject("no effective data"));case 15:if(i=mo(u,e,{min:a,max:o}),f=St(i,"0.max")-St(i,"0.min"),i=Ut(i,(function(r){return r.counts=kr(r.arr),r})),!((c=ro(Ut(i,"counts"))*f)<=0)){r.next=21;break}throw new Error("r[".concat(c,"<=0]"));case 21:return i=Ut(i,(function(r){return r.pdf=r.counts/c,r})),s=function(r,n,t){return pa.gamma.pdf(r,n,t)},l=function(r,n){var t=[];return Ea(i,(function(e){var a=e.avg,o=e.pdf,u=s(a,r,n);if(!ca(u))throw console.log("x",a,"shape",r,"scale",n),new Error("yf is not number");t.push([a,o,u])})),t},p=function(){var r=ea(oa.mark((function r(n){var t,e,a;return oa.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=n[0],e=n[1],a=0,Ea(l(t,e),(function(r){var n=r[1],t=r[2];a+=Math.pow(n-t,2)})),r.abrupt("return",a);case 5:case"end":return r.stop()}}),r)})));return function(n){return r.apply(this,arguments)}}(),r.next=27,oo(p,[1,1]);case 27:return h=r.sent,v=St(h,"x.0",null),m=St(h,"x.1",null),d=l(v,m),g=Ut(d,(function(r){return[r[0],r[1]*c,r[2]*c]})),r.abrupt("return",{shape:v,scale:m,arr:u,arrPdf:d,arrCounts:g,dx:f,bs:i});case 33:case"end":return r.stop()}}),r)}))),bo.apply(this,arguments)}function yo(r,n){(null==n||n>r.length)&&(n=r.length);for(var t=0,e=new Array(n);t<n;t++)e[t]=r[t];return e}function wo(r){return function(r){if(Array.isArray(r))return yo(r)}(r)||function(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||function(r,n){if(r){if("string"==typeof r)return yo(r,n);var t=Object.prototype.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?yo(r,n):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var xo=ya("floor"),jo=ya("ceil");function _o(r,n){return Mo.apply(this,arguments)}function Mo(){return Mo=ea(oa.mark((function r(n,t){var e,a,o,u,i,f,c,s,l,p,h,v,m,d,g,b,y,w,x=arguments;return oa.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e=x.length>2&&void 0!==x[2]?x[2]:{},no(t)){r.next=3;break}throw new Error("invalid fun");case 3:if(a=ra(n),0!==kr(a)){r.next=6;break}return r.abrupt("return",null);case 6:if(ja(o=St(e,"nCurve"))||(o=100),o=xa(o),Ge(u=St(e,"dx",null))?(u=Je(u),s=co(a),l=lo(a),f=xo(s/u)*u,c=jo(l/u)*u,i=wa(c-f)/u):(ja(i=St(e,"n"))||(i=30),i=xa(i),f=St(e,"min",null),c=St(e,"max",null)),p=mo(a,i,{min:f,max:c}),Ge(u)||(u=St(p,"0.max")-St(p,"0.min")),p=Ut(p,(function(r){return r.counts=kr(r.arr),r})),h=[].concat(wo(Ut(p,"min")),wo(Ut(p,"max"))),v=co(h),m=lo(h),d=Ut(p,"counts"),g=ro(d)*u,b=Ut(d,(function(r){return r/g})),y=vo(v,m,o),!to(w=t({arr:a,min:v,max:m,barWidth:u,bins:p,counts:d,pdfs:b,curveX:y}))){r.next=26;break}return r.next=25,w;case 25:w=r.sent;case 26:return r.abrupt("return",{arr:a,min:v,max:m,barWidth:u,bins:p,counts:d,pdfs:b,ratioForCountToPdf:1/g,curveX:y,curveY:w});case 27:case"end":return r.stop()}}),r)}))),Mo.apply(this,arguments)}function ko(){return ko=ea(oa.mark((function r(n){var t,e,a,o,u,i,f,c=arguments;return oa.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=c.length>1&&void 0!==c[1]?c[1]:{},Or(n)){r.next=3;break}return r.abrupt("return",Promise.reject("arr is not an array"));case 3:if(0!==kr(n)){r.next=5;break}return r.abrupt("return",Promise.reject("arr is not an effective array"));case 5:return e=ra(n),e=Vt(e,(function(r){return r>0})),r.next=9,go(n,t);case 9:return a=r.sent,r.next=12,_o(e,(function(r){return Ut(r.curveX,(function(r){return pa.gamma.pdf(r,a.shape,a.scale)}))}),t);case 12:return o=r.sent,u=Ut(o.bins,(function(r,n){return r.pdf=o.pdfs[n],r})),i=Ut(o.curveX,(function(r,n){return{x:r,pdf:o.curveY[n]}})),f={shape:a.shape,scale:a.scale,arr:o.arr,min:o.min,max:o.max,barWidth:o.barWidth,ratioForCountToPdf:o.ratioForCountToPdf,bins:u,curves:i},r.abrupt("return",f);case 17:case"end":return r.stop()}}),r)}))),ko.apply(this,arguments)}function qo(r,n,t){return n in r?Object.defineProperty(r,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[n]=t,r}function Ao(r,n){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(r);n&&(e=e.filter((function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable}))),t.push.apply(t,e)}return t}function Po(r){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Ao(Object(t),!0).forEach((function(n){qo(r,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Ao(Object(t)).forEach((function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))}))}return r}function Eo(){return Eo=ea(oa.mark((function r(n,t){var e,a,o,u,i,f,c=arguments;return oa.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e=c.length>2&&void 0!==c[2]?c[2]:{},Or(n)){r.next=3;break}return r.abrupt("return",Promise.reject("arr is not an array"));case 3:if(0!==kr(n)){r.next=5;break}return r.abrupt("return",Promise.reject("arr is not an effective array"));case 5:if(Ge(t)){r.next=7;break}return r.abrupt("return",Promise.reject("ratio[".concat(t,"] is not a number")));case 7:if(!((t=Je(t))<0)){r.next=10;break}return r.abrupt("return",Promise.reject("ratio[".concat(t,"] < 0")));case 10:if(!(t>1)){r.next=12;break}return r.abrupt("return",Promise.reject("ratio[".concat(t,"] > 1")));case 12:return ja(a=St(e,"n"))||(a=30),a=xa(a),o=St(e,"min",null),u=St(e,"max",null),r.next=19,go(n,{n:a,min:o,max:u});case 19:return i=r.sent,f=pa.gamma.inv(t,i.shape,i.scale),r.abrupt("return",Po({inv:f},i));case 22:case"end":return r.stop()}}),r)}))),Eo.apply(this,arguments)}function Oo(r){if(!Or(r))return null;if(0===kr(r))return null;var n=ia(r),t=kr(n);if(0===t)return null;var e=0;Ea(n,(function(r){e+=Math.log(r)})),e/=t;try{e=Math.exp(e)}catch(r){return console.log(r),null}return e}function So(r){return No.apply(this,arguments)}function No(){return No=ea(oa.mark((function r(n){var t,e,a,o,u,i,f,c=arguments;return oa.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=c.length>1&&void 0!==c[1]?c[1]:{},Or(n)){r.next=3;break}return r.abrupt("return",Promise.reject("arr is not an array"));case 3:if(0!==kr(n)){r.next=5;break}return r.abrupt("return",Promise.reject("arr is not an effective array"));case 5:return e=null,a=null,r.next=9,_o(n,(function(r){e=na(r.arr);var n=(a=ha(r.arr))*Math.sqrt(2*Math.PI);return Ut(r.curveX,(function(r){var t=0;return 0!==n&&(t=1/n*Math.exp(-Math.pow(r-e,2)/(2*Math.pow(a,2)))),t}))}),t);case 9:return o=r.sent,u=Ut(o.bins,(function(r,n){return r.pdf=o.pdfs[n],r})),i=Ut(o.curveX,(function(r,n){return{x:r,pdf:o.curveY[n]}})),f={avg:e,std:a,arr:o.arr,min:o.min,max:o.max,barWidth:o.barWidth,ratioForCountToPdf:o.ratioForCountToPdf,bins:u,curves:i},r.abrupt("return",f);case 14:case"end":return r.stop()}}),r)}))),No.apply(this,arguments)}function Io(){return Io=ea(oa.mark((function r(n){var t,e,a,o,u,i,f,c,s=arguments;return oa.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=s.length>1&&void 0!==s[1]?s[1]:{},Or(n)){r.next=3;break}return r.abrupt("return",Promise.reject("arr is not an array"));case 3:if(0!==kr(n)){r.next=5;break}return r.abrupt("return",Promise.reject("arr is not an effective array"));case 5:return r.next=7,So(n,t);case 7:return e=r.sent,a=fa(n),r.next=11,So(a);case 11:return o=r.sent,u=Ut(o.curves,(function(r){return{x:Math.exp(r.x),pdf:r.pdf}})),i=e.ratioForCountToPdf/o.ratioForCountToPdf,u=Ut(u,(function(r){return r.pdf*=i,r})),f=Oo(e.arr),c={avg:e.avg,std:e.std,avg_geo:f,avg_log:o.avg,std_log:o.std,arr:e.arr,min:e.min,max:e.max,barWidth:e.barWidth,ratioForCountToPdf:e.ratioForCountToPdf,bins:e.bins,curves:u},r.abrupt("return",c);case 18:case"end":return r.stop()}}),r)}))),Io.apply(this,arguments)}function To(r,n){return Fo.apply(this,arguments)}function Fo(){return Fo=ea(oa.mark((function r(n,t){var e,a,o,u;return oa.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(Or(n)){r.next=2;break}return r.abrupt("return",Promise.reject("arr is not an array"));case 2:if(0!==kr(n)){r.next=4;break}return r.abrupt("return",Promise.reject("arr is not an effective array"));case 4:if(Ge(t)){r.next=6;break}return r.abrupt("return",Promise.reject("ratio[".concat(t,"] is not a number")));case 6:if(!((t=Je(t))<0)){r.next=9;break}return r.abrupt("return",Promise.reject("ratio[".concat(t,"] < 0")));case 9:if(!(t>1)){r.next=11;break}return r.abrupt("return",Promise.reject("ratio[".concat(t,"] > 1")));case 11:if(e=ra(n),0!==kr(e)){r.next=15;break}return r.abrupt("return",Promise.reject("no effective data"));case 15:if(a=na(e),o=ha(e),ca(a)){r.next=19;break}return r.abrupt("return",Promise.reject("avg[".concat(a,"] is not a number")));case 19:if(ca(o)){r.next=21;break}return r.abrupt("return",Promise.reject("std[".concat(o,"] is not a number")));case 21:if(!(o<=0)){r.next=23;break}return r.abrupt("return",Promise.reject("std[".concat(o,"] <= 0")));case 23:return u=pa.normal.inv(t,a,o),r.abrupt("return",{inv:u,avg:a,std:o,arr:e});case 25:case"end":return r.stop()}}),r)}))),Fo.apply(this,arguments)}function zo(){return zo=ea(oa.mark((function r(n,t){var e,a;return oa.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(Or(n)){r.next=2;break}return r.abrupt("return",Promise.reject("arr is not an array"));case 2:if(0!==kr(n)){r.next=4;break}return r.abrupt("return",Promise.reject("arr is not an effective array"));case 4:if(Ge(t)){r.next=6;break}return r.abrupt("return",Promise.reject("ratio[".concat(t,"] is not a number")));case 6:if(!((t=Je(t))<0)){r.next=9;break}return r.abrupt("return",Promise.reject("ratio[".concat(t,"] < 0")));case 9:if(!(t>1)){r.next=11;break}return r.abrupt("return",Promise.reject("ratio[".concat(t,"] > 1")));case 11:if(e=fa(n),0!==kr(e)){r.next=15;break}return r.abrupt("return",Promise.reject("no effective data"));case 15:return r.next=17,To(e,t);case 17:if(a=r.sent,ca(St(a,"inv"))){r.next=20;break}return r.abrupt("return",Promise.reject("invalid value from arrNormInv"));case 20:return a={inv:Math.exp(a.inv),avg:Math.exp(a.avg),std:Math.exp(a.std),arr:Ut(a.arr,(function(r){return Math.exp(r)}))},r.abrupt("return",a);case 22:case"end":return r.stop()}}),r)}))),zo.apply(this,arguments)}function Lo(r){return!!da(r)&&xa(r)>=0}function Ro(r){if(0===r.length)return 0;var n,t=r[0],e=0;if("number"!=typeof t)return NaN;for(var a=1;a<r.length;a++){if("number"!=typeof r[a])return NaN;n=t+r[a],Math.abs(t)>=Math.abs(r[a])?e+=t-n+r[a]:e+=r[a]-n+t,t=n}return t+e}function Co(r){if(0===r.length)throw new Error("mean requires at least one data point");return Ro(r)/r.length}function Do(r,n){var t,e,a=Co(r),o=0;if(2===n)for(e=0;e<r.length;e++)o+=(t=r[e]-a)*t;else for(e=0;e<r.length;e++)o+=Math.pow(r[e]-a,n);return o}function Go(r){if(0===r.length)throw new Error("variance requires at least one data point");return Do(r,2)/r.length}function Uo(r){if(1===r.length)return 0;var n=Go(r);return Math.sqrt(n)}function Bo(r){if(0===r.length)throw new Error("mode requires at least one data point");if(1===r.length)return r[0];for(var n=r[0],t=NaN,e=0,a=1,o=1;o<r.length+1;o++)r[o]!==n?(a>e&&(e=a,t=n),a=1,n=r[o]):a++;return t}function Vo(r){return r.slice().sort((function(r,n){return r-n}))}function Wo(r){if(0===r.length)throw new Error("min requires at least one data point");for(var n=r[0],t=1;t<r.length;t++)r[t]<n&&(n=r[t]);return n}function $o(r){if(0===r.length)throw new Error("max requires at least one data point");for(var n=r[0],t=1;t<r.length;t++)r[t]>n&&(n=r[t]);return n}function Xo(r){for(var n=0,t=0;t<r.length;t++){if("number"!=typeof r[t])return NaN;n+=r[t]}return n}function Yo(r,n){var t=r.length*n;if(0===r.length)throw new Error("quantile requires at least one data point.");if(n<0||n>1)throw new Error("quantiles must be between 0 and 1");return 1===n?r[r.length-1]:0===n?r[0]:t%1!=0?r[Math.ceil(t)-1]:r.length%2==0?(r[t-1]+r[t])/2:r[t]}function Ho(r,n,t,e){for(t=t||0,e=e||r.length-1;e>t;){if(e-t>600){var a=e-t+1,o=n-t+1,u=Math.log(a),i=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*i*(a-i)/a);o-a/2<0&&(f*=-1),Ho(r,n,Math.max(t,Math.floor(n-o*i/a+f)),Math.min(e,Math.floor(n+(a-o)*i/a+f)))}var c=r[n],s=t,l=e;for(Qo(r,t,n),r[e]>c&&Qo(r,t,e);s<l;){for(Qo(r,s,l),s++,l--;r[s]<c;)s++;for(;r[l]>c;)l--}r[t]===c?Qo(r,t,l):Qo(r,++l,e),l<=n&&(t=l+1),n<=l&&(e=l-1)}}function Qo(r,n,t){var e=r[n];r[n]=r[t],r[t]=e}function Ko(r,n){var t=r.slice();if(Array.isArray(n)){!function(r,n){for(var t=[0],e=0;e<n.length;e++)t.push(ru(r.length,n[e]));t.push(r.length-1),t.sort(Jo);var a=[0,t.length-1];for(;a.length;){var o=Math.ceil(a.pop()),u=Math.floor(a.pop());if(!(o-u<=1)){var i=Math.floor((u+o)/2);Zo(r,t[i],Math.floor(t[u]),Math.ceil(t[o])),a.push(u,i,i,o)}}}(t,n);for(var e=[],a=0;a<n.length;a++)e[a]=Yo(t,n[a]);return e}return Zo(t,ru(t.length,n),0,t.length-1),Yo(t,n)}function Zo(r,n,t,e){n%1==0?Ho(r,n,t,e):(Ho(r,n=Math.floor(n),t,e),Ho(r,n+1,n+1,e))}function Jo(r,n){return r-n}function ru(r,n){var t=r*n;return 1===n?r-1:0===n?0:t%1!=0?Math.ceil(t)-1:r%2==0?t-.5:t}function nu(r,n){if(n<r[0])return 0;if(n>r[r.length-1])return 1;var t=function(r,n){var t=0,e=0,a=r.length;for(;e<a;)n<=r[t=e+a>>>1]?a=t:e=-~t;return e}(r,n);if(r[t]!==n)return t/r.length;t++;var e=function(r,n){var t=0,e=0,a=r.length;for(;e<a;)n>=r[t=e+a>>>1]?e=-~t:a=t;return e}(r,n);if(e===t)return t/r.length;var a=e-t+1;return a*(e+t)/2/a/r.length}function tu(r){var n=Ko(r,.75),t=Ko(r,.25);if("number"==typeof n&&"number"==typeof t)return n-t}function eu(r){return+Ko(r,.5)}function au(r){for(var n=eu(r),t=[],e=0;e<r.length;e++)t.push(Math.abs(r[e]-n));return eu(t)}function ou(r,n){n=n||Math.random;for(var t,e,a=r.length;a>0;)e=Math.floor(n()*a--),t=r[a],r[a]=r[e],r[e]=t;return r}function uu(r,n){return ou(r.slice(),n)}function iu(r,n,t){return uu(r,t).slice(0,n)}function fu(r,n){for(var t=[],e=0;e<r;e++){for(var a=[],o=0;o<n;o++)a.push(0);t.push(a)}return t}function cu(r){for(var n,t=0,e=0;e<r.length;e++)0!==e&&r[e]===n||(n=r[e],t++);return t}function su(r,n,t,e){var a;if(r>0){var o=(t[n]-t[r-1])/(n-r+1);a=e[n]-e[r-1]-(n-r+1)*o*o}else a=e[n]-t[n]*t[n]/(n+1);return a<0?0:a}function lu(r,n,t,e,a,o,u){if(!(r>n)){var i=Math.floor((r+n)/2);e[t][i]=e[t-1][i-1],a[t][i]=i;var f=t;r>t&&(f=Math.max(f,a[t][r-1]||0)),f=Math.max(f,a[t-1][i]||0);var c,s,l,p=i-1;n<e[0].length-1&&(p=Math.min(p,a[t][n+1]||0));for(var h=p;h>=f&&!((c=su(h,i,o,u))+e[t-1][f-1]>=e[t][i]);--h)(s=su(f,i,o,u)+e[t-1][f-1])<e[t][i]&&(e[t][i]=s,a[t][i]=f),f++,(l=c+e[t-1][h-1])<e[t][i]&&(e[t][i]=l,a[t][i]=h);lu(r,i-1,t,e,a,o,u),lu(i+1,n,t,e,a,o,u)}}function pu(r,n){if(r.length!==n.length)throw new Error("sampleCovariance requires samples with equal lengths");if(r.length<2)throw new Error("sampleCovariance requires at least two data points in each sample");for(var t=Co(r),e=Co(n),a=0,o=0;o<r.length;o++)a+=(r[o]-t)*(n[o]-e);return a/(r.length-1)}function hu(r){if(r.length<2)throw new Error("sampleVariance requires at least two data points");return Do(r,2)/(r.length-1)}function vu(r){var n=hu(r);return Math.sqrt(n)}function mu(r,n){return pu(r,n)/vu(r)/vu(n)}function du(r,n,t,e){return(r*n+t*e)/(n+e)}function gu(r){if(0===r.length)throw new Error("meanSimple requires at least one data point");return Xo(r)/r.length}function bu(r){if(0===r.length)throw new Error("rootMeanSquare requires at least one data point");for(var n=0,t=0;t<r.length;t++)n+=Math.pow(r[t],2);return Math.sqrt(n/r.length)}var yu=function(){this.totalCount=0,this.data={}};yu.prototype.train=function(r,n){for(var t in this.data[n]||(this.data[n]={}),r){var e=r[t];void 0===this.data[n][t]&&(this.data[n][t]={}),void 0===this.data[n][t][e]&&(this.data[n][t][e]=0),this.data[n][t][e]++}this.totalCount++},yu.prototype.score=function(r){var n,t={};for(var e in r){var a=r[e];for(n in this.data)t[n]={},this.data[n][e]?t[n][e+"_"+a]=(this.data[n][e][a]||0)/this.totalCount:t[n][e+"_"+a]=0}var o={};for(n in t)for(var u in o[n]=0,t[n])o[n]+=t[n][u];return o};var wu=function(){this.weights=[],this.bias=0};wu.prototype.predict=function(r){if(r.length!==this.weights.length)return null;for(var n=0,t=0;t<this.weights.length;t++)n+=this.weights[t]*r[t];return(n+=this.bias)>0?1:0},wu.prototype.train=function(r,n){if(0!==n&&1!==n)return null;r.length!==this.weights.length&&(this.weights=r,this.bias=1);var t=this.predict(r);if("number"==typeof t&&t!==n){for(var e=n-t,a=0;a<this.weights.length;a++)this.weights[a]+=e*r[a];this.bias+=e}return this};var xu=1e-4;function ju(r){if(r<0)throw new Error("factorial requires a non-negative value");if(Math.floor(r)!==r)throw new Error("factorial requires an integer input");for(var n=1,t=2;t<=r;t++)n*=t;return n}var _u=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],Mu=Math.log(Math.sqrt(2*Math.PI));var ku={1:{.995:0,.99:0,.975:0,.95:0,.9:.02,.5:.45,.1:2.71,.05:3.84,.025:5.02,.01:6.63,.005:7.88},2:{.995:.01,.99:.02,.975:.05,.95:.1,.9:.21,.5:1.39,.1:4.61,.05:5.99,.025:7.38,.01:9.21,.005:10.6},3:{.995:.07,.99:.11,.975:.22,.95:.35,.9:.58,.5:2.37,.1:6.25,.05:7.81,.025:9.35,.01:11.34,.005:12.84},4:{.995:.21,.99:.3,.975:.48,.95:.71,.9:1.06,.5:3.36,.1:7.78,.05:9.49,.025:11.14,.01:13.28,.005:14.86},5:{.995:.41,.99:.55,.975:.83,.95:1.15,.9:1.61,.5:4.35,.1:9.24,.05:11.07,.025:12.83,.01:15.09,.005:16.75},6:{.995:.68,.99:.87,.975:1.24,.95:1.64,.9:2.2,.5:5.35,.1:10.65,.05:12.59,.025:14.45,.01:16.81,.005:18.55},7:{.995:.99,.99:1.25,.975:1.69,.95:2.17,.9:2.83,.5:6.35,.1:12.02,.05:14.07,.025:16.01,.01:18.48,.005:20.28},8:{.995:1.34,.99:1.65,.975:2.18,.95:2.73,.9:3.49,.5:7.34,.1:13.36,.05:15.51,.025:17.53,.01:20.09,.005:21.96},9:{.995:1.73,.99:2.09,.975:2.7,.95:3.33,.9:4.17,.5:8.34,.1:14.68,.05:16.92,.025:19.02,.01:21.67,.005:23.59},10:{.995:2.16,.99:2.56,.975:3.25,.95:3.94,.9:4.87,.5:9.34,.1:15.99,.05:18.31,.025:20.48,.01:23.21,.005:25.19},11:{.995:2.6,.99:3.05,.975:3.82,.95:4.57,.9:5.58,.5:10.34,.1:17.28,.05:19.68,.025:21.92,.01:24.72,.005:26.76},12:{.995:3.07,.99:3.57,.975:4.4,.95:5.23,.9:6.3,.5:11.34,.1:18.55,.05:21.03,.025:23.34,.01:26.22,.005:28.3},13:{.995:3.57,.99:4.11,.975:5.01,.95:5.89,.9:7.04,.5:12.34,.1:19.81,.05:22.36,.025:24.74,.01:27.69,.005:29.82},14:{.995:4.07,.99:4.66,.975:5.63,.95:6.57,.9:7.79,.5:13.34,.1:21.06,.05:23.68,.025:26.12,.01:29.14,.005:31.32},15:{.995:4.6,.99:5.23,.975:6.27,.95:7.26,.9:8.55,.5:14.34,.1:22.31,.05:25,.025:27.49,.01:30.58,.005:32.8},16:{.995:5.14,.99:5.81,.975:6.91,.95:7.96,.9:9.31,.5:15.34,.1:23.54,.05:26.3,.025:28.85,.01:32,.005:34.27},17:{.995:5.7,.99:6.41,.975:7.56,.95:8.67,.9:10.09,.5:16.34,.1:24.77,.05:27.59,.025:30.19,.01:33.41,.005:35.72},18:{.995:6.26,.99:7.01,.975:8.23,.95:9.39,.9:10.87,.5:17.34,.1:25.99,.05:28.87,.025:31.53,.01:34.81,.005:37.16},19:{.995:6.84,.99:7.63,.975:8.91,.95:10.12,.9:11.65,.5:18.34,.1:27.2,.05:30.14,.025:32.85,.01:36.19,.005:38.58},20:{.995:7.43,.99:8.26,.975:9.59,.95:10.85,.9:12.44,.5:19.34,.1:28.41,.05:31.41,.025:34.17,.01:37.57,.005:40},21:{.995:8.03,.99:8.9,.975:10.28,.95:11.59,.9:13.24,.5:20.34,.1:29.62,.05:32.67,.025:35.48,.01:38.93,.005:41.4},22:{.995:8.64,.99:9.54,.975:10.98,.95:12.34,.9:14.04,.5:21.34,.1:30.81,.05:33.92,.025:36.78,.01:40.29,.005:42.8},23:{.995:9.26,.99:10.2,.975:11.69,.95:13.09,.9:14.85,.5:22.34,.1:32.01,.05:35.17,.025:38.08,.01:41.64,.005:44.18},24:{.995:9.89,.99:10.86,.975:12.4,.95:13.85,.9:15.66,.5:23.34,.1:33.2,.05:36.42,.025:39.36,.01:42.98,.005:45.56},25:{.995:10.52,.99:11.52,.975:13.12,.95:14.61,.9:16.47,.5:24.34,.1:34.28,.05:37.65,.025:40.65,.01:44.31,.005:46.93},26:{.995:11.16,.99:12.2,.975:13.84,.95:15.38,.9:17.29,.5:25.34,.1:35.56,.05:38.89,.025:41.92,.01:45.64,.005:48.29},27:{.995:11.81,.99:12.88,.975:14.57,.95:16.15,.9:18.11,.5:26.34,.1:36.74,.05:40.11,.025:43.19,.01:46.96,.005:49.65},28:{.995:12.46,.99:13.57,.975:15.31,.95:16.93,.9:18.94,.5:27.34,.1:37.92,.05:41.34,.025:44.46,.01:48.28,.005:50.99},29:{.995:13.12,.99:14.26,.975:16.05,.95:17.71,.9:19.77,.5:28.34,.1:39.09,.05:42.56,.025:45.72,.01:49.59,.005:52.34},30:{.995:13.79,.99:14.95,.975:16.79,.95:18.49,.9:20.6,.5:29.34,.1:40.26,.05:43.77,.025:46.98,.01:50.89,.005:53.67},40:{.995:20.71,.99:22.16,.975:24.43,.95:26.51,.9:29.05,.5:39.34,.1:51.81,.05:55.76,.025:59.34,.01:63.69,.005:66.77},50:{.995:27.99,.99:29.71,.975:32.36,.95:34.76,.9:37.69,.5:49.33,.1:63.17,.05:67.5,.025:71.42,.01:76.15,.005:79.49},60:{.995:35.53,.99:37.48,.975:40.48,.95:43.19,.9:46.46,.5:59.33,.1:74.4,.05:79.08,.025:83.3,.01:88.38,.005:91.95},70:{.995:43.28,.99:45.44,.975:48.76,.95:51.74,.9:55.33,.5:69.33,.1:85.53,.05:90.53,.025:95.02,.01:100.42,.005:104.22},80:{.995:51.17,.99:53.54,.975:57.15,.95:60.39,.9:64.28,.5:79.33,.1:96.58,.05:101.88,.025:106.63,.01:112.33,.005:116.32},90:{.995:59.2,.99:61.75,.975:65.65,.95:69.13,.9:73.29,.5:89.33,.1:107.57,.05:113.14,.025:118.14,.01:124.12,.005:128.3},100:{.995:67.33,.99:70.06,.975:74.22,.95:77.93,.9:82.36,.5:99.33,.1:118.5,.05:124.34,.025:129.56,.01:135.81,.005:140.17}};var qu=Math.sqrt(2*Math.PI),Au={gaussian:function(r){return Math.exp(-.5*r*r)/qu}},Pu={nrd:function(r){var n=vu(r),t=tu(r);return"number"==typeof t&&(n=Math.min(n,t/1.34)),1.06*n*Math.pow(r.length,-.2)}};function Eu(r,n,t){var e,a;if(void 0===n)e=Au.gaussian;else if("string"==typeof n){if(!Au[n])throw new Error('Unknown kernel "'+n+'"');e=Au[n]}else e=n;if(void 0===t)a=Pu.nrd(r);else if("string"==typeof t){if(!Pu[t])throw new Error('Unknown bandwidth method "'+t+'"');a=Pu[t](r)}else a=t;return function(n){var t=0,o=0;for(t=0;t<r.length;t++)o+=e((n-r[t])/a);return o/a/r.length}}var Ou=Math.sqrt(2*Math.PI);function Su(r){for(var n=r,t=r,e=1;e<15;e++)n+=t*=r*r/(2*e+1);return Math.round(1e4*(.5+n/Ou*Math.exp(-r*r/2)))/1e4}for(var Nu=[],Iu=0;Iu<=3.09;Iu+=.01)Nu.push(Su(Iu));function Tu(r){var n=1/(1+.5*Math.abs(r)),t=n*Math.exp(-r*r+((((((((.17087277*n-.82215223)*n+1.48851587)*n-1.13520398)*n+.27886807)*n-.18628806)*n+.09678418)*n+.37409196)*n+1.00002368)*n-1.26551223);return r>=0?1-t:t-1}function Fu(r){var n=8*(Math.PI-3)/(3*Math.PI*(4-Math.PI)),t=Math.sqrt(Math.sqrt(Math.pow(2/(Math.PI*n)+Math.log(1-r*r)/2,2)-Math.log(1-r*r)/n)-(2/(Math.PI*n)+Math.log(1-r*r)/2));return r>=0?t:-t}function zu(r){if("number"==typeof r)return r<0?-1:0===r?0:1;throw new TypeError("not a number")}function Lu(r,n){for(var t=0,e=0;e<r.length;e++){var a=r[e]-n[e];t+=a*a}return Math.sqrt(t)}function Ru(r,n){return r.map((function(r){for(var t=Number.MAX_VALUE,e=-1,a=0;a<n.length;a++){var o=Lu(r,n[a]);o<t&&(t=o,e=a)}return e}))}function Cu(r,n,t){for(var e=r[0].length,a=fu(t,e),o=Array(t).fill(0),u=r.length,i=0;i<u;i++){for(var f=r[i],c=n[i],s=a[c],l=0;l<e;l++)s[l]+=f[l];o[c]+=1}for(var p=0;p<t;p++){if(0===o[p])throw new Error("Centroid "+p+" has no friends");for(var h=a[p],v=0;v<e;v++)h[v]/=o[p]}return a}function Du(r,n){for(var t=0,e=0;e<r.length;e++)t+=Lu(r[e],n[e]);return t}function Gu(r,n){if(r.length!==n.length)throw new Error("must have exactly as many labels as points");for(var t=function(r){for(var n=1+$o(r),t=Array(n),e=0;e<r.length;e++){var a=r[e];void 0===t[a]&&(t[a]=[]),t[a].push(e)}return t}(n),e=function(r){for(var n=r.length,t=fu(n,n),e=0;e<n;e++)for(var a=0;a<e;a++)t[e][a]=Lu(r[e],r[a]),t[a][e]=t[e][a];return t}(r),a=[],o=0;o<r.length;o++){var u=0;if(t[n[o]].length>1){var i=Bu(o,t[n[o]],e),f=Uu(o,n,t,e);u=(f-i)/Math.max(i,f)}a.push(u)}return a}function Uu(r,n,t,e){for(var a=n[r],o=Number.MAX_VALUE,u=0;u<t.length;u++)if(u!==a){var i=Bu(r,t[u],e);i<o&&(o=i)}return o}function Bu(r,n,t){for(var e=0,a=0;a<n.length;a++)e+=t[r][n[a]];return e/n.length}function Vu(r,n){return 0===r&&0===n?0:Math.abs((r-n)/n)}var Wu=Object.freeze({__proto__:null,BayesianClassifier:yu,PerceptronModel:wu,addToMean:function(r,n,t){return r+(t-r)/(n+1)},approxEqual:function(r,n,t){return void 0===t&&(t=xu),Vu(r,n)<=t},average:Co,averageSimple:gu,bayesian:yu,bernoulliDistribution:function(r){if(r<0||r>1)throw new Error("bernoulliDistribution requires probability to be between 0 and 1 inclusive");return[1-r,r]},binomialDistribution:function(r,n){if(!(n<0||n>1||r<=0||r%1!=0)){var t=0,e=0,a=[],o=1;do{a[t]=o*Math.pow(n,t)*Math.pow(1-n,r-t),e+=a[t],o=o*(r-++t+1)/t}while(e<.9999);return a}},bisect:function(r,n,t,e,a){if("function"!=typeof r)throw new TypeError("func must be a function");for(var o=0;o<e;o++){var u=(n+t)/2;if(0===r(u)||Math.abs((t-n)/2)<a)return u;zu(r(u))===zu(r(n))?n=u:t=u}throw new Error("maximum number of iterations exceeded")},chiSquaredDistributionTable:ku,chiSquaredGoodnessOfFit:function(r,n,t){for(var e=0,a=n(Co(r)),o=[],u=[],i=0;i<r.length;i++)void 0===o[r[i]]&&(o[r[i]]=0),o[r[i]]++;for(var f=0;f<o.length;f++)void 0===o[f]&&(o[f]=0);for(var c in a)c in o&&(u[+c]=a[c]*r.length);for(var s=u.length-1;s>=0;s--)u[s]<3&&(u[s-1]+=u[s],u.pop(),o[s-1]+=o[s],o.pop());for(var l=0;l<o.length;l++)e+=Math.pow(o[l]-u[l],2)/u[l];var p=o.length-1-1;return ku[p][t]<e},chunk:function(r,n){var t=[];if(n<1)throw new Error("chunk size must be a positive number");if(Math.floor(n)!==n)throw new Error("chunk size must be an integer");for(var e=0;e<r.length;e+=n)t.push(r.slice(e,e+n));return t},ckmeans:function(r,n){if(n>r.length)throw new Error("cannot generate more classes than there are data values");var t=Vo(r);if(1===cu(t))return[t];var e=fu(n,t.length),a=fu(n,t.length);!function(r,n,t){for(var e=n[0].length,a=r[Math.floor(e/2)],o=[],u=[],i=0,f=void 0;i<e;++i)f=r[i]-a,0===i?(o.push(f),u.push(f*f)):(o.push(o[i-1]+f),u.push(u[i-1]+f*f)),n[0][i]=su(0,i,o,u),t[0][i]=0;for(var c=1;c<n.length;++c)lu(c<n.length-1?c:e-1,e-1,c,n,t,o,u)}(t,e,a);for(var o=[],u=a[0].length-1,i=a.length-1;i>=0;i--){var f=a[i][u];o[i]=t.slice(f,u+1),i>0&&(u=f-1)}return o},coefficientOfVariation:function(r){return vu(r)/Co(r)},combinations:function r(n,t){var e,a,o,u,i=[];for(e=0;e<n.length;e++)if(1===t)i.push([n[e]]);else for(o=r(n.slice(e+1,n.length),t-1),a=0;a<o.length;a++)(u=o[a]).unshift(n[e]),i.push(u);return i},combinationsReplacement:function r(n,t){for(var e=[],a=0;a<n.length;a++)if(1===t)e.push([n[a]]);else for(var o=r(n.slice(a,n.length),t-1),u=0;u<o.length;u++)e.push([n[a]].concat(o[u]));return e},combineMeans:du,combineVariances:function(r,n,t,e,a,o){var u=du(n,t,a,o);return(t*(r+Math.pow(n-u,2))+o*(e+Math.pow(a-u,2)))/(t+o)},cumulativeStdLogisticProbability:function(r){return 1/(Math.exp(-r)+1)},cumulativeStdNormalProbability:function(r){var n=Math.abs(r),t=Math.min(Math.round(100*n),Nu.length-1);return r>=0?Nu[t]:+(1-Nu[t]).toFixed(4)},epsilon:xu,equalIntervalBreaks:function(r,n){if(r.length<2)return r;for(var t=Wo(r),e=$o(r),a=[t],o=(e-t)/n,u=1;u<n;u++)a.push(a[0]+o*u);return a.push(e),a},erf:Tu,errorFunction:Tu,extent:function(r){if(0===r.length)throw new Error("extent requires at least one data point");for(var n=r[0],t=r[0],e=1;e<r.length;e++)r[e]>t&&(t=r[e]),r[e]<n&&(n=r[e]);return[n,t]},extentSorted:function(r){return[r[0],r[r.length-1]]},factorial:ju,gamma:function r(n){if(Number.isInteger(n))return n<=0?NaN:ju(n-1);if(--n<0)return Math.PI/(Math.sin(Math.PI*-n)*r(-n));var t=n+1/4;return Math.pow(n/Math.E,n)*Math.sqrt(2*Math.PI*(n+1/6))*(1+1/144/Math.pow(t,2)-1/12960/Math.pow(t,3)-257/207360/Math.pow(t,4)-52/2612736/Math.pow(t,5)+5741173/9405849600/Math.pow(t,6)+37529/18811699200/Math.pow(t,7))},gammaln:function(r){if(r<=0)return 1/0;r--;for(var n=_u[0],t=1;t<15;t++)n+=_u[t]/(r+t);var e=5.2421875+r;return Mu+Math.log(n)-e+(r+.5)*Math.log(e)},geometricMean:function(r){if(0===r.length)throw new Error("geometricMean requires at least one data point");for(var n=1,t=0;t<r.length;t++){if(r[t]<0)throw new Error("geometricMean requires only non-negative numbers as input");n*=r[t]}return Math.pow(n,1/r.length)},harmonicMean:function(r){if(0===r.length)throw new Error("harmonicMean requires at least one data point");for(var n=0,t=0;t<r.length;t++){if(r[t]<=0)throw new Error("harmonicMean requires only positive numbers as input");n+=1/r[t]}return r.length/n},interquartileRange:tu,inverseErrorFunction:Fu,iqr:tu,kMeansCluster:function(r,n,t){void 0===t&&(t=Math.random);for(var e=null,a=iu(r,n,t),o=null,u=Number.MAX_VALUE;0!==u;)e=a,u=Du(a=Cu(r,o=Ru(r,a),n),e);return{labels:o,centroids:a}},kde:Eu,kernelDensityEstimation:Eu,linearRegression:function(r){var n,t,e=r.length;if(1===e)n=0,t=r[0][1];else{for(var a,o,u,i=0,f=0,c=0,s=0,l=0;l<e;l++)i+=o=(a=r[l])[0],f+=u=a[1],c+=o*o,s+=o*u;t=f/e-(n=(e*s-i*f)/(e*c-i*i))*i/e}return{m:n,b:t}},linearRegressionLine:function(r){return function(n){return r.b+r.m*n}},logAverage:function(r){if(0===r.length)throw new Error("logAverage requires at least one data point");for(var n=0,t=0;t<r.length;t++){if(r[t]<0)throw new Error("logAverage requires only non-negative numbers as input");n+=Math.log(r[t])}return Math.exp(n/r.length)},logit:function(r){if(r<=0||r>=1)throw new Error("p must be strictly between zero and one");return Math.log(r/(1-r))},mad:au,max:$o,maxSorted:function(r){return r[r.length-1]},mean:Co,meanSimple:gu,median:eu,medianAbsoluteDeviation:au,medianSorted:function(r){return Yo(r,.5)},min:Wo,minSorted:function(r){return r[0]},mode:function(r){return Bo(Vo(r))},modeFast:function(r){for(var n,t=new Map,e=0,a=0;a<r.length;a++){var o=t.get(r[a]);void 0===o?o=1:o++,o>e&&(n=r[a],e=o),t.set(r[a],o)}if(0===e)throw new Error("mode requires at last one data point");return n},modeSorted:Bo,numericSort:Vo,perceptron:wu,permutationTest:function(r,n,t,e,a){if(void 0===e&&(e=1e4),void 0===t&&(t="two_side"),"two_side"!==t&&"greater"!==t&&"less"!==t)throw new Error("`alternative` must be either 'two_side', 'greater', or 'less'.");for(var o=Co(r)-Co(n),u=new Array(e),i=r.concat(n),f=Math.floor(i.length/2),c=0;c<e;c++){ou(i,a);var s=i.slice(0,f),l=i.slice(f,i.length),p=Co(s)-Co(l);u[c]=p}var h=0;if("two_side"===t)for(var v=0;v<=e;v++)Math.abs(u[v])>=Math.abs(o)&&(h+=1);else if("greater"===t)for(var m=0;m<=e;m++)u[m]>=o&&(h+=1);else for(var d=0;d<=e;d++)u[d]<=o&&(h+=1);return h/e},permutationsHeap:function(r){for(var n=new Array(r.length),t=[r.slice()],e=0;e<r.length;e++)n[e]=0;for(var a=0;a<r.length;)if(n[a]<a){var o=0;a%2!=0&&(o=n[a]);var u=r[o];r[o]=r[a],r[a]=u,t.push(r.slice()),n[a]++,a=0}else n[a]=0,a++;return t},poissonDistribution:function(r){if(!(r<=0)){var n=0,t=0,e=[],a=1;do{e[n]=Math.exp(-r)*Math.pow(r,n)/a,t+=e[n],a*=++n}while(t<.9999);return e}},probit:function(r){return 0===r?r=xu:r>=1&&(r=.9999),Math.sqrt(2)*Fu(2*r-1)},product:function(r){for(var n=1,t=0;t<r.length;t++)n*=r[t];return n},quantile:Ko,quantileRank:function(r,n){return nu(Vo(r),n)},quantileRankSorted:nu,quantileSorted:Yo,quickselect:Ho,rSquared:function(r,n){if(r.length<2)return 1;for(var t=0,e=0;e<r.length;e++)t+=r[e][1];for(var a=t/r.length,o=0,u=0;u<r.length;u++)o+=Math.pow(a-r[u][1],2);for(var i=0,f=0;f<r.length;f++)i+=Math.pow(r[f][1]-n(r[f][0]),2);return 1-i/o},relativeError:Vu,rms:bu,rootMeanSquare:bu,sample:iu,sampleCorrelation:mu,sampleCovariance:pu,sampleKurtosis:function(r){var n=r.length;if(n<4)throw new Error("sampleKurtosis requires at least four data points");for(var t,e=Co(r),a=0,o=0,u=0;u<n;u++)a+=(t=r[u]-e)*t,o+=t*t*t*t;return(n-1)/((n-2)*(n-3))*(n*(n+1)*o/(a*a)-3*(n-1))},sampleRankCorrelation:function(r,n){for(var t=r.map((function(r,n){return[r,n]})).sort((function(r,n){return r[0]-n[0]})).map((function(r){return r[1]})),e=n.map((function(r,n){return[r,n]})).sort((function(r,n){return r[0]-n[0]})).map((function(r){return r[1]})),a=Array(t.length),o=Array(t.length),u=0;u<t.length;u++)a[t[u]]=u,o[e[u]]=u;return mu(a,o)},sampleSkewness:function(r){if(r.length<3)throw new Error("sampleSkewness requires at least three data points");for(var n,t=Co(r),e=0,a=0,o=0;o<r.length;o++)e+=(n=r[o]-t)*n,a+=n*n*n;var u=r.length-1,i=Math.sqrt(e/u),f=r.length;return f*a/((f-1)*(f-2)*Math.pow(i,3))},sampleStandardDeviation:vu,sampleVariance:hu,sampleWithReplacement:function(r,n,t){if(0===r.length)return[];t=t||Math.random;for(var e=r.length,a=[],o=0;o<n;o++){var u=Math.floor(t()*e);a.push(r[u])}return a},shuffle:uu,shuffleInPlace:ou,sign:zu,silhouette:Gu,silhouetteMetric:function(r,n){return $o(Gu(r,n))},standardDeviation:Uo,standardNormalTable:Nu,subtractFromMean:function(r,n,t){return(r*n-t)/(n-1)},sum:Ro,sumNthPowerDeviations:Do,sumSimple:Xo,tTest:function(r,n){return(Co(r)-n)/(Uo(r)/Math.sqrt(r.length))},tTestTwoSample:function(r,n,t){var e=r.length,a=n.length;if(!e||!a)return null;t||(t=0);var o=Co(r),u=Co(n),i=hu(r),f=hu(n);if("number"==typeof o&&"number"==typeof u&&"number"==typeof i&&"number"==typeof f){var c=((e-1)*i+(a-1)*f)/(e+a-2);return(o-u-t)/Math.sqrt(c*(1/e+1/a))}},uniqueCountSorted:cu,variance:Go,wilcoxonRankSum:function(r,n){if(!r.length||!n.length)throw new Error("Neither sample can be empty");for(var t=r.map((function(r){return{label:"x",value:r}})).concat(n.map((function(r){return{label:"y",value:r}}))).sort((function(r,n){return r.value-n.value})),e=0;e<t.length;e++)t[e].rank=e;for(var a=[t[0].rank],o=1;o<t.length;o++)t[o].value===t[o-1].value?(a.push(t[o].rank),o===t.length-1&&u(t,a)):a.length>1?u(t,a):a=[t[o].rank];function u(r,n){for(var t=(n[0]+n[n.length-1])/2,e=0;e<n.length;e++)r[n[e]].rank=t}for(var i=0,f=0;f<t.length;f++){var c=t[f];"x"===c.label&&(i+=c.rank+1)}return i},zScore:function(r,n,t){return(r-n)/t}});var $u,Xu=St($u=Wu,"default.default")?$u.default.default:St($u,"default")?$u.default:$u;var Yu=4294967295,Hu=Math.min;var Qu=function(r,n){if((r=va(r))<1||r>9007199254740991)return[];var t=Yu,e=Hu(r,Yu);n=Pa(n),r-=Yu;for(var a=Fn(e,n);++t<r;)n(t);return a};function Ku(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;function t(r,n){var t,e;return function(){var a;if(null!=t)a=t,t=null;else do{t=2*Math.random()-1,a=2*Math.random()-1,e=t*t+a*a}while(!e||e>1);return r+n*a*Math.sqrt(-2*Math.log(e)/e)}}return t(r,n)}r.arrAverage=na,r.arrAverageWithLogNormCI=function(r,n){return Aa.apply(this,arguments)},r.arrAverageWithNormCI=ka,r.arrCount=function(r){if(!Or(r))return[];if(0===kr(r))return[];var n=[];if(Ea(r,(function(r){(Ge(r)||De(r))&&n.push(function(r){if(!De(r)&&!Ge(r)&&!mt(r))return"";var n="";try{n=String(r)}catch(r){}try{n=r.toString()}catch(r){}return n}(r))})),0===kr(n))return[];n=Ut(n,(function(r){return{v:r}}));var t=Ta(n,"v");return t=Ut(t,(function(r,n){return{key:n,count:kr(r)}})),t=Ka(t,"count"),t=Ja(t)},r.arrGammaFit=go,r.arrGammaHist=function(r){return ko.apply(this,arguments)},r.arrGammaInv=function(r,n){return Eo.apply(this,arguments)},r.arrGeometricAverage=Oo,r.arrGeometricStd=function(r){if(!Or(r))return null;if(0===kr(r))return null;var n=fa(r),t=kr(n);if(0===t)return null;if(t<=1)return null;var e=ha(n);return Math.exp(e)},r.arrLogNormHist=function(r){return Io.apply(this,arguments)},r.arrLogNormInv=function(r,n){return zo.apply(this,arguments)},r.arrMovingAverage=function(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Or(r))return[];if(0===kr(r))return[];var t=St(n,"selectCountHalf");Lo(t)||(t=2),t=xa(t);var e=kr(r);if(0===e)return[];var a=Fe(r);return Ea(r,(function(n,o){var u=o-t;u=Math.max(u,0),u=Math.min(u,e-1);var i=Math.max(o+t,0);i=Math.max(i,0),i=Math.min(i,e-1);for(var f=[],c=u;c<=i;c++)f.push(r[c]);var s=na(f);a[o]=s})),a},r.arrNormHist=So,r.arrNormInv=To,r.arrQuartile=function(r,n){if(!Or(r))return null;if(0===kr(r))return null;if(!ua(n))return null;(n=Je(n))<0&&(n=0),n>1&&(n=1);var t=ra(r);return 0===kr(t)?null:Xu.quantile(t,n)},r.arrStd=ha,r.bin=mo,r.histGen=_o,r.jStat=pa,r.randNorm=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Ge(r)||(r=0),r=Je(r),Ge(n)||(n=1),(n=Je(n))<0&&(n=0);var e=St(t,"low");e=Ge(e)?Je(e):null;var a=St(t,"up");if(a=Ge(a)?Je(a):null,null!==e&&null!==a&&e>=a)throw new Error("low[".concat(e,"] >= up[").concat(a,"]"));var o=St(t,"num");(o=xa(o))<=0&&(o=1);var u=Ku(r,n),i=function r(){var n=u();return null!==e&&n<e&&(n=r()),null!==a&&n>a&&(n=r()),n},f=Ut(Qu(o),(function(){return i()}));return 1===o&&(f=f[0]),f},r.simpleStatistics=Xu,r.studentTInv=_a,Object.defineProperty(r,"__esModule",{value:!0})}));
//# sourceMappingURL=w-statistic.umd.js.map
