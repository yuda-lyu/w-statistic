/*!
 * w-statistic v1.0.13
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(r,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((r="undefined"!=typeof globalThis?globalThis:r||self)["w-statistic"]={})}(this,(function(r){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var e=Object.prototype;var o=function(r){var t=r&&r.constructor;return r===("function"==typeof t&&t.prototype||e)};var a=function(r,t){return function(n){return r(t(n))}},i=a(Object.keys,Object),u=o,f=i,c=Object.prototype.hasOwnProperty;var l=function(r){if(!u(r))return f(r);var t=[];for(var n in Object(r))c.call(r,n)&&"constructor"!=n&&t.push(n);return t},s="object"==typeof t&&t&&t.Object===Object&&t,p=s,v="object"==typeof self&&self&&self.Object===Object&&self,h=p||v||Function("return this")(),m=h.Symbol,g=m,d=Object.prototype,b=d.hasOwnProperty,y=d.toString,w=g?g.toStringTag:void 0;var j=function(r){var t=b.call(r,w),n=r[w];try{r[w]=void 0;var e=!0}catch(r){}var o=y.call(r);return e&&(t?r[w]=n:delete r[w]),o},x=Object.prototype.toString;var _=j,M=function(r){return x.call(r)},P=m?m.toStringTag:void 0;var q=function(r){return null==r?void 0===r?"[object Undefined]":"[object Null]":P&&P in Object(r)?_(r):M(r)};var A=function(r){var t=typeof r;return null!=r&&("object"==t||"function"==t)},S=q,E=A;var O,k=function(r){if(!E(r))return!1;var t=S(r);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},N=h["__core-js_shared__"],I=(O=/[^.]+$/.exec(N&&N.keys&&N.keys.IE_PROTO||""))?"Symbol(src)_1."+O:"";var z=function(r){return!!I&&I in r},F=Function.prototype.toString;var T=function(r){if(null!=r){try{return F.call(r)}catch(r){}try{return r+""}catch(r){}}return""},$=k,R=z,C=A,D=T,L=/^\[object .+?Constructor\]$/,U=Function.prototype,B=Object.prototype,G=U.toString,V=B.hasOwnProperty,W=RegExp("^"+G.call(V).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var X=function(r){return!(!C(r)||R(r))&&($(r)?W:L).test(D(r))},Y=function(r,t){return null==r?void 0:r[t]};var H=function(r,t){var n=Y(r,t);return X(n)?n:void 0},Q=H(h,"DataView"),K=H(h,"Map"),Z=Q,J=K,rr=H(h,"Promise"),tr=H(h,"Set"),nr=H(h,"WeakMap"),er=q,or=T,ar="[object Map]",ir="[object Promise]",ur="[object Set]",fr="[object WeakMap]",cr="[object DataView]",lr=or(Z),sr=or(J),pr=or(rr),vr=or(tr),hr=or(nr),mr=er;(Z&&mr(new Z(new ArrayBuffer(1)))!=cr||J&&mr(new J)!=ar||rr&&mr(rr.resolve())!=ir||tr&&mr(new tr)!=ur||nr&&mr(new nr)!=fr)&&(mr=function(r){var t=er(r),n="[object Object]"==t?r.constructor:void 0,e=n?or(n):"";if(e)switch(e){case lr:return cr;case sr:return ar;case pr:return ir;case vr:return ur;case hr:return fr}return t});var gr=mr;var dr=function(r){return"number"==typeof r&&r>-1&&r%1==0&&r<=9007199254740991},br=k,yr=dr;var wr=function(r){return null!=r&&yr(r.length)&&!br(r)},jr=Array.isArray;var xr=function(r){return null!=r&&"object"==typeof r},_r=q,Mr=jr,Pr=xr;var qr=function(r){return"string"==typeof r||!Mr(r)&&Pr(r)&&"[object String]"==_r(r)};var Ar=function(r){return function(t){return null==t?void 0:t[r]}},Sr=Ar("length"),Er=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var Or=function(r){return Er.test(r)},kr="\\ud800-\\udfff",Nr="["+kr+"]",Ir="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",zr="\\ud83c[\\udffb-\\udfff]",Fr="[^"+kr+"]",Tr="(?:\\ud83c[\\udde6-\\uddff]){2}",$r="[\\ud800-\\udbff][\\udc00-\\udfff]",Rr="(?:"+Ir+"|"+zr+")"+"?",Cr="[\\ufe0e\\ufe0f]?",Dr=Cr+Rr+("(?:\\u200d(?:"+[Fr,Tr,$r].join("|")+")"+Cr+Rr+")*"),Lr="(?:"+[Fr+Ir+"?",Ir,Tr,$r,Nr].join("|")+")",Ur=RegExp(zr+"(?="+zr+")|"+Lr+Dr,"g");var Br=Sr,Gr=Or,Vr=function(r){for(var t=Ur.lastIndex=0;Ur.test(r);)++t;return t};var Wr=l,Xr=gr,Yr=wr,Hr=qr,Qr=function(r){return Gr(r)?Vr(r):Br(r)};var Kr=function(r){if(null==r)return 0;if(Yr(r))return Hr(r)?Qr(r):r.length;var t=Xr(r);return"[object Map]"==t||"[object Set]"==t?r.size:Wr(r).length};var Zr=function(r,t){for(var n,e=-1,o=r.length;++e<o;){var a=t(r[e]);void 0!==a&&(n=void 0===n?a:n+a)}return n},Jr=Zr;var rt=function(r){return r},tt=function(r,t){var n=null==r?0:r.length;return n?Jr(r,t)/n:NaN},nt=rt;var et=function(r){return tt(r,nt)};function ot(r){return"[object Array]"===Object.prototype.toString.call(r)}var at=function(r,t){for(var n=-1,e=null==r?0:r.length,o=Array(e);++n<e;)o[n]=t(r[n],n,r);return o};var it=function(){this.__data__=[],this.size=0};var ut=function(r,t){return r===t||r!=r&&t!=t},ft=ut;var ct=function(r,t){for(var n=r.length;n--;)if(ft(r[n][0],t))return n;return-1},lt=ct,st=Array.prototype.splice;var pt=ct;var vt=ct;var ht=ct;var mt=it,gt=function(r){var t=this.__data__,n=lt(t,r);return!(n<0)&&(n==t.length-1?t.pop():st.call(t,n,1),--this.size,!0)},dt=function(r){var t=this.__data__,n=pt(t,r);return n<0?void 0:t[n][1]},bt=function(r){return vt(this.__data__,r)>-1},yt=function(r,t){var n=this.__data__,e=ht(n,r);return e<0?(++this.size,n.push([r,t])):n[e][1]=t,this};function wt(r){var t=-1,n=null==r?0:r.length;for(this.clear();++t<n;){var e=r[t];this.set(e[0],e[1])}}wt.prototype.clear=mt,wt.prototype.delete=gt,wt.prototype.get=dt,wt.prototype.has=bt,wt.prototype.set=yt;var jt=wt,xt=jt;var _t=function(){this.__data__=new xt,this.size=0};var Mt=function(r){var t=this.__data__,n=t.delete(r);return this.size=t.size,n};var Pt=function(r){return this.__data__.get(r)};var qt=function(r){return this.__data__.has(r)},At=H(Object,"create"),St=At;var Et=function(){this.__data__=St?St(null):{},this.size=0};var Ot=function(r){var t=this.has(r)&&delete this.__data__[r];return this.size-=t?1:0,t},kt=At,Nt=Object.prototype.hasOwnProperty;var It=function(r){var t=this.__data__;if(kt){var n=t[r];return"__lodash_hash_undefined__"===n?void 0:n}return Nt.call(t,r)?t[r]:void 0},zt=At,Ft=Object.prototype.hasOwnProperty;var Tt=At;var $t=Et,Rt=Ot,Ct=It,Dt=function(r){var t=this.__data__;return zt?void 0!==t[r]:Ft.call(t,r)},Lt=function(r,t){var n=this.__data__;return this.size+=this.has(r)?0:1,n[r]=Tt&&void 0===t?"__lodash_hash_undefined__":t,this};function Ut(r){var t=-1,n=null==r?0:r.length;for(this.clear();++t<n;){var e=r[t];this.set(e[0],e[1])}}Ut.prototype.clear=$t,Ut.prototype.delete=Rt,Ut.prototype.get=Ct,Ut.prototype.has=Dt,Ut.prototype.set=Lt;var Bt=Ut,Gt=jt,Vt=K;var Wt=function(r){var t=typeof r;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==r:null===r};var Xt=function(r,t){var n=r.__data__;return Wt(t)?n["string"==typeof t?"string":"hash"]:n.map},Yt=Xt;var Ht=Xt;var Qt=Xt;var Kt=Xt;var Zt=function(r,t){var n=Kt(this,r),e=n.size;return n.set(r,t),this.size+=n.size==e?0:1,this},Jt=function(){this.size=0,this.__data__={hash:new Bt,map:new(Vt||Gt),string:new Bt}},rn=function(r){var t=Yt(this,r).delete(r);return this.size-=t?1:0,t},tn=function(r){return Ht(this,r).get(r)},nn=function(r){return Qt(this,r).has(r)},en=Zt;function on(r){var t=-1,n=null==r?0:r.length;for(this.clear();++t<n;){var e=r[t];this.set(e[0],e[1])}}on.prototype.clear=Jt,on.prototype.delete=rn,on.prototype.get=tn,on.prototype.has=nn,on.prototype.set=en;var an=on,un=jt,fn=K,cn=an;var ln=jt,sn=_t,pn=Mt,vn=Pt,hn=qt,mn=function(r,t){var n=this.__data__;if(n instanceof un){var e=n.__data__;if(!fn||e.length<199)return e.push([r,t]),this.size=++n.size,this;n=this.__data__=new cn(e)}return n.set(r,t),this.size=n.size,this};function gn(r){var t=this.__data__=new ln(r);this.size=t.size}gn.prototype.clear=sn,gn.prototype.delete=pn,gn.prototype.get=vn,gn.prototype.has=hn,gn.prototype.set=mn;var dn=gn;var bn=an,yn=function(r){return this.__data__.set(r,"__lodash_hash_undefined__"),this},wn=function(r){return this.__data__.has(r)};function jn(r){var t=-1,n=null==r?0:r.length;for(this.__data__=new bn;++t<n;)this.add(r[t])}jn.prototype.add=jn.prototype.push=yn,jn.prototype.has=wn;var xn=jn,_n=function(r,t){for(var n=-1,e=null==r?0:r.length;++n<e;)if(t(r[n],n,r))return!0;return!1},Mn=function(r,t){return r.has(t)};var Pn=function(r,t,n,e,o,a){var i=1&n,u=r.length,f=t.length;if(u!=f&&!(i&&f>u))return!1;var c=a.get(r),l=a.get(t);if(c&&l)return c==t&&l==r;var s=-1,p=!0,v=2&n?new xn:void 0;for(a.set(r,t),a.set(t,r);++s<u;){var h=r[s],m=t[s];if(e)var g=i?e(m,h,s,t,r,a):e(h,m,s,r,t,a);if(void 0!==g){if(g)continue;p=!1;break}if(v){if(!_n(t,(function(r,t){if(!Mn(v,t)&&(h===r||o(h,r,n,e,a)))return v.push(t)}))){p=!1;break}}else if(h!==m&&!o(h,m,n,e,a)){p=!1;break}}return a.delete(r),a.delete(t),p},qn=h.Uint8Array;var An=function(r){var t=-1,n=Array(r.size);return r.forEach((function(r,e){n[++t]=[e,r]})),n};var Sn=qn,En=ut,On=Pn,kn=An,Nn=function(r){var t=-1,n=Array(r.size);return r.forEach((function(r){n[++t]=r})),n},In=m?m.prototype:void 0,zn=In?In.valueOf:void 0;var Fn=function(r,t,n,e,o,a,i){switch(n){case"[object DataView]":if(r.byteLength!=t.byteLength||r.byteOffset!=t.byteOffset)return!1;r=r.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(r.byteLength!=t.byteLength||!a(new Sn(r),new Sn(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return En(+r,+t);case"[object Error]":return r.name==t.name&&r.message==t.message;case"[object RegExp]":case"[object String]":return r==t+"";case"[object Map]":var u=kn;case"[object Set]":var f=1&e;if(u||(u=Nn),r.size!=t.size&&!f)return!1;var c=i.get(r);if(c)return c==t;e|=2,i.set(r,t);var l=On(u(r),u(t),e,o,a,i);return i.delete(r),l;case"[object Symbol]":if(zn)return zn.call(r)==zn.call(t)}return!1};var Tn=function(r,t){for(var n=-1,e=t.length,o=r.length;++n<e;)r[o+n]=t[n];return r},$n=Tn,Rn=jr;var Cn=function(r,t,n){var e=t(r);return Rn(r)?e:$n(e,n(r))};var Dn=function(r,t){for(var n=-1,e=null==r?0:r.length,o=0,a=[];++n<e;){var i=r[n];t(i,n,r)&&(a[o++]=i)}return a};var Ln=function(){return[]},Un=Dn,Bn=Ln,Gn=Object.prototype.propertyIsEnumerable,Vn=Object.getOwnPropertySymbols,Wn=Vn?function(r){return null==r?[]:(r=Object(r),Un(Vn(r),(function(t){return Gn.call(r,t)})))}:Bn;var Xn=function(r,t){for(var n=-1,e=Array(r);++n<r;)e[n]=t(n);return e},Yn=q,Hn=xr;var Qn=function(r){return Hn(r)&&"[object Arguments]"==Yn(r)},Kn=xr,Zn=Object.prototype,Jn=Zn.hasOwnProperty,re=Zn.propertyIsEnumerable,te=Qn(function(){return arguments}())?Qn:function(r){return Kn(r)&&Jn.call(r,"callee")&&!re.call(r,"callee")},ne=te,ee={};var oe=function(){return!1};!function(r,t){var n=h,e=oe,o=t&&!t.nodeType&&t,a=o&&r&&!r.nodeType&&r,i=a&&a.exports===o?n.Buffer:void 0,u=(i?i.isBuffer:void 0)||e;r.exports=u}({get exports(){return ee},set exports(r){ee=r}},ee);var ae=/^(?:0|[1-9]\d*)$/;var ie=function(r,t){var n=typeof r;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&ae.test(r))&&r>-1&&r%1==0&&r<t},ue=q,fe=dr,ce=xr,le={};le["[object Float32Array]"]=le["[object Float64Array]"]=le["[object Int8Array]"]=le["[object Int16Array]"]=le["[object Int32Array]"]=le["[object Uint8Array]"]=le["[object Uint8ClampedArray]"]=le["[object Uint16Array]"]=le["[object Uint32Array]"]=!0,le["[object Arguments]"]=le["[object Array]"]=le["[object ArrayBuffer]"]=le["[object Boolean]"]=le["[object DataView]"]=le["[object Date]"]=le["[object Error]"]=le["[object Function]"]=le["[object Map]"]=le["[object Number]"]=le["[object Object]"]=le["[object RegExp]"]=le["[object Set]"]=le["[object String]"]=le["[object WeakMap]"]=!1;var se=function(r){return ce(r)&&fe(r.length)&&!!le[ue(r)]};var pe=function(r){return function(t){return r(t)}},ve={};!function(r,t){var n=s,e=t&&!t.nodeType&&t,o=e&&r&&!r.nodeType&&r,a=o&&o.exports===e&&n.process,i=function(){try{var r=o&&o.require&&o.require("util").types;return r||a&&a.binding&&a.binding("util")}catch(r){}}();r.exports=i}({get exports(){return ve},set exports(r){ve=r}},ve);var he=se,me=pe,ge=ve&&ve.isTypedArray,de=ge?me(ge):he,be=Xn,ye=ne,we=jr,je=ee,xe=ie,_e=de,Me=Object.prototype.hasOwnProperty;var Pe=function(r,t){var n=we(r),e=!n&&ye(r),o=!n&&!e&&je(r),a=!n&&!e&&!o&&_e(r),i=n||e||o||a,u=i?be(r.length,String):[],f=u.length;for(var c in r)!t&&!Me.call(r,c)||i&&("length"==c||o&&("offset"==c||"parent"==c)||a&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||xe(c,f))||u.push(c);return u},qe=Pe,Ae=l,Se=wr;var Ee=function(r){return Se(r)?qe(r):Ae(r)},Oe=Cn,ke=Wn,Ne=Ee;var Ie=function(r){return Oe(r,Ne,ke)},ze=Ie,Fe=Object.prototype.hasOwnProperty;var Te=dn,$e=Pn,Re=Fn,Ce=function(r,t,n,e,o,a){var i=1&n,u=ze(r),f=u.length;if(f!=ze(t).length&&!i)return!1;for(var c=f;c--;){var l=u[c];if(!(i?l in t:Fe.call(t,l)))return!1}var s=a.get(r),p=a.get(t);if(s&&p)return s==t&&p==r;var v=!0;a.set(r,t),a.set(t,r);for(var h=i;++c<f;){var m=r[l=u[c]],g=t[l];if(e)var d=i?e(g,m,l,t,r,a):e(m,g,l,r,t,a);if(!(void 0===d?m===g||o(m,g,n,e,a):d)){v=!1;break}h||(h="constructor"==l)}if(v&&!h){var b=r.constructor,y=t.constructor;b==y||!("constructor"in r)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof y&&y instanceof y||(v=!1)}return a.delete(r),a.delete(t),v},De=gr,Le=jr,Ue=ee,Be=de,Ge="[object Arguments]",Ve="[object Array]",We="[object Object]",Xe=Object.prototype.hasOwnProperty;var Ye=function(r,t,n,e,o,a){var i=Le(r),u=Le(t),f=i?Ve:De(r),c=u?Ve:De(t),l=(f=f==Ge?We:f)==We,s=(c=c==Ge?We:c)==We,p=f==c;if(p&&Ue(r)){if(!Ue(t))return!1;i=!0,l=!1}if(p&&!l)return a||(a=new Te),i||Be(r)?$e(r,t,n,e,o,a):Re(r,t,f,n,e,o,a);if(!(1&n)){var v=l&&Xe.call(r,"__wrapped__"),h=s&&Xe.call(t,"__wrapped__");if(v||h){var m=v?r.value():r,g=h?t.value():t;return a||(a=new Te),o(m,g,n,e,a)}}return!!p&&(a||(a=new Te),Ce(r,t,n,e,o,a))},He=xr;var Qe=function r(t,n,e,o,a){return t===n||(null==t||null==n||!He(t)&&!He(n)?t!=t&&n!=n:Ye(t,n,e,o,r,a))},Ke=dn,Ze=Qe;var Je=A;var ro=function(r){return r==r&&!Je(r)},to=ro,no=Ee;var eo=function(r,t){return function(n){return null!=n&&(n[r]===t&&(void 0!==t||r in Object(n)))}},oo=function(r,t,n,e){var o=n.length,a=o,i=!e;if(null==r)return!a;for(r=Object(r);o--;){var u=n[o];if(i&&u[2]?u[1]!==r[u[0]]:!(u[0]in r))return!1}for(;++o<a;){var f=(u=n[o])[0],c=r[f],l=u[1];if(i&&u[2]){if(void 0===c&&!(f in r))return!1}else{var s=new Ke;if(e)var p=e(c,l,f,r,t,s);if(!(void 0===p?Ze(l,c,3,e,s):p))return!1}}return!0},ao=function(r){for(var t=no(r),n=t.length;n--;){var e=t[n],o=r[e];t[n]=[e,o,to(o)]}return t},io=eo;var uo=function(r){var t=ao(r);return 1==t.length&&t[0][2]?io(t[0][0],t[0][1]):function(n){return n===r||oo(n,r,t)}},fo=q,co=xr;var lo=function(r){return"symbol"==typeof r||co(r)&&"[object Symbol]"==fo(r)},so=jr,po=lo,vo=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ho=/^\w*$/;var mo=function(r,t){if(so(r))return!1;var n=typeof r;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=r&&!po(r))||(ho.test(r)||!vo.test(r)||null!=t&&r in Object(t))},go=an;function bo(r,t){if("function"!=typeof r||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var e=arguments,o=t?t.apply(this,e):e[0],a=n.cache;if(a.has(o))return a.get(o);var i=r.apply(this,e);return n.cache=a.set(o,i)||a,i};return n.cache=new(bo.Cache||go),n}bo.Cache=go;var yo=bo;var wo=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,jo=/\\(\\)?/g,xo=function(r){var t=yo(r,(function(r){return 500===n.size&&n.clear(),r})),n=t.cache;return t}((function(r){var t=[];return 46===r.charCodeAt(0)&&t.push(""),r.replace(wo,(function(r,n,e,o){t.push(e?o.replace(jo,"$1"):n||r)})),t})),_o=at,Mo=jr,Po=lo,qo=m?m.prototype:void 0,Ao=qo?qo.toString:void 0;var So=function r(t){if("string"==typeof t)return t;if(Mo(t))return _o(t,r)+"";if(Po(t))return Ao?Ao.call(t):"";var n=t+"";return"0"==n&&1/t==-Infinity?"-0":n},Eo=So;var Oo=function(r){return null==r?"":Eo(r)},ko=jr,No=mo,Io=xo,zo=Oo;var Fo=function(r,t){return ko(r)?r:No(r,t)?[r]:Io(zo(r))},To=lo;var $o=function(r){if("string"==typeof r||To(r))return r;var t=r+"";return"0"==t&&1/r==-Infinity?"-0":t},Ro=Fo,Co=$o;var Do=function(r,t){for(var n=0,e=(t=Ro(t,r)).length;null!=r&&n<e;)r=r[Co(t[n++])];return n&&n==e?r:void 0},Lo=Do;var Uo=function(r,t,n){var e=null==r?void 0:Lo(r,t);return void 0===e?n:e};var Bo=Fo,Go=ne,Vo=jr,Wo=ie,Xo=dr,Yo=$o;var Ho=function(r,t){return null!=r&&t in Object(r)},Qo=function(r,t,n){for(var e=-1,o=(t=Bo(t,r)).length,a=!1;++e<o;){var i=Yo(t[e]);if(!(a=null!=r&&n(r,i)))break;r=r[i]}return a||++e!=o?a:!!(o=null==r?0:r.length)&&Xo(o)&&Wo(i,o)&&(Vo(r)||Go(r))};var Ko=Qe,Zo=Uo,Jo=function(r,t){return null!=r&&Qo(r,t,Ho)},ra=mo,ta=ro,na=eo,ea=$o;var oa=Do;var aa=Ar,ia=function(r){return function(t){return oa(t,r)}},ua=mo,fa=$o;var ca=uo,la=function(r,t){return ra(r)&&ta(t)?na(ea(r),t):function(n){var e=Zo(n,r);return void 0===e&&e===t?Jo(n,r):Ko(t,e,3)}},sa=rt,pa=jr,va=function(r){return ua(r)?aa(fa(r)):ia(r)};var ha=function(r){return"function"==typeof r?r:null==r?sa:"object"==typeof r?pa(r)?la(r[0],r[1]):ca(r):va(r)};var ma=function(r){return function(t,n,e){for(var o=-1,a=Object(t),i=e(t),u=i.length;u--;){var f=i[r?u:++o];if(!1===n(a[f],f,a))break}return t}}(),ga=Ee;var da=wr;var ba=function(r,t){return function(n,e){if(null==n)return n;if(!da(n))return r(n,e);for(var o=n.length,a=t?o:-1,i=Object(n);(t?a--:++a<o)&&!1!==e(i[a],a,i););return n}}((function(r,t){return r&&ma(r,t,ga)})),ya=ba,wa=wr;var ja=function(r,t){var n=-1,e=wa(r)?Array(r.length):[];return ya(r,(function(r,o,a){e[++n]=t(r,o,a)})),e},xa=at,_a=ha,Ma=ja,Pa=jr;var qa=function(r,t){return(Pa(r)?xa:Ma)(r,_a(t))},Aa=ba;var Sa=Dn,Ea=function(r,t){var n=[];return Aa(r,(function(r,e,o){t(r,e,o)&&n.push(r)})),n},Oa=ha,ka=jr;var Na=function(r,t){return(ka(r)?Sa:Ea)(r,Oa(t))};var Ia=function(r,t){for(var n=-1,e=null==r?0:r.length;++n<e&&!1!==t(r[n],n,r););return r},za=H,Fa=function(){try{var r=za(Object,"defineProperty");return r({},"",{}),r}catch(r){}}(),Ta=Fa;var $a=function(r,t,n){"__proto__"==t&&Ta?Ta(r,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):r[t]=n},Ra=$a,Ca=ut,Da=Object.prototype.hasOwnProperty;var La=function(r,t,n){var e=r[t];Da.call(r,t)&&Ca(e,n)&&(void 0!==n||t in r)||Ra(r,t,n)},Ua=La,Ba=$a;var Ga=function(r,t,n,e){var o=!n;n||(n={});for(var a=-1,i=t.length;++a<i;){var u=t[a],f=e?e(n[u],r[u],u,n,r):void 0;void 0===f&&(f=r[u]),o?Ba(n,u,f):Ua(n,u,f)}return n},Va=Ga,Wa=Ee;var Xa=function(r,t){return r&&Va(t,Wa(t),r)};var Ya=A,Ha=o,Qa=function(r){var t=[];if(null!=r)for(var n in Object(r))t.push(n);return t},Ka=Object.prototype.hasOwnProperty;var Za=Pe,Ja=function(r){if(!Ya(r))return Qa(r);var t=Ha(r),n=[];for(var e in r)("constructor"!=e||!t&&Ka.call(r,e))&&n.push(e);return n},ri=wr;var ti=function(r){return ri(r)?Za(r,!0):Ja(r)},ni=Ga,ei=ti;var oi=function(r,t){return r&&ni(t,ei(t),r)},ai={};!function(r,t){var n=h,e=t&&!t.nodeType&&t,o=e&&r&&!r.nodeType&&r,a=o&&o.exports===e?n.Buffer:void 0,i=a?a.allocUnsafe:void 0;r.exports=function(r,t){if(t)return r.slice();var n=r.length,e=i?i(n):new r.constructor(n);return r.copy(e),e}}({get exports(){return ai},set exports(r){ai=r}},ai);var ii=function(r,t){var n=-1,e=r.length;for(t||(t=Array(e));++n<e;)t[n]=r[n];return t},ui=Ga,fi=Wn;var ci=function(r,t){return ui(r,fi(r),t)},li=a(Object.getPrototypeOf,Object),si=Tn,pi=li,vi=Wn,hi=Ln,mi=Object.getOwnPropertySymbols?function(r){for(var t=[];r;)si(t,vi(r)),r=pi(r);return t}:hi,gi=Ga,di=mi;var bi=function(r,t){return gi(r,di(r),t)},yi=Cn,wi=mi,ji=ti;var xi=function(r){return yi(r,ji,wi)},_i=Object.prototype.hasOwnProperty;var Mi=function(r){var t=r.length,n=new r.constructor(t);return t&&"string"==typeof r[0]&&_i.call(r,"index")&&(n.index=r.index,n.input=r.input),n},Pi=qn;var qi=function(r){var t=new r.constructor(r.byteLength);return new Pi(t).set(new Pi(r)),t},Ai=qi;var Si=function(r,t){var n=t?Ai(r.buffer):r.buffer;return new r.constructor(n,r.byteOffset,r.byteLength)},Ei=/\w*$/;var Oi=function(r){var t=new r.constructor(r.source,Ei.exec(r));return t.lastIndex=r.lastIndex,t},ki=m?m.prototype:void 0,Ni=ki?ki.valueOf:void 0;var Ii=qi;var zi=qi,Fi=Si,Ti=Oi,$i=function(r){return Ni?Object(Ni.call(r)):{}},Ri=function(r,t){var n=t?Ii(r.buffer):r.buffer;return new r.constructor(n,r.byteOffset,r.length)};var Ci=function(r,t,n){var e=r.constructor;switch(t){case"[object ArrayBuffer]":return zi(r);case"[object Boolean]":case"[object Date]":return new e(+r);case"[object DataView]":return Fi(r,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Ri(r,n);case"[object Map]":case"[object Set]":return new e;case"[object Number]":case"[object String]":return new e(r);case"[object RegExp]":return Ti(r);case"[object Symbol]":return $i(r)}},Di=A,Li=Object.create,Ui=function(){function r(){}return function(t){if(!Di(t))return{};if(Li)return Li(t);r.prototype=t;var n=new r;return r.prototype=void 0,n}}(),Bi=li,Gi=o;var Vi=function(r){return"function"!=typeof r.constructor||Gi(r)?{}:Ui(Bi(r))},Wi=gr,Xi=xr;var Yi=function(r){return Xi(r)&&"[object Map]"==Wi(r)},Hi=pe,Qi=ve&&ve.isMap,Ki=Qi?Hi(Qi):Yi,Zi=gr,Ji=xr;var ru=function(r){return Ji(r)&&"[object Set]"==Zi(r)},tu=pe,nu=ve&&ve.isSet,eu=nu?tu(nu):ru,ou=dn,au=Ia,iu=La,uu=Xa,fu=oi,cu=ai,lu=ii,su=ci,pu=bi,vu=Ie,hu=xi,mu=gr,gu=Mi,du=Ci,bu=Vi,yu=jr,wu=ee,ju=Ki,xu=A,_u=eu,Mu=Ee,Pu=ti,qu="[object Arguments]",Au="[object Function]",Su="[object Object]",Eu={};Eu[qu]=Eu["[object Array]"]=Eu["[object ArrayBuffer]"]=Eu["[object DataView]"]=Eu["[object Boolean]"]=Eu["[object Date]"]=Eu["[object Float32Array]"]=Eu["[object Float64Array]"]=Eu["[object Int8Array]"]=Eu["[object Int16Array]"]=Eu["[object Int32Array]"]=Eu["[object Map]"]=Eu["[object Number]"]=Eu[Su]=Eu["[object RegExp]"]=Eu["[object Set]"]=Eu["[object String]"]=Eu["[object Symbol]"]=Eu["[object Uint8Array]"]=Eu["[object Uint8ClampedArray]"]=Eu["[object Uint16Array]"]=Eu["[object Uint32Array]"]=!0,Eu["[object Error]"]=Eu[Au]=Eu["[object WeakMap]"]=!1;var Ou=function r(t,n,e,o,a,i){var u,f=1&n,c=2&n,l=4&n;if(e&&(u=a?e(t,o,a,i):e(t)),void 0!==u)return u;if(!xu(t))return t;var s=yu(t);if(s){if(u=gu(t),!f)return lu(t,u)}else{var p=mu(t),v=p==Au||"[object GeneratorFunction]"==p;if(wu(t))return cu(t,f);if(p==Su||p==qu||v&&!a){if(u=c||v?{}:bu(t),!f)return c?pu(t,fu(u,t)):su(t,uu(u,t))}else{if(!Eu[p])return a?t:{};u=du(t,p,f)}}i||(i=new ou);var h=i.get(t);if(h)return h;i.set(t,u),_u(t)?t.forEach((function(o){u.add(r(o,n,e,o,t,i))})):ju(t)&&t.forEach((function(o,a){u.set(a,r(o,n,e,a,t,i))}));var m=s?void 0:(l?c?hu:vu:c?Pu:Mu)(t);return au(m||t,(function(o,a){m&&(o=t[a=o]),iu(u,a,r(o,n,e,a,t,i))})),u},ku=Ou;var Nu=function(r){return ku(r,5)};function Iu(r){return"[object Object]"===Object.prototype.toString.call(r)}function zu(r){return"[object String]"===Object.prototype.toString.call(r)}function Fu(r){return!!function(r){return"[object Undefined]"===Object.prototype.toString.call(r)}(r)||(!!function(r){return"[object Null]"===Object.prototype.toString.call(r)}(r)||(!!function(r){if(Iu(r)){for(let t in r)return!1;return!0}return!1}(r)||(!!function(r){return!(!zu(r)||""!==r)}(r)||!!function(r){return!!ot(r)&&0===r.length}(r))))}function Tu(r){return!!ot(r)&&(0!==r.length&&(1!==r.length||!Fu(r[0])))}function $u(r){return!(!zu(r)||""===r)}function Ru(r){let t=!1;return $u(r)?t=!isNaN(Number(r)):function(r){return"[object Number]"===Object.prototype.toString.call(r)}(r)&&(t=!0),t}var Cu=/\s/;var Du=function(r){for(var t=r.length;t--&&Cu.test(r.charAt(t)););return t},Lu=/^\s+/;var Uu=function(r){return r?r.slice(0,Du(r)+1).replace(Lu,""):r},Bu=A,Gu=lo,Vu=/^[-+]0x[0-9a-f]+$/i,Wu=/^0b[01]+$/i,Xu=/^0o[0-7]+$/i,Yu=parseInt;var Hu=function(r){if("number"==typeof r)return r;if(Gu(r))return NaN;if(Bu(r)){var t="function"==typeof r.valueOf?r.valueOf():r;r=Bu(t)?t+"":t}if("string"!=typeof r)return 0===r?r:+r;r=Uu(r);var n=Wu.test(r);return n||Xu.test(r)?Yu(r.slice(2),n?2:8):Vu.test(r)?NaN:+r},Qu=Hu,Ku=1/0;var Zu=function(r){return r?(r=Qu(r))===Ku||r===-1/0?17976931348623157e292*(r<0?-1:1):r==r?r:0:0===r?r:0};function Ju(r){if(!Ru(r))return 0;return Zu(r)}function rf(r){return Tu(r)?(r=Nu(r),r=Na(r,Ru),r=qa(r,Ju)):[]}function tf(r){if(!ot(r))return null;if(0===Kr(r))return null;let t=rf(r);return 0===Kr(t)?null:et(t)}function nf(r){if(!Ru(r))return!1;return Ju(r)>0}function ef(r){return Tu(r)?(r=Nu(r),r=Na(r,nf),r=qa(r,Ju)):[]}function of(r){return Tu(r)?(r=ef(r),r=qa(r,Math.log)):[]}var af=q,uf=xr;var ff=function(r){return"number"==typeof r||uf(r)&&"[object Number]"==af(r)},cf={};!function(r,t){r.exports=function(){var r=function(r,t){var n=Array.prototype.concat,e=Array.prototype.slice,o=Object.prototype.toString;function a(t,n){var e=t>n?t:n;return r.pow(10,17-~~(r.log(e>0?e:-e)*r.LOG10E))}var i=Array.isArray||function(r){return"[object Array]"===o.call(r)};function u(r){return"[object Function]"===o.call(r)}function f(r){return"number"==typeof r&&r-r==0}function c(r){return n.apply([],r)}function l(){return new l._init(arguments)}function s(){return 0}function p(){return 1}function v(r,t){return r===t?1:0}l.fn=l.prototype,l._init=function(r){if(i(r[0]))if(i(r[0][0])){u(r[1])&&(r[0]=l.map(r[0],r[1]));for(var t=0;t<r[0].length;t++)this[t]=r[0][t];this.length=r[0].length}else this[0]=u(r[1])?l.map(r[0],r[1]):r[0],this.length=1;else if(f(r[0]))this[0]=l.seq.apply(null,r),this.length=1;else{if(r[0]instanceof l)return l(r[0].toArray());this[0]=[],this.length=1}return this},l._init.prototype=l.prototype,l._init.constructor=l,l.utils={calcRdx:a,isArray:i,isFunction:u,isNumber:f,toVector:c},l._random_fn=r.random,l.setRandom=function(r){if("function"!=typeof r)throw new TypeError("fn is not a function");l._random_fn=r},l.extend=function(r){var t,n;if(1===arguments.length){for(n in r)l[n]=r[n];return this}for(t=1;t<arguments.length;t++)for(n in arguments[t])r[n]=arguments[t][n];return r},l.rows=function(r){return r.length||1},l.cols=function(r){return r[0].length||1},l.dimensions=function(r){return{rows:l.rows(r),cols:l.cols(r)}},l.row=function(r,t){return i(t)?t.map((function(t){return l.row(r,t)})):r[t]},l.rowa=function(r,t){return l.row(r,t)},l.col=function(r,t){if(i(t)){var n=l.arange(r.length).map((function(){return new Array(t.length)}));return t.forEach((function(t,e){l.arange(r.length).forEach((function(o){n[o][e]=r[o][t]}))})),n}for(var e=new Array(r.length),o=0;o<r.length;o++)e[o]=[r[o][t]];return e},l.cola=function(r,t){return l.col(r,t).map((function(r){return r[0]}))},l.diag=function(r){for(var t=l.rows(r),n=new Array(t),e=0;e<t;e++)n[e]=[r[e][e]];return n},l.antidiag=function(r){for(var t=l.rows(r)-1,n=new Array(t),e=0;t>=0;t--,e++)n[e]=[r[e][t]];return n},l.transpose=function(r){var t,n,e,o,a,u=[];for(i(r[0])||(r=[r]),n=r.length,e=r[0].length,a=0;a<e;a++){for(t=new Array(n),o=0;o<n;o++)t[o]=r[o][a];u.push(t)}return 1===u.length?u[0]:u},l.map=function(r,t,n){var e,o,a,u,f;for(i(r[0])||(r=[r]),o=r.length,a=r[0].length,u=n?r:new Array(o),e=0;e<o;e++)for(u[e]||(u[e]=new Array(a)),f=0;f<a;f++)u[e][f]=t(r[e][f],e,f);return 1===u.length?u[0]:u},l.cumreduce=function(r,t,n){var e,o,a,u,f;for(i(r[0])||(r=[r]),o=r.length,a=r[0].length,u=n?r:new Array(o),e=0;e<o;e++)for(u[e]||(u[e]=new Array(a)),a>0&&(u[e][0]=r[e][0]),f=1;f<a;f++)u[e][f]=t(u[e][f-1],r[e][f]);return 1===u.length?u[0]:u},l.alter=function(r,t){return l.map(r,t,!0)},l.create=function(r,t,n){var e,o,a=new Array(r);for(u(t)&&(n=t,t=r),e=0;e<r;e++)for(a[e]=new Array(t),o=0;o<t;o++)a[e][o]=n(e,o);return a},l.zeros=function(r,t){return f(t)||(t=r),l.create(r,t,s)},l.ones=function(r,t){return f(t)||(t=r),l.create(r,t,p)},l.rand=function(r,t){return f(t)||(t=r),l.create(r,t,l._random_fn)},l.identity=function(r,t){return f(t)||(t=r),l.create(r,t,v)},l.symmetric=function(r){var t,n,e=r.length;if(r.length!==r[0].length)return!1;for(t=0;t<e;t++)for(n=0;n<e;n++)if(r[n][t]!==r[t][n])return!1;return!0},l.clear=function(r){return l.alter(r,s)},l.seq=function(r,t,n,e){u(e)||(e=!1);var o,i=[],f=a(r,t),c=(t*f-r*f)/((n-1)*f),l=r;for(o=0;l<=t&&o<n;l=(r*f+c*f*++o)/f)i.push(e?e(l,o):l);return i},l.arange=function(r,n,e){var o,a=[];if(e=e||1,n===t&&(n=r,r=0),r===n||0===e)return[];if(r<n&&e<0)return[];if(r>n&&e>0)return[];if(e>0)for(o=r;o<n;o+=e)a.push(o);else for(o=r;o>n;o+=e)a.push(o);return a},l.slice=function(){function r(r,n,e,o){var a,i=[],u=r.length;if(n===t&&e===t&&o===t)return l.copy(r);if(o=o||1,(n=(n=n||0)>=0?n:u+n)===(e=(e=e||r.length)>=0?e:u+e)||0===o)return[];if(n<e&&o<0)return[];if(n>e&&o>0)return[];if(o>0)for(a=n;a<e;a+=o)i.push(r[a]);else for(a=n;a>e;a+=o)i.push(r[a]);return i}function n(t,n){var e,o;return f((n=n||{}).row)?f(n.col)?t[n.row][n.col]:r(l.rowa(t,n.row),(e=n.col||{}).start,e.end,e.step):f(n.col)?r(l.cola(t,n.col),(o=n.row||{}).start,o.end,o.step):(o=n.row||{},e=n.col||{},r(t,o.start,o.end,o.step).map((function(t){return r(t,e.start,e.end,e.step)})))}return n}(),l.sliceAssign=function(n,e,o){var a,i;if(f(e.row)){if(f(e.col))return n[e.row][e.col]=o;e.col=e.col||{},e.col.start=e.col.start||0,e.col.end=e.col.end||n[0].length,e.col.step=e.col.step||1,a=l.arange(e.col.start,r.min(n.length,e.col.end),e.col.step);var u=e.row;return a.forEach((function(r,t){n[u][r]=o[t]})),n}if(f(e.col)){e.row=e.row||{},e.row.start=e.row.start||0,e.row.end=e.row.end||n.length,e.row.step=e.row.step||1,i=l.arange(e.row.start,r.min(n[0].length,e.row.end),e.row.step);var c=e.col;return i.forEach((function(r,t){n[r][c]=o[t]})),n}return o[0].length===t&&(o=[o]),e.row.start=e.row.start||0,e.row.end=e.row.end||n.length,e.row.step=e.row.step||1,e.col.start=e.col.start||0,e.col.end=e.col.end||n[0].length,e.col.step=e.col.step||1,i=l.arange(e.row.start,r.min(n.length,e.row.end),e.row.step),a=l.arange(e.col.start,r.min(n[0].length,e.col.end),e.col.step),i.forEach((function(r,t){a.forEach((function(e,a){n[r][e]=o[t][a]}))})),n},l.diagonal=function(r){var t=l.zeros(r.length,r.length);return r.forEach((function(r,n){t[n][n]=r})),t},l.copy=function(r){return r.map((function(r){return f(r)?r:r.map((function(r){return r}))}))};var h=l.prototype;return h.length=0,h.push=Array.prototype.push,h.sort=Array.prototype.sort,h.splice=Array.prototype.splice,h.slice=Array.prototype.slice,h.toArray=function(){return this.length>1?e.call(this):e.call(this)[0]},h.map=function(r,t){return l(l.map(this,r,t))},h.cumreduce=function(r,t){return l(l.cumreduce(this,r,t))},h.alter=function(r){return l.alter(this,r),this},function(r){for(var t=0;t<r.length;t++)!function(r){h[r]=function(t){var n,e=this;return t?(setTimeout((function(){t.call(e,h[r].call(e))})),this):(n=l[r](this),i(n)?l(n):n)}}(r[t])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(r){for(var t=0;t<r.length;t++)!function(r){h[r]=function(t,n){var e=this;return n?(setTimeout((function(){n.call(e,h[r].call(e,t))})),this):l(l[r](this,t))}}(r[t])}("row col".split(" ")),function(r){for(var t=0;t<r.length;t++)!function(r){h[r]=function(){return l(l[r].apply(null,arguments))}}(r[t])}("create zeros ones rand identity".split(" ")),l}(Math);return function(r,t){var n=r.utils.isFunction;function e(r,t){return r-t}function o(r,n,e){return t.max(n,t.min(r,e))}r.sum=function(r){for(var t=0,n=r.length;--n>=0;)t+=r[n];return t},r.sumsqrd=function(r){for(var t=0,n=r.length;--n>=0;)t+=r[n]*r[n];return t},r.sumsqerr=function(t){for(var n,e=r.mean(t),o=0,a=t.length;--a>=0;)o+=(n=t[a]-e)*n;return o},r.sumrow=function(r){for(var t=0,n=r.length;--n>=0;)t+=r[n];return t},r.product=function(r){for(var t=1,n=r.length;--n>=0;)t*=r[n];return t},r.min=function(r){for(var t=r[0],n=0;++n<r.length;)r[n]<t&&(t=r[n]);return t},r.max=function(r){for(var t=r[0],n=0;++n<r.length;)r[n]>t&&(t=r[n]);return t},r.unique=function(r){for(var t={},n=[],e=0;e<r.length;e++)t[r[e]]||(t[r[e]]=!0,n.push(r[e]));return n},r.mean=function(t){return r.sum(t)/t.length},r.meansqerr=function(t){return r.sumsqerr(t)/t.length},r.geomean=function(n){var e=n.map(t.log),o=r.mean(e);return t.exp(o)},r.median=function(r){var t=r.length,n=r.slice().sort(e);return 1&t?n[t/2|0]:(n[t/2-1]+n[t/2])/2},r.cumsum=function(t){return r.cumreduce(t,(function(r,t){return r+t}))},r.cumprod=function(t){return r.cumreduce(t,(function(r,t){return r*t}))},r.diff=function(r){var t,n=[],e=r.length;for(t=1;t<e;t++)n.push(r[t]-r[t-1]);return n},r.rank=function(r){var t,n=[],o={};for(t=0;t<r.length;t++)o[f=r[t]]?o[f]++:(o[f]=1,n.push(f));var a=n.sort(e),i={},u=1;for(t=0;t<a.length;t++){var f,c=o[f=a[t]],l=(u+(u+c-1))/2;i[f]=l,u+=c}return r.map((function(r){return i[r]}))},r.mode=function(r){var t,n=r.length,o=r.slice().sort(e),a=1,i=0,u=0,f=[];for(t=0;t<n;t++)o[t]===o[t+1]?a++:(a>i?(f=[o[t]],i=a,u=0):a===i&&(f.push(o[t]),u++),a=1);return 0===u?f[0]:f},r.range=function(t){return r.max(t)-r.min(t)},r.variance=function(t,n){return r.sumsqerr(t)/(t.length-(n?1:0))},r.pooledvariance=function(t){return t.reduce((function(t,n){return t+r.sumsqerr(n)}),0)/(t.reduce((function(r,t){return r+t.length}),0)-t.length)},r.deviation=function(t){for(var n=r.mean(t),e=t.length,o=new Array(e),a=0;a<e;a++)o[a]=t[a]-n;return o},r.stdev=function(n,e){return t.sqrt(r.variance(n,e))},r.pooledstdev=function(n){return t.sqrt(r.pooledvariance(n))},r.meandev=function(n){for(var e=r.mean(n),o=[],a=n.length-1;a>=0;a--)o.push(t.abs(n[a]-e));return r.mean(o)},r.meddev=function(n){for(var e=r.median(n),o=[],a=n.length-1;a>=0;a--)o.push(t.abs(n[a]-e));return r.median(o)},r.coeffvar=function(t){return r.stdev(t)/r.mean(t)},r.quartiles=function(r){var n=r.length,o=r.slice().sort(e);return[o[t.round(n/4)-1],o[t.round(n/2)-1],o[t.round(3*n/4)-1]]},r.quantiles=function(r,n,a,i){var u,f,c,l,s,p=r.slice().sort(e),v=[n.length],h=r.length;for(void 0===a&&(a=3/8),void 0===i&&(i=3/8),u=0;u<n.length;u++)c=h*(f=n[u])+(a+f*(1-a-i)),l=t.floor(o(c,1,h-1)),s=o(c-l,0,1),v[u]=(1-s)*p[l-1]+s*p[l];return v},r.percentile=function(r,t,n){var o=r.slice().sort(e),a=t*(o.length+(n?1:-1))+(n?0:1),i=parseInt(a),u=a-i;return i+1<o.length?o[i-1]+u*(o[i]-o[i-1]):o[i-1]},r.percentileOfScore=function(r,t,n){var e,o,a=0,i=r.length,u=!1;for("strict"===n&&(u=!0),o=0;o<i;o++)e=r[o],(u&&e<t||!u&&e<=t)&&a++;return a/i},r.histogram=function(n,e){e=e||4;var o,a=r.min(n),i=(r.max(n)-a)/e,u=n.length,f=[];for(o=0;o<e;o++)f[o]=0;for(o=0;o<u;o++)f[t.min(t.floor((n[o]-a)/i),e-1)]+=1;return f},r.covariance=function(t,n){var e,o=r.mean(t),a=r.mean(n),i=t.length,u=new Array(i);for(e=0;e<i;e++)u[e]=(t[e]-o)*(n[e]-a);return r.sum(u)/(i-1)},r.corrcoeff=function(t,n){return r.covariance(t,n)/r.stdev(t,1)/r.stdev(n,1)},r.spearmancoeff=function(t,n){return t=r.rank(t),n=r.rank(n),r.corrcoeff(t,n)},r.stanMoment=function(n,e){for(var o=r.mean(n),a=r.stdev(n),i=n.length,u=0,f=0;f<i;f++)u+=t.pow((n[f]-o)/a,e);return u/n.length},r.skewness=function(t){return r.stanMoment(t,3)},r.kurtosis=function(t){return r.stanMoment(t,4)-3};var a=r.prototype;!function(t){for(var e=0;e<t.length;e++)!function(t){a[t]=function(e,o){var i=[],u=0,f=this;if(n(e)&&(o=e,e=!1),o)return setTimeout((function(){o.call(f,a[t].call(f,e))})),this;if(this.length>1){for(f=!0===e?this:this.transpose();u<f.length;u++)i[u]=r[t](f[u]);return i}return r[t](this[0],e)}}(t[e])}("cumsum cumprod".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){a[t]=function(e,o){var i=[],u=0,f=this;if(n(e)&&(o=e,e=!1),o)return setTimeout((function(){o.call(f,a[t].call(f,e))})),this;if(this.length>1){for("sumrow"!==t&&(f=!0===e?this:this.transpose());u<f.length;u++)i[u]=r[t](f[u]);return!0===e?r[t](r.utils.toVector(i)):i}return r[t](this[0],e)}}(t[e])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){a[t]=function(){var e,o=[],i=0,u=this,f=Array.prototype.slice.call(arguments);if(n(f[f.length-1])){e=f[f.length-1];var c=f.slice(0,f.length-1);return setTimeout((function(){e.call(u,a[t].apply(u,c))})),this}e=void 0;var l=function(n){return r[t].apply(u,[n].concat(f))};if(this.length>1){for(u=u.transpose();i<u.length;i++)o[i]=l(u[i]);return o}return l(this[0])}}(t[e])}("quantiles percentileOfScore".split(" "))}(r,Math),function(r,t){r.gammaln=function(r){var n,e,o,a=0,i=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],u=1.000000000190015;for(o=(e=n=r)+5.5,o-=(n+.5)*t.log(o);a<6;a++)u+=i[a]/++e;return t.log(2.5066282746310007*u/n)-o},r.loggam=function(r){var n,e,o,a,i,u,f,c=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(n=r,f=0,1==r||2==r)return 0;for(r<=7&&(n=r+(f=t.floor(7-r))),e=1/(n*n),o=2*t.PI,i=c[9],u=8;u>=0;u--)i*=e,i+=c[u];if(a=i/n+.5*t.log(o)+(n-.5)*t.log(n)-n,r<=7)for(u=1;u<=f;u++)a-=t.log(n-1),n-=1;return a},r.gammafn=function(r){var n,e,o,a,i=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],u=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],f=!1,c=0,l=0,s=0,p=r;if(r>171.6243769536076)return 1/0;if(p<=0){if(!(a=p%1+36e-17))return 1/0;f=(1&p?-1:1)*t.PI/t.sin(t.PI*a),p=1-p}for(o=p,e=p<1?p++:(p-=c=(0|p)-1)-1,n=0;n<8;++n)s=(s+i[n])*e,l=l*e+u[n];if(a=s/l+1,o<p)a/=o;else if(o>p)for(n=0;n<c;++n)a*=p,p++;return f&&(a=f/a),a},r.gammap=function(t,n){return r.lowRegGamma(t,n)*r.gammafn(t)},r.lowRegGamma=function(n,e){var o,a=r.gammaln(n),i=n,u=1/n,f=u,c=e+1-n,l=1/1e-30,s=1/c,p=s,v=1,h=-~(8.5*t.log(n>=1?n:1/n)+.4*n+17);if(e<0||n<=0)return NaN;if(e<n+1){for(;v<=h;v++)u+=f*=e/++i;return u*t.exp(-e+n*t.log(e)-a)}for(;v<=h;v++)p*=(s=1/(s=(o=-v*(v-n))*s+(c+=2)))*(l=c+o/l);return 1-p*t.exp(-e+n*t.log(e)-a)},r.factorialln=function(t){return t<0?NaN:r.gammaln(t+1)},r.factorial=function(t){return t<0?NaN:r.gammafn(t+1)},r.combination=function(n,e){return n>170||e>170?t.exp(r.combinationln(n,e)):r.factorial(n)/r.factorial(e)/r.factorial(n-e)},r.combinationln=function(t,n){return r.factorialln(t)-r.factorialln(n)-r.factorialln(t-n)},r.permutation=function(t,n){return r.factorial(t)/r.factorial(t-n)},r.betafn=function(n,e){if(!(n<=0||e<=0))return n+e>170?t.exp(r.betaln(n,e)):r.gammafn(n)*r.gammafn(e)/r.gammafn(n+e)},r.betaln=function(t,n){return r.gammaln(t)+r.gammaln(n)-r.gammaln(t+n)},r.betacf=function(r,n,e){var o,a,i,u,f=1e-30,c=1,l=n+e,s=n+1,p=n-1,v=1,h=1-l*r/s;for(t.abs(h)<f&&(h=f),u=h=1/h;c<=100&&(h=1+(a=c*(e-c)*r/((p+(o=2*c))*(n+o)))*h,t.abs(h)<f&&(h=f),v=1+a/v,t.abs(v)<f&&(v=f),u*=(h=1/h)*v,h=1+(a=-(n+c)*(l+c)*r/((n+o)*(s+o)))*h,t.abs(h)<f&&(h=f),v=1+a/v,t.abs(v)<f&&(v=f),u*=i=(h=1/h)*v,!(t.abs(i-1)<3e-7));c++);return u},r.gammapinv=function(n,e){var o,a,i,u,f,c,l=0,s=e-1,p=1e-8,v=r.gammaln(e);if(n>=1)return t.max(100,e+100*t.sqrt(e));if(n<=0)return 0;for(e>1?(f=t.log(s),c=t.exp(s*(f-1)-v),u=n<.5?n:1-n,o=(2.30753+.27061*(a=t.sqrt(-2*t.log(u))))/(1+a*(.99229+.04481*a))-a,n<.5&&(o=-o),o=t.max(.001,e*t.pow(1-1/(9*e)-o/(3*t.sqrt(e)),3))):o=n<(a=1-e*(.253+.12*e))?t.pow(n/a,1/e):1-t.log(1-(n-a)/(1-a));l<12;l++){if(o<=0)return 0;if((o-=a=(i=(r.lowRegGamma(e,o)-n)/(a=e>1?c*t.exp(-(o-s)+s*(t.log(o)-f)):t.exp(-o+s*t.log(o)-v)))/(1-.5*t.min(1,i*((e-1)/o-1))))<=0&&(o=.5*(o+a)),t.abs(a)<p*o)break}return o},r.erf=function(r){var n,e,o,a,i=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],u=i.length-1,f=!1,c=0,l=0;for(r<0&&(r=-r,f=!0),e=4*(n=2/(2+r))-2;u>0;u--)o=c,c=e*c-l+i[u],l=o;return a=n*t.exp(-r*r+.5*(i[0]+e*c)-l),f?a-1:1-a},r.erfc=function(t){return 1-r.erf(t)},r.erfcinv=function(n){var e,o,a,i,u=0;if(n>=2)return-100;if(n<=0)return 100;for(i=n<1?n:2-n,e=-.70711*((2.30753+.27061*(a=t.sqrt(-2*t.log(i/2))))/(1+a*(.99229+.04481*a))-a);u<2;u++)e+=(o=r.erfc(e)-i)/(1.1283791670955126*t.exp(-e*e)-e*o);return n<1?e:-e},r.ibetainv=function(n,e,o){var a,i,u,f,c,l,s,p,v,h,m=1e-8,g=e-1,d=o-1,b=0;if(n<=0)return 0;if(n>=1)return 1;for(e>=1&&o>=1?(u=n<.5?n:1-n,l=(2.30753+.27061*(f=t.sqrt(-2*t.log(u))))/(1+f*(.99229+.04481*f))-f,n<.5&&(l=-l),s=(l*l-3)/6,p=2/(1/(2*e-1)+1/(2*o-1)),v=l*t.sqrt(s+p)/p-(1/(2*o-1)-1/(2*e-1))*(s+5/6-2/(3*p)),l=e/(e+o*t.exp(2*v))):(a=t.log(e/(e+o)),i=t.log(o/(e+o)),l=n<(f=t.exp(e*a)/e)/(v=f+(c=t.exp(o*i)/o))?t.pow(e*v*n,1/e):1-t.pow(o*v*(1-n),1/o)),h=-r.gammaln(e)-r.gammaln(o)+r.gammaln(e+o);b<10;b++){if(0===l||1===l)return l;if((l-=f=(c=(r.ibeta(l,e,o)-n)/(f=t.exp(g*t.log(l)+d*t.log(1-l)+h)))/(1-.5*t.min(1,c*(g/l-d/(1-l)))))<=0&&(l=.5*(l+f)),l>=1&&(l=.5*(l+f+1)),t.abs(f)<m*l&&b>0)break}return l},r.ibeta=function(n,e,o){var a=0===n||1===n?0:t.exp(r.gammaln(e+o)-r.gammaln(e)-r.gammaln(o)+e*t.log(n)+o*t.log(1-n));return!(n<0||n>1)&&(n<(e+1)/(e+o+2)?a*r.betacf(n,e,o)/e:1-a*r.betacf(1-n,o,e)/o)},r.randn=function(n,e){var o,a,i,u,f;if(e||(e=n),n)return r.create(n,e,(function(){return r.randn()}));do{o=r._random_fn(),a=1.7156*(r._random_fn()-.5),f=(i=o-.449871)*i+(u=t.abs(a)+.386595)*(.196*u-.25472*i)}while(f>.27597&&(f>.27846||a*a>-4*t.log(o)*o*o));return a/o},r.randg=function(n,e,o){var a,i,u,f,c,l,s=n;if(o||(o=e),n||(n=1),e)return(l=r.zeros(e,o)).alter((function(){return r.randg(n)})),l;n<1&&(n+=1),a=n-1/3,i=1/t.sqrt(9*a);do{do{f=1+i*(c=r.randn())}while(f<=0);f*=f*f,u=r._random_fn()}while(u>1-.331*t.pow(c,4)&&t.log(u)>.5*c*c+a*(1-f+t.log(f)));if(n==s)return a*f;do{u=r._random_fn()}while(0===u);return t.pow(u,1/s)*a*f},function(t){for(var n=0;n<t.length;n++)!function(t){r.fn[t]=function(){return r(r.map(this,(function(n){return r[t](n)})))}}(t[n])}("gammaln gammafn factorial factorialln".split(" ")),function(t){for(var n=0;n<t.length;n++)!function(t){r.fn[t]=function(){return r(r[t].apply(null,arguments))}}(t[n])}("randn".split(" "))}(r,Math),function(r,t){function n(r,n,e,o){for(var a,i=0,u=1,f=1,c=1,l=0,s=0;t.abs((f-s)/f)>o;)s=f,u=c+(a=-(n+l)*(n+e+l)*r/(n+2*l)/(n+2*l+1))*u,f=(i=f+a*i)+(a=(l+=1)*(e-l)*r/(n+2*l-1)/(n+2*l))*f,i/=c=u+a*c,u/=c,f/=c,c=1;return f/n}function e(r){return r/t.abs(r)}function o(n,e,o){var a=12,i=6,u=-30,f=-50,c=60,l=8,s=3,p=2,v=3,h=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],m=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],g=.5*n;if(g>=l)return 1;var d,b=2*r.normal.cdf(g,0,1,1,0)-1;b=b>=t.exp(f/o)?t.pow(b,o):0;for(var y=g,w=(l-g)/(d=n>s?p:v),j=y+w,x=0,_=o-1,M=1;M<=d;M++){for(var P=0,q=.5*(j+y),A=.5*(j-y),S=1;S<=a;S++){var E,O=q+A*(i<S?h[(E=a-S+1)-1]:-h[(E=S)-1]),k=O*O;if(k>c)break;var N=2*r.normal.cdf(O,0,1,1,0)*.5-2*r.normal.cdf(O,n,1,1,0)*.5;N>=t.exp(u/_)&&(P+=N=m[E-1]*t.exp(-.5*k)*t.pow(N,_))}x+=P*=2*A*o/t.sqrt(2*t.PI),y=j,j+=w}return(b+=x)<=t.exp(u/e)?0:(b=t.pow(b,e))>=1?1:b}function a(r,n,e){var o=.322232421088,a=.099348462606,i=-1,u=.588581570495,f=-.342242088547,c=.531103462366,l=-.204231210125,s=.10353775285,p=-453642210148e-16,v=.0038560700634,h=.8832,m=.2368,g=1.214,d=1.208,b=1.4142,y=120,w=.5-.5*r,j=t.sqrt(t.log(1/(w*w))),x=j+((((j*p+l)*j+f)*j+i)*j+o)/((((j*v+s)*j+c)*j+u)*j+a);e<y&&(x+=(x*x*x+x)/e/4);var _=h-m*x;return e<y&&(_+=-g/e+d*x/e),x*(_*t.log(n-1)+b)}!function(t){for(var n=0;n<t.length;n++)!function(t){r[t]=function r(t,n,e){return this instanceof r?(this._a=t,this._b=n,this._c=e,this):new r(t,n,e)},r.fn[t]=function(n,e,o){var a=r[t](n,e,o);return a.data=this,a},r[t].prototype.sample=function(n){var e=this._a,o=this._b,a=this._c;return n?r.alter(n,(function(){return r[t].sample(e,o,a)})):r[t].sample(e,o,a)},function(n){for(var e=0;e<n.length;e++)!function(n){r[t].prototype[n]=function(e){var o=this._a,a=this._b,i=this._c;return e||0===e||(e=this.data),"number"!=typeof e?r.fn.map.call(e,(function(e){return r[t][n](e,o,a,i)})):r[t][n](e,o,a,i)}}(n[e])}("pdf cdf inv".split(" ")),function(n){for(var e=0;e<n.length;e++)!function(n){r[t].prototype[n]=function(){return r[t][n](this._a,this._b,this._c)}}(n[e])}("mean median mode variance".split(" "))}(t[n])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),r.extend(r.beta,{pdf:function(n,e,o){return n>1||n<0?0:1==e&&1==o?1:e<512&&o<512?t.pow(n,e-1)*t.pow(1-n,o-1)/r.betafn(e,o):t.exp((e-1)*t.log(n)+(o-1)*t.log(1-n)-r.betaln(e,o))},cdf:function(t,n,e){return t>1||t<0?1*(t>1):r.ibeta(t,n,e)},inv:function(t,n,e){return r.ibetainv(t,n,e)},mean:function(r,t){return r/(r+t)},median:function(t,n){return r.ibetainv(.5,t,n)},mode:function(r,t){return(r-1)/(r+t-2)},sample:function(t,n){var e=r.randg(t);return e/(e+r.randg(n))},variance:function(r,n){return r*n/(t.pow(r+n,2)*(r+n+1))}}),r.extend(r.centralF,{pdf:function(n,e,o){var a;return n<0?0:e<=2?0===n&&e<2?1/0:0===n&&2===e?1:1/r.betafn(e/2,o/2)*t.pow(e/o,e/2)*t.pow(n,e/2-1)*t.pow(1+e/o*n,-(e+o)/2):(a=e*n/(o+n*e),e*(o/(o+n*e))/2*r.binomial.pdf((e-2)/2,(e+o-2)/2,a))},cdf:function(t,n,e){return t<0?0:r.ibeta(n*t/(n*t+e),n/2,e/2)},inv:function(t,n,e){return e/(n*(1/r.ibetainv(t,n/2,e/2)-1))},mean:function(r,t){return t>2?t/(t-2):void 0},mode:function(r,t){return r>2?t*(r-2)/(r*(t+2)):void 0},sample:function(t,n){return 2*r.randg(t/2)/t/(2*r.randg(n/2)/n)},variance:function(r,t){if(!(t<=4))return 2*t*t*(r+t-2)/(r*(t-2)*(t-2)*(t-4))}}),r.extend(r.cauchy,{pdf:function(r,n,e){return e<0?0:e/(t.pow(r-n,2)+t.pow(e,2))/t.PI},cdf:function(r,n,e){return t.atan((r-n)/e)/t.PI+.5},inv:function(r,n,e){return n+e*t.tan(t.PI*(r-.5))},median:function(r){return r},mode:function(r){return r},sample:function(n,e){return r.randn()*t.sqrt(1/(2*r.randg(.5)))*e+n}}),r.extend(r.chisquare,{pdf:function(n,e){return n<0?0:0===n&&2===e?.5:t.exp((e/2-1)*t.log(n)-n/2-e/2*t.log(2)-r.gammaln(e/2))},cdf:function(t,n){return t<0?0:r.lowRegGamma(n/2,t/2)},inv:function(t,n){return 2*r.gammapinv(t,.5*n)},mean:function(r){return r},median:function(r){return r*t.pow(1-2/(9*r),3)},mode:function(r){return r-2>0?r-2:0},sample:function(t){return 2*r.randg(t/2)},variance:function(r){return 2*r}}),r.extend(r.exponential,{pdf:function(r,n){return r<0?0:n*t.exp(-n*r)},cdf:function(r,n){return r<0?0:1-t.exp(-n*r)},inv:function(r,n){return-t.log(1-r)/n},mean:function(r){return 1/r},median:function(r){return 1/r*t.log(2)},mode:function(){return 0},sample:function(n){return-1/n*t.log(r._random_fn())},variance:function(r){return t.pow(r,-2)}}),r.extend(r.gamma,{pdf:function(n,e,o){return n<0?0:0===n&&1===e?1/o:t.exp((e-1)*t.log(n)-n/o-r.gammaln(e)-e*t.log(o))},cdf:function(t,n,e){return t<0?0:r.lowRegGamma(n,t/e)},inv:function(t,n,e){return r.gammapinv(t,n)*e},mean:function(r,t){return r*t},mode:function(r,t){if(r>1)return(r-1)*t},sample:function(t,n){return r.randg(t)*n},variance:function(r,t){return r*t*t}}),r.extend(r.invgamma,{pdf:function(n,e,o){return n<=0?0:t.exp(-(e+1)*t.log(n)-o/n-r.gammaln(e)+e*t.log(o))},cdf:function(t,n,e){return t<=0?0:1-r.lowRegGamma(n,e/t)},inv:function(t,n,e){return e/r.gammapinv(1-t,n)},mean:function(r,t){return r>1?t/(r-1):void 0},mode:function(r,t){return t/(r+1)},sample:function(t,n){return n/r.randg(t)},variance:function(r,t){if(!(r<=2))return t*t/((r-1)*(r-1)*(r-2))}}),r.extend(r.kumaraswamy,{pdf:function(r,n,e){return 0===r&&1===n?e:1===r&&1===e?n:t.exp(t.log(n)+t.log(e)+(n-1)*t.log(r)+(e-1)*t.log(1-t.pow(r,n)))},cdf:function(r,n,e){return r<0?0:r>1?1:1-t.pow(1-t.pow(r,n),e)},inv:function(r,n,e){return t.pow(1-t.pow(1-r,1/e),1/n)},mean:function(t,n){return n*r.gammafn(1+1/t)*r.gammafn(n)/r.gammafn(1+1/t+n)},median:function(r,n){return t.pow(1-t.pow(2,-1/n),1/r)},mode:function(r,n){if(r>=1&&n>=1&&1!==r&&1!==n)return t.pow((r-1)/(r*n-1),1/r)},variance:function(){throw new Error("variance not yet implemented")}}),r.extend(r.lognormal,{pdf:function(r,n,e){return r<=0?0:t.exp(-t.log(r)-.5*t.log(2*t.PI)-t.log(e)-t.pow(t.log(r)-n,2)/(2*e*e))},cdf:function(n,e,o){return n<0?0:.5+.5*r.erf((t.log(n)-e)/t.sqrt(2*o*o))},inv:function(n,e,o){return t.exp(-1.4142135623730951*o*r.erfcinv(2*n)+e)},mean:function(r,n){return t.exp(r+n*n/2)},median:function(r){return t.exp(r)},mode:function(r,n){return t.exp(r-n*n)},sample:function(n,e){return t.exp(r.randn()*e+n)},variance:function(r,n){return(t.exp(n*n)-1)*t.exp(2*r+n*n)}}),r.extend(r.noncentralt,{pdf:function(n,e,o){var a=1e-14;return t.abs(o)<a?r.studentt.pdf(n,e):t.abs(n)<a?t.exp(r.gammaln((e+1)/2)-o*o/2-.5*t.log(t.PI*e)-r.gammaln(e/2)):e/n*(r.noncentralt.cdf(n*t.sqrt(1+2/e),e+2,o)-r.noncentralt.cdf(n,e,o))},cdf:function(n,e,o){var a=1e-14,i=200;if(t.abs(o)<a)return r.studentt.cdf(n,e);var u=!1;n<0&&(u=!0,o=-o);for(var f=r.normal.cdf(-o,0,1),c=a+1,l=c,s=n*n/(n*n+e),p=0,v=t.exp(-o*o/2),h=t.exp(-o*o/2-.5*t.log(2)-r.gammaln(1.5))*o;p<i||l>a||c>a;)l=c,p>0&&(v*=o*o/(2*p),h*=o*o/(2*(p+.5))),f+=.5*(c=v*r.beta.cdf(s,p+.5,e/2)+h*r.beta.cdf(s,p+1,e/2)),p++;return u?1-f:f}}),r.extend(r.normal,{pdf:function(r,n,e){return t.exp(-.5*t.log(2*t.PI)-t.log(e)-t.pow(r-n,2)/(2*e*e))},cdf:function(n,e,o){return.5*(1+r.erf((n-e)/t.sqrt(2*o*o)))},inv:function(t,n,e){return-1.4142135623730951*e*r.erfcinv(2*t)+n},mean:function(r){return r},median:function(r){return r},mode:function(r){return r},sample:function(t,n){return r.randn()*n+t},variance:function(r,t){return t*t}}),r.extend(r.pareto,{pdf:function(r,n,e){return r<n?0:e*t.pow(n,e)/t.pow(r,e+1)},cdf:function(r,n,e){return r<n?0:1-t.pow(n/r,e)},inv:function(r,n,e){return n/t.pow(1-r,1/e)},mean:function(r,n){if(!(n<=1))return n*t.pow(r,n)/(n-1)},median:function(r,n){return r*(n*t.SQRT2)},mode:function(r){return r},variance:function(r,n){if(!(n<=2))return r*r*n/(t.pow(n-1,2)*(n-2))}}),r.extend(r.studentt,{pdf:function(n,e){return e=e>1e100?1e100:e,1/(t.sqrt(e)*r.betafn(.5,e/2))*t.pow(1+n*n/e,-(e+1)/2)},cdf:function(n,e){var o=e/2;return r.ibeta((n+t.sqrt(n*n+e))/(2*t.sqrt(n*n+e)),o,o)},inv:function(n,e){var o=r.ibetainv(2*t.min(n,1-n),.5*e,.5);return o=t.sqrt(e*(1-o)/o),n>.5?o:-o},mean:function(r){return r>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(n){return r.randn()*t.sqrt(n/(2*r.randg(n/2)))},variance:function(r){return r>2?r/(r-2):r>1?1/0:void 0}}),r.extend(r.weibull,{pdf:function(r,n,e){return r<0||n<0||e<0?0:e/n*t.pow(r/n,e-1)*t.exp(-t.pow(r/n,e))},cdf:function(r,n,e){return r<0?0:1-t.exp(-t.pow(r/n,e))},inv:function(r,n,e){return n*t.pow(-t.log(1-r),1/e)},mean:function(t,n){return t*r.gammafn(1+1/n)},median:function(r,n){return r*t.pow(t.log(2),1/n)},mode:function(r,n){return n<=1?0:r*t.pow((n-1)/n,1/n)},sample:function(n,e){return n*t.pow(-t.log(r._random_fn()),1/e)},variance:function(n,e){return n*n*r.gammafn(1+2/e)-t.pow(r.weibull.mean(n,e),2)}}),r.extend(r.uniform,{pdf:function(r,t,n){return r<t||r>n?0:1/(n-t)},cdf:function(r,t,n){return r<t?0:r<n?(r-t)/(n-t):1},inv:function(r,t,n){return t+r*(n-t)},mean:function(r,t){return.5*(r+t)},median:function(t,n){return r.mean(t,n)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(t,n){return t/2+n/2+(n/2-t/2)*(2*r._random_fn()-1)},variance:function(r,n){return t.pow(n-r,2)/12}}),r.extend(r.binomial,{pdf:function(n,e,o){return 0===o||1===o?e*o===n?1:0:r.combination(e,n)*t.pow(o,n)*t.pow(1-o,e-n)},cdf:function(e,o,a){var i,u=1e-10;if(e<0)return 0;if(e>=o)return 1;if(a<0||a>1||o<=0)return NaN;var f=a,c=(e=t.floor(e))+1,l=o-e,s=c+l,p=t.exp(r.gammaln(s)-r.gammaln(l)-r.gammaln(c)+c*t.log(f)+l*t.log(1-f));return i=f<(c+1)/(s+2)?p*n(f,c,l,u):1-p*n(1-f,l,c,u),t.round(1/u*(1-i))/(1/u)}}),r.extend(r.negbin,{pdf:function(n,e,o){return n===n>>>0&&(n<0?0:r.combination(n+e-1,e-1)*t.pow(1-o,n)*t.pow(o,e))},cdf:function(t,n,e){var o=0,a=0;if(t<0)return 0;for(;a<=t;a++)o+=r.negbin.pdf(a,n,e);return o}}),r.extend(r.hypgeom,{pdf:function(n,e,o,a){if(n!=n|0)return!1;if(n<0||n<o-(e-a))return 0;if(n>a||n>o)return 0;if(2*o>e)return 2*a>e?r.hypgeom.pdf(e-o-a+n,e,e-o,e-a):r.hypgeom.pdf(a-n,e,e-o,a);if(2*a>e)return r.hypgeom.pdf(o-n,e,o,e-a);if(o<a)return r.hypgeom.pdf(n,e,a,o);for(var i=1,u=0,f=0;f<n;f++){for(;i>1&&u<a;)i*=1-o/(e-u),u++;i*=(a-f)*(o-f)/((f+1)*(e-o-a+f+1))}for(;u<a;u++)i*=1-o/(e-u);return t.min(1,t.max(0,i))},cdf:function(n,e,o,a){if(n<0||n<o-(e-a))return 0;if(n>=a||n>=o)return 1;if(2*o>e)return 2*a>e?r.hypgeom.cdf(e-o-a+n,e,e-o,e-a):1-r.hypgeom.cdf(a-n-1,e,e-o,a);if(2*a>e)return 1-r.hypgeom.cdf(o-n-1,e,o,e-a);if(o<a)return r.hypgeom.cdf(n,e,a,o);for(var i=1,u=1,f=0,c=0;c<n;c++){for(;i>1&&f<a;){var l=1-o/(e-f);u*=l,i*=l,f++}i+=u*=(a-c)*(o-c)/((c+1)*(e-o-a+c+1))}for(;f<a;f++)i*=1-o/(e-f);return t.min(1,t.max(0,i))}}),r.extend(r.poisson,{pdf:function(n,e){return e<0||n%1!=0||n<0?0:t.pow(e,n)*t.exp(-e)/r.factorial(n)},cdf:function(t,n){var e=[],o=0;if(t<0)return 0;for(;o<=t;o++)e.push(r.poisson.pdf(o,n));return r.sum(e)},mean:function(r){return r},variance:function(r){return r},sampleSmall:function(n){var e=1,o=0,a=t.exp(-n);do{o++,e*=r._random_fn()}while(e>a);return o-1},sampleLarge:function(n){var e,o,a,i,u,f,c,l,s,p,v=n;for(i=t.sqrt(v),u=t.log(v),f=.02483*(c=.931+2.53*i)-.059,l=1.1239+1.1328/(c-3.4),s=.9277-3.6224/(c-2);;){if(o=t.random()-.5,a=t.random(),p=.5-t.abs(o),e=t.floor((2*f/p+c)*o+v+.43),p>=.07&&a<=s)return e;if(!(e<0||p<.013&&a>p)&&t.log(a)+t.log(l)-t.log(f/(p*p)+c)<=e*u-v-r.loggam(e+1))return e}},sample:function(r){return r<10?this.sampleSmall(r):this.sampleLarge(r)}}),r.extend(r.triangular,{pdf:function(r,t,n,e){return n<=t||e<t||e>n?NaN:r<t||r>n?0:r<e?2*(r-t)/((n-t)*(e-t)):r===e?2/(n-t):2*(n-r)/((n-t)*(n-e))},cdf:function(r,n,e,o){return e<=n||o<n||o>e?NaN:r<=n?0:r>=e?1:r<=o?t.pow(r-n,2)/((e-n)*(o-n)):1-t.pow(e-r,2)/((e-n)*(e-o))},inv:function(r,n,e,o){return e<=n||o<n||o>e?NaN:r<=(o-n)/(e-n)?n+(e-n)*t.sqrt(r*((o-n)/(e-n))):n+(e-n)*(1-t.sqrt((1-r)*(1-(o-n)/(e-n))))},mean:function(r,t,n){return(r+t+n)/3},median:function(r,n,e){return e<=(r+n)/2?n-t.sqrt((n-r)*(n-e))/t.sqrt(2):e>(r+n)/2?r+t.sqrt((n-r)*(e-r))/t.sqrt(2):void 0},mode:function(r,t,n){return n},sample:function(n,e,o){var a=r._random_fn();return a<(o-n)/(e-n)?n+t.sqrt(a*(e-n)*(o-n)):e-t.sqrt((1-a)*(e-n)*(e-o))},variance:function(r,t,n){return(r*r+t*t+n*n-r*t-r*n-t*n)/18}}),r.extend(r.arcsine,{pdf:function(r,n,e){return e<=n?NaN:r<=n||r>=e?0:2/t.PI*t.pow(t.pow(e-n,2)-t.pow(2*r-n-e,2),-.5)},cdf:function(r,n,e){return r<n?0:r<e?2/t.PI*t.asin(t.sqrt((r-n)/(e-n))):1},inv:function(r,n,e){return n+(.5-.5*t.cos(t.PI*r))*(e-n)},mean:function(r,t){return t<=r?NaN:(r+t)/2},median:function(r,t){return t<=r?NaN:(r+t)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(n,e){return(n+e)/2+(e-n)/2*t.sin(2*t.PI*r.uniform.sample(0,1))},variance:function(r,n){return n<=r?NaN:t.pow(n-r,2)/8}}),r.extend(r.laplace,{pdf:function(r,n,e){return e<=0?0:t.exp(-t.abs(r-n)/e)/(2*e)},cdf:function(r,n,e){return e<=0?0:r<n?.5*t.exp((r-n)/e):1-.5*t.exp(-(r-n)/e)},mean:function(r){return r},median:function(r){return r},mode:function(r){return r},variance:function(r,t){return 2*t*t},sample:function(n,o){var a=r._random_fn()-.5;return n-o*e(a)*t.log(1-2*t.abs(a))}}),r.extend(r.tukey,{cdf:function(n,e,a){var i=1,u=e,f=16,c=8,l=-30,s=1e-14,p=100,v=800,h=5e3,m=25e3,g=1,d=.5,b=.25,y=.125,w=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],j=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(n<=0)return 0;if(a<2||i<1||u<2)return NaN;if(!Number.isFinite(n))return 1;if(a>m)return o(n,i,u);var x,_=.5*a,M=_*t.log(a)-a*t.log(2)-r.gammaln(_),P=_-1,q=.25*a;x=a<=p?g:a<=v?d:a<=h?b:y,M+=t.log(x);for(var A=0,S=1;S<=50;S++){for(var E=0,O=(2*S-1)*x,k=1;k<=f;k++){var N,I;c<k?(N=k-c-1,I=M+P*t.log(O+w[N]*x)-(w[N]*x+O)*q):(N=k-1,I=M+P*t.log(O-w[N]*x)+(w[N]*x-O)*q),I>=l&&(E+=o(c<k?n*t.sqrt(.5*(w[N]*x+O)):n*t.sqrt(.5*(-w[N]*x+O)),i,u)*j[N]*t.exp(I))}if(S*x>=1&&E<=s)break;A+=E}if(E>s)throw new Error("tukey.cdf failed to converge");return A>1&&(A=1),A},inv:function(n,e,o){var i=1e-4,u=50;if(o<2||e<2)return NaN;if(n<0||n>1)return NaN;if(0===n)return 0;if(1===n)return 1/0;var f,c=a(n,e,o),l=r.tukey.cdf(c,e,o)-n;f=l>0?t.max(0,c-1):c+1;for(var s,p=r.tukey.cdf(f,e,o)-n,v=1;v<u;v++)if(s=f-p*(f-c)/(p-l),l=p,c=f,s<0&&(s=0,p=-n),p=r.tukey.cdf(s,e,o)-n,f=s,t.abs(f-c)<i)return s;throw new Error("tukey.inv failed to converge")}})}(r,Math),function(r,t){var n=Array.prototype.push,e=r.utils.isArray;function o(t){return e(t)||t instanceof r}r.extend({add:function(t,n){return o(n)?(o(n[0])||(n=[n]),r.map(t,(function(r,t,e){return r+n[t][e]}))):r.map(t,(function(r){return r+n}))},subtract:function(t,n){return o(n)?(o(n[0])||(n=[n]),r.map(t,(function(r,t,e){return r-n[t][e]||0}))):r.map(t,(function(r){return r-n}))},divide:function(t,n){return o(n)?(o(n[0])||(n=[n]),r.multiply(t,r.inv(n))):r.map(t,(function(r){return r/n}))},multiply:function(t,n){var e,a,i,u,f,c,l,s;if(void 0===t.length&&void 0===n.length)return t*n;if(f=t.length,c=t[0].length,l=r.zeros(f,i=o(n)?n[0].length:c),s=0,o(n)){for(;s<i;s++)for(e=0;e<f;e++){for(u=0,a=0;a<c;a++)u+=t[e][a]*n[a][s];l[e][s]=u}return 1===f&&1===s?l[0][0]:l}return r.map(t,(function(r){return r*n}))},outer:function(t,n){return r.multiply(t.map((function(r){return[r]})),[n])},dot:function(t,n){o(t[0])||(t=[t]),o(n[0])||(n=[n]);for(var e,a,i=1===t[0].length&&1!==t.length?r.transpose(t):t,u=1===n[0].length&&1!==n.length?r.transpose(n):n,f=[],c=0,l=i.length,s=i[0].length;c<l;c++){for(f[c]=[],e=0,a=0;a<s;a++)e+=i[c][a]*u[c][a];f[c]=e}return 1===f.length?f[0]:f},pow:function(n,e){return r.map(n,(function(r){return t.pow(r,e)}))},exp:function(n){return r.map(n,(function(r){return t.exp(r)}))},log:function(n){return r.map(n,(function(r){return t.log(r)}))},abs:function(n){return r.map(n,(function(r){return t.abs(r)}))},norm:function(r,n){var e=0,a=0;for(isNaN(n)&&(n=2),o(r[0])&&(r=r[0]);a<r.length;a++)e+=t.pow(t.abs(r[a]),n);return t.pow(e,1/n)},angle:function(n,e){return t.acos(r.dot(n,e)/(r.norm(n)*r.norm(e)))},aug:function(r,t){var e,o=[];for(e=0;e<r.length;e++)o.push(r[e].slice());for(e=0;e<o.length;e++)n.apply(o[e],t[e]);return o},inv:function(t){for(var n,e=t.length,o=t[0].length,a=r.identity(e,o),i=r.gauss_jordan(t,a),u=[],f=0;f<e;f++)for(u[f]=[],n=o;n<i[0].length;n++)u[f][n-o]=i[f][n];return u},det:function r(t){if(2===t.length)return t[0][0]*t[1][1]-t[0][1]*t[1][0];for(var n=0,e=0;e<t.length;e++){for(var o=[],a=1;a<t.length;a++){o[a-1]=[];for(var i=0;i<t.length;i++)i<e?o[a-1][i]=t[a][i]:i>e&&(o[a-1][i-1]=t[a][i])}var u=e%2?-1:1;n+=r(o)*t[0][e]*u}return n},gauss_elimination:function(n,e){var o,a,i,u,f=0,c=0,l=n.length,s=n[0].length,p=1,v=0,h=[];for(o=(n=r.aug(n,e))[0].length,f=0;f<l;f++){for(a=n[f][f],c=f,u=f+1;u<s;u++)a<t.abs(n[u][f])&&(a=n[u][f],c=u);if(c!=f)for(u=0;u<o;u++)i=n[f][u],n[f][u]=n[c][u],n[c][u]=i;for(c=f+1;c<l;c++)for(p=n[c][f]/n[f][f],u=f;u<o;u++)n[c][u]=n[c][u]-p*n[f][u]}for(f=l-1;f>=0;f--){for(v=0,c=f+1;c<=l-1;c++)v+=h[c]*n[f][c];h[f]=(n[f][o-1]-v)/n[f][f]}return h},gauss_jordan:function(n,e){var o,a,i,u=r.aug(n,e),f=u.length,c=u[0].length,l=0;for(a=0;a<f;a++){var s=a;for(i=a+1;i<f;i++)t.abs(u[i][a])>t.abs(u[s][a])&&(s=i);var p=u[a];for(u[a]=u[s],u[s]=p,i=a+1;i<f;i++)for(l=u[i][a]/u[a][a],o=a;o<c;o++)u[i][o]-=u[a][o]*l}for(a=f-1;a>=0;a--){for(l=u[a][a],i=0;i<a;i++)for(o=c-1;o>a-1;o--)u[i][o]-=u[a][o]*u[i][a]/l;for(u[a][a]/=l,o=f;o<c;o++)u[a][o]/=l}return u},triaUpSolve:function(t,n){var e,o=t[0].length,a=r.zeros(1,o)[0],i=!1;return null!=n[0].length&&(n=n.map((function(r){return r[0]})),i=!0),r.arange(o-1,-1,-1).forEach((function(i){e=r.arange(i+1,o).map((function(r){return a[r]*t[i][r]})),a[i]=(n[i]-r.sum(e))/t[i][i]})),i?a.map((function(r){return[r]})):a},triaLowSolve:function(t,n){var e,o=t[0].length,a=r.zeros(1,o)[0],i=!1;return null!=n[0].length&&(n=n.map((function(r){return r[0]})),i=!0),r.arange(o).forEach((function(o){e=r.arange(o).map((function(r){return t[o][r]*a[r]})),a[o]=(n[o]-r.sum(e))/t[o][o]})),i?a.map((function(r){return[r]})):a},lu:function(t){var n,e=t.length,o=r.identity(e),a=r.zeros(t.length,t[0].length);return r.arange(e).forEach((function(r){a[0][r]=t[0][r]})),r.arange(1,e).forEach((function(i){r.arange(i).forEach((function(e){n=r.arange(e).map((function(r){return o[i][r]*a[r][e]})),o[i][e]=(t[i][e]-r.sum(n))/a[e][e]})),r.arange(i,e).forEach((function(e){n=r.arange(i).map((function(r){return o[i][r]*a[r][e]})),a[i][e]=t[n.length][e]-r.sum(n)}))})),[o,a]},cholesky:function(n){var e,o=n.length,a=r.zeros(n.length,n[0].length);return r.arange(o).forEach((function(i){e=r.arange(i).map((function(r){return t.pow(a[i][r],2)})),a[i][i]=t.sqrt(n[i][i]-r.sum(e)),r.arange(i+1,o).forEach((function(t){e=r.arange(i).map((function(r){return a[i][r]*a[t][r]})),a[t][i]=(n[i][t]-r.sum(e))/a[i][i]}))})),a},gauss_jacobi:function(n,e,o,a){for(var i,u,f,c,l=0,s=0,p=n.length,v=[],h=[],m=[];l<p;l++)for(v[l]=[],h[l]=[],m[l]=[],s=0;s<p;s++)l>s?(v[l][s]=n[l][s],h[l][s]=m[l][s]=0):l<s?(h[l][s]=n[l][s],v[l][s]=m[l][s]=0):(m[l][s]=n[l][s],v[l][s]=h[l][s]=0);for(f=r.multiply(r.multiply(r.inv(m),r.add(v,h)),-1),u=r.multiply(r.inv(m),e),i=o,c=r.add(r.multiply(f,o),u),l=2;t.abs(r.norm(r.subtract(c,i)))>a;)i=c,c=r.add(r.multiply(f,i),u),l++;return c},gauss_seidel:function(n,e,o,a){for(var i,u,f,c,l,s=0,p=n.length,v=[],h=[],m=[];s<p;s++)for(v[s]=[],h[s]=[],m[s]=[],i=0;i<p;i++)s>i?(v[s][i]=n[s][i],h[s][i]=m[s][i]=0):s<i?(h[s][i]=n[s][i],v[s][i]=m[s][i]=0):(m[s][i]=n[s][i],v[s][i]=h[s][i]=0);for(c=r.multiply(r.multiply(r.inv(r.add(m,v)),h),-1),f=r.multiply(r.inv(r.add(m,v)),e),u=o,l=r.add(r.multiply(c,o),f),s=2;t.abs(r.norm(r.subtract(l,u)))>a;)u=l,l=r.add(r.multiply(c,u),f),s+=1;return l},SOR:function(n,e,o,a,i){for(var u,f,c,l,s,p=0,v=n.length,h=[],m=[],g=[];p<v;p++)for(h[p]=[],m[p]=[],g[p]=[],u=0;u<v;u++)p>u?(h[p][u]=n[p][u],m[p][u]=g[p][u]=0):p<u?(m[p][u]=n[p][u],h[p][u]=g[p][u]=0):(g[p][u]=n[p][u],h[p][u]=m[p][u]=0);for(l=r.multiply(r.inv(r.add(g,r.multiply(h,i))),r.subtract(r.multiply(g,1-i),r.multiply(m,i))),c=r.multiply(r.multiply(r.inv(r.add(g,r.multiply(h,i))),e),i),f=o,s=r.add(r.multiply(l,o),c),p=2;t.abs(r.norm(r.subtract(s,f)))>a;)f=s,s=r.add(r.multiply(l,f),c),p++;return s},householder:function(n){for(var e,o,a,i,u=n.length,f=n[0].length,c=0,l=[],s=[];c<u-1;c++){for(e=0,i=c+1;i<f;i++)e+=n[i][c]*n[i][c];for(e=(n[c+1][c]>0?-1:1)*t.sqrt(e),o=t.sqrt((e*e-n[c+1][c]*e)/2),(l=r.zeros(u,1))[c+1][0]=(n[c+1][c]-e)/(2*o),a=c+2;a<u;a++)l[a][0]=n[a][c]/(2*o);s=r.subtract(r.identity(u,f),r.multiply(r.multiply(l,r.transpose(l)),2)),n=r.multiply(s,r.multiply(n,s))}return n},QR:function(){var n=r.sum,e=r.arange;function o(o){var a,i,u,f=o.length,c=o[0].length,l=r.zeros(c,c);for(o=r.copy(o),i=0;i<c;i++){for(l[i][i]=t.sqrt(n(e(f).map((function(r){return o[r][i]*o[r][i]})))),a=0;a<f;a++)o[a][i]=o[a][i]/l[i][i];for(u=i+1;u<c;u++)for(l[i][u]=n(e(f).map((function(r){return o[r][i]*o[r][u]}))),a=0;a<f;a++)o[a][u]=o[a][u]-o[a][i]*l[i][u]}return[o,l]}return o}(),lstsq:function(){function t(t){var n=(t=r.copy(t)).length,e=r.identity(n);return r.arange(n-1,-1,-1).forEach((function(n){r.sliceAssign(e,{row:n},r.divide(r.slice(e,{row:n}),t[n][n])),r.sliceAssign(t,{row:n},r.divide(r.slice(t,{row:n}),t[n][n])),r.arange(n).forEach((function(o){var a=r.multiply(t[o][n],-1),i=r.slice(t,{row:o}),u=r.multiply(r.slice(t,{row:n}),a);r.sliceAssign(t,{row:o},r.add(i,u));var f=r.slice(e,{row:o}),c=r.multiply(r.slice(e,{row:n}),a);r.sliceAssign(e,{row:o},r.add(f,c))}))})),e}function n(n,e){var o=!1;void 0===e[0].length&&(e=e.map((function(r){return[r]})),o=!0);var a=r.QR(n),i=a[0],u=a[1],f=n[0].length,c=r.slice(i,{col:{end:f}}),l=t(r.slice(u,{row:{end:f}})),s=r.transpose(c);void 0===s[0].length&&(s=[s]);var p=r.multiply(r.multiply(l,s),e);return void 0===p.length&&(p=[[p]]),o?p.map((function(r){return r[0]})):p}return n}(),jacobi:function(n){for(var e,o,a,i,u,f,c,l=1,s=n.length,p=r.identity(s,s),v=[];1===l;){for(u=n[0][1],a=0,i=1,e=0;e<s;e++)for(o=0;o<s;o++)e!=o&&u<t.abs(n[e][o])&&(u=t.abs(n[e][o]),a=e,i=o);for(f=n[a][a]===n[i][i]?n[a][i]>0?t.PI/4:-t.PI/4:t.atan(2*n[a][i]/(n[a][a]-n[i][i]))/2,(c=r.identity(s,s))[a][a]=t.cos(f),c[a][i]=-t.sin(f),c[i][a]=t.sin(f),c[i][i]=t.cos(f),p=r.multiply(p,c),n=r.multiply(r.multiply(r.inv(c),n),c),l=0,e=1;e<s;e++)for(o=1;o<s;o++)e!=o&&t.abs(n[e][o])>.001&&(l=1)}for(e=0;e<s;e++)v.push(n[e][e]);return[p,v]},rungekutta:function(r,t,n,e,o,a){var i,u,f;if(2===a)for(;e<=n;)o+=((i=t*r(e,o))+(u=t*r(e+t,o+i)))/2,e+=t;if(4===a)for(;e<=n;)o+=((i=t*r(e,o))+2*(u=t*r(e+t/2,o+i/2))+2*(f=t*r(e+t/2,o+u/2))+t*r(e+t,o+f))/6,e+=t;return o},romberg:function(r,n,e,o){for(var a,i,u,f,c,l=0,s=(e-n)/2,p=[],v=[],h=[];l<o/2;){for(c=r(n),u=n,f=0;u<=e;u+=s,f++)p[f]=u;for(a=p.length,u=1;u<a-1;u++)c+=(u%2!=0?4:2)*r(p[u]);c=s/3*(c+r(e)),h[l]=c,s/=2,l++}for(i=h.length,a=1;1!==i;){for(u=0;u<i-1;u++)v[u]=(t.pow(4,a)*h[u+1]-h[u])/(t.pow(4,a)-1);i=v.length,h=v,v=[],a++}return h},richardson:function(r,n,e,o){function a(r,t){for(var n,e=0,o=r.length;e<o;e++)r[e]===t&&(n=e);return n}for(var i,u,f,c,l,s=t.abs(e-r[a(r,e)+1]),p=0,v=[],h=[];o>=s;)i=a(r,e+o),u=a(r,e),v[p]=(n[i]-2*n[u]+n[2*u-i])/(o*o),o/=2,p++;for(c=v.length,f=1;1!=c;){for(l=0;l<c-1;l++)h[l]=(t.pow(4,f)*v[l+1]-v[l])/(t.pow(4,f)-1);c=h.length,v=h,h=[],f++}return v},simpson:function(r,t,n,e){for(var o,a=(n-t)/e,i=r(t),u=[],f=t,c=0,l=1;f<=n;f+=a,c++)u[c]=f;for(o=u.length;l<o-1;l++)i+=(l%2!=0?4:2)*r(u[l]);return a/3*(i+r(n))},hermite:function(r,t,n,e){for(var o,a=r.length,i=0,u=0,f=[],c=[],l=[],s=[];u<a;u++){for(f[u]=1,o=0;o<a;o++)u!=o&&(f[u]*=(e-r[o])/(r[u]-r[o]));for(c[u]=0,o=0;o<a;o++)u!=o&&(c[u]+=1/(r[u]-r[o]));l[u]=(1-2*(e-r[u])*c[u])*(f[u]*f[u]),s[u]=(e-r[u])*(f[u]*f[u]),i+=l[u]*t[u]+s[u]*n[u]}return i},lagrange:function(r,t,n){for(var e,o,a=0,i=0,u=r.length;i<u;i++){for(o=t[i],e=0;e<u;e++)i!=e&&(o*=(n-r[e])/(r[i]-r[e]));a+=o}return a},cubic_spline:function(t,n,e){for(var o,a=t.length,i=0,u=[],f=[],c=[],l=[],s=[],p=[],v=[];i<a-1;i++)s[i]=t[i+1]-t[i];for(c[0]=0,i=1;i<a-1;i++)c[i]=3/s[i]*(n[i+1]-n[i])-3/s[i-1]*(n[i]-n[i-1]);for(i=1;i<a-1;i++)u[i]=[],f[i]=[],u[i][i-1]=s[i-1],u[i][i]=2*(s[i-1]+s[i]),u[i][i+1]=s[i],f[i][0]=c[i];for(l=r.multiply(r.inv(u),f),o=0;o<a-1;o++)p[o]=(n[o+1]-n[o])/s[o]-s[o]*(l[o+1][0]+2*l[o][0])/3,v[o]=(l[o+1][0]-l[o][0])/(3*s[o]);for(o=0;o<a&&!(t[o]>e);o++);return n[o-=1]+(e-t[o])*p[o]+r.sq(e-t[o])*l[o]+(e-t[o])*r.sq(e-t[o])*v[o]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(t){var n,e,o=t.length,a=t[0].length,i=0,u=[],f=[],c=[],l=[],s=[],p=[],v=[],h=[],m=[],g=[];for(i=0;i<o;i++)u[i]=r.sum(t[i])/a;for(i=0;i<a;i++)for(v[i]=[],n=0;n<o;n++)v[i][n]=t[n][i]-u[n];for(v=r.transpose(v),i=0;i<o;i++)for(h[i]=[],n=0;n<o;n++)h[i][n]=r.dot([v[i]],[v[n]])/(a-1);for(m=(c=r.jacobi(h))[0],f=c[1],g=r.transpose(m),i=0;i<f.length;i++)for(n=i;n<f.length;n++)f[i]<f[n]&&(e=f[i],f[i]=f[n],f[n]=e,l=g[i],g[i]=g[n],g[n]=l);for(p=r.transpose(v),i=0;i<o;i++)for(s[i]=[],n=0;n<p.length;n++)s[i][n]=r.dot([g[i]],[p[n]]);return[t,f,g,s]}}),function(t){for(var n=0;n<t.length;n++)!function(t){r.fn[t]=function(n,e){var o=this;return e?(setTimeout((function(){e.call(o,r.fn[t].call(o,n))}),15),this):"number"==typeof r[t](this,n)?r[t](this,n):r(r[t](this,n))}}(t[n])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(r,Math),function(r,t){var n=[].slice,e=r.utils.isNumber,o=r.utils.isArray;function a(r,n,e,o){if(r>1||e>1||r<=0||e<=0)throw new Error("Proportions should be greater than 0 and less than 1");var a=(r*n+e*o)/(n+o);return(r-e)/t.sqrt(a*(1-a)*(1/n+1/o))}r.extend({zscore:function(){var t=n.call(arguments);return e(t[1])?(t[0]-t[1])/t[2]:(t[0]-r.mean(t[1]))/r.stdev(t[1],t[2])},ztest:function(){var e,a=n.call(arguments);return o(a[1])?(e=r.zscore(a[0],a[1],a[3]),1===a[2]?r.normal.cdf(-t.abs(e),0,1):2*r.normal.cdf(-t.abs(e),0,1)):a.length>2?(e=r.zscore(a[0],a[1],a[2]),1===a[3]?r.normal.cdf(-t.abs(e),0,1):2*r.normal.cdf(-t.abs(e),0,1)):(e=a[0],1===a[1]?r.normal.cdf(-t.abs(e),0,1):2*r.normal.cdf(-t.abs(e),0,1))}}),r.extend(r.fn,{zscore:function(r,t){return(r-this.mean())/this.stdev(t)},ztest:function(n,e,o){var a=t.abs(this.zscore(n,o));return 1===e?r.normal.cdf(-a,0,1):2*r.normal.cdf(-a,0,1)}}),r.extend({tscore:function(){var e=n.call(arguments);return 4===e.length?(e[0]-e[1])/(e[2]/t.sqrt(e[3])):(e[0]-r.mean(e[1]))/(r.stdev(e[1],!0)/t.sqrt(e[1].length))},ttest:function(){var o,a=n.call(arguments);return 5===a.length?(o=t.abs(r.tscore(a[0],a[1],a[2],a[3])),1===a[4]?r.studentt.cdf(-o,a[3]-1):2*r.studentt.cdf(-o,a[3]-1)):e(a[1])?(o=t.abs(a[0]),1==a[2]?r.studentt.cdf(-o,a[1]-1):2*r.studentt.cdf(-o,a[1]-1)):(o=t.abs(r.tscore(a[0],a[1])),1==a[2]?r.studentt.cdf(-o,a[1].length-1):2*r.studentt.cdf(-o,a[1].length-1))}}),r.extend(r.fn,{tscore:function(r){return(r-this.mean())/(this.stdev(!0)/t.sqrt(this.cols()))},ttest:function(n,e){return 1===e?1-r.studentt.cdf(t.abs(this.tscore(n)),this.cols()-1):2*r.studentt.cdf(-t.abs(this.tscore(n)),this.cols()-1)}}),r.extend({anovafscore:function(){var e,o,a,i,u,f,c,l,s=n.call(arguments);if(1===s.length){for(u=new Array(s[0].length),c=0;c<s[0].length;c++)u[c]=s[0][c];s=u}for(o=new Array,c=0;c<s.length;c++)o=o.concat(s[c]);for(a=r.mean(o),e=0,c=0;c<s.length;c++)e+=s[c].length*t.pow(r.mean(s[c])-a,2);for(e/=s.length-1,f=0,c=0;c<s.length;c++)for(i=r.mean(s[c]),l=0;l<s[c].length;l++)f+=t.pow(s[c][l]-i,2);return e/(f/=o.length-s.length)},anovaftest:function(){var t,o,a,i,u=n.call(arguments);if(e(u[0]))return 1-r.centralF.cdf(u[0],u[1],u[2]);var f=r.anovafscore(u);for(t=u.length-1,a=0,i=0;i<u.length;i++)a+=u[i].length;return o=a-t-1,1-r.centralF.cdf(f,t,o)},ftest:function(t,n,e){return 1-r.centralF.cdf(t,n,e)}}),r.extend(r.fn,{anovafscore:function(){return r.anovafscore(this.toArray())},anovaftes:function(){var t,n=0;for(t=0;t<this.length;t++)n+=this[t].length;return r.ftest(this.anovafscore(),this.length-1,n-this.length)}}),r.extend({qscore:function(){var o,a,i,u,f,c=n.call(arguments);return e(c[0])?(o=c[0],a=c[1],i=c[2],u=c[3],f=c[4]):(o=r.mean(c[0]),a=r.mean(c[1]),i=c[0].length,u=c[1].length,f=c[2]),t.abs(o-a)/(f*t.sqrt((1/i+1/u)/2))},qtest:function(){var t,e=n.call(arguments);3===e.length?(t=e[0],e=e.slice(1)):7===e.length?(t=r.qscore(e[0],e[1],e[2],e[3],e[4]),e=e.slice(5)):(t=r.qscore(e[0],e[1],e[2]),e=e.slice(3));var o=e[0],a=e[1];return 1-r.tukey.cdf(t,a,o-a)},tukeyhsd:function(t){for(var n=r.pooledstdev(t),e=t.map((function(t){return r.mean(t)})),o=t.reduce((function(r,t){return r+t.length}),0),a=[],i=0;i<t.length;++i)for(var u=i+1;u<t.length;++u){var f=r.qtest(e[i],e[u],t[i].length,t[u].length,n,o,t.length);a.push([[i,u],f])}return a}}),r.extend({normalci:function(){var e,o=n.call(arguments),a=new Array(2);return e=4===o.length?t.abs(r.normal.inv(o[1]/2,0,1)*o[2]/t.sqrt(o[3])):t.abs(r.normal.inv(o[1]/2,0,1)*r.stdev(o[2])/t.sqrt(o[2].length)),a[0]=o[0]-e,a[1]=o[0]+e,a},tci:function(){var e,o=n.call(arguments),a=new Array(2);return e=4===o.length?t.abs(r.studentt.inv(o[1]/2,o[3]-1)*o[2]/t.sqrt(o[3])):t.abs(r.studentt.inv(o[1]/2,o[2].length-1)*r.stdev(o[2],!0)/t.sqrt(o[2].length)),a[0]=o[0]-e,a[1]=o[0]+e,a},significant:function(r,t){return r<t}}),r.extend(r.fn,{normalci:function(t,n){return r.normalci(t,n,this.toArray())},tci:function(t,n){return r.tci(t,n,this.toArray())}}),r.extend(r.fn,{oneSidedDifferenceOfProportions:function(t,n,e,o){var i=a(t,n,e,o);return r.ztest(i,1)},twoSidedDifferenceOfProportions:function(t,n,e,o){var i=a(t,n,e,o);return r.ztest(i,2)}})}(r,Math),r.models=function(){function t(t){var e=t[0].length;return r.arange(e).map((function(o){var a=r.arange(e).filter((function(r){return r!==o}));return n(r.col(t,o).map((function(r){return r[0]})),r.col(t,a))}))}function n(t,n){var e=t.length,o=n[0].length-1,a=e-o-1,i=r.lstsq(n,t),u=r.multiply(n,i.map((function(r){return[r]}))).map((function(r){return r[0]})),f=r.subtract(t,u),c=r.mean(t),l=r.sum(u.map((function(r){return Math.pow(r-c,2)}))),s=r.sum(t.map((function(r,t){return Math.pow(r-u[t],2)}))),p=l+s;return{exog:n,endog:t,nobs:e,df_model:o,df_resid:a,coef:i,predict:u,resid:f,ybar:c,SST:p,SSE:l,SSR:s,R2:l/p}}function e(n){var e=t(n.exog),o=Math.sqrt(n.SSR/n.df_resid),a=e.map((function(r){var t=r.SST,n=r.R2;return o/Math.sqrt(t*(1-n))})),i=n.coef.map((function(r,t){return(r-0)/a[t]})),u=i.map((function(t){var e=r.studentt.cdf(t,n.df_resid);return 2*(e>.5?1-e:e)})),f=r.studentt.inv(.975,n.df_resid),c=n.coef.map((function(r,t){var n=f*a[t];return[r-n,r+n]}));return{se:a,t:i,p:u,sigmaHat:o,interval95:c}}function o(t){var n,e,o,a=t.R2/t.df_model/((1-t.R2)/t.df_resid);return{F_statistic:a,pvalue:1-(n=a,e=t.df_model,o=t.df_resid,r.beta.cdf(n/(o/e+n),e/2,o/2))}}function a(r,t){var a=n(r,t),i=e(a),u=o(a),f=1-(1-a.R2)*((a.nobs-1)/a.df_resid);return a.t=i,a.f=u,a.adjust_R2=f,a}return{ols:a}}(),r.extend({buildxmatrix:function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++){var e=[1];t[n]=e.concat(arguments[n])}return r(t)},builddxmatrix:function(){for(var t=new Array(arguments[0].length),n=0;n<arguments[0].length;n++){var e=[1];t[n]=e.concat(arguments[0][n])}return r(t)},buildjxmatrix:function(t){for(var n=new Array(t.length),e=0;e<t.length;e++)n[e]=t[e];return r.builddxmatrix(n)},buildymatrix:function(t){return r(t).transpose()},buildjymatrix:function(r){return r.transpose()},matrixmult:function(t,n){var e,o,a,i,u;if(t.cols()==n.rows()){if(n.rows()>1){for(i=[],e=0;e<t.rows();e++)for(i[e]=[],o=0;o<n.cols();o++){for(u=0,a=0;a<t.cols();a++)u+=t.toArray()[e][a]*n.toArray()[a][o];i[e][o]=u}return r(i)}for(i=[],e=0;e<t.rows();e++)for(i[e]=[],o=0;o<n.cols();o++){for(u=0,a=0;a<t.cols();a++)u+=t.toArray()[e][a]*n.toArray()[o];i[e][o]=u}return r(i)}},regress:function(t,n){var e=r.xtranspxinv(t),o=t.transpose(),a=r.matrixmult(r(e),o);return r.matrixmult(a,n)},regresst:function(t,n,e){var o=r.regress(t,n),a={anova:{}},i=r.jMatYBar(t,o);a.yBar=i;var u=n.mean();a.anova.residuals=r.residuals(n,i),a.anova.ssr=r.ssr(i,u),a.anova.msr=a.anova.ssr/(t[0].length-1),a.anova.sse=r.sse(n,i),a.anova.mse=a.anova.sse/(n.length-(t[0].length-1)-1),a.anova.sst=r.sst(n,u),a.anova.mst=a.anova.sst/(n.length-1),a.anova.r2=1-a.anova.sse/a.anova.sst,a.anova.r2<0&&(a.anova.r2=0),a.anova.fratio=a.anova.msr/a.anova.mse,a.anova.pvalue=r.anovaftest(a.anova.fratio,t[0].length-1,n.length-(t[0].length-1)-1),a.anova.rmse=Math.sqrt(a.anova.mse),a.anova.r2adj=1-a.anova.mse/a.anova.mst,a.anova.r2adj<0&&(a.anova.r2adj=0),a.stats=new Array(t[0].length);for(var f,c,l,s=r.xtranspxinv(t),p=0;p<o.length;p++)f=Math.sqrt(a.anova.mse*Math.abs(s[p][p])),c=Math.abs(o[p]/f),l=r.ttest(c,n.length-t[0].length-1,e),a.stats[p]=[o[p],f,c,l];return a.regress=o,a},xtranspx:function(t){return r.matrixmult(t.transpose(),t)},xtranspxinv:function(t){var n=r.matrixmult(t.transpose(),t);return r.inv(n)},jMatYBar:function(t,n){var e=r.matrixmult(t,n);return new r(e)},residuals:function(t,n){return r.matrixsubtract(t,n)},ssr:function(r,t){for(var n=0,e=0;e<r.length;e++)n+=Math.pow(r[e]-t,2);return n},sse:function(r,t){for(var n=0,e=0;e<r.length;e++)n+=Math.pow(r[e]-t[e],2);return n},sst:function(r,t){for(var n=0,e=0;e<r.length;e++)n+=Math.pow(r[e]-t,2);return n},matrixsubtract:function(t,n){for(var e=new Array(t.length),o=0;o<t.length;o++){e[o]=new Array(t[o].length);for(var a=0;a<t[o].length;a++)e[o][a]=t[o][a]-n[o][a]}return r(e)}}),r.jStat=r,r}()}({get exports(){return cf},set exports(r){cf=r}});let lf=cf.jStat,sf={beta:{pdf:lf.beta.pdf,cdf:lf.beta.cdf,inv:lf.beta.inv,sample:lf.beta.sample},centralF:{pdf:lf.centralF.pdf,cdf:lf.centralF.cdf,inv:lf.centralF.inv,sample:lf.centralF.sample},cauchy:{pdf:lf.cauchy.pdf,cdf:lf.cauchy.cdf,inv:lf.cauchy.inv,sample:lf.cauchy.sample},chisquare:{pdf:lf.chisquare.pdf,cdf:lf.chisquare.cdf,inv:lf.chisquare.inv,sample:lf.chisquare.sample},exponential:{pdf:lf.exponential.pdf,cdf:lf.exponential.cdf,inv:lf.exponential.inv,sample:lf.exponential.sample},gamma:{pdf:lf.gamma.pdf,cdf:lf.gamma.cdf,inv:lf.gamma.inv,sample:lf.gamma.sample},invgamma:{pdf:lf.invgamma.pdf,cdf:lf.invgamma.cdf,inv:lf.invgamma.inv,sample:lf.invgamma.sample},kumaraswamy:{pdf:lf.kumaraswamy.pdf,cdf:lf.kumaraswamy.cdf,inv:lf.kumaraswamy.inv,sample:lf.kumaraswamy.sample},lognormal:{pdf:lf.lognormal.pdf,cdf:lf.lognormal.cdf,inv:lf.lognormal.inv,sample:lf.lognormal.sample},normal:{pdf:lf.normal.pdf,cdf:lf.normal.cdf,inv:lf.normal.inv,sample:lf.normal.sample},pareto:{pdf:lf.pareto.pdf,cdf:lf.pareto.cdf,inv:lf.pareto.inv,sample:(r,t)=>{throw new Error("invalid pareto.sample")}},studentt:{pdf:lf.studentt.pdf,cdf:lf.studentt.cdf,inv:lf.studentt.inv,sample:lf.studentt.sample},tukey:{pdf:(r,t,n)=>{throw new Error("invalid tukey.pdf")},cdf:lf.tukey.cdf,inv:lf.tukey.inv,sample:(r,t)=>{throw new Error("invalid tukey.sample")}},weibull:{pdf:lf.weibull.pdf,cdf:lf.weibull.cdf,inv:lf.weibull.inv,sample:lf.weibull.sample},uniform:{pdf:lf.uniform.pdf,cdf:lf.uniform.cdf,inv:lf.uniform.inv,sample:lf.uniform.sample},binomial:{pdf:lf.binomial.pdf,cdf:lf.binomial.cdf,inv:(r,t,n)=>{throw new Error("invalid binomial.inv")},sample:(r,t)=>{throw new Error("invalid binomial.sample")}},negbin:{pdf:lf.negbin.pdf,cdf:lf.negbin.cdf,inv:(r,t,n)=>{throw new Error("invalid negbin.inv")},sample:(r,t)=>{throw new Error("invalid negbin.sample")}},hypgeom:{pdf:lf.hypgeom.pdf,cdf:lf.hypgeom.cdf,inv:(r,t,n,e)=>{throw new Error("invalid hypgeom.inv")},sample:(r,t,n)=>{throw new Error("invalid hypgeom.sample")}},poisson:{pdf:lf.poisson.pdf,cdf:lf.poisson.cdf,inv:(r,t)=>{throw new Error("invalid poisson.inv")},sample:lf.poisson.sample},triangular:{pdf:lf.triangular.pdf,cdf:lf.triangular.cdf,inv:(r,t,n,e)=>{throw new Error("invalid triangular.inv")},sample:lf.triangular.sample},arcsine:{pdf:lf.arcsine.pdf,cdf:lf.arcsine.cdf,inv:lf.arcsine.inv,sample:lf.arcsine.sample},std:r=>lf.stdev(r,!1),sampleStd:r=>lf.stdev(r,!0),emquantile:(r,t)=>lf.quantiles(r,[t],.4,.4)[0],emquantiles:lf.quantiles,percentile:lf.percentile};function pf(r){if(!ot(r))return null;if(0===Kr(r))return null;if(r=Na(r,(r=>Ru(r))),r=qa(r,Ju),Kr(r)<=1)return null;return sf.sampleStd(r)}var vf=Zu;var hf=function(r){var t=vf(r),n=t%1;return t==t?n?t-n:t:0},mf=hf;var gf=function(r){return"number"==typeof r&&r==mf(r)};function df(r){return!!Ru(r)&&(r=Ju(r),gf(r))}var bf=hf,yf=Hu,wf=Oo,jf=h.isFinite,xf=Math.min;var _f=function(r){var t=Math[r];return function(r,n){if(r=yf(r),(n=null==n?0:xf(bf(n),292))&&jf(r)){var e=(wf(r)+"e").split("e"),o=t(e[0]+"e"+(+e[1]+n));return+((e=(wf(o)+"e").split("e"))[0]+"e"+(+e[1]-n))}return t(r)}},Mf=_f("round");function Pf(r){if(!Ru(r))return 0;r=Ju(r);let t=Mf(r);return"0"===String(t)?0:t}function qf(r){if(!df(r))return!1;return Pf(r)>0}async function Af(r,t){if(!qf(r))return Promise.reject(`n[${r}] is not positive integer`);if((r=Pf(r))<=1)return Promise.reject(`n[${r}] <= 1`);if(Ru(t)||(t=.95),(t=Ju(t))<0)return Promise.reject(`p[${t}] < 0`);if(t>1)return Promise.reject(`p[${t}] > 1`);let n=r-1;return sf.studentt.inv(t,n)}async function Sf(r,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"two-tailed";if(!ot(r))return Promise.reject("arr is not an array");if(0===Kr(r))return Promise.reject("arr is not an effective array");if(!Ru(t))return Promise.reject(`p[${t}] is not a number`);if((t=Ju(t))<0)return Promise.reject(`p[${t}] < 0`);if(t>1)return Promise.reject(`p[${t}] > 1`);if("two-tailed"!==n&&"upper-tail"!==n&&"lower-tail"!==n)return Promise.reject(`mode[${n}] is not 'two-tailed', 'upper-tail' or 'lower-tail'`);let e=rf(r),o=Kr(e);if(0===o)return Promise.reject("no effective data");let a=tf(r),i=pf(r);if(!ff(a))return Promise.reject(`avg[${a}] is not a number`);if(!ff(i))return Promise.reject(`sigma[${i}] is not a number`);let u=null;if("upper-tail"===n||"lower-tail"===n){let r=await Af(o,t);u="upper-tail"===n?a+r*i/Math.sqrt(o):a-r*i/Math.sqrt(o)}else if("two-tailed"===n){let r=await Af(o,t/2);u=[a-r*i/Math.sqrt(o),a+r*i/Math.sqrt(o)]}return u}var Ef={},Of=rt;var kf=function(r){return"function"==typeof r?r:Of},Nf=Ia,If=ba,zf=kf,Ff=jr;var Tf=function(r,t){return(Ff(r)?Nf:If)(r,zf(t))};!function(r){r.exports=Tf}({get exports(){return Ef},set exports(r){Ef=r}});var $f=n(Ef);var Rf=ba;var Cf=function(r,t,n,e){for(var o=-1,a=null==r?0:r.length;++o<a;){var i=r[o];t(e,i,n(i),r)}return e},Df=function(r,t,n,e){return Rf(r,(function(r,o,a){t(e,r,n(r),a)})),e},Lf=ha,Uf=jr;var Bf=$a,Gf=function(r,t){return function(n,e){var o=Uf(n)?Cf:Df,a=t?t():{};return o(n,r,Lf(e),a)}},Vf=Object.prototype.hasOwnProperty,Wf=Gf((function(r,t,n){Vf.call(r,n)?r[n].push(t):Bf(r,n,[t])})),Xf=ne,Yf=jr,Hf=m?m.isConcatSpreadable:void 0;var Qf=Tn,Kf=function(r){return Yf(r)||Xf(r)||!!(Hf&&r&&r[Hf])};var Zf=function r(t,n,e,o,a){var i=-1,u=t.length;for(e||(e=Kf),a||(a=[]);++i<u;){var f=t[i];n>0&&e(f)?n>1?r(f,n-1,e,o,a):Qf(a,f):o||(a[a.length]=f)}return a};var Jf=lo;var rc=function(r,t){if(r!==t){var n=void 0!==r,e=null===r,o=r==r,a=Jf(r),i=void 0!==t,u=null===t,f=t==t,c=Jf(t);if(!u&&!c&&!a&&r>t||a&&i&&f&&!u&&!c||e&&i&&f||!n&&f||!o)return 1;if(!e&&!a&&!c&&r<t||c&&n&&o&&!e&&!a||u&&n&&o||!i&&o||!f)return-1}return 0};var tc=at,nc=Do,ec=ha,oc=ja,ac=function(r,t){var n=r.length;for(r.sort(t);n--;)r[n]=r[n].value;return r},ic=pe,uc=function(r,t,n){for(var e=-1,o=r.criteria,a=t.criteria,i=o.length,u=n.length;++e<i;){var f=rc(o[e],a[e]);if(f)return e>=u?f:f*("desc"==n[e]?-1:1)}return r.index-t.index},fc=rt,cc=jr;var lc=function(r,t,n){t=t.length?tc(t,(function(r){return cc(r)?function(t){return nc(t,1===r.length?r[0]:r)}:r})):[fc];var e=-1;t=tc(t,ic(ec));var o=oc(r,(function(r,n,o){return{criteria:tc(t,(function(t){return t(r)})),index:++e,value:r}}));return ac(o,(function(r,t){return uc(r,t,n)}))};var sc=function(r,t,n){switch(n.length){case 0:return r.call(t);case 1:return r.call(t,n[0]);case 2:return r.call(t,n[0],n[1]);case 3:return r.call(t,n[0],n[1],n[2])}return r.apply(t,n)},pc=Math.max;var vc=function(r,t,n){return t=pc(void 0===t?r.length-1:t,0),function(){for(var e=arguments,o=-1,a=pc(e.length-t,0),i=Array(a);++o<a;)i[o]=e[t+o];o=-1;for(var u=Array(t+1);++o<t;)u[o]=e[o];return u[t]=n(i),sc(r,this,u)}};var hc=function(r){return function(){return r}},mc=Fa,gc=mc?function(r,t){return mc(r,"toString",{configurable:!0,enumerable:!1,value:hc(t),writable:!0})}:rt,dc=Date.now;var bc=function(r){var t=0,n=0;return function(){var e=dc(),o=16-(e-n);if(n=e,o>0){if(++t>=800)return arguments[0]}else t=0;return r.apply(void 0,arguments)}},yc=bc(gc),wc=rt,jc=vc,xc=yc;var _c=ut,Mc=wr,Pc=ie,qc=A;var Ac=Zf,Sc=lc,Ec=function(r,t,n){if(!qc(n))return!1;var e=typeof t;return!!("number"==e?Mc(n)&&Pc(t,n.length):"string"==e&&t in n)&&_c(n[t],r)},Oc=function(r,t){return xc(jc(r,t,wc),r+"")}((function(r,t){if(null==r)return[];var n=t.length;return n>1&&Ec(r,t[0],t[1])?t=[]:n>2&&Ec(t[0],t[1],t[2])&&(t=[t[0]]),Sc(r,Ac(t,1),[])})),kc=Array.prototype.reverse;var Nc=function(r){return null==r?r:kc.call(r)};var Ic=Zr,zc=rt;var Fc=function(r){return r&&r.length?Ic(r,zc):0};function Tc(r){let t=Object.prototype.toString.call(r);return"[object Function]"===t||"[object AsyncFunction]"===t}function $c(r){let t,n=Object.prototype.toString.call(r);if(t="[object Promise]"===n,t)return!0;if("[object Function]"!==n)return!1;try{t="function"!=typeof r.subscribe&&"function"==typeof r.then}catch(r){}return t}function Rc(r,t,n,e,o){for(let a=0;a<r.length;++a)r[a]=t*n[a]+e*o[a]}function Cc(r,t){return r.y-t.y}var Dc=lo;var Lc=function(r,t,n){for(var e=-1,o=r.length;++e<o;){var a=r[e],i=t(a);if(null!=i&&(void 0===u?i==i&&!Dc(i):n(i,u)))var u=i,f=a}return f};var Uc=Lc,Bc=function(r,t){return r<t},Gc=rt;var Vc=function(r){return r&&r.length?Uc(r,Gc,Bc):void 0};var Wc=Lc,Xc=function(r,t){return r>t},Yc=rt;var Hc=function(r){return r&&r.length?Wc(r,Yc,Xc):void 0};function Qc(r,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},e=Uo(n,"keyMax");$u(e)||(e="max");let o=Uo(n,"keyMin");$u(o)||(o="min");let a=Uo(n,"keyValue");$u(a)||(a="value");let i=Uo(n,"keyItems");if($u(i)||(i="items"),!Tu(r))return[];if(!Tu(t))return[];let u=Nu(t);return $f(r,((r,n)=>{let f=Uo(r,a);Ru(f)?f=Ju(f):Ru(r)&&(f=Ju(r)),ff(f)&&$f(t,((t,n)=>{let a=Uo(t,e,null),c=Uo(t,o,null);if(null!==a&&null!==c&&Ru(a)&&Ru(c)){let e=Uo(t,"maxType");"<="!==e&&"<"!==e&&(e="<=");let o,p,v=Uo(t,"minType");">="!==v&&">"!==v&&(v=">="),a=Ju(a),c=Ju(c),o=">="===v?f>=c:f>c,p="<="===e?f<=a:f<a,o&&p&&(l=u[n],s=i,Iu(l)&&($u(s)||Ru(s))&&s in l||(u[n][i]=[]),u[n][i].push(r))}var l,s}))})),u}function Kc(r,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(!Ru(r))return[];if(r=Ju(r),!Ru(t))return[];t=Ju(t),qf(n)||(n=2),n=Pf(n);let e=(t-r)/n,o=r,a=[];for(let r=0;r<=n;r++)a.push(o),o+=e;return a}function Zc(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};qf(t)||(t=30),t=Pf(t);let e=rf(r);if(0===Kr(e))return[];let o=Uo(n,"min",null);Ru(o)||(o=Vc(e)),o=Ju(o);let a=Uo(n,"max",null);Ru(a)||(a=Hc(e)),a=Ju(a);let i=Kc(o,a,t),u=[];for(let r=0;r<Kr(i)-1;r++){let t=0===r?">=":">",n="<=",e={min:i[r],max:i[r+1],avg:(i[r]+i[r+1])/2,minType:t,maxType:n};u.push(e)}let f=Qc(e,u);return qa(f,(r=>({min:r.min,max:r.max,avg:r.avg,arr:Uo(r,"items",[])})))}async function Jc(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!ot(r))return Promise.reject("arr is not an array");if(0===Kr(r))return Promise.reject("arr is not an effective array");let n=Uo(t,"n");qf(n)||(n=30),n=Pf(n);let e=Uo(t,"min",null),o=Uo(t,"max",null),a=rf(r);if(a=Na(a,(r=>r>0)),0===Kr(a))return Promise.reject("no effective data");let i=Zc(a,n,{min:e,max:o}),u=Uo(i,"0.max")-Uo(i,"0.min");i=qa(i,(r=>(r.counts=Kr(r.arr),r)));let f=Fc(qa(i,"counts"))*u;if(f<=0)throw new Error(`r[${f}<=0]`);i=qa(i,(r=>(r.pdf=r.counts/f,r)));let c=(r,t)=>{let n=[];return $f(i,(e=>{let o=e.avg,a=e.pdf,i=((r,t,n)=>sf.gamma.pdf(r,t,n))(o,r,t);if(!ff(i))throw console.log("x",o,"shape",r,"scale",t),new Error("yf is not number");n.push([o,a,i])})),n},l=await async function(r,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!Tc(r))return Promise.reject("invalid fun");if(!Tu(t))return Promise.reject("params is not an effective array");let e=Kr(t),o=Uo(n,"maxIterations");Ru(o)||(o=200*e),o=Ju(o);let a=Uo(n,"nonZeroDelta");Ru(a)||(a=1.05),a=Ju(a);let i=Uo(n,"delta");Ru(i)||(i=.001),i=Ju(i);let u=Uo(n,"minErrorDelta");Ru(u)||(u=1e-6),u=Ju(u);let f=Uo(n,"minTolerance");Ru(f)||(f=1e-5),f=Ju(f);let c=Uo(n,"rho");Ru(c)||(c=1),c=Ju(c);let l=Uo(n,"chi");Ru(l)||(l=2),l=Ju(l);let s=Uo(n,"psi");Ru(s)||(s=-.5),s=Ju(s);let p=Uo(n,"sigma");Ru(p)||(p=.5),p=Ju(p);let v=0;async function h(){let t=r(...arguments);return $c(t)&&(t=await t),v++,t}let m=new Array(e+1);m[0]=t,m[0].y=await h(t),m[0].id=0;for(let r=0;r<e;++r){let n=t.slice();n[r]=n[r]?n[r]*a:i,m[r+1]=n,m[r+1].y=await h(n),m[r+1].id=r+1}let g,d=r=>{for(let t=0;t<r.length;t++)m[e][t]=r[t];m[e].y=r.y},b=t.slice(),y=t.slice(),w=t.slice(),j=t.slice();for(let r=0;r<o;++r){m.sort(Cc),g=0;for(let r=0;r<e;++r)g=Math.max(g,Math.abs(m[0][r]-m[1][r]));if(Math.abs(m[0].y-m[e].y)<u&&g<f)break;for(let r=0;r<e;++r){b[r]=0;for(let t=0;t<e;++t)b[r]+=m[t][r];b[r]/=e}let r=m[e];if(Rc(y,1+c,b,-c,r),y.y=await h(y),y.y<m[0].y)Rc(j,1+l,b,-l,r),j.y=await h(j),j.y<y.y?d(j):d(y);else if(y.y>=m[e-1].y){let t=!1;if(y.y>r.y?(Rc(w,1+s,b,-s,r),w.y=await h(w),w.y<r.y?d(w):t=!0):(Rc(w,1-s*c,b,s*c,r),w.y=await h(w),w.y<y.y?d(w):t=!0),t){if(p>=1)break;for(let r=1;r<m.length;++r)Rc(m[r],1-p,m[0],p,m[r]),m[r].y=await h(m[r])}}else d(y)}m.sort(Cc);let x=[],_=m[0];for(let r=0;r<e;r++)x.push(_[r]);return{count:v,y:m[0].y,x:x}}((async r=>{let t=r[0],n=r[1],e=0;return $f(c(t,n),(r=>{let t=r[1],n=r[2];e+=(t-n)**2})),e}),[1,1]),s=Uo(l,"x.0",null),p=Uo(l,"x.1",null),v=c(s,p);return{shape:s,scale:p,arr:a,arrPdf:v,arrCounts:qa(v,(r=>[r[0],r[1]*f,r[2]*f])),dx:u,bs:i}}var rl=_f("floor"),tl=_f("ceil");async function nl(r,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!Tc(t))throw new Error("invalid fun");let e=rf(r);if(0===Kr(e))return null;let o,a,i,u,f=Uo(n,"nCurve");if(qf(f)||(f=100),f=Pf(f),o=Uo(n,"dx",null),Ru(o)){o=Ju(o);let r=Vc(e),t=Hc(e);i=rl(r/o)*o,u=tl(t/o)*o,a=Mf(u-i)/o}else a=Uo(n,"n"),qf(a)||(a=30),a=Pf(a),i=Uo(n,"min",null),u=Uo(n,"max",null);let c=Zc(e,a,{min:i,max:u});Ru(o)||(o=Uo(c,"0.max")-Uo(c,"0.min")),c=qa(c,(r=>(r.counts=Kr(r.arr),r)));let l=[...qa(c,"min"),...qa(c,"max")],s=Vc(l),p=Hc(l),v=qa(c,"counts"),h=Fc(v)*o,m=qa(v,(r=>r/h)),g=Kc(s,p,f),d=t({arr:e,min:s,max:p,barWidth:o,bins:c,counts:v,pdfs:m,curveX:g});return $c(d)&&(d=await d),{arr:e,min:s,max:p,barWidth:o,bins:c,counts:v,pdfs:m,ratioForCountToPdf:1/h,curveX:g,curveY:d}}function el(r){return el="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},el(r)}function ol(r){var t=function(r,t){if("object"!==el(r)||null===r)return r;var n=r[Symbol.toPrimitive];if(void 0!==n){var e=n.call(r,t||"default");if("object"!==el(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(r)}(r,"string");return"symbol"===el(t)?t:String(t)}function al(r,t,n){return(t=ol(t))in r?Object.defineProperty(r,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[t]=n,r}function il(r,t){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(r);t&&(e=e.filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.push.apply(n,e)}return n}function ul(r){if(!ot(r))return null;if(0===Kr(r))return null;let t=ef(r),n=Kr(t);if(0===n)return null;let e=0;$f(t,(r=>{e+=Math.log(r)})),e/=n;try{e=Math.exp(e)}catch(r){return console.log(r),null}return e}async function fl(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!ot(r))return Promise.reject("arr is not an array");if(0===Kr(r))return Promise.reject("arr is not an effective array");let n=null,e=null,o=await nl(r,(r=>{n=tf(r.arr),e=pf(r.arr);let t=e*Math.sqrt(2*Math.PI);return qa(r.curveX,(r=>{let o=0;return 0!==t&&(o=1/t*Math.exp(-((r-n)**2)/(2*e**2))),o}))}),t),a=qa(o.bins,((r,t)=>(r.pdf=o.pdfs[t],r))),i=qa(o.curveX,((r,t)=>({x:r,pdf:o.curveY[t]})));return{avg:n,std:e,arr:o.arr,min:o.min,max:o.max,barWidth:o.barWidth,ratioForCountToPdf:o.ratioForCountToPdf,bins:a,curves:i}}async function cl(r,t){if(!ot(r))return Promise.reject("arr is not an array");if(0===Kr(r))return Promise.reject("arr is not an effective array");if(!Ru(t))return Promise.reject(`ratio[${t}] is not a number`);if((t=Ju(t))<0)return Promise.reject(`ratio[${t}] < 0`);if(t>1)return Promise.reject(`ratio[${t}] > 1`);let n=rf(r);if(0===Kr(n))return Promise.reject("no effective data");let e=tf(n),o=pf(n);return ff(e)?ff(o)?o<=0?Promise.reject(`std[${o}] <= 0`):{inv:sf.normal.inv(t,e,o),avg:e,std:o,arr:n}:Promise.reject(`std[${o}] is not a number`):Promise.reject(`avg[${e}] is not a number`)}function ll(r){if(0===r.length)return 0;var t,n=r[0],e=0;if("number"!=typeof n)return NaN;for(var o=1;o<r.length;o++){if("number"!=typeof r[o])return NaN;t=n+r[o],Math.abs(n)>=Math.abs(r[o])?e+=n-t+r[o]:e+=r[o]-t+n,n=t}return n+e}function sl(r){if(0===r.length)throw new Error("mean requires at least one data point");return ll(r)/r.length}function pl(r,t){var n,e,o=sl(r),a=0;if(2===t)for(e=0;e<r.length;e++)a+=(n=r[e]-o)*n;else for(e=0;e<r.length;e++)a+=Math.pow(r[e]-o,t);return a}function vl(r){if(0===r.length)throw new Error("variance requires at least one data point");return pl(r,2)/r.length}function hl(r){if(1===r.length)return 0;var t=vl(r);return Math.sqrt(t)}function ml(r){if(0===r.length)throw new Error("mode requires at least one data point");if(1===r.length)return r[0];for(var t=r[0],n=NaN,e=0,o=1,a=1;a<r.length+1;a++)r[a]!==t?(o>e&&(e=o,n=t),o=1,t=r[a]):o++;return n}function gl(r){return r.slice().sort((function(r,t){return r-t}))}function dl(r){if(0===r.length)throw new Error("min requires at least one data point");for(var t=r[0],n=1;n<r.length;n++)r[n]<t&&(t=r[n]);return t}function bl(r){if(0===r.length)throw new Error("max requires at least one data point");for(var t=r[0],n=1;n<r.length;n++)r[n]>t&&(t=r[n]);return t}function yl(r){for(var t=0,n=0;n<r.length;n++){if("number"!=typeof r[n])return NaN;t+=r[n]}return t}function wl(r,t){var n=r.length*t;if(0===r.length)throw new Error("quantile requires at least one data point.");if(t<0||t>1)throw new Error("quantiles must be between 0 and 1");return 1===t?r[r.length-1]:0===t?r[0]:n%1!=0?r[Math.ceil(n)-1]:r.length%2==0?(r[n-1]+r[n])/2:r[n]}function jl(r,t,n,e){for(n=n||0,e=e||r.length-1;e>n;){if(e-n>600){var o=e-n+1,a=t-n+1,i=Math.log(o),u=.5*Math.exp(2*i/3),f=.5*Math.sqrt(i*u*(o-u)/o);a-o/2<0&&(f*=-1),jl(r,t,Math.max(n,Math.floor(t-a*u/o+f)),Math.min(e,Math.floor(t+(o-a)*u/o+f)))}var c=r[t],l=n,s=e;for(xl(r,n,t),r[e]>c&&xl(r,n,e);l<s;){for(xl(r,l,s),l++,s--;r[l]<c;)l++;for(;r[s]>c;)s--}r[n]===c?xl(r,n,s):xl(r,++s,e),s<=t&&(n=s+1),t<=s&&(e=s-1)}}function xl(r,t,n){var e=r[t];r[t]=r[n],r[n]=e}function _l(r,t){var n=r.slice();if(Array.isArray(t)){!function(r,t){for(var n=[0],e=0;e<t.length;e++)n.push(ql(r.length,t[e]));n.push(r.length-1),n.sort(Pl);var o=[0,n.length-1];for(;o.length;){var a=Math.ceil(o.pop()),i=Math.floor(o.pop());if(!(a-i<=1)){var u=Math.floor((i+a)/2);Ml(r,n[u],Math.floor(n[i]),Math.ceil(n[a])),o.push(i,u,u,a)}}}(n,t);for(var e=[],o=0;o<t.length;o++)e[o]=wl(n,t[o]);return e}return Ml(n,ql(n.length,t),0,n.length-1),wl(n,t)}function Ml(r,t,n,e){t%1==0?jl(r,t,n,e):(jl(r,t=Math.floor(t),n,e),jl(r,t+1,t+1,e))}function Pl(r,t){return r-t}function ql(r,t){var n=r*t;return 1===t?r-1:0===t?0:n%1!=0?Math.ceil(n)-1:r%2==0?n-.5:n}function Al(r,t){if(t<r[0])return 0;if(t>r[r.length-1])return 1;var n=function(r,t){var n=0,e=0,o=r.length;for(;e<o;)t<=r[n=e+o>>>1]?o=n:e=-~n;return e}(r,t);if(r[n]!==t)return n/r.length;n++;var e=function(r,t){var n=0,e=0,o=r.length;for(;e<o;)t>=r[n=e+o>>>1]?e=-~n:o=n;return e}(r,t);if(e===n)return n/r.length;var o=e-n+1;return o*(e+n)/2/o/r.length}function Sl(r){var t=_l(r,.75),n=_l(r,.25);if("number"==typeof t&&"number"==typeof n)return t-n}function El(r){return+_l(r,.5)}function Ol(r){for(var t=El(r),n=[],e=0;e<r.length;e++)n.push(Math.abs(r[e]-t));return El(n)}function kl(r,t){t=t||Math.random;for(var n,e,o=r.length;o>0;)e=Math.floor(t()*o--),n=r[o],r[o]=r[e],r[e]=n;return r}function Nl(r,t){return kl(r.slice(),t)}function Il(r,t,n){return Nl(r,n).slice(0,t)}function zl(r,t){for(var n=[],e=0;e<r;e++){for(var o=[],a=0;a<t;a++)o.push(0);n.push(o)}return n}function Fl(r){for(var t,n=0,e=0;e<r.length;e++)0!==e&&r[e]===t||(t=r[e],n++);return n}function Tl(r,t,n,e){var o;if(r>0){var a=(n[t]-n[r-1])/(t-r+1);o=e[t]-e[r-1]-(t-r+1)*a*a}else o=e[t]-n[t]*n[t]/(t+1);return o<0?0:o}function $l(r,t,n,e,o,a,i){if(!(r>t)){var u=Math.floor((r+t)/2);e[n][u]=e[n-1][u-1],o[n][u]=u;var f=n;r>n&&(f=Math.max(f,o[n][r-1]||0)),f=Math.max(f,o[n-1][u]||0);var c,l,s,p=u-1;t<e[0].length-1&&(p=Math.min(p,o[n][t+1]||0));for(var v=p;v>=f&&!((c=Tl(v,u,a,i))+e[n-1][f-1]>=e[n][u]);--v)(l=Tl(f,u,a,i)+e[n-1][f-1])<e[n][u]&&(e[n][u]=l,o[n][u]=f),f++,(s=c+e[n-1][v-1])<e[n][u]&&(e[n][u]=s,o[n][u]=v);$l(r,u-1,n,e,o,a,i),$l(u+1,t,n,e,o,a,i)}}function Rl(r,t){if(r.length!==t.length)throw new Error("sampleCovariance requires samples with equal lengths");if(r.length<2)throw new Error("sampleCovariance requires at least two data points in each sample");for(var n=sl(r),e=sl(t),o=0,a=0;a<r.length;a++)o+=(r[a]-n)*(t[a]-e);return o/(r.length-1)}function Cl(r){if(r.length<2)throw new Error("sampleVariance requires at least two data points");return pl(r,2)/(r.length-1)}function Dl(r){var t=Cl(r);return Math.sqrt(t)}function Ll(r,t){return Rl(r,t)/Dl(r)/Dl(t)}function Ul(r,t,n,e){return(r*t+n*e)/(t+e)}function Bl(r){if(0===r.length)throw new Error("meanSimple requires at least one data point");return yl(r)/r.length}function Gl(r){if(0===r.length)throw new Error("rootMeanSquare requires at least one data point");for(var t=0,n=0;n<r.length;n++)t+=Math.pow(r[n],2);return Math.sqrt(t/r.length)}var Vl=function(){this.totalCount=0,this.data={}};Vl.prototype.train=function(r,t){for(var n in this.data[t]||(this.data[t]={}),r){var e=r[n];void 0===this.data[t][n]&&(this.data[t][n]={}),void 0===this.data[t][n][e]&&(this.data[t][n][e]=0),this.data[t][n][e]++}this.totalCount++},Vl.prototype.score=function(r){var t,n={};for(var e in r){var o=r[e];for(t in this.data)n[t]={},this.data[t][e]?n[t][e+"_"+o]=(this.data[t][e][o]||0)/this.totalCount:n[t][e+"_"+o]=0}var a={};for(t in n)for(var i in a[t]=0,n[t])a[t]+=n[t][i];return a};var Wl=function(){this.weights=[],this.bias=0};Wl.prototype.predict=function(r){if(r.length!==this.weights.length)return null;for(var t=0,n=0;n<this.weights.length;n++)t+=this.weights[n]*r[n];return(t+=this.bias)>0?1:0},Wl.prototype.train=function(r,t){if(0!==t&&1!==t)return null;r.length!==this.weights.length&&(this.weights=r,this.bias=1);var n=this.predict(r);if("number"==typeof n&&n!==t){for(var e=t-n,o=0;o<this.weights.length;o++)this.weights[o]+=e*r[o];this.bias+=e}return this};var Xl=1e-4;function Yl(r){if(r<0)throw new Error("factorial requires a non-negative value");if(Math.floor(r)!==r)throw new Error("factorial requires an integer input");for(var t=1,n=2;n<=r;n++)t*=n;return t}var Hl=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],Ql=Math.log(Math.sqrt(2*Math.PI));var Kl={1:{.995:0,.99:0,.975:0,.95:0,.9:.02,.5:.45,.1:2.71,.05:3.84,.025:5.02,.01:6.63,.005:7.88},2:{.995:.01,.99:.02,.975:.05,.95:.1,.9:.21,.5:1.39,.1:4.61,.05:5.99,.025:7.38,.01:9.21,.005:10.6},3:{.995:.07,.99:.11,.975:.22,.95:.35,.9:.58,.5:2.37,.1:6.25,.05:7.81,.025:9.35,.01:11.34,.005:12.84},4:{.995:.21,.99:.3,.975:.48,.95:.71,.9:1.06,.5:3.36,.1:7.78,.05:9.49,.025:11.14,.01:13.28,.005:14.86},5:{.995:.41,.99:.55,.975:.83,.95:1.15,.9:1.61,.5:4.35,.1:9.24,.05:11.07,.025:12.83,.01:15.09,.005:16.75},6:{.995:.68,.99:.87,.975:1.24,.95:1.64,.9:2.2,.5:5.35,.1:10.65,.05:12.59,.025:14.45,.01:16.81,.005:18.55},7:{.995:.99,.99:1.25,.975:1.69,.95:2.17,.9:2.83,.5:6.35,.1:12.02,.05:14.07,.025:16.01,.01:18.48,.005:20.28},8:{.995:1.34,.99:1.65,.975:2.18,.95:2.73,.9:3.49,.5:7.34,.1:13.36,.05:15.51,.025:17.53,.01:20.09,.005:21.96},9:{.995:1.73,.99:2.09,.975:2.7,.95:3.33,.9:4.17,.5:8.34,.1:14.68,.05:16.92,.025:19.02,.01:21.67,.005:23.59},10:{.995:2.16,.99:2.56,.975:3.25,.95:3.94,.9:4.87,.5:9.34,.1:15.99,.05:18.31,.025:20.48,.01:23.21,.005:25.19},11:{.995:2.6,.99:3.05,.975:3.82,.95:4.57,.9:5.58,.5:10.34,.1:17.28,.05:19.68,.025:21.92,.01:24.72,.005:26.76},12:{.995:3.07,.99:3.57,.975:4.4,.95:5.23,.9:6.3,.5:11.34,.1:18.55,.05:21.03,.025:23.34,.01:26.22,.005:28.3},13:{.995:3.57,.99:4.11,.975:5.01,.95:5.89,.9:7.04,.5:12.34,.1:19.81,.05:22.36,.025:24.74,.01:27.69,.005:29.82},14:{.995:4.07,.99:4.66,.975:5.63,.95:6.57,.9:7.79,.5:13.34,.1:21.06,.05:23.68,.025:26.12,.01:29.14,.005:31.32},15:{.995:4.6,.99:5.23,.975:6.27,.95:7.26,.9:8.55,.5:14.34,.1:22.31,.05:25,.025:27.49,.01:30.58,.005:32.8},16:{.995:5.14,.99:5.81,.975:6.91,.95:7.96,.9:9.31,.5:15.34,.1:23.54,.05:26.3,.025:28.85,.01:32,.005:34.27},17:{.995:5.7,.99:6.41,.975:7.56,.95:8.67,.9:10.09,.5:16.34,.1:24.77,.05:27.59,.025:30.19,.01:33.41,.005:35.72},18:{.995:6.26,.99:7.01,.975:8.23,.95:9.39,.9:10.87,.5:17.34,.1:25.99,.05:28.87,.025:31.53,.01:34.81,.005:37.16},19:{.995:6.84,.99:7.63,.975:8.91,.95:10.12,.9:11.65,.5:18.34,.1:27.2,.05:30.14,.025:32.85,.01:36.19,.005:38.58},20:{.995:7.43,.99:8.26,.975:9.59,.95:10.85,.9:12.44,.5:19.34,.1:28.41,.05:31.41,.025:34.17,.01:37.57,.005:40},21:{.995:8.03,.99:8.9,.975:10.28,.95:11.59,.9:13.24,.5:20.34,.1:29.62,.05:32.67,.025:35.48,.01:38.93,.005:41.4},22:{.995:8.64,.99:9.54,.975:10.98,.95:12.34,.9:14.04,.5:21.34,.1:30.81,.05:33.92,.025:36.78,.01:40.29,.005:42.8},23:{.995:9.26,.99:10.2,.975:11.69,.95:13.09,.9:14.85,.5:22.34,.1:32.01,.05:35.17,.025:38.08,.01:41.64,.005:44.18},24:{.995:9.89,.99:10.86,.975:12.4,.95:13.85,.9:15.66,.5:23.34,.1:33.2,.05:36.42,.025:39.36,.01:42.98,.005:45.56},25:{.995:10.52,.99:11.52,.975:13.12,.95:14.61,.9:16.47,.5:24.34,.1:34.28,.05:37.65,.025:40.65,.01:44.31,.005:46.93},26:{.995:11.16,.99:12.2,.975:13.84,.95:15.38,.9:17.29,.5:25.34,.1:35.56,.05:38.89,.025:41.92,.01:45.64,.005:48.29},27:{.995:11.81,.99:12.88,.975:14.57,.95:16.15,.9:18.11,.5:26.34,.1:36.74,.05:40.11,.025:43.19,.01:46.96,.005:49.65},28:{.995:12.46,.99:13.57,.975:15.31,.95:16.93,.9:18.94,.5:27.34,.1:37.92,.05:41.34,.025:44.46,.01:48.28,.005:50.99},29:{.995:13.12,.99:14.26,.975:16.05,.95:17.71,.9:19.77,.5:28.34,.1:39.09,.05:42.56,.025:45.72,.01:49.59,.005:52.34},30:{.995:13.79,.99:14.95,.975:16.79,.95:18.49,.9:20.6,.5:29.34,.1:40.26,.05:43.77,.025:46.98,.01:50.89,.005:53.67},40:{.995:20.71,.99:22.16,.975:24.43,.95:26.51,.9:29.05,.5:39.34,.1:51.81,.05:55.76,.025:59.34,.01:63.69,.005:66.77},50:{.995:27.99,.99:29.71,.975:32.36,.95:34.76,.9:37.69,.5:49.33,.1:63.17,.05:67.5,.025:71.42,.01:76.15,.005:79.49},60:{.995:35.53,.99:37.48,.975:40.48,.95:43.19,.9:46.46,.5:59.33,.1:74.4,.05:79.08,.025:83.3,.01:88.38,.005:91.95},70:{.995:43.28,.99:45.44,.975:48.76,.95:51.74,.9:55.33,.5:69.33,.1:85.53,.05:90.53,.025:95.02,.01:100.42,.005:104.22},80:{.995:51.17,.99:53.54,.975:57.15,.95:60.39,.9:64.28,.5:79.33,.1:96.58,.05:101.88,.025:106.63,.01:112.33,.005:116.32},90:{.995:59.2,.99:61.75,.975:65.65,.95:69.13,.9:73.29,.5:89.33,.1:107.57,.05:113.14,.025:118.14,.01:124.12,.005:128.3},100:{.995:67.33,.99:70.06,.975:74.22,.95:77.93,.9:82.36,.5:99.33,.1:118.5,.05:124.34,.025:129.56,.01:135.81,.005:140.17}};var Zl=Math.sqrt(2*Math.PI),Jl={gaussian:function(r){return Math.exp(-.5*r*r)/Zl}},rs={nrd:function(r){var t=Dl(r),n=Sl(r);return"number"==typeof n&&(t=Math.min(t,n/1.34)),1.06*t*Math.pow(r.length,-.2)}};function ts(r,t,n){var e,o;if(void 0===t)e=Jl.gaussian;else if("string"==typeof t){if(!Jl[t])throw new Error('Unknown kernel "'+t+'"');e=Jl[t]}else e=t;if(void 0===n)o=rs.nrd(r);else if("string"==typeof n){if(!rs[n])throw new Error('Unknown bandwidth method "'+n+'"');o=rs[n](r)}else o=n;return function(t){var n=0,a=0;for(n=0;n<r.length;n++)a+=e((t-r[n])/o);return a/o/r.length}}var ns=Math.sqrt(2*Math.PI);function es(r){for(var t=r,n=r,e=1;e<15;e++)t+=n*=r*r/(2*e+1);return Math.round(1e4*(.5+t/ns*Math.exp(-r*r/2)))/1e4}for(var os=[],as=0;as<=3.09;as+=.01)os.push(es(as));function is(r){var t=1/(1+.5*Math.abs(r)),n=t*Math.exp(-r*r+((((((((.17087277*t-.82215223)*t+1.48851587)*t-1.13520398)*t+.27886807)*t-.18628806)*t+.09678418)*t+.37409196)*t+1.00002368)*t-1.26551223);return r>=0?1-n:n-1}function us(r){var t=8*(Math.PI-3)/(3*Math.PI*(4-Math.PI)),n=Math.sqrt(Math.sqrt(Math.pow(2/(Math.PI*t)+Math.log(1-r*r)/2,2)-Math.log(1-r*r)/t)-(2/(Math.PI*t)+Math.log(1-r*r)/2));return r>=0?n:-n}function fs(r){if("number"==typeof r)return r<0?-1:0===r?0:1;throw new TypeError("not a number")}function cs(r,t){for(var n=0,e=0;e<r.length;e++){var o=r[e]-t[e];n+=o*o}return Math.sqrt(n)}function ls(r,t){return r.map((function(r){for(var n=Number.MAX_VALUE,e=-1,o=0;o<t.length;o++){var a=cs(r,t[o]);a<n&&(n=a,e=o)}return e}))}function ss(r,t,n){for(var e=r[0].length,o=zl(n,e),a=Array(n).fill(0),i=r.length,u=0;u<i;u++){for(var f=r[u],c=t[u],l=o[c],s=0;s<e;s++)l[s]+=f[s];a[c]+=1}for(var p=0;p<n;p++){if(0===a[p])throw new Error("Centroid "+p+" has no friends");for(var v=o[p],h=0;h<e;h++)v[h]/=a[p]}return o}function ps(r,t){for(var n=0,e=0;e<r.length;e++)n+=cs(r[e],t[e]);return n}function vs(r,t){if(r.length!==t.length)throw new Error("must have exactly as many labels as points");for(var n=function(r){for(var t=1+bl(r),n=Array(t),e=0;e<r.length;e++){var o=r[e];void 0===n[o]&&(n[o]=[]),n[o].push(e)}return n}(t),e=function(r){for(var t=r.length,n=zl(t,t),e=0;e<t;e++)for(var o=0;o<e;o++)n[e][o]=cs(r[e],r[o]),n[o][e]=n[e][o];return n}(r),o=[],a=0;a<r.length;a++){var i=0;if(n[t[a]].length>1){var u=ms(a,n[t[a]],e),f=hs(a,t,n,e);i=(f-u)/Math.max(u,f)}o.push(i)}return o}function hs(r,t,n,e){for(var o=t[r],a=Number.MAX_VALUE,i=0;i<n.length;i++)if(i!==o){var u=ms(r,n[i],e);u<a&&(a=u)}return a}function ms(r,t,n){for(var e=0,o=0;o<t.length;o++)e+=n[r][t[o]];return e/t.length}function gs(r,t){return 0===r&&0===t?0:Math.abs((r-t)/t)}var ds=Object.freeze({__proto__:null,BayesianClassifier:Vl,PerceptronModel:Wl,addToMean:function(r,t,n){return r+(n-r)/(t+1)},approxEqual:function(r,t,n){return void 0===n&&(n=Xl),gs(r,t)<=n},average:sl,averageSimple:Bl,bayesian:Vl,bernoulliDistribution:function(r){if(r<0||r>1)throw new Error("bernoulliDistribution requires probability to be between 0 and 1 inclusive");return[1-r,r]},binomialDistribution:function(r,t){if(!(t<0||t>1||r<=0||r%1!=0)){var n=0,e=0,o=[],a=1;do{o[n]=a*Math.pow(t,n)*Math.pow(1-t,r-n),e+=o[n],a=a*(r-++n+1)/n}while(e<1-Xl);return o}},bisect:function(r,t,n,e,o){if("function"!=typeof r)throw new TypeError("func must be a function");for(var a=0;a<e;a++){var i=(t+n)/2;if(0===r(i)||Math.abs((n-t)/2)<o)return i;fs(r(i))===fs(r(t))?t=i:n=i}throw new Error("maximum number of iterations exceeded")},chiSquaredDistributionTable:Kl,chiSquaredGoodnessOfFit:function(r,t,n){for(var e=0,o=t(sl(r)),a=[],i=[],u=0;u<r.length;u++)void 0===a[r[u]]&&(a[r[u]]=0),a[r[u]]++;for(var f=0;f<a.length;f++)void 0===a[f]&&(a[f]=0);for(var c in o)c in a&&(i[+c]=o[c]*r.length);for(var l=i.length-1;l>=0;l--)i[l]<3&&(i[l-1]+=i[l],i.pop(),a[l-1]+=a[l],a.pop());for(var s=0;s<a.length;s++)e+=Math.pow(a[s]-i[s],2)/i[s];var p=a.length-1-1;return Kl[p][n]<e},chunk:function(r,t){var n=[];if(t<1)throw new Error("chunk size must be a positive number");if(Math.floor(t)!==t)throw new Error("chunk size must be an integer");for(var e=0;e<r.length;e+=t)n.push(r.slice(e,e+t));return n},ckmeans:function(r,t){if(t>r.length)throw new Error("cannot generate more classes than there are data values");var n=gl(r);if(1===Fl(n))return[n];var e=zl(t,n.length),o=zl(t,n.length);!function(r,t,n){for(var e=t[0].length,o=r[Math.floor(e/2)],a=[],i=[],u=0,f=void 0;u<e;++u)f=r[u]-o,0===u?(a.push(f),i.push(f*f)):(a.push(a[u-1]+f),i.push(i[u-1]+f*f)),t[0][u]=Tl(0,u,a,i),n[0][u]=0;for(var c=1;c<t.length;++c)$l(c<t.length-1?c:e-1,e-1,c,t,n,a,i)}(n,e,o);for(var a=[],i=o[0].length-1,u=o.length-1;u>=0;u--){var f=o[u][i];a[u]=n.slice(f,i+1),u>0&&(i=f-1)}return a},coefficientOfVariation:function(r){return Dl(r)/sl(r)},combinations:function r(t,n){var e,o,a,i,u=[];for(e=0;e<t.length;e++)if(1===n)u.push([t[e]]);else for(a=r(t.slice(e+1,t.length),n-1),o=0;o<a.length;o++)(i=a[o]).unshift(t[e]),u.push(i);return u},combinationsReplacement:function r(t,n){for(var e=[],o=0;o<t.length;o++)if(1===n)e.push([t[o]]);else for(var a=r(t.slice(o,t.length),n-1),i=0;i<a.length;i++)e.push([t[o]].concat(a[i]));return e},combineMeans:Ul,combineVariances:function(r,t,n,e,o,a){var i=Ul(t,n,o,a);return(n*(r+Math.pow(t-i,2))+a*(e+Math.pow(o-i,2)))/(n+a)},cumulativeStdLogisticProbability:function(r){return 1/(Math.exp(-r)+1)},cumulativeStdNormalProbability:function(r){var t=Math.abs(r),n=Math.min(Math.round(100*t),os.length-1);return r>=0?os[n]:+(1-os[n]).toFixed(4)},epsilon:Xl,equalIntervalBreaks:function(r,t){if(r.length<2)return r;for(var n=dl(r),e=bl(r),o=[n],a=(e-n)/t,i=1;i<t;i++)o.push(o[0]+a*i);return o.push(e),o},erf:is,errorFunction:is,extent:function(r){if(0===r.length)throw new Error("extent requires at least one data point");for(var t=r[0],n=r[0],e=1;e<r.length;e++)r[e]>n&&(n=r[e]),r[e]<t&&(t=r[e]);return[t,n]},extentSorted:function(r){return[r[0],r[r.length-1]]},factorial:Yl,gamma:function r(t){if(Number.isInteger(t))return t<=0?NaN:Yl(t-1);if(--t<0)return Math.PI/(Math.sin(Math.PI*-t)*r(-t));var n=t+1/4;return Math.pow(t/Math.E,t)*Math.sqrt(2*Math.PI*(t+1/6))*(1+1/144/Math.pow(n,2)-1/12960/Math.pow(n,3)-257/207360/Math.pow(n,4)-52/2612736/Math.pow(n,5)+5741173/9405849600/Math.pow(n,6)+37529/18811699200/Math.pow(n,7))},gammaln:function(r){if(r<=0)return 1/0;r--;for(var t=Hl[0],n=1;n<15;n++)t+=Hl[n]/(r+n);var e=5.2421875+r;return Ql+Math.log(t)-e+(r+.5)*Math.log(e)},geometricMean:function(r){if(0===r.length)throw new Error("geometricMean requires at least one data point");for(var t=1,n=0;n<r.length;n++){if(r[n]<0)throw new Error("geometricMean requires only non-negative numbers as input");t*=r[n]}return Math.pow(t,1/r.length)},harmonicMean:function(r){if(0===r.length)throw new Error("harmonicMean requires at least one data point");for(var t=0,n=0;n<r.length;n++){if(r[n]<=0)throw new Error("harmonicMean requires only positive numbers as input");t+=1/r[n]}return r.length/t},interquartileRange:Sl,inverseErrorFunction:us,iqr:Sl,jenks:function(r,t){if(t>r.length)return null;var n=function(r,t){var n,e,o=[],a=[],i=0;for(n=0;n<r.length+1;n++){var u=[],f=[];for(e=0;e<t+1;e++)u.push(0),f.push(0);o.push(u),a.push(f)}for(n=1;n<t+1;n++)for(o[1][n]=1,a[1][n]=0,e=2;e<r.length+1;e++)a[e][n]=1/0;for(var c=2;c<r.length+1;c++){for(var l=0,s=0,p=0,v=0,h=1;h<c+1;h++){var m=c-h+1,g=r[m-1];if(i=(s+=g*g)-(l+=g)*l/++p,0!=(v=m-1))for(e=2;e<t+1;e++)a[c][e]>=i+a[v][e-1]&&(o[c][e]=m,a[c][e]=i+a[v][e-1])}o[c][1]=1,a[c][1]=i}return{lowerClassLimits:o,varianceCombinations:a}}(r=r.slice().sort((function(r,t){return r-t})),t);return function(r,t,n){var e=r.length,o=[],a=n;for(o[n]=r[r.length-1];a>0;)o[a-1]=r[t[e][a]-1],e=t[e][a]-1,a--;return o}(r,n.lowerClassLimits,t)},kMeansCluster:function(r,t,n){void 0===n&&(n=Math.random);for(var e=null,o=Il(r,t,n),a=null,i=Number.MAX_VALUE;0!==i;)e=o,i=ps(o=ss(r,a=ls(r,o),t),e);return{labels:a,centroids:o}},kde:ts,kernelDensityEstimation:ts,linearRegression:function(r){var t,n,e=r.length;if(1===e)t=0,n=r[0][1];else{for(var o,a,i,u=0,f=0,c=0,l=0,s=0;s<e;s++)u+=a=(o=r[s])[0],f+=i=o[1],c+=a*a,l+=a*i;n=f/e-(t=(e*l-u*f)/(e*c-u*u))*u/e}return{m:t,b:n}},linearRegressionLine:function(r){return function(t){return r.b+r.m*t}},logAverage:function(r){if(0===r.length)throw new Error("logAverage requires at least one data point");for(var t=0,n=0;n<r.length;n++){if(r[n]<0)throw new Error("logAverage requires only non-negative numbers as input");t+=Math.log(r[n])}return Math.exp(t/r.length)},logit:function(r){if(r<=0||r>=1)throw new Error("p must be strictly between zero and one");return Math.log(r/(1-r))},mad:Ol,max:bl,maxSorted:function(r){return r[r.length-1]},mean:sl,meanSimple:Bl,median:El,medianAbsoluteDeviation:Ol,medianSorted:function(r){return wl(r,.5)},min:dl,minSorted:function(r){return r[0]},mode:function(r){return ml(gl(r))},modeFast:function(r){for(var t,n=new Map,e=0,o=0;o<r.length;o++){var a=n.get(r[o]);void 0===a?a=1:a++,a>e&&(t=r[o],e=a),n.set(r[o],a)}if(0===e)throw new Error("mode requires at last one data point");return t},modeSorted:ml,numericSort:gl,perceptron:Wl,permutationTest:function(r,t,n,e,o){if(void 0===e&&(e=1e4),void 0===n&&(n="two_side"),"two_side"!==n&&"greater"!==n&&"less"!==n)throw new Error("`alternative` must be either 'two_side', 'greater', or 'less'.");for(var a=sl(r)-sl(t),i=new Array(e),u=r.concat(t),f=Math.floor(u.length/2),c=0;c<e;c++){kl(u,o);var l=u.slice(0,f),s=u.slice(f,u.length),p=sl(l)-sl(s);i[c]=p}var v=0;if("two_side"===n)for(var h=0;h<=e;h++)Math.abs(i[h])>=Math.abs(a)&&(v+=1);else if("greater"===n)for(var m=0;m<=e;m++)i[m]>=a&&(v+=1);else for(var g=0;g<=e;g++)i[g]<=a&&(v+=1);return v/e},permutationsHeap:function(r){for(var t=new Array(r.length),n=[r.slice()],e=0;e<r.length;e++)t[e]=0;for(var o=0;o<r.length;)if(t[o]<o){var a=0;o%2!=0&&(a=t[o]);var i=r[a];r[a]=r[o],r[o]=i,n.push(r.slice()),t[o]++,o=0}else t[o]=0,o++;return n},poissonDistribution:function(r){if(!(r<=0)){var t=0,n=0,e=[],o=1;do{e[t]=Math.exp(-r)*Math.pow(r,t)/o,n+=e[t],o*=++t}while(n<1-Xl);return e}},probit:function(r){return 0===r?r=Xl:r>=1&&(r=1-Xl),Math.sqrt(2)*us(2*r-1)},product:function(r){for(var t=1,n=0;n<r.length;n++)t*=r[n];return t},quantile:_l,quantileRank:function(r,t){return Al(gl(r),t)},quantileRankSorted:Al,quantileSorted:wl,quickselect:jl,rSquared:function(r,t){if(r.length<2)return 1;for(var n=0,e=0;e<r.length;e++)n+=r[e][1];for(var o=n/r.length,a=0,i=0;i<r.length;i++)a+=Math.pow(o-r[i][1],2);for(var u=0,f=0;f<r.length;f++)u+=Math.pow(r[f][1]-t(r[f][0]),2);return 1-u/a},relativeError:gs,rms:Gl,rootMeanSquare:Gl,sample:Il,sampleCorrelation:Ll,sampleCovariance:Rl,sampleKurtosis:function(r){var t=r.length;if(t<4)throw new Error("sampleKurtosis requires at least four data points");for(var n,e=sl(r),o=0,a=0,i=0;i<t;i++)o+=(n=r[i]-e)*n,a+=n*n*n*n;return(t-1)/((t-2)*(t-3))*(t*(t+1)*a/(o*o)-3*(t-1))},sampleRankCorrelation:function(r,t){for(var n=r.map((function(r,t){return[r,t]})).sort((function(r,t){return r[0]-t[0]})).map((function(r){return r[1]})),e=t.map((function(r,t){return[r,t]})).sort((function(r,t){return r[0]-t[0]})).map((function(r){return r[1]})),o=Array(n.length),a=Array(n.length),i=0;i<n.length;i++)o[n[i]]=i,a[e[i]]=i;return Ll(o,a)},sampleSkewness:function(r){if(r.length<3)throw new Error("sampleSkewness requires at least three data points");for(var t,n=sl(r),e=0,o=0,a=0;a<r.length;a++)e+=(t=r[a]-n)*t,o+=t*t*t;var i=r.length-1,u=Math.sqrt(e/i),f=r.length;return f*o/((f-1)*(f-2)*Math.pow(u,3))},sampleStandardDeviation:Dl,sampleVariance:Cl,sampleWithReplacement:function(r,t,n){if(0===r.length)return[];n=n||Math.random;for(var e=r.length,o=[],a=0;a<t;a++){var i=Math.floor(n()*e);o.push(r[i])}return o},shuffle:Nl,shuffleInPlace:kl,sign:fs,silhouette:vs,silhouetteMetric:function(r,t){return bl(vs(r,t))},standardDeviation:hl,standardNormalTable:os,subtractFromMean:function(r,t,n){return(r*t-n)/(t-1)},sum:ll,sumNthPowerDeviations:pl,sumSimple:yl,tTest:function(r,t){return(sl(r)-t)/(hl(r)/Math.sqrt(r.length))},tTestTwoSample:function(r,t,n){var e=r.length,o=t.length;if(!e||!o)return null;n||(n=0);var a=sl(r),i=sl(t),u=Cl(r),f=Cl(t);if("number"==typeof a&&"number"==typeof i&&"number"==typeof u&&"number"==typeof f){var c=((e-1)*u+(o-1)*f)/(e+o-2);return(a-i-n)/Math.sqrt(c*(1/e+1/o))}},uniqueCountSorted:Fl,variance:vl,wilcoxonRankSum:function(r,t){if(!r.length||!t.length)throw new Error("Neither sample can be empty");for(var n=r.map((function(r){return{label:"x",value:r}})).concat(t.map((function(r){return{label:"y",value:r}}))).sort((function(r,t){return r.value-t.value})),e=0;e<n.length;e++)n[e].rank=e;for(var o=[n[0].rank],a=1;a<n.length;a++)n[a].value===n[a-1].value?(o.push(n[a].rank),a===n.length-1&&i(n,o)):o.length>1?i(n,o):o=[n[a].rank];function i(r,t){for(var n=(t[0]+t[t.length-1])/2,e=0;e<t.length;e++)r[t[e]].rank=n}for(var u=0,f=0;f<n.length;f++){var c=n[f];"x"===c.label&&(u+=c.rank+1)}return u},zScore:function(r,t,n){return(r-t)/n}});let bs=Uo(ys=ds,"default.default")?ys.default.default:Uo(ys,"default")?ys.default:ys;var ys;var ws=q,js=xr;var xs=function(r){return!0===r||!1===r||js(r)&&"[object Boolean]"==ws(r)};function _s(r){return xs(r)}function Ms(r){if(Iu(r)){for(let t in r)return!0;return!1}return!1}function Ps(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Uo(t,"interpX");Ru(n)||(n=null);let e=Uo(t,"useRegIntercept");_s(e)||(e=!0);let o=Uo(t,"useSync");_s(o)||(o=!1);let a=()=>{let t=[];if($f(r,(r=>{let n=Uo(r,0),e=Uo(r,1);Ru(n)&&Ru(e)&&t.push([Ju(n),Ju(e)])})),0===Kr(t))return null;let o=null;if(e)o=bs.linearRegression(t);else{let r=0,n=0;$f(t,(t=>{r+=t[0]**2,n+=t[0]*t[1]}));let e=null;0!==r&&(e=n/r),o={m:e,b:0}}if(Ru(n)){n=Ju(n);let r=bs.linearRegressionLine(o)(n);o.interpY=r}return o};return o?a():(async()=>{let r=null;try{return r=a(),Ms(r)?r:Promise.reject("no effective data")}catch(r){return console.log(r),Promise.reject(r.toString())}})()}var qs=Xn,As=kf,Ss=hf,Es=4294967295,Os=Math.min;var ks=function(r,t){if((r=Ss(r))<1||r>9007199254740991)return[];var n=Es,e=Os(r,Es);t=As(t),r-=Es;for(var o=qs(e,t);++n<r;)t(n);return o};r.arrAverage=tf,r.arrAverageWithLogNormCI=async function(r,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"two-tailed";if(!ot(r))return Promise.reject("arr is not an array");if(0===Kr(r))return Promise.reject("arr is not an effective array");if(!Ru(t))return Promise.reject(`p[${t}] is not a number`);if((t=Ju(t))<0)return Promise.reject(`p[${t}] < 0`);if(t>1)return Promise.reject(`p[${t}] > 1`);if("two-tailed"!==n&&"upper-tail"!==n&&"lower-tail"!==n)return Promise.reject(`mode[${n}] is not 'two-tailed', 'upper-tail' or 'lower-tail'`);let e=of(r);if(0===Kr(e))return Promise.reject("no effective data");let o=await Sf(e,t,n);return o=ot(o)?[Math.exp(o[0]),Math.exp(o[1])]:Math.exp(o),o},r.arrAverageWithNormCI=Sf,r.arrCount=function(r){if(!ot(r))return[];if(0===Kr(r))return[];let t=[];if($f(r,(r=>{(Ru(r)||$u(r))&&t.push(function(r){if(!$u(r)&&!Ru(r)&&!lo(r))return"";let t="";try{t=String(r)}catch(r){}try{t=r.toString()}catch(r){}return t}(r))})),0===Kr(t))return[];t=qa(t,(r=>({v:r})));let n=Wf(t,"v");return n=qa(n,((r,t)=>({key:t,count:Kr(r)}))),n=Oc(n,"count"),n=Nc(n),n},r.arrGammaFit=Jc,r.arrGammaHist=async function(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!ot(r))return Promise.reject("arr is not an array");if(0===Kr(r))return Promise.reject("arr is not an effective array");let n=rf(r);n=Na(n,(r=>r>0));let e=await Jc(r,t),o=await nl(n,(r=>qa(r.curveX,(r=>sf.gamma.pdf(r,e.shape,e.scale)))),t),a=qa(o.bins,((r,t)=>(r.pdf=o.pdfs[t],r))),i=qa(o.curveX,((r,t)=>({x:r,pdf:o.curveY[t]})));return{shape:e.shape,scale:e.scale,arr:o.arr,min:o.min,max:o.max,barWidth:o.barWidth,ratioForCountToPdf:o.ratioForCountToPdf,bins:a,curves:i}},r.arrGammaInv=async function(r,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!ot(r))return Promise.reject("arr is not an array");if(0===Kr(r))return Promise.reject("arr is not an effective array");if(!Ru(t))return Promise.reject(`ratio[${t}] is not a number`);if((t=Ju(t))<0)return Promise.reject(`ratio[${t}] < 0`);if(t>1)return Promise.reject(`ratio[${t}] > 1`);let e=Uo(n,"n");qf(e)||(e=30),e=Pf(e);let o=Uo(n,"min",null),a=Uo(n,"max",null),i=await Jc(r,{n:e,min:o,max:a});return function(r){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?il(Object(n),!0).forEach((function(t){al(r,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):il(Object(n)).forEach((function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(n,t))}))}return r}({inv:sf.gamma.inv(t,i.shape,i.scale)},i)},r.arrGeometricAverage=ul,r.arrGeometricStd=function(r){if(!ot(r))return null;if(0===Kr(r))return null;let t=of(r),n=Kr(t);if(0===n)return null;if(n<=1)return null;let e=pf(t);return Math.exp(e)},r.arrLogNormHist=async function(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!ot(r))return Promise.reject("arr is not an array");if(0===Kr(r))return Promise.reject("arr is not an effective array");let n=await fl(r,t),e=of(r),o=await fl(e),a=qa(o.curves,(r=>({x:Math.exp(r.x),pdf:r.pdf}))),i=n.ratioForCountToPdf/o.ratioForCountToPdf;a=qa(a,(r=>(r.pdf*=i,r)));let u=ul(n.arr);return{avg:n.avg,std:n.std,avg_geo:u,avg_log:o.avg,std_log:o.std,arr:n.arr,min:n.min,max:n.max,barWidth:n.barWidth,ratioForCountToPdf:n.ratioForCountToPdf,bins:n.bins,curves:a}},r.arrLogNormInv=async function(r,t){if(!ot(r))return Promise.reject("arr is not an array");if(0===Kr(r))return Promise.reject("arr is not an effective array");if(!Ru(t))return Promise.reject(`ratio[${t}] is not a number`);if((t=Ju(t))<0)return Promise.reject(`ratio[${t}] < 0`);if(t>1)return Promise.reject(`ratio[${t}] > 1`);let n=of(r);if(0===Kr(n))return Promise.reject("no effective data");let e=await cl(n,t);return ff(Uo(e,"inv"))?(e={inv:Math.exp(e.inv),avg:Math.exp(e.avg),std:Math.exp(e.std),arr:qa(e.arr,(r=>Math.exp(r)))},e):Promise.reject("invalid value from arrNormInv")},r.arrMovingAverage=function(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!ot(r))return[];if(0===Kr(r))return[];let n=Uo(t,"selectCountHalf");var e;df(e=n)&&Pf(e)>=0||(n=2),n=Pf(n);let o=Kr(r);if(0===o)return[];let a=Nu(r);return $f(r,((t,e)=>{let i=e-n;i=Math.max(i,0),i=Math.min(i,o-1);let u=Math.max(e+n,0);u=Math.max(u,0),u=Math.min(u,o-1);let f=[];for(let t=i;t<=u;t++)f.push(r[t]);let c=tf(f);a[e]=c})),a},r.arrNormHist=fl,r.arrNormInv=cl,r.arrQuartile=function(r,t){if(!ot(r))return null;if(0===Kr(r))return null;if(!nf(t))return null;(t=Ju(t))<0&&(t=0),t>1&&(t=1);let n=rf(r);return 0===Kr(n)?null:bs.quantile(n,t)},r.arrStd=pf,r.bin=Zc,r.histGen=nl,r.jStat=sf,r.regLine=Ps,r.regPower=function(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Uo(t,"interpX");Ru(n)||(n=null);let e=Uo(t,"useSync");_s(e)||(e=!1);let o=()=>{$f(r,(r=>{let t=Uo(r,0),n=Uo(r,1);Ru(t)&&Ru(n)&&(t=Ju(t),n=Ju(n))}));let t=Ps(qa(r,(r=>[Math.log(r[0]),Math.log(r[1])])),{useRegIntercept:!0,useSync:!0});if(!Ms(t))return null;let e={a:Math.exp(t.b),b:t.m};if(Ru(n)){n=Ju(n);let r=e.a*n**e.b;e.interpY=r}return e};return e?o():(async()=>{let r=null;try{return r=o(),Ms(r)?r:Promise.reject("no effective data")}catch(r){return console.log(r),Promise.reject(r.toString())}})()},r.sampleRandom=async function(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null;if("beta"===r){let e=Uo(t,"alpha");if(!ff(e))return Promise.reject("opt.alpha is not a number");let o=Uo(t,"beta");if(!ff(o))return Promise.reject("opt.beta is not a number");n=()=>sf[r].sample(e,o)}else if("centralF"===r){let e=Uo(t,"df1");if(!ff(e))return Promise.reject("opt.df1 is not a number");let o=Uo(t,"df2");if(!ff(o))return Promise.reject("opt.df2 is not a number");n=()=>sf[r].sample(e,o)}else if("cauchy"===r){let e=Uo(t,"local");if(!ff(e))return Promise.reject("opt.local is not a number");let o=Uo(t,"scale");if(!ff(o))return Promise.reject("opt.scale is not a number");n=()=>sf[r].sample(e,o)}else if("chisquare"===r){let e=Uo(t,"dof");if(!ff(e))return Promise.reject("opt.dof is not a number");n=()=>sf[r].sample(e)}else if("exponential"===r){let e=Uo(t,"rate");if(!ff(e))return Promise.reject("opt.rate is not a number");n=()=>sf[r].sample(e)}else if("gamma"===r){let e=Uo(t,"shape");if(!ff(e))return Promise.reject("opt.shape is not a number");let o=Uo(t,"scale");if(!ff(o))return Promise.reject("opt.scale is not a number");n=()=>sf[r].sample(e,o)}else if("invgamma"===r){let e=Uo(t,"shape");if(!ff(e))return Promise.reject("opt.shape is not a number");let o=Uo(t,"scale");if(!ff(o))return Promise.reject("opt.scale is not a number");n=()=>sf[r].sample(e,o)}else if("kumaraswamy"===r){let e=Uo(t,"alpha");if(!ff(e))return Promise.reject("opt.alpha is not a number");let o=Uo(t,"beta");if(!ff(o))return Promise.reject("opt.beta is not a number");n=()=>sf[r].sample(e,o)}else if("lognormal"===r){let e=Uo(t,"mu");if(!ff(e))return Promise.reject("opt.mu is not a number");let o=Uo(t,"sigma");if(!ff(o))return Promise.reject("opt.sigma is not a number");n=()=>sf[r].sample(e,o)}else if("normal"===r){let e=Uo(t,"mu");if(!ff(e))return Promise.reject("opt.mu is not a number");let o=Uo(t,"sigma");if(!ff(o))return Promise.reject("opt.sigma is not a number");n=()=>sf[r].sample(e,o)}else{if("pareto"===r)return Promise.reject("invalid pareto.sample");if("studentt"===r){let e=Uo(t,"dof");if(!ff(e))return Promise.reject("opt.dof is not a number");n=()=>sf[r].sample(e)}else{if("tukey"===r)return Promise.reject("invalid tukey.sample");if("weibull"===r){let e=Uo(t,"scale");if(!ff(e))return Promise.reject("opt.scale is not a number");let o=Uo(t,"shape");if(!ff(o))return Promise.reject("opt.shape is not a number");n=()=>sf[r].sample(e,o)}else if("uniform"===r){let e=Uo(t,"a");if(!ff(e))return Promise.reject("opt.a is not a number");let o=Uo(t,"b");if(!ff(o))return Promise.reject("opt.b is not a number");n=()=>sf[r].sample(e,o)}else{if("binomial"===r)return Promise.reject("invalid binomial.sample");if("negbin"===r)return Promise.reject("invalid negbin.sample");if("hypgeom"===r)return Promise.reject("invalid hypgeom.sample");if("poisson"===r){let e=Uo(t,"l");if(!ff(e))return Promise.reject("opt.l is not a number");n=()=>sf[r].sample(e)}else if("triangular"===r){let e=Uo(t,"a");if(!ff(e))return Promise.reject("opt.a is not a number");let o=Uo(t,"b");if(!ff(o))return Promise.reject("opt.b is not a number");let a=Uo(t,"c");if(!ff(a))return Promise.reject("opt.c is not a number");n=()=>sf[r].sample(e,o,a)}else{if("arcsine"!==r)return Promise.reject(`invalid name[${r}]`);{let e=Uo(t,"a");if(!ff(e))return Promise.reject("opt.a is not a number");let o=Uo(t,"b");if(!ff(o))return Promise.reject("opt.b is not a number");n=()=>sf[r].sample(e,o)}}}}}let e=Uo(t,"num");e=Pf(e),e<=0&&(e=1);let o=Uo(t,"low");o=Ru(o)?Ju(o):null;let a=Uo(t,"up");if(a=Ru(a)?Ju(a):null,null!==o&&null!==a&&o>=a)throw new Error(`low[${o}] >= up[${a}]`);let i=()=>{let r=n();return null!==o&&r<o&&(r=i()),null!==a&&r>a&&(r=i()),r},u=qa(ks(e),(()=>i()));return 1===e&&(u=u[0]),u},r.simpleStatistics=bs,r.studentTInv=Af}));
//# sourceMappingURL=w-statistic.umd.js.map
