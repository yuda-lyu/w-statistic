/*!
 * w-statistic v1.0.15
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(r,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((r="undefined"!=typeof globalThis?globalThis:r||self)["w-statistic"]={})}(this,(function(r){"use strict";var t=Object.prototype;function n(r){var n=r&&r.constructor;return r===("function"==typeof n&&n.prototype||t)}function e(r,t){return function(n){return r(t(n))}}var o=e(Object.keys,Object),a=Object.prototype.hasOwnProperty;function i(r){if(!n(r))return o(r);var t=[];for(var e in Object(r))a.call(r,e)&&"constructor"!=e&&t.push(e);return t}var u="object"==typeof global&&global&&global.Object===Object&&global,f="object"==typeof self&&self&&self.Object===Object&&self,l=u||f||Function("return this")(),c=l.Symbol,s=Object.prototype,p=s.hasOwnProperty,h=s.toString,m=c?c.toStringTag:void 0;var v=Object.prototype.toString;var d="[object Null]",g="[object Undefined]",b=c?c.toStringTag:void 0;function y(r){return null==r?void 0===r?g:d:b&&b in Object(r)?function(r){var t=p.call(r,m),n=r[m];try{r[m]=void 0;var e=!0}catch(r){}var o=h.call(r);return e&&(t?r[m]=n:delete r[m]),o}(r):function(r){return v.call(r)}(r)}function w(r){var t=typeof r;return null!=r&&("object"==t||"function"==t)}var j="[object AsyncFunction]",x="[object Function]",_="[object GeneratorFunction]",M="[object Proxy]";function P(r){if(!w(r))return!1;var t=y(r);return t==x||t==_||t==j||t==M}var q,A=l["__core-js_shared__"],S=(q=/[^.]+$/.exec(A&&A.keys&&A.keys.IE_PROTO||""))?"Symbol(src)_1."+q:"";var E=Function.prototype.toString;function O(r){if(null!=r){try{return E.call(r)}catch(r){}try{return r+""}catch(r){}}return""}var k=/^\[object .+?Constructor\]$/,N=Function.prototype,I=Object.prototype,z=N.toString,F=I.hasOwnProperty,T=RegExp("^"+z.call(F).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function $(r){return!(!w(r)||(t=r,S&&S in t))&&(P(r)?T:k).test(O(r));var t}function R(r,t){var n=function(r,t){return null==r?void 0:r[t]}(r,t);return $(n)?n:void 0}var C=R(l,"DataView"),D=R(l,"Map"),L=R(l,"Promise"),U=R(l,"Set"),B=R(l,"WeakMap"),G="[object Map]",V="[object Promise]",W="[object Set]",X="[object WeakMap]",Y="[object DataView]",H=O(C),Q=O(D),K=O(L),Z=O(U),J=O(B),rr=y;(C&&rr(new C(new ArrayBuffer(1)))!=Y||D&&rr(new D)!=G||L&&rr(L.resolve())!=V||U&&rr(new U)!=W||B&&rr(new B)!=X)&&(rr=function(r){var t=y(r),n="[object Object]"==t?r.constructor:void 0,e=n?O(n):"";if(e)switch(e){case H:return Y;case Q:return G;case K:return V;case Z:return W;case J:return X}return t});var tr=rr,nr=9007199254740991;function er(r){return"number"==typeof r&&r>-1&&r%1==0&&r<=nr}function or(r){return null!=r&&er(r.length)&&!P(r)}var ar=Array.isArray;function ir(r){return null!=r&&"object"==typeof r}var ur="[object String]";function fr(r){return function(t){return null==t?void 0:t[r]}}var lr=fr("length"),cr=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var sr="\\ud800-\\udfff",pr="["+sr+"]",hr="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",mr="\\ud83c[\\udffb-\\udfff]",vr="[^"+sr+"]",dr="(?:\\ud83c[\\udde6-\\uddff]){2}",gr="[\\ud800-\\udbff][\\udc00-\\udfff]",br="(?:"+hr+"|"+mr+")"+"?",yr="[\\ufe0e\\ufe0f]?",wr=yr+br+("(?:\\u200d(?:"+[vr,dr,gr].join("|")+")"+yr+br+")*"),jr="(?:"+[vr+hr+"?",hr,dr,gr,pr].join("|")+")",xr=RegExp(mr+"(?="+mr+")|"+jr+wr,"g");function _r(r){return function(r){return cr.test(r)}(r)?function(r){for(var t=xr.lastIndex=0;xr.test(r);)++t;return t}(r):lr(r)}var Mr="[object Map]",Pr="[object Set]";function qr(r){if(null==r)return 0;if(or(r))return"string"==typeof(t=r)||!ar(t)&&ir(t)&&y(t)==ur?_r(r):r.length;var t,n=tr(r);return n==Mr||n==Pr?r.size:i(r).length}function Ar(r,t){for(var n,e=-1,o=r.length;++e<o;){var a=t(r[e]);void 0!==a&&(n=void 0===n?a:n+a)}return n}var Sr=NaN;function Er(r){return r}function Or(r){return function(r,t){var n=null==r?0:r.length;return n?Ar(r,t)/n:Sr}(r,Er)}function kr(r){return"[object Array]"===Object.prototype.toString.call(r)}function Nr(r,t){for(var n=-1,e=null==r?0:r.length,o=Array(e);++n<e;)o[n]=t(r[n],n,r);return o}function Ir(r,t){return r===t||r!=r&&t!=t}function zr(r,t){for(var n=r.length;n--;)if(Ir(r[n][0],t))return n;return-1}var Fr=Array.prototype.splice;function Tr(r){var t=-1,n=null==r?0:r.length;for(this.clear();++t<n;){var e=r[t];this.set(e[0],e[1])}}Tr.prototype.clear=function(){this.__data__=[],this.size=0},Tr.prototype.delete=function(r){var t=this.__data__,n=zr(t,r);return!(n<0)&&(n==t.length-1?t.pop():Fr.call(t,n,1),--this.size,!0)},Tr.prototype.get=function(r){var t=this.__data__,n=zr(t,r);return n<0?void 0:t[n][1]},Tr.prototype.has=function(r){return zr(this.__data__,r)>-1},Tr.prototype.set=function(r,t){var n=this.__data__,e=zr(n,r);return e<0?(++this.size,n.push([r,t])):n[e][1]=t,this};var $r=R(Object,"create");var Rr=Object.prototype.hasOwnProperty;var Cr=Object.prototype.hasOwnProperty;function Dr(r){var t=-1,n=null==r?0:r.length;for(this.clear();++t<n;){var e=r[t];this.set(e[0],e[1])}}function Lr(r,t){var n,e,o=r.__data__;return("string"==(e=typeof(n=t))||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==n:null===n)?o["string"==typeof t?"string":"hash"]:o.map}function Ur(r){var t=-1,n=null==r?0:r.length;for(this.clear();++t<n;){var e=r[t];this.set(e[0],e[1])}}Dr.prototype.clear=function(){this.__data__=$r?$r(null):{},this.size=0},Dr.prototype.delete=function(r){var t=this.has(r)&&delete this.__data__[r];return this.size-=t?1:0,t},Dr.prototype.get=function(r){var t=this.__data__;if($r){var n=t[r];return"__lodash_hash_undefined__"===n?void 0:n}return Rr.call(t,r)?t[r]:void 0},Dr.prototype.has=function(r){var t=this.__data__;return $r?void 0!==t[r]:Cr.call(t,r)},Dr.prototype.set=function(r,t){var n=this.__data__;return this.size+=this.has(r)?0:1,n[r]=$r&&void 0===t?"__lodash_hash_undefined__":t,this},Ur.prototype.clear=function(){this.size=0,this.__data__={hash:new Dr,map:new(D||Tr),string:new Dr}},Ur.prototype.delete=function(r){var t=Lr(this,r).delete(r);return this.size-=t?1:0,t},Ur.prototype.get=function(r){return Lr(this,r).get(r)},Ur.prototype.has=function(r){return Lr(this,r).has(r)},Ur.prototype.set=function(r,t){var n=Lr(this,r),e=n.size;return n.set(r,t),this.size+=n.size==e?0:1,this};function Br(r){var t=this.__data__=new Tr(r);this.size=t.size}Br.prototype.clear=function(){this.__data__=new Tr,this.size=0},Br.prototype.delete=function(r){var t=this.__data__,n=t.delete(r);return this.size=t.size,n},Br.prototype.get=function(r){return this.__data__.get(r)},Br.prototype.has=function(r){return this.__data__.has(r)},Br.prototype.set=function(r,t){var n=this.__data__;if(n instanceof Tr){var e=n.__data__;if(!D||e.length<199)return e.push([r,t]),this.size=++n.size,this;n=this.__data__=new Ur(e)}return n.set(r,t),this.size=n.size,this};function Gr(r){var t=-1,n=null==r?0:r.length;for(this.__data__=new Ur;++t<n;)this.add(r[t])}function Vr(r,t){for(var n=-1,e=null==r?0:r.length;++n<e;)if(t(r[n],n,r))return!0;return!1}Gr.prototype.add=Gr.prototype.push=function(r){return this.__data__.set(r,"__lodash_hash_undefined__"),this},Gr.prototype.has=function(r){return this.__data__.has(r)};var Wr=1,Xr=2;function Yr(r,t,n,e,o,a){var i=n&Wr,u=r.length,f=t.length;if(u!=f&&!(i&&f>u))return!1;var l=a.get(r),c=a.get(t);if(l&&c)return l==t&&c==r;var s=-1,p=!0,h=n&Xr?new Gr:void 0;for(a.set(r,t),a.set(t,r);++s<u;){var m=r[s],v=t[s];if(e)var d=i?e(v,m,s,t,r,a):e(m,v,s,r,t,a);if(void 0!==d){if(d)continue;p=!1;break}if(h){if(!Vr(t,(function(r,t){if(i=t,!h.has(i)&&(m===r||o(m,r,n,e,a)))return h.push(t);var i}))){p=!1;break}}else if(m!==v&&!o(m,v,n,e,a)){p=!1;break}}return a.delete(r),a.delete(t),p}var Hr=l.Uint8Array;function Qr(r){var t=-1,n=Array(r.size);return r.forEach((function(r,e){n[++t]=[e,r]})),n}function Kr(r){var t=-1,n=Array(r.size);return r.forEach((function(r){n[++t]=r})),n}var Zr=1,Jr=2,rt="[object Boolean]",tt="[object Date]",nt="[object Error]",et="[object Map]",ot="[object Number]",at="[object RegExp]",it="[object Set]",ut="[object String]",ft="[object Symbol]",lt="[object ArrayBuffer]",ct="[object DataView]",st=c?c.prototype:void 0,pt=st?st.valueOf:void 0;function ht(r,t){for(var n=-1,e=t.length,o=r.length;++n<e;)r[o+n]=t[n];return r}function mt(r,t,n){var e=t(r);return ar(r)?e:ht(e,n(r))}function vt(r,t){for(var n=-1,e=null==r?0:r.length,o=0,a=[];++n<e;){var i=r[n];t(i,n,r)&&(a[o++]=i)}return a}function dt(){return[]}var gt=Object.prototype.propertyIsEnumerable,bt=Object.getOwnPropertySymbols,yt=bt?function(r){return null==r?[]:(r=Object(r),vt(bt(r),(function(t){return gt.call(r,t)})))}:dt;function wt(r,t){for(var n=-1,e=Array(r);++n<r;)e[n]=t(n);return e}function jt(r){return ir(r)&&"[object Arguments]"==y(r)}var xt=Object.prototype,_t=xt.hasOwnProperty,Mt=xt.propertyIsEnumerable,Pt=jt(function(){return arguments}())?jt:function(r){return ir(r)&&_t.call(r,"callee")&&!Mt.call(r,"callee")},qt=Pt;var At="object"==typeof r&&r&&!r.nodeType&&r,St=At&&"object"==typeof module&&module&&!module.nodeType&&module,Et=St&&St.exports===At?l.Buffer:void 0,Ot=(Et?Et.isBuffer:void 0)||function(){return!1},kt=9007199254740991,Nt=/^(?:0|[1-9]\d*)$/;function It(r,t){var n=typeof r;return!!(t=null==t?kt:t)&&("number"==n||"symbol"!=n&&Nt.test(r))&&r>-1&&r%1==0&&r<t}var zt={};function Ft(r){return function(t){return r(t)}}zt["[object Float32Array]"]=zt["[object Float64Array]"]=zt["[object Int8Array]"]=zt["[object Int16Array]"]=zt["[object Int32Array]"]=zt["[object Uint8Array]"]=zt["[object Uint8ClampedArray]"]=zt["[object Uint16Array]"]=zt["[object Uint32Array]"]=!0,zt["[object Arguments]"]=zt["[object Array]"]=zt["[object ArrayBuffer]"]=zt["[object Boolean]"]=zt["[object DataView]"]=zt["[object Date]"]=zt["[object Error]"]=zt["[object Function]"]=zt["[object Map]"]=zt["[object Number]"]=zt["[object Object]"]=zt["[object RegExp]"]=zt["[object Set]"]=zt["[object String]"]=zt["[object WeakMap]"]=!1;var Tt="object"==typeof r&&r&&!r.nodeType&&r,$t=Tt&&"object"==typeof module&&module&&!module.nodeType&&module,Rt=$t&&$t.exports===Tt&&u.process,Ct=function(){try{var r=$t&&$t.require&&$t.require("util").types;return r||Rt&&Rt.binding&&Rt.binding("util")}catch(r){}}(),Dt=Ct&&Ct.isTypedArray,Lt=Dt?Ft(Dt):function(r){return ir(r)&&er(r.length)&&!!zt[y(r)]},Ut=Object.prototype.hasOwnProperty;function Bt(r,t){var n=ar(r),e=!n&&qt(r),o=!n&&!e&&Ot(r),a=!n&&!e&&!o&&Lt(r),i=n||e||o||a,u=i?wt(r.length,String):[],f=u.length;for(var l in r)!t&&!Ut.call(r,l)||i&&("length"==l||o&&("offset"==l||"parent"==l)||a&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||It(l,f))||u.push(l);return u}function Gt(r){return or(r)?Bt(r):i(r)}function Vt(r){return mt(r,Gt,yt)}var Wt=1,Xt=Object.prototype.hasOwnProperty;var Yt=1,Ht="[object Arguments]",Qt="[object Array]",Kt="[object Object]",Zt=Object.prototype.hasOwnProperty;function Jt(r,t,n,e,o,a){var i=ar(r),u=ar(t),f=i?Qt:tr(r),l=u?Qt:tr(t),c=(f=f==Ht?Kt:f)==Kt,s=(l=l==Ht?Kt:l)==Kt,p=f==l;if(p&&Ot(r)){if(!Ot(t))return!1;i=!0,c=!1}if(p&&!c)return a||(a=new Br),i||Lt(r)?Yr(r,t,n,e,o,a):function(r,t,n,e,o,a,i){switch(n){case ct:if(r.byteLength!=t.byteLength||r.byteOffset!=t.byteOffset)return!1;r=r.buffer,t=t.buffer;case lt:return!(r.byteLength!=t.byteLength||!a(new Hr(r),new Hr(t)));case rt:case tt:case ot:return Ir(+r,+t);case nt:return r.name==t.name&&r.message==t.message;case at:case ut:return r==t+"";case et:var u=Qr;case it:var f=e&Zr;if(u||(u=Kr),r.size!=t.size&&!f)return!1;var l=i.get(r);if(l)return l==t;e|=Jr,i.set(r,t);var c=Yr(u(r),u(t),e,o,a,i);return i.delete(r),c;case ft:if(pt)return pt.call(r)==pt.call(t)}return!1}(r,t,f,n,e,o,a);if(!(n&Yt)){var h=c&&Zt.call(r,"__wrapped__"),m=s&&Zt.call(t,"__wrapped__");if(h||m){var v=h?r.value():r,d=m?t.value():t;return a||(a=new Br),o(v,d,n,e,a)}}return!!p&&(a||(a=new Br),function(r,t,n,e,o,a){var i=n&Wt,u=Vt(r),f=u.length;if(f!=Vt(t).length&&!i)return!1;for(var l=f;l--;){var c=u[l];if(!(i?c in t:Xt.call(t,c)))return!1}var s=a.get(r),p=a.get(t);if(s&&p)return s==t&&p==r;var h=!0;a.set(r,t),a.set(t,r);for(var m=i;++l<f;){var v=r[c=u[l]],d=t[c];if(e)var g=i?e(d,v,c,t,r,a):e(v,d,c,r,t,a);if(!(void 0===g?v===d||o(v,d,n,e,a):g)){h=!1;break}m||(m="constructor"==c)}if(h&&!m){var b=r.constructor,y=t.constructor;b==y||!("constructor"in r)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof y&&y instanceof y||(h=!1)}return a.delete(r),a.delete(t),h}(r,t,n,e,o,a))}function rn(r,t,n,e,o){return r===t||(null==r||null==t||!ir(r)&&!ir(t)?r!=r&&t!=t:Jt(r,t,n,e,rn,o))}var tn=1,nn=2;function en(r){return r==r&&!w(r)}function on(r,t){return function(n){return null!=n&&(n[r]===t&&(void 0!==t||r in Object(n)))}}function an(r){var t=function(r){for(var t=Gt(r),n=t.length;n--;){var e=t[n],o=r[e];t[n]=[e,o,en(o)]}return t}(r);return 1==t.length&&t[0][2]?on(t[0][0],t[0][1]):function(n){return n===r||function(r,t,n,e){var o=n.length,a=o,i=!e;if(null==r)return!a;for(r=Object(r);o--;){var u=n[o];if(i&&u[2]?u[1]!==r[u[0]]:!(u[0]in r))return!1}for(;++o<a;){var f=(u=n[o])[0],l=r[f],c=u[1];if(i&&u[2]){if(void 0===l&&!(f in r))return!1}else{var s=new Br;if(e)var p=e(l,c,f,r,t,s);if(!(void 0===p?rn(c,l,tn|nn,e,s):p))return!1}}return!0}(n,r,t)}}var un="[object Symbol]";function fn(r){return"symbol"==typeof r||ir(r)&&y(r)==un}var ln=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,cn=/^\w*$/;function sn(r,t){if(ar(r))return!1;var n=typeof r;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=r&&!fn(r))||(cn.test(r)||!ln.test(r)||null!=t&&r in Object(t))}var pn="Expected a function";function hn(r,t){if("function"!=typeof r||null!=t&&"function"!=typeof t)throw new TypeError(pn);var n=function(){var e=arguments,o=t?t.apply(this,e):e[0],a=n.cache;if(a.has(o))return a.get(o);var i=r.apply(this,e);return n.cache=a.set(o,i)||a,i};return n.cache=new(hn.Cache||Ur),n}hn.Cache=Ur;var mn,vn,dn,gn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,bn=/\\(\\)?/g,yn=(mn=function(r){var t=[];return 46===r.charCodeAt(0)&&t.push(""),r.replace(gn,(function(r,n,e,o){t.push(e?o.replace(bn,"$1"):n||r)})),t},vn=hn(mn,(function(r){return 500===dn.size&&dn.clear(),r})),dn=vn.cache,vn),wn=yn,jn=1/0,xn=c?c.prototype:void 0,_n=xn?xn.toString:void 0;function Mn(r){if("string"==typeof r)return r;if(ar(r))return Nr(r,Mn)+"";if(fn(r))return _n?_n.call(r):"";var t=r+"";return"0"==t&&1/r==-jn?"-0":t}function Pn(r){return null==r?"":Mn(r)}function qn(r,t){return ar(r)?r:sn(r,t)?[r]:wn(Pn(r))}var An=1/0;function Sn(r){if("string"==typeof r||fn(r))return r;var t=r+"";return"0"==t&&1/r==-An?"-0":t}function En(r,t){for(var n=0,e=(t=qn(t,r)).length;null!=r&&n<e;)r=r[Sn(t[n++])];return n&&n==e?r:void 0}function On(r,t,n){var e=null==r?void 0:En(r,t);return void 0===e?n:e}function kn(r,t){return null!=r&&t in Object(r)}function Nn(r,t){return null!=r&&function(r,t,n){for(var e=-1,o=(t=qn(t,r)).length,a=!1;++e<o;){var i=Sn(t[e]);if(!(a=null!=r&&n(r,i)))break;r=r[i]}return a||++e!=o?a:!!(o=null==r?0:r.length)&&er(o)&&It(i,o)&&(ar(r)||qt(r))}(r,t,kn)}var In=1,zn=2;function Fn(r){return sn(r)?fr(Sn(r)):function(r){return function(t){return En(t,r)}}(r)}function Tn(r){return"function"==typeof r?r:null==r?Er:"object"==typeof r?ar(r)?(t=r[0],n=r[1],sn(t)&&en(n)?on(Sn(t),n):function(r){var e=On(r,t);return void 0===e&&e===n?Nn(r,t):rn(n,e,In|zn)}):an(r):Fn(r);var t,n}var $n,Rn=function(r,t,n){for(var e=-1,o=Object(r),a=n(r),i=a.length;i--;){var u=a[$n?i:++e];if(!1===t(o[u],u,o))break}return r};var Cn=function(r,t){return function(n,e){if(null==n)return n;if(!or(n))return r(n,e);for(var o=n.length,a=t?o:-1,i=Object(n);(t?a--:++a<o)&&!1!==e(i[a],a,i););return n}}((function(r,t){return r&&Rn(r,t,Gt)})),Dn=Cn;function Ln(r,t){var n=-1,e=or(r)?Array(r.length):[];return Dn(r,(function(r,o,a){e[++n]=t(r,o,a)})),e}function Un(r,t){return(ar(r)?Nr:Ln)(r,Tn(t))}function Bn(r,t){var n=[];return Dn(r,(function(r,e,o){t(r,e,o)&&n.push(r)})),n}function Gn(r,t){return(ar(r)?vt:Bn)(r,Tn(t))}function Vn(r,t){for(var n=-1,e=null==r?0:r.length;++n<e&&!1!==t(r[n],n,r););return r}var Wn=function(){try{var r=R(Object,"defineProperty");return r({},"",{}),r}catch(r){}}(),Xn=Wn;function Yn(r,t,n){"__proto__"==t&&Xn?Xn(r,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):r[t]=n}var Hn=Object.prototype.hasOwnProperty;function Qn(r,t,n){var e=r[t];Hn.call(r,t)&&Ir(e,n)&&(void 0!==n||t in r)||Yn(r,t,n)}function Kn(r,t,n,e){var o=!n;n||(n={});for(var a=-1,i=t.length;++a<i;){var u=t[a],f=e?e(n[u],r[u],u,n,r):void 0;void 0===f&&(f=r[u]),o?Yn(n,u,f):Qn(n,u,f)}return n}var Zn=Object.prototype.hasOwnProperty;function Jn(r){if(!w(r))return function(r){var t=[];if(null!=r)for(var n in Object(r))t.push(n);return t}(r);var t=n(r),e=[];for(var o in r)("constructor"!=o||!t&&Zn.call(r,o))&&e.push(o);return e}function re(r){return or(r)?Bt(r,!0):Jn(r)}var te="object"==typeof r&&r&&!r.nodeType&&r,ne=te&&"object"==typeof module&&module&&!module.nodeType&&module,ee=ne&&ne.exports===te?l.Buffer:void 0,oe=ee?ee.allocUnsafe:void 0;var ae=e(Object.getPrototypeOf,Object),ie=Object.getOwnPropertySymbols?function(r){for(var t=[];r;)ht(t,yt(r)),r=ae(r);return t}:dt,ue=ie;function fe(r){return mt(r,re,ue)}var le=Object.prototype.hasOwnProperty;function ce(r){var t=new r.constructor(r.byteLength);return new Hr(t).set(new Hr(r)),t}var se=/\w*$/;var pe=c?c.prototype:void 0,he=pe?pe.valueOf:void 0;var me="[object Boolean]",ve="[object Date]",de="[object Map]",ge="[object Number]",be="[object RegExp]",ye="[object Set]",we="[object String]",je="[object Symbol]",xe="[object ArrayBuffer]",_e="[object DataView]",Me="[object Float32Array]",Pe="[object Float64Array]",qe="[object Int8Array]",Ae="[object Int16Array]",Se="[object Int32Array]",Ee="[object Uint8Array]",Oe="[object Uint8ClampedArray]",ke="[object Uint16Array]",Ne="[object Uint32Array]";function Ie(r,t,n){var e,o=r.constructor;switch(t){case xe:return ce(r);case me:case ve:return new o(+r);case _e:return function(r,t){var n=t?ce(r.buffer):r.buffer;return new r.constructor(n,r.byteOffset,r.byteLength)}(r,n);case Me:case Pe:case qe:case Ae:case Se:case Ee:case Oe:case ke:case Ne:return function(r,t){var n=t?ce(r.buffer):r.buffer;return new r.constructor(n,r.byteOffset,r.length)}(r,n);case de:return new o;case ge:case we:return new o(r);case be:return function(r){var t=new r.constructor(r.source,se.exec(r));return t.lastIndex=r.lastIndex,t}(r);case ye:return new o;case je:return e=r,he?Object(he.call(e)):{}}}var ze=Object.create,Fe=function(){function r(){}return function(t){if(!w(t))return{};if(ze)return ze(t);r.prototype=t;var n=new r;return r.prototype=void 0,n}}(),Te=Fe;var $e=Ct&&Ct.isMap,Re=$e?Ft($e):function(r){return ir(r)&&"[object Map]"==tr(r)};var Ce=Ct&&Ct.isSet,De=Ce?Ft(Ce):function(r){return ir(r)&&"[object Set]"==tr(r)},Le=1,Ue=2,Be=4,Ge="[object Arguments]",Ve="[object Function]",We="[object GeneratorFunction]",Xe="[object Object]",Ye={};function He(r,t,e,o,a,i){var u,f=t&Le,l=t&Ue,c=t&Be;if(e&&(u=a?e(r,o,a,i):e(r)),void 0!==u)return u;if(!w(r))return r;var s=ar(r);if(s){if(u=function(r){var t=r.length,n=new r.constructor(t);return t&&"string"==typeof r[0]&&le.call(r,"index")&&(n.index=r.index,n.input=r.input),n}(r),!f)return function(r,t){var n=-1,e=r.length;for(t||(t=Array(e));++n<e;)t[n]=r[n];return t}(r,u)}else{var p=tr(r),h=p==Ve||p==We;if(Ot(r))return function(r,t){if(t)return r.slice();var n=r.length,e=oe?oe(n):new r.constructor(n);return r.copy(e),e}(r,f);if(p==Xe||p==Ge||h&&!a){if(u=l||h?{}:function(r){return"function"!=typeof r.constructor||n(r)?{}:Te(ae(r))}(r),!f)return l?function(r,t){return Kn(r,ue(r),t)}(r,function(r,t){return r&&Kn(t,re(t),r)}(u,r)):function(r,t){return Kn(r,yt(r),t)}(r,function(r,t){return r&&Kn(t,Gt(t),r)}(u,r))}else{if(!Ye[p])return a?r:{};u=Ie(r,p,f)}}i||(i=new Br);var m=i.get(r);if(m)return m;i.set(r,u),De(r)?r.forEach((function(n){u.add(He(n,t,e,n,r,i))})):Re(r)&&r.forEach((function(n,o){u.set(o,He(n,t,e,o,r,i))}));var v=s?void 0:(c?l?fe:Vt:l?re:Gt)(r);return Vn(v||r,(function(n,o){v&&(n=r[o=n]),Qn(u,o,He(n,t,e,o,r,i))})),u}Ye[Ge]=Ye["[object Array]"]=Ye["[object ArrayBuffer]"]=Ye["[object DataView]"]=Ye["[object Boolean]"]=Ye["[object Date]"]=Ye["[object Float32Array]"]=Ye["[object Float64Array]"]=Ye["[object Int8Array]"]=Ye["[object Int16Array]"]=Ye["[object Int32Array]"]=Ye["[object Map]"]=Ye["[object Number]"]=Ye[Xe]=Ye["[object RegExp]"]=Ye["[object Set]"]=Ye["[object String]"]=Ye["[object Symbol]"]=Ye["[object Uint8Array]"]=Ye["[object Uint8ClampedArray]"]=Ye["[object Uint16Array]"]=Ye["[object Uint32Array]"]=!0,Ye["[object Error]"]=Ye[Ve]=Ye["[object WeakMap]"]=!1;var Qe=1,Ke=4;function Ze(r){return He(r,Qe|Ke)}function Je(r){return"[object Object]"===Object.prototype.toString.call(r)}function ro(r){return"[object String]"===Object.prototype.toString.call(r)}function to(r){return r!=r}function no(r){return!!function(r){return"[object Undefined]"===Object.prototype.toString.call(r)}(r)||(!!function(r){return"[object Null]"===Object.prototype.toString.call(r)}(r)||(!!function(r){if(Je(r)){for(let t in r)return!1;return!0}return!1}(r)||(!!function(r){return!(!ro(r)||""!==r)}(r)||(!!function(r){return!!kr(r)&&0===r.length}(r)||!!to(r)))))}function eo(r){return!!kr(r)&&(0!==r.length&&(1!==r.length||!no(r[0])))}function oo(r){return!(!ro(r)||""===r)}function ao(r){let t=!1;if(oo(r))t=!isNaN(Number(r));else if(function(r){return"[object Number]"===Object.prototype.toString.call(r)}(r)){if(to(r))return!1;t=!0}return t}var io=/\s/;var uo=/^\s+/;function fo(r){return r?r.slice(0,function(r){for(var t=r.length;t--&&io.test(r.charAt(t)););return t}(r)+1).replace(uo,""):r}var lo=NaN,co=/^[-+]0x[0-9a-f]+$/i,so=/^0b[01]+$/i,po=/^0o[0-7]+$/i,ho=parseInt;function mo(r){if("number"==typeof r)return r;if(fn(r))return lo;if(w(r)){var t="function"==typeof r.valueOf?r.valueOf():r;r=w(t)?t+"":t}if("string"!=typeof r)return 0===r?r:+r;r=fo(r);var n=so.test(r);return n||po.test(r)?ho(r.slice(2),n?2:8):co.test(r)?lo:+r}var vo=1/0,go=17976931348623157e292;function bo(r){return r?(r=mo(r))===vo||r===-vo?(r<0?-1:1)*go:r==r?r:0:0===r?r:0}function yo(r){if(!ao(r))return 0;return bo(r)}function wo(r){return eo(r)?r=Un(r=Gn(r=Ze(r),ao),yo):[]}function jo(r){if(!kr(r))return null;if(0===qr(r))return null;let t=wo(r);return 0===qr(t)?null:Or(t)}function xo(r){if(!ao(r))return!1;return yo(r)>0}function _o(r){return eo(r)?r=Un(r=Gn(r=Ze(r),xo),yo):[]}function Mo(r){return eo(r)?r=Un(r=_o(r),Math.log):[]}var Po="[object Number]";function qo(r){return"number"==typeof r||ir(r)&&y(r)==Po}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var Ao={};!function(r,t){r.exports=function(){var r=function(r,t){var n=Array.prototype.concat,e=Array.prototype.slice,o=Object.prototype.toString;function a(t,n){var e=t>n?t:n;return r.pow(10,17-~~(r.log(e>0?e:-e)*r.LOG10E))}var i=Array.isArray||function(r){return"[object Array]"===o.call(r)};function u(r){return"[object Function]"===o.call(r)}function f(r){return"number"==typeof r&&r-r==0}function l(r){return n.apply([],r)}function c(){return new c._init(arguments)}function s(){return 0}function p(){return 1}function h(r,t){return r===t?1:0}c.fn=c.prototype,c._init=function(r){if(i(r[0]))if(i(r[0][0])){u(r[1])&&(r[0]=c.map(r[0],r[1]));for(var t=0;t<r[0].length;t++)this[t]=r[0][t];this.length=r[0].length}else this[0]=u(r[1])?c.map(r[0],r[1]):r[0],this.length=1;else if(f(r[0]))this[0]=c.seq.apply(null,r),this.length=1;else{if(r[0]instanceof c)return c(r[0].toArray());this[0]=[],this.length=1}return this},c._init.prototype=c.prototype,c._init.constructor=c,c.utils={calcRdx:a,isArray:i,isFunction:u,isNumber:f,toVector:l},c._random_fn=r.random,c.setRandom=function(r){if("function"!=typeof r)throw new TypeError("fn is not a function");c._random_fn=r},c.extend=function(r){var t,n;if(1===arguments.length){for(n in r)c[n]=r[n];return this}for(t=1;t<arguments.length;t++)for(n in arguments[t])r[n]=arguments[t][n];return r},c.rows=function(r){return r.length||1},c.cols=function(r){return r[0].length||1},c.dimensions=function(r){return{rows:c.rows(r),cols:c.cols(r)}},c.row=function(r,t){return i(t)?t.map((function(t){return c.row(r,t)})):r[t]},c.rowa=function(r,t){return c.row(r,t)},c.col=function(r,t){if(i(t)){var n=c.arange(r.length).map((function(){return new Array(t.length)}));return t.forEach((function(t,e){c.arange(r.length).forEach((function(o){n[o][e]=r[o][t]}))})),n}for(var e=new Array(r.length),o=0;o<r.length;o++)e[o]=[r[o][t]];return e},c.cola=function(r,t){return c.col(r,t).map((function(r){return r[0]}))},c.diag=function(r){for(var t=c.rows(r),n=new Array(t),e=0;e<t;e++)n[e]=[r[e][e]];return n},c.antidiag=function(r){for(var t=c.rows(r)-1,n=new Array(t),e=0;t>=0;t--,e++)n[e]=[r[e][t]];return n},c.transpose=function(r){var t,n,e,o,a,u=[];for(i(r[0])||(r=[r]),n=r.length,e=r[0].length,a=0;a<e;a++){for(t=new Array(n),o=0;o<n;o++)t[o]=r[o][a];u.push(t)}return 1===u.length?u[0]:u},c.map=function(r,t,n){var e,o,a,u,f;for(i(r[0])||(r=[r]),o=r.length,a=r[0].length,u=n?r:new Array(o),e=0;e<o;e++)for(u[e]||(u[e]=new Array(a)),f=0;f<a;f++)u[e][f]=t(r[e][f],e,f);return 1===u.length?u[0]:u},c.cumreduce=function(r,t,n){var e,o,a,u,f;for(i(r[0])||(r=[r]),o=r.length,a=r[0].length,u=n?r:new Array(o),e=0;e<o;e++)for(u[e]||(u[e]=new Array(a)),a>0&&(u[e][0]=r[e][0]),f=1;f<a;f++)u[e][f]=t(u[e][f-1],r[e][f]);return 1===u.length?u[0]:u},c.alter=function(r,t){return c.map(r,t,!0)},c.create=function(r,t,n){var e,o,a=new Array(r);for(u(t)&&(n=t,t=r),e=0;e<r;e++)for(a[e]=new Array(t),o=0;o<t;o++)a[e][o]=n(e,o);return a},c.zeros=function(r,t){return f(t)||(t=r),c.create(r,t,s)},c.ones=function(r,t){return f(t)||(t=r),c.create(r,t,p)},c.rand=function(r,t){return f(t)||(t=r),c.create(r,t,c._random_fn)},c.identity=function(r,t){return f(t)||(t=r),c.create(r,t,h)},c.symmetric=function(r){var t,n,e=r.length;if(r.length!==r[0].length)return!1;for(t=0;t<e;t++)for(n=0;n<e;n++)if(r[n][t]!==r[t][n])return!1;return!0},c.clear=function(r){return c.alter(r,s)},c.seq=function(r,t,n,e){u(e)||(e=!1);var o,i=[],f=a(r,t),l=(t*f-r*f)/((n-1)*f),c=r;for(o=0;c<=t&&o<n;c=(r*f+l*f*++o)/f)i.push(e?e(c,o):c);return i},c.arange=function(r,n,e){var o,a=[];if(e=e||1,n===t&&(n=r,r=0),r===n||0===e)return[];if(r<n&&e<0)return[];if(r>n&&e>0)return[];if(e>0)for(o=r;o<n;o+=e)a.push(o);else for(o=r;o>n;o+=e)a.push(o);return a},c.slice=function(){function r(r,n,e,o){var a,i=[],u=r.length;if(n===t&&e===t&&o===t)return c.copy(r);if(o=o||1,(n=(n=n||0)>=0?n:u+n)===(e=(e=e||r.length)>=0?e:u+e)||0===o)return[];if(n<e&&o<0)return[];if(n>e&&o>0)return[];if(o>0)for(a=n;a<e;a+=o)i.push(r[a]);else for(a=n;a>e;a+=o)i.push(r[a]);return i}function n(t,n){var e,o;return f((n=n||{}).row)?f(n.col)?t[n.row][n.col]:r(c.rowa(t,n.row),(e=n.col||{}).start,e.end,e.step):f(n.col)?r(c.cola(t,n.col),(o=n.row||{}).start,o.end,o.step):(o=n.row||{},e=n.col||{},r(t,o.start,o.end,o.step).map((function(t){return r(t,e.start,e.end,e.step)})))}return n}(),c.sliceAssign=function(n,e,o){var a,i;if(f(e.row)){if(f(e.col))return n[e.row][e.col]=o;e.col=e.col||{},e.col.start=e.col.start||0,e.col.end=e.col.end||n[0].length,e.col.step=e.col.step||1,a=c.arange(e.col.start,r.min(n.length,e.col.end),e.col.step);var u=e.row;return a.forEach((function(r,t){n[u][r]=o[t]})),n}if(f(e.col)){e.row=e.row||{},e.row.start=e.row.start||0,e.row.end=e.row.end||n.length,e.row.step=e.row.step||1,i=c.arange(e.row.start,r.min(n[0].length,e.row.end),e.row.step);var l=e.col;return i.forEach((function(r,t){n[r][l]=o[t]})),n}return o[0].length===t&&(o=[o]),e.row.start=e.row.start||0,e.row.end=e.row.end||n.length,e.row.step=e.row.step||1,e.col.start=e.col.start||0,e.col.end=e.col.end||n[0].length,e.col.step=e.col.step||1,i=c.arange(e.row.start,r.min(n.length,e.row.end),e.row.step),a=c.arange(e.col.start,r.min(n[0].length,e.col.end),e.col.step),i.forEach((function(r,t){a.forEach((function(e,a){n[r][e]=o[t][a]}))})),n},c.diagonal=function(r){var t=c.zeros(r.length,r.length);return r.forEach((function(r,n){t[n][n]=r})),t},c.copy=function(r){return r.map((function(r){return f(r)?r:r.map((function(r){return r}))}))};var m=c.prototype;return m.length=0,m.push=Array.prototype.push,m.sort=Array.prototype.sort,m.splice=Array.prototype.splice,m.slice=Array.prototype.slice,m.toArray=function(){return this.length>1?e.call(this):e.call(this)[0]},m.map=function(r,t){return c(c.map(this,r,t))},m.cumreduce=function(r,t){return c(c.cumreduce(this,r,t))},m.alter=function(r){return c.alter(this,r),this},function(r){for(var t=0;t<r.length;t++)!function(r){m[r]=function(t){var n,e=this;return t?(setTimeout((function(){t.call(e,m[r].call(e))})),this):(n=c[r](this),i(n)?c(n):n)}}(r[t])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(r){for(var t=0;t<r.length;t++)!function(r){m[r]=function(t,n){var e=this;return n?(setTimeout((function(){n.call(e,m[r].call(e,t))})),this):c(c[r](this,t))}}(r[t])}("row col".split(" ")),function(r){for(var t=0;t<r.length;t++)!function(r){m[r]=function(){return c(c[r].apply(null,arguments))}}(r[t])}("create zeros ones rand identity".split(" ")),c}(Math);return function(r,t){var n=r.utils.isFunction;function e(r,t){return r-t}function o(r,n,e){return t.max(n,t.min(r,e))}r.sum=function(r){for(var t=0,n=r.length;--n>=0;)t+=r[n];return t},r.sumsqrd=function(r){for(var t=0,n=r.length;--n>=0;)t+=r[n]*r[n];return t},r.sumsqerr=function(t){for(var n,e=r.mean(t),o=0,a=t.length;--a>=0;)o+=(n=t[a]-e)*n;return o},r.sumrow=function(r){for(var t=0,n=r.length;--n>=0;)t+=r[n];return t},r.product=function(r){for(var t=1,n=r.length;--n>=0;)t*=r[n];return t},r.min=function(r){for(var t=r[0],n=0;++n<r.length;)r[n]<t&&(t=r[n]);return t},r.max=function(r){for(var t=r[0],n=0;++n<r.length;)r[n]>t&&(t=r[n]);return t},r.unique=function(r){for(var t={},n=[],e=0;e<r.length;e++)t[r[e]]||(t[r[e]]=!0,n.push(r[e]));return n},r.mean=function(t){return r.sum(t)/t.length},r.meansqerr=function(t){return r.sumsqerr(t)/t.length},r.geomean=function(n){var e=n.map(t.log),o=r.mean(e);return t.exp(o)},r.median=function(r){var t=r.length,n=r.slice().sort(e);return 1&t?n[t/2|0]:(n[t/2-1]+n[t/2])/2},r.cumsum=function(t){return r.cumreduce(t,(function(r,t){return r+t}))},r.cumprod=function(t){return r.cumreduce(t,(function(r,t){return r*t}))},r.diff=function(r){var t,n=[],e=r.length;for(t=1;t<e;t++)n.push(r[t]-r[t-1]);return n},r.rank=function(r){var t,n=[],o={};for(t=0;t<r.length;t++)o[f=r[t]]?o[f]++:(o[f]=1,n.push(f));var a=n.sort(e),i={},u=1;for(t=0;t<a.length;t++){var f,l=o[f=a[t]],c=(u+(u+l-1))/2;i[f]=c,u+=l}return r.map((function(r){return i[r]}))},r.mode=function(r){var t,n=r.length,o=r.slice().sort(e),a=1,i=0,u=0,f=[];for(t=0;t<n;t++)o[t]===o[t+1]?a++:(a>i?(f=[o[t]],i=a,u=0):a===i&&(f.push(o[t]),u++),a=1);return 0===u?f[0]:f},r.range=function(t){return r.max(t)-r.min(t)},r.variance=function(t,n){return r.sumsqerr(t)/(t.length-(n?1:0))},r.pooledvariance=function(t){return t.reduce((function(t,n){return t+r.sumsqerr(n)}),0)/(t.reduce((function(r,t){return r+t.length}),0)-t.length)},r.deviation=function(t){for(var n=r.mean(t),e=t.length,o=new Array(e),a=0;a<e;a++)o[a]=t[a]-n;return o},r.stdev=function(n,e){return t.sqrt(r.variance(n,e))},r.pooledstdev=function(n){return t.sqrt(r.pooledvariance(n))},r.meandev=function(n){for(var e=r.mean(n),o=[],a=n.length-1;a>=0;a--)o.push(t.abs(n[a]-e));return r.mean(o)},r.meddev=function(n){for(var e=r.median(n),o=[],a=n.length-1;a>=0;a--)o.push(t.abs(n[a]-e));return r.median(o)},r.coeffvar=function(t){return r.stdev(t)/r.mean(t)},r.quartiles=function(r){var n=r.length,o=r.slice().sort(e);return[o[t.round(n/4)-1],o[t.round(n/2)-1],o[t.round(3*n/4)-1]]},r.quantiles=function(r,n,a,i){var u,f,l,c,s,p=r.slice().sort(e),h=[n.length],m=r.length;for(void 0===a&&(a=3/8),void 0===i&&(i=3/8),u=0;u<n.length;u++)l=m*(f=n[u])+(a+f*(1-a-i)),c=t.floor(o(l,1,m-1)),s=o(l-c,0,1),h[u]=(1-s)*p[c-1]+s*p[c];return h},r.percentile=function(r,t,n){var o=r.slice().sort(e),a=t*(o.length+(n?1:-1))+(n?0:1),i=parseInt(a),u=a-i;return i+1<o.length?o[i-1]+u*(o[i]-o[i-1]):o[i-1]},r.percentileOfScore=function(r,t,n){var e,o,a=0,i=r.length,u=!1;for("strict"===n&&(u=!0),o=0;o<i;o++)e=r[o],(u&&e<t||!u&&e<=t)&&a++;return a/i},r.histogram=function(n,e){e=e||4;var o,a=r.min(n),i=(r.max(n)-a)/e,u=n.length,f=[];for(o=0;o<e;o++)f[o]=0;for(o=0;o<u;o++)f[t.min(t.floor((n[o]-a)/i),e-1)]+=1;return f},r.covariance=function(t,n){var e,o=r.mean(t),a=r.mean(n),i=t.length,u=new Array(i);for(e=0;e<i;e++)u[e]=(t[e]-o)*(n[e]-a);return r.sum(u)/(i-1)},r.corrcoeff=function(t,n){return r.covariance(t,n)/r.stdev(t,1)/r.stdev(n,1)},r.spearmancoeff=function(t,n){return t=r.rank(t),n=r.rank(n),r.corrcoeff(t,n)},r.stanMoment=function(n,e){for(var o=r.mean(n),a=r.stdev(n),i=n.length,u=0,f=0;f<i;f++)u+=t.pow((n[f]-o)/a,e);return u/n.length},r.skewness=function(t){return r.stanMoment(t,3)},r.kurtosis=function(t){return r.stanMoment(t,4)-3};var a=r.prototype;!function(t){for(var e=0;e<t.length;e++)!function(t){a[t]=function(e,o){var i=[],u=0,f=this;if(n(e)&&(o=e,e=!1),o)return setTimeout((function(){o.call(f,a[t].call(f,e))})),this;if(this.length>1){for(f=!0===e?this:this.transpose();u<f.length;u++)i[u]=r[t](f[u]);return i}return r[t](this[0],e)}}(t[e])}("cumsum cumprod".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){a[t]=function(e,o){var i=[],u=0,f=this;if(n(e)&&(o=e,e=!1),o)return setTimeout((function(){o.call(f,a[t].call(f,e))})),this;if(this.length>1){for("sumrow"!==t&&(f=!0===e?this:this.transpose());u<f.length;u++)i[u]=r[t](f[u]);return!0===e?r[t](r.utils.toVector(i)):i}return r[t](this[0],e)}}(t[e])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){a[t]=function(){var e,o=[],i=0,u=this,f=Array.prototype.slice.call(arguments);if(n(f[f.length-1])){e=f[f.length-1];var l=f.slice(0,f.length-1);return setTimeout((function(){e.call(u,a[t].apply(u,l))})),this}e=void 0;var c=function(n){return r[t].apply(u,[n].concat(f))};if(this.length>1){for(u=u.transpose();i<u.length;i++)o[i]=c(u[i]);return o}return c(this[0])}}(t[e])}("quantiles percentileOfScore".split(" "))}(r,Math),function(r,t){r.gammaln=function(r){var n,e,o,a=0,i=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],u=1.000000000190015;for(o=(e=n=r)+5.5,o-=(n+.5)*t.log(o);a<6;a++)u+=i[a]/++e;return t.log(2.5066282746310007*u/n)-o},r.loggam=function(r){var n,e,o,a,i,u,f,l=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(n=r,f=0,1==r||2==r)return 0;for(r<=7&&(n=r+(f=t.floor(7-r))),e=1/(n*n),o=2*t.PI,i=l[9],u=8;u>=0;u--)i*=e,i+=l[u];if(a=i/n+.5*t.log(o)+(n-.5)*t.log(n)-n,r<=7)for(u=1;u<=f;u++)a-=t.log(n-1),n-=1;return a},r.gammafn=function(r){var n,e,o,a,i=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],u=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],f=!1,l=0,c=0,s=0,p=r;if(r>171.6243769536076)return 1/0;if(p<=0){if(!(a=p%1+36e-17))return 1/0;f=(1&p?-1:1)*t.PI/t.sin(t.PI*a),p=1-p}for(o=p,e=p<1?p++:(p-=l=(0|p)-1)-1,n=0;n<8;++n)s=(s+i[n])*e,c=c*e+u[n];if(a=s/c+1,o<p)a/=o;else if(o>p)for(n=0;n<l;++n)a*=p,p++;return f&&(a=f/a),a},r.gammap=function(t,n){return r.lowRegGamma(t,n)*r.gammafn(t)},r.lowRegGamma=function(n,e){var o,a=r.gammaln(n),i=n,u=1/n,f=u,l=e+1-n,c=1/1e-30,s=1/l,p=s,h=1,m=-~(8.5*t.log(n>=1?n:1/n)+.4*n+17);if(e<0||n<=0)return NaN;if(e<n+1){for(;h<=m;h++)u+=f*=e/++i;return u*t.exp(-e+n*t.log(e)-a)}for(;h<=m;h++)p*=(s=1/(s=(o=-h*(h-n))*s+(l+=2)))*(c=l+o/c);return 1-p*t.exp(-e+n*t.log(e)-a)},r.factorialln=function(t){return t<0?NaN:r.gammaln(t+1)},r.factorial=function(t){return t<0?NaN:r.gammafn(t+1)},r.combination=function(n,e){return n>170||e>170?t.exp(r.combinationln(n,e)):r.factorial(n)/r.factorial(e)/r.factorial(n-e)},r.combinationln=function(t,n){return r.factorialln(t)-r.factorialln(n)-r.factorialln(t-n)},r.permutation=function(t,n){return r.factorial(t)/r.factorial(t-n)},r.betafn=function(n,e){if(!(n<=0||e<=0))return n+e>170?t.exp(r.betaln(n,e)):r.gammafn(n)*r.gammafn(e)/r.gammafn(n+e)},r.betaln=function(t,n){return r.gammaln(t)+r.gammaln(n)-r.gammaln(t+n)},r.betacf=function(r,n,e){var o,a,i,u,f=1e-30,l=1,c=n+e,s=n+1,p=n-1,h=1,m=1-c*r/s;for(t.abs(m)<f&&(m=f),u=m=1/m;l<=100&&(m=1+(a=l*(e-l)*r/((p+(o=2*l))*(n+o)))*m,t.abs(m)<f&&(m=f),h=1+a/h,t.abs(h)<f&&(h=f),u*=(m=1/m)*h,m=1+(a=-(n+l)*(c+l)*r/((n+o)*(s+o)))*m,t.abs(m)<f&&(m=f),h=1+a/h,t.abs(h)<f&&(h=f),u*=i=(m=1/m)*h,!(t.abs(i-1)<3e-7));l++);return u},r.gammapinv=function(n,e){var o,a,i,u,f,l,c=0,s=e-1,p=1e-8,h=r.gammaln(e);if(n>=1)return t.max(100,e+100*t.sqrt(e));if(n<=0)return 0;for(e>1?(f=t.log(s),l=t.exp(s*(f-1)-h),u=n<.5?n:1-n,o=(2.30753+.27061*(a=t.sqrt(-2*t.log(u))))/(1+a*(.99229+.04481*a))-a,n<.5&&(o=-o),o=t.max(.001,e*t.pow(1-1/(9*e)-o/(3*t.sqrt(e)),3))):o=n<(a=1-e*(.253+.12*e))?t.pow(n/a,1/e):1-t.log(1-(n-a)/(1-a));c<12;c++){if(o<=0)return 0;if((o-=a=(i=(r.lowRegGamma(e,o)-n)/(a=e>1?l*t.exp(-(o-s)+s*(t.log(o)-f)):t.exp(-o+s*t.log(o)-h)))/(1-.5*t.min(1,i*((e-1)/o-1))))<=0&&(o=.5*(o+a)),t.abs(a)<p*o)break}return o},r.erf=function(r){var n,e,o,a,i=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],u=i.length-1,f=!1,l=0,c=0;for(r<0&&(r=-r,f=!0),e=4*(n=2/(2+r))-2;u>0;u--)o=l,l=e*l-c+i[u],c=o;return a=n*t.exp(-r*r+.5*(i[0]+e*l)-c),f?a-1:1-a},r.erfc=function(t){return 1-r.erf(t)},r.erfcinv=function(n){var e,o,a,i,u=0;if(n>=2)return-100;if(n<=0)return 100;for(i=n<1?n:2-n,e=-.70711*((2.30753+.27061*(a=t.sqrt(-2*t.log(i/2))))/(1+a*(.99229+.04481*a))-a);u<2;u++)e+=(o=r.erfc(e)-i)/(1.1283791670955126*t.exp(-e*e)-e*o);return n<1?e:-e},r.ibetainv=function(n,e,o){var a,i,u,f,l,c,s,p,h,m,v=1e-8,d=e-1,g=o-1,b=0;if(n<=0)return 0;if(n>=1)return 1;for(e>=1&&o>=1?(u=n<.5?n:1-n,c=(2.30753+.27061*(f=t.sqrt(-2*t.log(u))))/(1+f*(.99229+.04481*f))-f,n<.5&&(c=-c),s=(c*c-3)/6,p=2/(1/(2*e-1)+1/(2*o-1)),h=c*t.sqrt(s+p)/p-(1/(2*o-1)-1/(2*e-1))*(s+5/6-2/(3*p)),c=e/(e+o*t.exp(2*h))):(a=t.log(e/(e+o)),i=t.log(o/(e+o)),c=n<(f=t.exp(e*a)/e)/(h=f+(l=t.exp(o*i)/o))?t.pow(e*h*n,1/e):1-t.pow(o*h*(1-n),1/o)),m=-r.gammaln(e)-r.gammaln(o)+r.gammaln(e+o);b<10;b++){if(0===c||1===c)return c;if((c-=f=(l=(r.ibeta(c,e,o)-n)/(f=t.exp(d*t.log(c)+g*t.log(1-c)+m)))/(1-.5*t.min(1,l*(d/c-g/(1-c)))))<=0&&(c=.5*(c+f)),c>=1&&(c=.5*(c+f+1)),t.abs(f)<v*c&&b>0)break}return c},r.ibeta=function(n,e,o){var a=0===n||1===n?0:t.exp(r.gammaln(e+o)-r.gammaln(e)-r.gammaln(o)+e*t.log(n)+o*t.log(1-n));return!(n<0||n>1)&&(n<(e+1)/(e+o+2)?a*r.betacf(n,e,o)/e:1-a*r.betacf(1-n,o,e)/o)},r.randn=function(n,e){var o,a,i,u,f;if(e||(e=n),n)return r.create(n,e,(function(){return r.randn()}));do{o=r._random_fn(),a=1.7156*(r._random_fn()-.5),f=(i=o-.449871)*i+(u=t.abs(a)+.386595)*(.196*u-.25472*i)}while(f>.27597&&(f>.27846||a*a>-4*t.log(o)*o*o));return a/o},r.randg=function(n,e,o){var a,i,u,f,l,c,s=n;if(o||(o=e),n||(n=1),e)return(c=r.zeros(e,o)).alter((function(){return r.randg(n)})),c;n<1&&(n+=1),a=n-1/3,i=1/t.sqrt(9*a);do{do{f=1+i*(l=r.randn())}while(f<=0);f*=f*f,u=r._random_fn()}while(u>1-.331*t.pow(l,4)&&t.log(u)>.5*l*l+a*(1-f+t.log(f)));if(n==s)return a*f;do{u=r._random_fn()}while(0===u);return t.pow(u,1/s)*a*f},function(t){for(var n=0;n<t.length;n++)!function(t){r.fn[t]=function(){return r(r.map(this,(function(n){return r[t](n)})))}}(t[n])}("gammaln gammafn factorial factorialln".split(" ")),function(t){for(var n=0;n<t.length;n++)!function(t){r.fn[t]=function(){return r(r[t].apply(null,arguments))}}(t[n])}("randn".split(" "))}(r,Math),function(r,t){function n(r,n,e,o){for(var a,i=0,u=1,f=1,l=1,c=0,s=0;t.abs((f-s)/f)>o;)s=f,u=l+(a=-(n+c)*(n+e+c)*r/(n+2*c)/(n+2*c+1))*u,f=(i=f+a*i)+(a=(c+=1)*(e-c)*r/(n+2*c-1)/(n+2*c))*f,i/=l=u+a*l,u/=l,f/=l,l=1;return f/n}function e(r){return r/t.abs(r)}function o(n,e,o){var a=12,i=6,u=-30,f=-50,l=60,c=8,s=3,p=2,h=3,m=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],v=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],d=.5*n;if(d>=c)return 1;var g,b=2*r.normal.cdf(d,0,1,1,0)-1;b=b>=t.exp(f/o)?t.pow(b,o):0;for(var y=d,w=(c-d)/(g=n>s?p:h),j=y+w,x=0,_=o-1,M=1;M<=g;M++){for(var P=0,q=.5*(j+y),A=.5*(j-y),S=1;S<=a;S++){var E,O=q+A*(i<S?m[(E=a-S+1)-1]:-m[(E=S)-1]),k=O*O;if(k>l)break;var N=2*r.normal.cdf(O,0,1,1,0)*.5-2*r.normal.cdf(O,n,1,1,0)*.5;N>=t.exp(u/_)&&(P+=N=v[E-1]*t.exp(-.5*k)*t.pow(N,_))}x+=P*=2*A*o/t.sqrt(2*t.PI),y=j,j+=w}return(b+=x)<=t.exp(u/e)?0:(b=t.pow(b,e))>=1?1:b}function a(r,n,e){var o=.322232421088,a=.099348462606,i=-1,u=.588581570495,f=-.342242088547,l=.531103462366,c=-.204231210125,s=.10353775285,p=-453642210148e-16,h=.0038560700634,m=.8832,v=.2368,d=1.214,g=1.208,b=1.4142,y=120,w=.5-.5*r,j=t.sqrt(t.log(1/(w*w))),x=j+((((j*p+c)*j+f)*j+i)*j+o)/((((j*h+s)*j+l)*j+u)*j+a);e<y&&(x+=(x*x*x+x)/e/4);var _=m-v*x;return e<y&&(_+=-d/e+g*x/e),x*(_*t.log(n-1)+b)}!function(t){for(var n=0;n<t.length;n++)!function(t){r[t]=function r(t,n,e){return this instanceof r?(this._a=t,this._b=n,this._c=e,this):new r(t,n,e)},r.fn[t]=function(n,e,o){var a=r[t](n,e,o);return a.data=this,a},r[t].prototype.sample=function(n){var e=this._a,o=this._b,a=this._c;return n?r.alter(n,(function(){return r[t].sample(e,o,a)})):r[t].sample(e,o,a)},function(n){for(var e=0;e<n.length;e++)!function(n){r[t].prototype[n]=function(e){var o=this._a,a=this._b,i=this._c;return e||0===e||(e=this.data),"number"!=typeof e?r.fn.map.call(e,(function(e){return r[t][n](e,o,a,i)})):r[t][n](e,o,a,i)}}(n[e])}("pdf cdf inv".split(" ")),function(n){for(var e=0;e<n.length;e++)!function(n){r[t].prototype[n]=function(){return r[t][n](this._a,this._b,this._c)}}(n[e])}("mean median mode variance".split(" "))}(t[n])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),r.extend(r.beta,{pdf:function(n,e,o){return n>1||n<0?0:1==e&&1==o?1:e<512&&o<512?t.pow(n,e-1)*t.pow(1-n,o-1)/r.betafn(e,o):t.exp((e-1)*t.log(n)+(o-1)*t.log(1-n)-r.betaln(e,o))},cdf:function(t,n,e){return t>1||t<0?1*(t>1):r.ibeta(t,n,e)},inv:function(t,n,e){return r.ibetainv(t,n,e)},mean:function(r,t){return r/(r+t)},median:function(t,n){return r.ibetainv(.5,t,n)},mode:function(r,t){return(r-1)/(r+t-2)},sample:function(t,n){var e=r.randg(t);return e/(e+r.randg(n))},variance:function(r,n){return r*n/(t.pow(r+n,2)*(r+n+1))}}),r.extend(r.centralF,{pdf:function(n,e,o){var a;return n<0?0:e<=2?0===n&&e<2?1/0:0===n&&2===e?1:1/r.betafn(e/2,o/2)*t.pow(e/o,e/2)*t.pow(n,e/2-1)*t.pow(1+e/o*n,-(e+o)/2):(a=e*n/(o+n*e),e*(o/(o+n*e))/2*r.binomial.pdf((e-2)/2,(e+o-2)/2,a))},cdf:function(t,n,e){return t<0?0:r.ibeta(n*t/(n*t+e),n/2,e/2)},inv:function(t,n,e){return e/(n*(1/r.ibetainv(t,n/2,e/2)-1))},mean:function(r,t){return t>2?t/(t-2):void 0},mode:function(r,t){return r>2?t*(r-2)/(r*(t+2)):void 0},sample:function(t,n){return 2*r.randg(t/2)/t/(2*r.randg(n/2)/n)},variance:function(r,t){if(!(t<=4))return 2*t*t*(r+t-2)/(r*(t-2)*(t-2)*(t-4))}}),r.extend(r.cauchy,{pdf:function(r,n,e){return e<0?0:e/(t.pow(r-n,2)+t.pow(e,2))/t.PI},cdf:function(r,n,e){return t.atan((r-n)/e)/t.PI+.5},inv:function(r,n,e){return n+e*t.tan(t.PI*(r-.5))},median:function(r){return r},mode:function(r){return r},sample:function(n,e){return r.randn()*t.sqrt(1/(2*r.randg(.5)))*e+n}}),r.extend(r.chisquare,{pdf:function(n,e){return n<0?0:0===n&&2===e?.5:t.exp((e/2-1)*t.log(n)-n/2-e/2*t.log(2)-r.gammaln(e/2))},cdf:function(t,n){return t<0?0:r.lowRegGamma(n/2,t/2)},inv:function(t,n){return 2*r.gammapinv(t,.5*n)},mean:function(r){return r},median:function(r){return r*t.pow(1-2/(9*r),3)},mode:function(r){return r-2>0?r-2:0},sample:function(t){return 2*r.randg(t/2)},variance:function(r){return 2*r}}),r.extend(r.exponential,{pdf:function(r,n){return r<0?0:n*t.exp(-n*r)},cdf:function(r,n){return r<0?0:1-t.exp(-n*r)},inv:function(r,n){return-t.log(1-r)/n},mean:function(r){return 1/r},median:function(r){return 1/r*t.log(2)},mode:function(){return 0},sample:function(n){return-1/n*t.log(r._random_fn())},variance:function(r){return t.pow(r,-2)}}),r.extend(r.gamma,{pdf:function(n,e,o){return n<0?0:0===n&&1===e?1/o:t.exp((e-1)*t.log(n)-n/o-r.gammaln(e)-e*t.log(o))},cdf:function(t,n,e){return t<0?0:r.lowRegGamma(n,t/e)},inv:function(t,n,e){return r.gammapinv(t,n)*e},mean:function(r,t){return r*t},mode:function(r,t){if(r>1)return(r-1)*t},sample:function(t,n){return r.randg(t)*n},variance:function(r,t){return r*t*t}}),r.extend(r.invgamma,{pdf:function(n,e,o){return n<=0?0:t.exp(-(e+1)*t.log(n)-o/n-r.gammaln(e)+e*t.log(o))},cdf:function(t,n,e){return t<=0?0:1-r.lowRegGamma(n,e/t)},inv:function(t,n,e){return e/r.gammapinv(1-t,n)},mean:function(r,t){return r>1?t/(r-1):void 0},mode:function(r,t){return t/(r+1)},sample:function(t,n){return n/r.randg(t)},variance:function(r,t){if(!(r<=2))return t*t/((r-1)*(r-1)*(r-2))}}),r.extend(r.kumaraswamy,{pdf:function(r,n,e){return 0===r&&1===n?e:1===r&&1===e?n:t.exp(t.log(n)+t.log(e)+(n-1)*t.log(r)+(e-1)*t.log(1-t.pow(r,n)))},cdf:function(r,n,e){return r<0?0:r>1?1:1-t.pow(1-t.pow(r,n),e)},inv:function(r,n,e){return t.pow(1-t.pow(1-r,1/e),1/n)},mean:function(t,n){return n*r.gammafn(1+1/t)*r.gammafn(n)/r.gammafn(1+1/t+n)},median:function(r,n){return t.pow(1-t.pow(2,-1/n),1/r)},mode:function(r,n){if(r>=1&&n>=1&&1!==r&&1!==n)return t.pow((r-1)/(r*n-1),1/r)},variance:function(){throw new Error("variance not yet implemented")}}),r.extend(r.lognormal,{pdf:function(r,n,e){return r<=0?0:t.exp(-t.log(r)-.5*t.log(2*t.PI)-t.log(e)-t.pow(t.log(r)-n,2)/(2*e*e))},cdf:function(n,e,o){return n<0?0:.5+.5*r.erf((t.log(n)-e)/t.sqrt(2*o*o))},inv:function(n,e,o){return t.exp(-1.4142135623730951*o*r.erfcinv(2*n)+e)},mean:function(r,n){return t.exp(r+n*n/2)},median:function(r){return t.exp(r)},mode:function(r,n){return t.exp(r-n*n)},sample:function(n,e){return t.exp(r.randn()*e+n)},variance:function(r,n){return(t.exp(n*n)-1)*t.exp(2*r+n*n)}}),r.extend(r.noncentralt,{pdf:function(n,e,o){var a=1e-14;return t.abs(o)<a?r.studentt.pdf(n,e):t.abs(n)<a?t.exp(r.gammaln((e+1)/2)-o*o/2-.5*t.log(t.PI*e)-r.gammaln(e/2)):e/n*(r.noncentralt.cdf(n*t.sqrt(1+2/e),e+2,o)-r.noncentralt.cdf(n,e,o))},cdf:function(n,e,o){var a=1e-14,i=200;if(t.abs(o)<a)return r.studentt.cdf(n,e);var u=!1;n<0&&(u=!0,o=-o);for(var f=r.normal.cdf(-o,0,1),l=a+1,c=l,s=n*n/(n*n+e),p=0,h=t.exp(-o*o/2),m=t.exp(-o*o/2-.5*t.log(2)-r.gammaln(1.5))*o;p<i||c>a||l>a;)c=l,p>0&&(h*=o*o/(2*p),m*=o*o/(2*(p+.5))),f+=.5*(l=h*r.beta.cdf(s,p+.5,e/2)+m*r.beta.cdf(s,p+1,e/2)),p++;return u?1-f:f}}),r.extend(r.normal,{pdf:function(r,n,e){return t.exp(-.5*t.log(2*t.PI)-t.log(e)-t.pow(r-n,2)/(2*e*e))},cdf:function(n,e,o){return.5*(1+r.erf((n-e)/t.sqrt(2*o*o)))},inv:function(t,n,e){return-1.4142135623730951*e*r.erfcinv(2*t)+n},mean:function(r){return r},median:function(r){return r},mode:function(r){return r},sample:function(t,n){return r.randn()*n+t},variance:function(r,t){return t*t}}),r.extend(r.pareto,{pdf:function(r,n,e){return r<n?0:e*t.pow(n,e)/t.pow(r,e+1)},cdf:function(r,n,e){return r<n?0:1-t.pow(n/r,e)},inv:function(r,n,e){return n/t.pow(1-r,1/e)},mean:function(r,n){if(!(n<=1))return n*t.pow(r,n)/(n-1)},median:function(r,n){return r*(n*t.SQRT2)},mode:function(r){return r},variance:function(r,n){if(!(n<=2))return r*r*n/(t.pow(n-1,2)*(n-2))}}),r.extend(r.studentt,{pdf:function(n,e){return e=e>1e100?1e100:e,1/(t.sqrt(e)*r.betafn(.5,e/2))*t.pow(1+n*n/e,-(e+1)/2)},cdf:function(n,e){var o=e/2;return r.ibeta((n+t.sqrt(n*n+e))/(2*t.sqrt(n*n+e)),o,o)},inv:function(n,e){var o=r.ibetainv(2*t.min(n,1-n),.5*e,.5);return o=t.sqrt(e*(1-o)/o),n>.5?o:-o},mean:function(r){return r>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(n){return r.randn()*t.sqrt(n/(2*r.randg(n/2)))},variance:function(r){return r>2?r/(r-2):r>1?1/0:void 0}}),r.extend(r.weibull,{pdf:function(r,n,e){return r<0||n<0||e<0?0:e/n*t.pow(r/n,e-1)*t.exp(-t.pow(r/n,e))},cdf:function(r,n,e){return r<0?0:1-t.exp(-t.pow(r/n,e))},inv:function(r,n,e){return n*t.pow(-t.log(1-r),1/e)},mean:function(t,n){return t*r.gammafn(1+1/n)},median:function(r,n){return r*t.pow(t.log(2),1/n)},mode:function(r,n){return n<=1?0:r*t.pow((n-1)/n,1/n)},sample:function(n,e){return n*t.pow(-t.log(r._random_fn()),1/e)},variance:function(n,e){return n*n*r.gammafn(1+2/e)-t.pow(r.weibull.mean(n,e),2)}}),r.extend(r.uniform,{pdf:function(r,t,n){return r<t||r>n?0:1/(n-t)},cdf:function(r,t,n){return r<t?0:r<n?(r-t)/(n-t):1},inv:function(r,t,n){return t+r*(n-t)},mean:function(r,t){return.5*(r+t)},median:function(t,n){return r.mean(t,n)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(t,n){return t/2+n/2+(n/2-t/2)*(2*r._random_fn()-1)},variance:function(r,n){return t.pow(n-r,2)/12}}),r.extend(r.binomial,{pdf:function(n,e,o){return 0===o||1===o?e*o===n?1:0:r.combination(e,n)*t.pow(o,n)*t.pow(1-o,e-n)},cdf:function(e,o,a){var i,u=1e-10;if(e<0)return 0;if(e>=o)return 1;if(a<0||a>1||o<=0)return NaN;var f=a,l=(e=t.floor(e))+1,c=o-e,s=l+c,p=t.exp(r.gammaln(s)-r.gammaln(c)-r.gammaln(l)+l*t.log(f)+c*t.log(1-f));return i=f<(l+1)/(s+2)?p*n(f,l,c,u):1-p*n(1-f,c,l,u),t.round(1/u*(1-i))/(1/u)}}),r.extend(r.negbin,{pdf:function(n,e,o){return n===n>>>0&&(n<0?0:r.combination(n+e-1,e-1)*t.pow(1-o,n)*t.pow(o,e))},cdf:function(t,n,e){var o=0,a=0;if(t<0)return 0;for(;a<=t;a++)o+=r.negbin.pdf(a,n,e);return o}}),r.extend(r.hypgeom,{pdf:function(n,e,o,a){if(n!=n|0)return!1;if(n<0||n<o-(e-a))return 0;if(n>a||n>o)return 0;if(2*o>e)return 2*a>e?r.hypgeom.pdf(e-o-a+n,e,e-o,e-a):r.hypgeom.pdf(a-n,e,e-o,a);if(2*a>e)return r.hypgeom.pdf(o-n,e,o,e-a);if(o<a)return r.hypgeom.pdf(n,e,a,o);for(var i=1,u=0,f=0;f<n;f++){for(;i>1&&u<a;)i*=1-o/(e-u),u++;i*=(a-f)*(o-f)/((f+1)*(e-o-a+f+1))}for(;u<a;u++)i*=1-o/(e-u);return t.min(1,t.max(0,i))},cdf:function(n,e,o,a){if(n<0||n<o-(e-a))return 0;if(n>=a||n>=o)return 1;if(2*o>e)return 2*a>e?r.hypgeom.cdf(e-o-a+n,e,e-o,e-a):1-r.hypgeom.cdf(a-n-1,e,e-o,a);if(2*a>e)return 1-r.hypgeom.cdf(o-n-1,e,o,e-a);if(o<a)return r.hypgeom.cdf(n,e,a,o);for(var i=1,u=1,f=0,l=0;l<n;l++){for(;i>1&&f<a;){var c=1-o/(e-f);u*=c,i*=c,f++}i+=u*=(a-l)*(o-l)/((l+1)*(e-o-a+l+1))}for(;f<a;f++)i*=1-o/(e-f);return t.min(1,t.max(0,i))}}),r.extend(r.poisson,{pdf:function(n,e){return e<0||n%1!=0||n<0?0:t.pow(e,n)*t.exp(-e)/r.factorial(n)},cdf:function(t,n){var e=[],o=0;if(t<0)return 0;for(;o<=t;o++)e.push(r.poisson.pdf(o,n));return r.sum(e)},mean:function(r){return r},variance:function(r){return r},sampleSmall:function(n){var e=1,o=0,a=t.exp(-n);do{o++,e*=r._random_fn()}while(e>a);return o-1},sampleLarge:function(n){var e,o,a,i,u,f,l,c,s,p,h=n;for(i=t.sqrt(h),u=t.log(h),f=.02483*(l=.931+2.53*i)-.059,c=1.1239+1.1328/(l-3.4),s=.9277-3.6224/(l-2);;){if(o=t.random()-.5,a=t.random(),p=.5-t.abs(o),e=t.floor((2*f/p+l)*o+h+.43),p>=.07&&a<=s)return e;if(!(e<0||p<.013&&a>p)&&t.log(a)+t.log(c)-t.log(f/(p*p)+l)<=e*u-h-r.loggam(e+1))return e}},sample:function(r){return r<10?this.sampleSmall(r):this.sampleLarge(r)}}),r.extend(r.triangular,{pdf:function(r,t,n,e){return n<=t||e<t||e>n?NaN:r<t||r>n?0:r<e?2*(r-t)/((n-t)*(e-t)):r===e?2/(n-t):2*(n-r)/((n-t)*(n-e))},cdf:function(r,n,e,o){return e<=n||o<n||o>e?NaN:r<=n?0:r>=e?1:r<=o?t.pow(r-n,2)/((e-n)*(o-n)):1-t.pow(e-r,2)/((e-n)*(e-o))},inv:function(r,n,e,o){return e<=n||o<n||o>e?NaN:r<=(o-n)/(e-n)?n+(e-n)*t.sqrt(r*((o-n)/(e-n))):n+(e-n)*(1-t.sqrt((1-r)*(1-(o-n)/(e-n))))},mean:function(r,t,n){return(r+t+n)/3},median:function(r,n,e){return e<=(r+n)/2?n-t.sqrt((n-r)*(n-e))/t.sqrt(2):e>(r+n)/2?r+t.sqrt((n-r)*(e-r))/t.sqrt(2):void 0},mode:function(r,t,n){return n},sample:function(n,e,o){var a=r._random_fn();return a<(o-n)/(e-n)?n+t.sqrt(a*(e-n)*(o-n)):e-t.sqrt((1-a)*(e-n)*(e-o))},variance:function(r,t,n){return(r*r+t*t+n*n-r*t-r*n-t*n)/18}}),r.extend(r.arcsine,{pdf:function(r,n,e){return e<=n?NaN:r<=n||r>=e?0:2/t.PI*t.pow(t.pow(e-n,2)-t.pow(2*r-n-e,2),-.5)},cdf:function(r,n,e){return r<n?0:r<e?2/t.PI*t.asin(t.sqrt((r-n)/(e-n))):1},inv:function(r,n,e){return n+(.5-.5*t.cos(t.PI*r))*(e-n)},mean:function(r,t){return t<=r?NaN:(r+t)/2},median:function(r,t){return t<=r?NaN:(r+t)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(n,e){return(n+e)/2+(e-n)/2*t.sin(2*t.PI*r.uniform.sample(0,1))},variance:function(r,n){return n<=r?NaN:t.pow(n-r,2)/8}}),r.extend(r.laplace,{pdf:function(r,n,e){return e<=0?0:t.exp(-t.abs(r-n)/e)/(2*e)},cdf:function(r,n,e){return e<=0?0:r<n?.5*t.exp((r-n)/e):1-.5*t.exp(-(r-n)/e)},mean:function(r){return r},median:function(r){return r},mode:function(r){return r},variance:function(r,t){return 2*t*t},sample:function(n,o){var a=r._random_fn()-.5;return n-o*e(a)*t.log(1-2*t.abs(a))}}),r.extend(r.tukey,{cdf:function(n,e,a){var i=1,u=e,f=16,l=8,c=-30,s=1e-14,p=100,h=800,m=5e3,v=25e3,d=1,g=.5,b=.25,y=.125,w=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],j=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(n<=0)return 0;if(a<2||i<1||u<2)return NaN;if(!Number.isFinite(n))return 1;if(a>v)return o(n,i,u);var x,_=.5*a,M=_*t.log(a)-a*t.log(2)-r.gammaln(_),P=_-1,q=.25*a;x=a<=p?d:a<=h?g:a<=m?b:y,M+=t.log(x);for(var A=0,S=1;S<=50;S++){for(var E=0,O=(2*S-1)*x,k=1;k<=f;k++){var N,I;l<k?(N=k-l-1,I=M+P*t.log(O+w[N]*x)-(w[N]*x+O)*q):(N=k-1,I=M+P*t.log(O-w[N]*x)+(w[N]*x-O)*q),I>=c&&(E+=o(l<k?n*t.sqrt(.5*(w[N]*x+O)):n*t.sqrt(.5*(-w[N]*x+O)),i,u)*j[N]*t.exp(I))}if(S*x>=1&&E<=s)break;A+=E}if(E>s)throw new Error("tukey.cdf failed to converge");return A>1&&(A=1),A},inv:function(n,e,o){var i=1e-4,u=50;if(o<2||e<2)return NaN;if(n<0||n>1)return NaN;if(0===n)return 0;if(1===n)return 1/0;var f,l=a(n,e,o),c=r.tukey.cdf(l,e,o)-n;f=c>0?t.max(0,l-1):l+1;for(var s,p=r.tukey.cdf(f,e,o)-n,h=1;h<u;h++)if(s=f-p*(f-l)/(p-c),c=p,l=f,s<0&&(s=0,p=-n),p=r.tukey.cdf(s,e,o)-n,f=s,t.abs(f-l)<i)return s;throw new Error("tukey.inv failed to converge")}})}(r,Math),function(r,t){var n=Array.prototype.push,e=r.utils.isArray;function o(t){return e(t)||t instanceof r}r.extend({add:function(t,n){return o(n)?(o(n[0])||(n=[n]),r.map(t,(function(r,t,e){return r+n[t][e]}))):r.map(t,(function(r){return r+n}))},subtract:function(t,n){return o(n)?(o(n[0])||(n=[n]),r.map(t,(function(r,t,e){return r-n[t][e]||0}))):r.map(t,(function(r){return r-n}))},divide:function(t,n){return o(n)?(o(n[0])||(n=[n]),r.multiply(t,r.inv(n))):r.map(t,(function(r){return r/n}))},multiply:function(t,n){var e,a,i,u,f,l,c,s;if(void 0===t.length&&void 0===n.length)return t*n;if(f=t.length,l=t[0].length,c=r.zeros(f,i=o(n)?n[0].length:l),s=0,o(n)){for(;s<i;s++)for(e=0;e<f;e++){for(u=0,a=0;a<l;a++)u+=t[e][a]*n[a][s];c[e][s]=u}return 1===f&&1===s?c[0][0]:c}return r.map(t,(function(r){return r*n}))},outer:function(t,n){return r.multiply(t.map((function(r){return[r]})),[n])},dot:function(t,n){o(t[0])||(t=[t]),o(n[0])||(n=[n]);for(var e,a,i=1===t[0].length&&1!==t.length?r.transpose(t):t,u=1===n[0].length&&1!==n.length?r.transpose(n):n,f=[],l=0,c=i.length,s=i[0].length;l<c;l++){for(f[l]=[],e=0,a=0;a<s;a++)e+=i[l][a]*u[l][a];f[l]=e}return 1===f.length?f[0]:f},pow:function(n,e){return r.map(n,(function(r){return t.pow(r,e)}))},exp:function(n){return r.map(n,(function(r){return t.exp(r)}))},log:function(n){return r.map(n,(function(r){return t.log(r)}))},abs:function(n){return r.map(n,(function(r){return t.abs(r)}))},norm:function(r,n){var e=0,a=0;for(isNaN(n)&&(n=2),o(r[0])&&(r=r[0]);a<r.length;a++)e+=t.pow(t.abs(r[a]),n);return t.pow(e,1/n)},angle:function(n,e){return t.acos(r.dot(n,e)/(r.norm(n)*r.norm(e)))},aug:function(r,t){var e,o=[];for(e=0;e<r.length;e++)o.push(r[e].slice());for(e=0;e<o.length;e++)n.apply(o[e],t[e]);return o},inv:function(t){for(var n,e=t.length,o=t[0].length,a=r.identity(e,o),i=r.gauss_jordan(t,a),u=[],f=0;f<e;f++)for(u[f]=[],n=o;n<i[0].length;n++)u[f][n-o]=i[f][n];return u},det:function r(t){if(2===t.length)return t[0][0]*t[1][1]-t[0][1]*t[1][0];for(var n=0,e=0;e<t.length;e++){for(var o=[],a=1;a<t.length;a++){o[a-1]=[];for(var i=0;i<t.length;i++)i<e?o[a-1][i]=t[a][i]:i>e&&(o[a-1][i-1]=t[a][i])}var u=e%2?-1:1;n+=r(o)*t[0][e]*u}return n},gauss_elimination:function(n,e){var o,a,i,u,f=0,l=0,c=n.length,s=n[0].length,p=1,h=0,m=[];for(o=(n=r.aug(n,e))[0].length,f=0;f<c;f++){for(a=n[f][f],l=f,u=f+1;u<s;u++)a<t.abs(n[u][f])&&(a=n[u][f],l=u);if(l!=f)for(u=0;u<o;u++)i=n[f][u],n[f][u]=n[l][u],n[l][u]=i;for(l=f+1;l<c;l++)for(p=n[l][f]/n[f][f],u=f;u<o;u++)n[l][u]=n[l][u]-p*n[f][u]}for(f=c-1;f>=0;f--){for(h=0,l=f+1;l<=c-1;l++)h+=m[l]*n[f][l];m[f]=(n[f][o-1]-h)/n[f][f]}return m},gauss_jordan:function(n,e){var o,a,i,u=r.aug(n,e),f=u.length,l=u[0].length,c=0;for(a=0;a<f;a++){var s=a;for(i=a+1;i<f;i++)t.abs(u[i][a])>t.abs(u[s][a])&&(s=i);var p=u[a];for(u[a]=u[s],u[s]=p,i=a+1;i<f;i++)for(c=u[i][a]/u[a][a],o=a;o<l;o++)u[i][o]-=u[a][o]*c}for(a=f-1;a>=0;a--){for(c=u[a][a],i=0;i<a;i++)for(o=l-1;o>a-1;o--)u[i][o]-=u[a][o]*u[i][a]/c;for(u[a][a]/=c,o=f;o<l;o++)u[a][o]/=c}return u},triaUpSolve:function(t,n){var e,o=t[0].length,a=r.zeros(1,o)[0],i=!1;return null!=n[0].length&&(n=n.map((function(r){return r[0]})),i=!0),r.arange(o-1,-1,-1).forEach((function(i){e=r.arange(i+1,o).map((function(r){return a[r]*t[i][r]})),a[i]=(n[i]-r.sum(e))/t[i][i]})),i?a.map((function(r){return[r]})):a},triaLowSolve:function(t,n){var e,o=t[0].length,a=r.zeros(1,o)[0],i=!1;return null!=n[0].length&&(n=n.map((function(r){return r[0]})),i=!0),r.arange(o).forEach((function(o){e=r.arange(o).map((function(r){return t[o][r]*a[r]})),a[o]=(n[o]-r.sum(e))/t[o][o]})),i?a.map((function(r){return[r]})):a},lu:function(t){var n,e=t.length,o=r.identity(e),a=r.zeros(t.length,t[0].length);return r.arange(e).forEach((function(r){a[0][r]=t[0][r]})),r.arange(1,e).forEach((function(i){r.arange(i).forEach((function(e){n=r.arange(e).map((function(r){return o[i][r]*a[r][e]})),o[i][e]=(t[i][e]-r.sum(n))/a[e][e]})),r.arange(i,e).forEach((function(e){n=r.arange(i).map((function(r){return o[i][r]*a[r][e]})),a[i][e]=t[n.length][e]-r.sum(n)}))})),[o,a]},cholesky:function(n){var e,o=n.length,a=r.zeros(n.length,n[0].length);return r.arange(o).forEach((function(i){e=r.arange(i).map((function(r){return t.pow(a[i][r],2)})),a[i][i]=t.sqrt(n[i][i]-r.sum(e)),r.arange(i+1,o).forEach((function(t){e=r.arange(i).map((function(r){return a[i][r]*a[t][r]})),a[t][i]=(n[i][t]-r.sum(e))/a[i][i]}))})),a},gauss_jacobi:function(n,e,o,a){for(var i,u,f,l,c=0,s=0,p=n.length,h=[],m=[],v=[];c<p;c++)for(h[c]=[],m[c]=[],v[c]=[],s=0;s<p;s++)c>s?(h[c][s]=n[c][s],m[c][s]=v[c][s]=0):c<s?(m[c][s]=n[c][s],h[c][s]=v[c][s]=0):(v[c][s]=n[c][s],h[c][s]=m[c][s]=0);for(f=r.multiply(r.multiply(r.inv(v),r.add(h,m)),-1),u=r.multiply(r.inv(v),e),i=o,l=r.add(r.multiply(f,o),u),c=2;t.abs(r.norm(r.subtract(l,i)))>a;)i=l,l=r.add(r.multiply(f,i),u),c++;return l},gauss_seidel:function(n,e,o,a){for(var i,u,f,l,c,s=0,p=n.length,h=[],m=[],v=[];s<p;s++)for(h[s]=[],m[s]=[],v[s]=[],i=0;i<p;i++)s>i?(h[s][i]=n[s][i],m[s][i]=v[s][i]=0):s<i?(m[s][i]=n[s][i],h[s][i]=v[s][i]=0):(v[s][i]=n[s][i],h[s][i]=m[s][i]=0);for(l=r.multiply(r.multiply(r.inv(r.add(v,h)),m),-1),f=r.multiply(r.inv(r.add(v,h)),e),u=o,c=r.add(r.multiply(l,o),f),s=2;t.abs(r.norm(r.subtract(c,u)))>a;)u=c,c=r.add(r.multiply(l,u),f),s+=1;return c},SOR:function(n,e,o,a,i){for(var u,f,l,c,s,p=0,h=n.length,m=[],v=[],d=[];p<h;p++)for(m[p]=[],v[p]=[],d[p]=[],u=0;u<h;u++)p>u?(m[p][u]=n[p][u],v[p][u]=d[p][u]=0):p<u?(v[p][u]=n[p][u],m[p][u]=d[p][u]=0):(d[p][u]=n[p][u],m[p][u]=v[p][u]=0);for(c=r.multiply(r.inv(r.add(d,r.multiply(m,i))),r.subtract(r.multiply(d,1-i),r.multiply(v,i))),l=r.multiply(r.multiply(r.inv(r.add(d,r.multiply(m,i))),e),i),f=o,s=r.add(r.multiply(c,o),l),p=2;t.abs(r.norm(r.subtract(s,f)))>a;)f=s,s=r.add(r.multiply(c,f),l),p++;return s},householder:function(n){for(var e,o,a,i,u=n.length,f=n[0].length,l=0,c=[],s=[];l<u-1;l++){for(e=0,i=l+1;i<f;i++)e+=n[i][l]*n[i][l];for(e=(n[l+1][l]>0?-1:1)*t.sqrt(e),o=t.sqrt((e*e-n[l+1][l]*e)/2),(c=r.zeros(u,1))[l+1][0]=(n[l+1][l]-e)/(2*o),a=l+2;a<u;a++)c[a][0]=n[a][l]/(2*o);s=r.subtract(r.identity(u,f),r.multiply(r.multiply(c,r.transpose(c)),2)),n=r.multiply(s,r.multiply(n,s))}return n},QR:function(){var n=r.sum,e=r.arange;function o(o){var a,i,u,f=o.length,l=o[0].length,c=r.zeros(l,l);for(o=r.copy(o),i=0;i<l;i++){for(c[i][i]=t.sqrt(n(e(f).map((function(r){return o[r][i]*o[r][i]})))),a=0;a<f;a++)o[a][i]=o[a][i]/c[i][i];for(u=i+1;u<l;u++)for(c[i][u]=n(e(f).map((function(r){return o[r][i]*o[r][u]}))),a=0;a<f;a++)o[a][u]=o[a][u]-o[a][i]*c[i][u]}return[o,c]}return o}(),lstsq:function(){function t(t){var n=(t=r.copy(t)).length,e=r.identity(n);return r.arange(n-1,-1,-1).forEach((function(n){r.sliceAssign(e,{row:n},r.divide(r.slice(e,{row:n}),t[n][n])),r.sliceAssign(t,{row:n},r.divide(r.slice(t,{row:n}),t[n][n])),r.arange(n).forEach((function(o){var a=r.multiply(t[o][n],-1),i=r.slice(t,{row:o}),u=r.multiply(r.slice(t,{row:n}),a);r.sliceAssign(t,{row:o},r.add(i,u));var f=r.slice(e,{row:o}),l=r.multiply(r.slice(e,{row:n}),a);r.sliceAssign(e,{row:o},r.add(f,l))}))})),e}function n(n,e){var o=!1;void 0===e[0].length&&(e=e.map((function(r){return[r]})),o=!0);var a=r.QR(n),i=a[0],u=a[1],f=n[0].length,l=r.slice(i,{col:{end:f}}),c=t(r.slice(u,{row:{end:f}})),s=r.transpose(l);void 0===s[0].length&&(s=[s]);var p=r.multiply(r.multiply(c,s),e);return void 0===p.length&&(p=[[p]]),o?p.map((function(r){return r[0]})):p}return n}(),jacobi:function(n){for(var e,o,a,i,u,f,l,c=1,s=n.length,p=r.identity(s,s),h=[];1===c;){for(u=n[0][1],a=0,i=1,e=0;e<s;e++)for(o=0;o<s;o++)e!=o&&u<t.abs(n[e][o])&&(u=t.abs(n[e][o]),a=e,i=o);for(f=n[a][a]===n[i][i]?n[a][i]>0?t.PI/4:-t.PI/4:t.atan(2*n[a][i]/(n[a][a]-n[i][i]))/2,(l=r.identity(s,s))[a][a]=t.cos(f),l[a][i]=-t.sin(f),l[i][a]=t.sin(f),l[i][i]=t.cos(f),p=r.multiply(p,l),n=r.multiply(r.multiply(r.inv(l),n),l),c=0,e=1;e<s;e++)for(o=1;o<s;o++)e!=o&&t.abs(n[e][o])>.001&&(c=1)}for(e=0;e<s;e++)h.push(n[e][e]);return[p,h]},rungekutta:function(r,t,n,e,o,a){var i,u,f;if(2===a)for(;e<=n;)o+=((i=t*r(e,o))+(u=t*r(e+t,o+i)))/2,e+=t;if(4===a)for(;e<=n;)o+=((i=t*r(e,o))+2*(u=t*r(e+t/2,o+i/2))+2*(f=t*r(e+t/2,o+u/2))+t*r(e+t,o+f))/6,e+=t;return o},romberg:function(r,n,e,o){for(var a,i,u,f,l,c=0,s=(e-n)/2,p=[],h=[],m=[];c<o/2;){for(l=r(n),u=n,f=0;u<=e;u+=s,f++)p[f]=u;for(a=p.length,u=1;u<a-1;u++)l+=(u%2!=0?4:2)*r(p[u]);l=s/3*(l+r(e)),m[c]=l,s/=2,c++}for(i=m.length,a=1;1!==i;){for(u=0;u<i-1;u++)h[u]=(t.pow(4,a)*m[u+1]-m[u])/(t.pow(4,a)-1);i=h.length,m=h,h=[],a++}return m},richardson:function(r,n,e,o){function a(r,t){for(var n,e=0,o=r.length;e<o;e++)r[e]===t&&(n=e);return n}for(var i,u,f,l,c,s=t.abs(e-r[a(r,e)+1]),p=0,h=[],m=[];o>=s;)i=a(r,e+o),u=a(r,e),h[p]=(n[i]-2*n[u]+n[2*u-i])/(o*o),o/=2,p++;for(l=h.length,f=1;1!=l;){for(c=0;c<l-1;c++)m[c]=(t.pow(4,f)*h[c+1]-h[c])/(t.pow(4,f)-1);l=m.length,h=m,m=[],f++}return h},simpson:function(r,t,n,e){for(var o,a=(n-t)/e,i=r(t),u=[],f=t,l=0,c=1;f<=n;f+=a,l++)u[l]=f;for(o=u.length;c<o-1;c++)i+=(c%2!=0?4:2)*r(u[c]);return a/3*(i+r(n))},hermite:function(r,t,n,e){for(var o,a=r.length,i=0,u=0,f=[],l=[],c=[],s=[];u<a;u++){for(f[u]=1,o=0;o<a;o++)u!=o&&(f[u]*=(e-r[o])/(r[u]-r[o]));for(l[u]=0,o=0;o<a;o++)u!=o&&(l[u]+=1/(r[u]-r[o]));c[u]=(1-2*(e-r[u])*l[u])*(f[u]*f[u]),s[u]=(e-r[u])*(f[u]*f[u]),i+=c[u]*t[u]+s[u]*n[u]}return i},lagrange:function(r,t,n){for(var e,o,a=0,i=0,u=r.length;i<u;i++){for(o=t[i],e=0;e<u;e++)i!=e&&(o*=(n-r[e])/(r[i]-r[e]));a+=o}return a},cubic_spline:function(t,n,e){for(var o,a=t.length,i=0,u=[],f=[],l=[],c=[],s=[],p=[],h=[];i<a-1;i++)s[i]=t[i+1]-t[i];for(l[0]=0,i=1;i<a-1;i++)l[i]=3/s[i]*(n[i+1]-n[i])-3/s[i-1]*(n[i]-n[i-1]);for(i=1;i<a-1;i++)u[i]=[],f[i]=[],u[i][i-1]=s[i-1],u[i][i]=2*(s[i-1]+s[i]),u[i][i+1]=s[i],f[i][0]=l[i];for(c=r.multiply(r.inv(u),f),o=0;o<a-1;o++)p[o]=(n[o+1]-n[o])/s[o]-s[o]*(c[o+1][0]+2*c[o][0])/3,h[o]=(c[o+1][0]-c[o][0])/(3*s[o]);for(o=0;o<a&&!(t[o]>e);o++);return n[o-=1]+(e-t[o])*p[o]+r.sq(e-t[o])*c[o]+(e-t[o])*r.sq(e-t[o])*h[o]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(t){var n,e,o=t.length,a=t[0].length,i=0,u=[],f=[],l=[],c=[],s=[],p=[],h=[],m=[],v=[],d=[];for(i=0;i<o;i++)u[i]=r.sum(t[i])/a;for(i=0;i<a;i++)for(h[i]=[],n=0;n<o;n++)h[i][n]=t[n][i]-u[n];for(h=r.transpose(h),i=0;i<o;i++)for(m[i]=[],n=0;n<o;n++)m[i][n]=r.dot([h[i]],[h[n]])/(a-1);for(v=(l=r.jacobi(m))[0],f=l[1],d=r.transpose(v),i=0;i<f.length;i++)for(n=i;n<f.length;n++)f[i]<f[n]&&(e=f[i],f[i]=f[n],f[n]=e,c=d[i],d[i]=d[n],d[n]=c);for(p=r.transpose(h),i=0;i<o;i++)for(s[i]=[],n=0;n<p.length;n++)s[i][n]=r.dot([d[i]],[p[n]]);return[t,f,d,s]}}),function(t){for(var n=0;n<t.length;n++)!function(t){r.fn[t]=function(n,e){var o=this;return e?(setTimeout((function(){e.call(o,r.fn[t].call(o,n))}),15),this):"number"==typeof r[t](this,n)?r[t](this,n):r(r[t](this,n))}}(t[n])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(r,Math),function(r,t){var n=[].slice,e=r.utils.isNumber,o=r.utils.isArray;function a(r,n,e,o){if(r>1||e>1||r<=0||e<=0)throw new Error("Proportions should be greater than 0 and less than 1");var a=(r*n+e*o)/(n+o);return(r-e)/t.sqrt(a*(1-a)*(1/n+1/o))}r.extend({zscore:function(){var t=n.call(arguments);return e(t[1])?(t[0]-t[1])/t[2]:(t[0]-r.mean(t[1]))/r.stdev(t[1],t[2])},ztest:function(){var e,a=n.call(arguments);return o(a[1])?(e=r.zscore(a[0],a[1],a[3]),1===a[2]?r.normal.cdf(-t.abs(e),0,1):2*r.normal.cdf(-t.abs(e),0,1)):a.length>2?(e=r.zscore(a[0],a[1],a[2]),1===a[3]?r.normal.cdf(-t.abs(e),0,1):2*r.normal.cdf(-t.abs(e),0,1)):(e=a[0],1===a[1]?r.normal.cdf(-t.abs(e),0,1):2*r.normal.cdf(-t.abs(e),0,1))}}),r.extend(r.fn,{zscore:function(r,t){return(r-this.mean())/this.stdev(t)},ztest:function(n,e,o){var a=t.abs(this.zscore(n,o));return 1===e?r.normal.cdf(-a,0,1):2*r.normal.cdf(-a,0,1)}}),r.extend({tscore:function(){var e=n.call(arguments);return 4===e.length?(e[0]-e[1])/(e[2]/t.sqrt(e[3])):(e[0]-r.mean(e[1]))/(r.stdev(e[1],!0)/t.sqrt(e[1].length))},ttest:function(){var o,a=n.call(arguments);return 5===a.length?(o=t.abs(r.tscore(a[0],a[1],a[2],a[3])),1===a[4]?r.studentt.cdf(-o,a[3]-1):2*r.studentt.cdf(-o,a[3]-1)):e(a[1])?(o=t.abs(a[0]),1==a[2]?r.studentt.cdf(-o,a[1]-1):2*r.studentt.cdf(-o,a[1]-1)):(o=t.abs(r.tscore(a[0],a[1])),1==a[2]?r.studentt.cdf(-o,a[1].length-1):2*r.studentt.cdf(-o,a[1].length-1))}}),r.extend(r.fn,{tscore:function(r){return(r-this.mean())/(this.stdev(!0)/t.sqrt(this.cols()))},ttest:function(n,e){return 1===e?1-r.studentt.cdf(t.abs(this.tscore(n)),this.cols()-1):2*r.studentt.cdf(-t.abs(this.tscore(n)),this.cols()-1)}}),r.extend({anovafscore:function(){var e,o,a,i,u,f,l,c,s=n.call(arguments);if(1===s.length){for(u=new Array(s[0].length),l=0;l<s[0].length;l++)u[l]=s[0][l];s=u}for(o=new Array,l=0;l<s.length;l++)o=o.concat(s[l]);for(a=r.mean(o),e=0,l=0;l<s.length;l++)e+=s[l].length*t.pow(r.mean(s[l])-a,2);for(e/=s.length-1,f=0,l=0;l<s.length;l++)for(i=r.mean(s[l]),c=0;c<s[l].length;c++)f+=t.pow(s[l][c]-i,2);return e/(f/=o.length-s.length)},anovaftest:function(){var t,o,a,i,u=n.call(arguments);if(e(u[0]))return 1-r.centralF.cdf(u[0],u[1],u[2]);var f=r.anovafscore(u);for(t=u.length-1,a=0,i=0;i<u.length;i++)a+=u[i].length;return o=a-t-1,1-r.centralF.cdf(f,t,o)},ftest:function(t,n,e){return 1-r.centralF.cdf(t,n,e)}}),r.extend(r.fn,{anovafscore:function(){return r.anovafscore(this.toArray())},anovaftes:function(){var t,n=0;for(t=0;t<this.length;t++)n+=this[t].length;return r.ftest(this.anovafscore(),this.length-1,n-this.length)}}),r.extend({qscore:function(){var o,a,i,u,f,l=n.call(arguments);return e(l[0])?(o=l[0],a=l[1],i=l[2],u=l[3],f=l[4]):(o=r.mean(l[0]),a=r.mean(l[1]),i=l[0].length,u=l[1].length,f=l[2]),t.abs(o-a)/(f*t.sqrt((1/i+1/u)/2))},qtest:function(){var t,e=n.call(arguments);3===e.length?(t=e[0],e=e.slice(1)):7===e.length?(t=r.qscore(e[0],e[1],e[2],e[3],e[4]),e=e.slice(5)):(t=r.qscore(e[0],e[1],e[2]),e=e.slice(3));var o=e[0],a=e[1];return 1-r.tukey.cdf(t,a,o-a)},tukeyhsd:function(t){for(var n=r.pooledstdev(t),e=t.map((function(t){return r.mean(t)})),o=t.reduce((function(r,t){return r+t.length}),0),a=[],i=0;i<t.length;++i)for(var u=i+1;u<t.length;++u){var f=r.qtest(e[i],e[u],t[i].length,t[u].length,n,o,t.length);a.push([[i,u],f])}return a}}),r.extend({normalci:function(){var e,o=n.call(arguments),a=new Array(2);return e=4===o.length?t.abs(r.normal.inv(o[1]/2,0,1)*o[2]/t.sqrt(o[3])):t.abs(r.normal.inv(o[1]/2,0,1)*r.stdev(o[2])/t.sqrt(o[2].length)),a[0]=o[0]-e,a[1]=o[0]+e,a},tci:function(){var e,o=n.call(arguments),a=new Array(2);return e=4===o.length?t.abs(r.studentt.inv(o[1]/2,o[3]-1)*o[2]/t.sqrt(o[3])):t.abs(r.studentt.inv(o[1]/2,o[2].length-1)*r.stdev(o[2],!0)/t.sqrt(o[2].length)),a[0]=o[0]-e,a[1]=o[0]+e,a},significant:function(r,t){return r<t}}),r.extend(r.fn,{normalci:function(t,n){return r.normalci(t,n,this.toArray())},tci:function(t,n){return r.tci(t,n,this.toArray())}}),r.extend(r.fn,{oneSidedDifferenceOfProportions:function(t,n,e,o){var i=a(t,n,e,o);return r.ztest(i,1)},twoSidedDifferenceOfProportions:function(t,n,e,o){var i=a(t,n,e,o);return r.ztest(i,2)}})}(r,Math),r.models=function(){function t(t){var e=t[0].length;return r.arange(e).map((function(o){var a=r.arange(e).filter((function(r){return r!==o}));return n(r.col(t,o).map((function(r){return r[0]})),r.col(t,a))}))}function n(t,n){var e=t.length,o=n[0].length-1,a=e-o-1,i=r.lstsq(n,t),u=r.multiply(n,i.map((function(r){return[r]}))).map((function(r){return r[0]})),f=r.subtract(t,u),l=r.mean(t),c=r.sum(u.map((function(r){return Math.pow(r-l,2)}))),s=r.sum(t.map((function(r,t){return Math.pow(r-u[t],2)}))),p=c+s;return{exog:n,endog:t,nobs:e,df_model:o,df_resid:a,coef:i,predict:u,resid:f,ybar:l,SST:p,SSE:c,SSR:s,R2:c/p}}function e(n){var e=t(n.exog),o=Math.sqrt(n.SSR/n.df_resid),a=e.map((function(r){var t=r.SST,n=r.R2;return o/Math.sqrt(t*(1-n))})),i=n.coef.map((function(r,t){return(r-0)/a[t]})),u=i.map((function(t){var e=r.studentt.cdf(t,n.df_resid);return 2*(e>.5?1-e:e)})),f=r.studentt.inv(.975,n.df_resid),l=n.coef.map((function(r,t){var n=f*a[t];return[r-n,r+n]}));return{se:a,t:i,p:u,sigmaHat:o,interval95:l}}function o(t){var n,e,o,a=t.R2/t.df_model/((1-t.R2)/t.df_resid);return{F_statistic:a,pvalue:1-(n=a,e=t.df_model,o=t.df_resid,r.beta.cdf(n/(o/e+n),e/2,o/2))}}function a(r,t){var a=n(r,t),i=e(a),u=o(a),f=1-(1-a.R2)*((a.nobs-1)/a.df_resid);return a.t=i,a.f=u,a.adjust_R2=f,a}return{ols:a}}(),r.extend({buildxmatrix:function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++){var e=[1];t[n]=e.concat(arguments[n])}return r(t)},builddxmatrix:function(){for(var t=new Array(arguments[0].length),n=0;n<arguments[0].length;n++){var e=[1];t[n]=e.concat(arguments[0][n])}return r(t)},buildjxmatrix:function(t){for(var n=new Array(t.length),e=0;e<t.length;e++)n[e]=t[e];return r.builddxmatrix(n)},buildymatrix:function(t){return r(t).transpose()},buildjymatrix:function(r){return r.transpose()},matrixmult:function(t,n){var e,o,a,i,u;if(t.cols()==n.rows()){if(n.rows()>1){for(i=[],e=0;e<t.rows();e++)for(i[e]=[],o=0;o<n.cols();o++){for(u=0,a=0;a<t.cols();a++)u+=t.toArray()[e][a]*n.toArray()[a][o];i[e][o]=u}return r(i)}for(i=[],e=0;e<t.rows();e++)for(i[e]=[],o=0;o<n.cols();o++){for(u=0,a=0;a<t.cols();a++)u+=t.toArray()[e][a]*n.toArray()[o];i[e][o]=u}return r(i)}},regress:function(t,n){var e=r.xtranspxinv(t),o=t.transpose(),a=r.matrixmult(r(e),o);return r.matrixmult(a,n)},regresst:function(t,n,e){var o=r.regress(t,n),a={anova:{}},i=r.jMatYBar(t,o);a.yBar=i;var u=n.mean();a.anova.residuals=r.residuals(n,i),a.anova.ssr=r.ssr(i,u),a.anova.msr=a.anova.ssr/(t[0].length-1),a.anova.sse=r.sse(n,i),a.anova.mse=a.anova.sse/(n.length-(t[0].length-1)-1),a.anova.sst=r.sst(n,u),a.anova.mst=a.anova.sst/(n.length-1),a.anova.r2=1-a.anova.sse/a.anova.sst,a.anova.r2<0&&(a.anova.r2=0),a.anova.fratio=a.anova.msr/a.anova.mse,a.anova.pvalue=r.anovaftest(a.anova.fratio,t[0].length-1,n.length-(t[0].length-1)-1),a.anova.rmse=Math.sqrt(a.anova.mse),a.anova.r2adj=1-a.anova.mse/a.anova.mst,a.anova.r2adj<0&&(a.anova.r2adj=0),a.stats=new Array(t[0].length);for(var f,l,c,s=r.xtranspxinv(t),p=0;p<o.length;p++)f=Math.sqrt(a.anova.mse*Math.abs(s[p][p])),l=Math.abs(o[p]/f),c=r.ttest(l,n.length-t[0].length-1,e),a.stats[p]=[o[p],f,l,c];return a.regress=o,a},xtranspx:function(t){return r.matrixmult(t.transpose(),t)},xtranspxinv:function(t){var n=r.matrixmult(t.transpose(),t);return r.inv(n)},jMatYBar:function(t,n){var e=r.matrixmult(t,n);return new r(e)},residuals:function(t,n){return r.matrixsubtract(t,n)},ssr:function(r,t){for(var n=0,e=0;e<r.length;e++)n+=Math.pow(r[e]-t,2);return n},sse:function(r,t){for(var n=0,e=0;e<r.length;e++)n+=Math.pow(r[e]-t[e],2);return n},sst:function(r,t){for(var n=0,e=0;e<r.length;e++)n+=Math.pow(r[e]-t,2);return n},matrixsubtract:function(t,n){for(var e=new Array(t.length),o=0;o<t.length;o++){e[o]=new Array(t[o].length);for(var a=0;a<t[o].length;a++)e[o][a]=t[o][a]-n[o][a]}return r(e)}}),r.jStat=r,r}()}({get exports(){return Ao},set exports(r){Ao=r}});let So=Ao.jStat,Eo={beta:{pdf:So.beta.pdf,cdf:So.beta.cdf,inv:So.beta.inv,sample:So.beta.sample},centralF:{pdf:So.centralF.pdf,cdf:So.centralF.cdf,inv:So.centralF.inv,sample:So.centralF.sample},cauchy:{pdf:So.cauchy.pdf,cdf:So.cauchy.cdf,inv:So.cauchy.inv,sample:So.cauchy.sample},chisquare:{pdf:So.chisquare.pdf,cdf:So.chisquare.cdf,inv:So.chisquare.inv,sample:So.chisquare.sample},exponential:{pdf:So.exponential.pdf,cdf:So.exponential.cdf,inv:So.exponential.inv,sample:So.exponential.sample},gamma:{pdf:So.gamma.pdf,cdf:So.gamma.cdf,inv:So.gamma.inv,sample:So.gamma.sample},invgamma:{pdf:So.invgamma.pdf,cdf:So.invgamma.cdf,inv:So.invgamma.inv,sample:So.invgamma.sample},kumaraswamy:{pdf:So.kumaraswamy.pdf,cdf:So.kumaraswamy.cdf,inv:So.kumaraswamy.inv,sample:So.kumaraswamy.sample},lognormal:{pdf:So.lognormal.pdf,cdf:So.lognormal.cdf,inv:So.lognormal.inv,sample:So.lognormal.sample},normal:{pdf:So.normal.pdf,cdf:So.normal.cdf,inv:So.normal.inv,sample:So.normal.sample},pareto:{pdf:So.pareto.pdf,cdf:So.pareto.cdf,inv:So.pareto.inv,sample:(r,t)=>{throw new Error("invalid pareto.sample")}},studentt:{pdf:So.studentt.pdf,cdf:So.studentt.cdf,inv:So.studentt.inv,sample:So.studentt.sample},tukey:{pdf:(r,t,n)=>{throw new Error("invalid tukey.pdf")},cdf:So.tukey.cdf,inv:So.tukey.inv,sample:(r,t)=>{throw new Error("invalid tukey.sample")}},weibull:{pdf:So.weibull.pdf,cdf:So.weibull.cdf,inv:So.weibull.inv,sample:So.weibull.sample},uniform:{pdf:So.uniform.pdf,cdf:So.uniform.cdf,inv:So.uniform.inv,sample:So.uniform.sample},binomial:{pdf:So.binomial.pdf,cdf:So.binomial.cdf,inv:(r,t,n)=>{throw new Error("invalid binomial.inv")},sample:(r,t)=>{throw new Error("invalid binomial.sample")}},negbin:{pdf:So.negbin.pdf,cdf:So.negbin.cdf,inv:(r,t,n)=>{throw new Error("invalid negbin.inv")},sample:(r,t)=>{throw new Error("invalid negbin.sample")}},hypgeom:{pdf:So.hypgeom.pdf,cdf:So.hypgeom.cdf,inv:(r,t,n,e)=>{throw new Error("invalid hypgeom.inv")},sample:(r,t,n)=>{throw new Error("invalid hypgeom.sample")}},poisson:{pdf:So.poisson.pdf,cdf:So.poisson.cdf,inv:(r,t)=>{throw new Error("invalid poisson.inv")},sample:So.poisson.sample},triangular:{pdf:So.triangular.pdf,cdf:So.triangular.cdf,inv:(r,t,n,e)=>{throw new Error("invalid triangular.inv")},sample:So.triangular.sample},arcsine:{pdf:So.arcsine.pdf,cdf:So.arcsine.cdf,inv:So.arcsine.inv,sample:So.arcsine.sample},std:r=>So.stdev(r,!1),sampleStd:r=>So.stdev(r,!0),emquantile:(r,t)=>So.quantiles(r,[t],.4,.4)[0],emquantiles:So.quantiles,percentile:So.percentile};function Oo(r){if(!kr(r))return null;if(0===qr(r))return null;if(qr(r=Un(r=Gn(r,(r=>ao(r))),yo))<=1)return null;return Eo.sampleStd(r)}function ko(r){var t=bo(r),n=t%1;return t==t?n?t-n:t:0}function No(r){return!!ao(r)&&(r=yo(r),"number"==typeof(t=r)&&t==ko(t));var t}var Io=l.isFinite,zo=Math.min;function Fo(r){var t=Math[r];return function(r,n){if(r=mo(r),(n=null==n?0:zo(ko(n),292))&&Io(r)){var e=(Pn(r)+"e").split("e");return+((e=(Pn(t(e[0]+"e"+(+e[1]+n)))+"e").split("e"))[0]+"e"+(+e[1]-n))}return t(r)}}var To=Fo("round");function $o(r){if(!ao(r))return 0;r=yo(r);let t=To(r);return"0"===String(t)?0:t}function Ro(r){if(!No(r))return!1;return $o(r)>0}async function Co(r,t){if(!Ro(r))return Promise.reject(`n[${r}] is not positive integer`);if((r=$o(r))<=1)return Promise.reject(`n[${r}] <= 1`);if(ao(t)||(t=.95),(t=yo(t))<0)return Promise.reject(`p[${t}] < 0`);if(t>1)return Promise.reject(`p[${t}] > 1`);let n=r-1;return Eo.studentt.inv(t,n)}async function Do(r,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"two-tailed";if(!kr(r))return Promise.reject("arr is not an array");if(0===qr(r))return Promise.reject("arr is not an effective array");if(!ao(t))return Promise.reject(`p[${t}] is not a number`);if((t=yo(t))<0)return Promise.reject(`p[${t}] < 0`);if(t>1)return Promise.reject(`p[${t}] > 1`);if("two-tailed"!==n&&"upper-tail"!==n&&"lower-tail"!==n)return Promise.reject(`mode[${n}] is not 'two-tailed', 'upper-tail' or 'lower-tail'`);let e=qr(wo(r));if(0===e)return Promise.reject("no effective data");let o=jo(r),a=Oo(r);if(!qo(o))return Promise.reject(`avg[${o}] is not a number`);if(!qo(a))return Promise.reject(`sigma[${a}] is not a number`);let i=null;if("upper-tail"===n||"lower-tail"===n){let r=await Co(e,t);i="upper-tail"===n?o+r*a/Math.sqrt(e):o-r*a/Math.sqrt(e)}else if("two-tailed"===n){let r=await Co(e,t/2);i=[o-r*a/Math.sqrt(e),o+r*a/Math.sqrt(e)]}return i}function Lo(r){return"function"==typeof r?r:Er}function Uo(r,t){return(ar(r)?Vn:Dn)(r,Lo(t))}function Bo(r,t,n,e){for(var o=-1,a=null==r?0:r.length;++o<a;){var i=r[o];t(e,i,n(i),r)}return e}function Go(r,t,n,e){return Dn(r,(function(r,o,a){t(e,r,n(r),a)})),e}var Vo,Wo,Xo=Object.prototype.hasOwnProperty,Yo=(Vo=function(r,t,n){Xo.call(r,n)?r[n].push(t):Yn(r,n,[t])},function(r,t){var n=ar(r)?Bo:Go,e=Wo?Wo():{};return n(r,Vo,Tn(t),e)}),Ho=Yo,Qo=c?c.isConcatSpreadable:void 0;function Ko(r){return ar(r)||qt(r)||!!(Qo&&r&&r[Qo])}function Zo(r,t,n,e,o){var a=-1,i=r.length;for(n||(n=Ko),o||(o=[]);++a<i;){var u=r[a];t>0&&n(u)?t>1?Zo(u,t-1,n,e,o):ht(o,u):e||(o[o.length]=u)}return o}function Jo(r,t){if(r!==t){var n=void 0!==r,e=null===r,o=r==r,a=fn(r),i=void 0!==t,u=null===t,f=t==t,l=fn(t);if(!u&&!l&&!a&&r>t||a&&i&&f&&!u&&!l||e&&i&&f||!n&&f||!o)return 1;if(!e&&!a&&!l&&r<t||l&&n&&o&&!e&&!a||u&&n&&o||!i&&o||!f)return-1}return 0}function ra(r,t,n){t=t.length?Nr(t,(function(r){return ar(r)?function(t){return En(t,1===r.length?r[0]:r)}:r})):[Er];var e=-1;return t=Nr(t,Ft(Tn)),function(r,t){var n=r.length;for(r.sort(t);n--;)r[n]=r[n].value;return r}(Ln(r,(function(r,n,o){return{criteria:Nr(t,(function(t){return t(r)})),index:++e,value:r}})),(function(r,t){return function(r,t,n){for(var e=-1,o=r.criteria,a=t.criteria,i=o.length,u=n.length;++e<i;){var f=Jo(o[e],a[e]);if(f)return e>=u?f:f*("desc"==n[e]?-1:1)}return r.index-t.index}(r,t,n)}))}var ta=Math.max;var na=Xn?function(r,t){return Xn(r,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:Er,ea=na,oa=Date.now;var aa=function(r){var t=0,n=0;return function(){var e=oa(),o=16-(e-n);if(n=e,o>0){if(++t>=800)return arguments[0]}else t=0;return r.apply(void 0,arguments)}}(ea),ia=aa;function ua(r,t,n){if(!w(n))return!1;var e=typeof t;return!!("number"==e?or(n)&&It(t,n.length):"string"==e&&t in n)&&Ir(n[t],r)}var fa=function(r,t){return ia(function(r,t,n){return t=ta(void 0===t?r.length-1:t,0),function(){for(var e=arguments,o=-1,a=ta(e.length-t,0),i=Array(a);++o<a;)i[o]=e[t+o];o=-1;for(var u=Array(t+1);++o<t;)u[o]=e[o];return u[t]=n(i),function(r,t,n){switch(n.length){case 0:return r.call(t);case 1:return r.call(t,n[0]);case 2:return r.call(t,n[0],n[1]);case 3:return r.call(t,n[0],n[1],n[2])}return r.apply(t,n)}(r,this,u)}}(r,t,Er),r+"")}((function(r,t){if(null==r)return[];var n=t.length;return n>1&&ua(r,t[0],t[1])?t=[]:n>2&&ua(t[0],t[1],t[2])&&(t=[t[0]]),ra(r,Zo(t,1),[])})),la=fa,ca=Array.prototype.reverse;function sa(r){return r&&r.length?Ar(r,Er):0}function pa(r){let t=Object.prototype.toString.call(r);return"[object Function]"===t||"[object AsyncFunction]"===t}function ha(r){let t,n=Object.prototype.toString.call(r);if(t="[object Promise]"===n,t)return!0;if("[object Function]"!==n)return!1;try{t="function"!=typeof r.subscribe&&"function"==typeof r.then}catch(r){}return t}function ma(r,t,n,e,o){for(let a=0;a<r.length;++a)r[a]=t*n[a]+e*o[a]}function va(r,t){return r.y-t.y}function da(r,t,n){for(var e=-1,o=r.length;++e<o;){var a=r[e],i=t(a);if(null!=i&&(void 0===u?i==i&&!fn(i):n(i,u)))var u=i,f=a}return f}function ga(r,t){return r<t}function ba(r){return r&&r.length?da(r,Er,ga):void 0}function ya(r,t){return r>t}function wa(r){return r&&r.length?da(r,Er,ya):void 0}function ja(r,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},e=On(n,"keyMax");oo(e)||(e="max");let o=On(n,"keyMin");oo(o)||(o="min");let a=On(n,"keyValue");oo(a)||(a="value");let i=On(n,"keyItems");if(oo(i)||(i="items"),!eo(r))return[];if(!eo(t))return[];let u=Ze(t);return Uo(r,((r,n)=>{let f=On(r,a);ao(f)?f=yo(f):ao(r)&&(f=yo(r)),qo(f)&&Uo(t,((t,n)=>{let a=On(t,e,null),l=On(t,o,null);if(null!==a&&null!==l&&ao(a)&&ao(l)){let e=On(t,"maxType");"<="!==e&&"<"!==e&&(e="<=");let o,p,h=On(t,"minType");">="!==h&&">"!==h&&(h=">="),a=yo(a),l=yo(l),o=">="===h?f>=l:f>l,p="<="===e?f<=a:f<a,o&&p&&(c=u[n],s=i,Je(c)&&(oo(s)||ao(s))&&s in c||(u[n][i]=[]),u[n][i].push(r))}var c,s}))})),u}function xa(r,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(!ao(r))return[];if(r=yo(r),!ao(t))return[];t=yo(t),Ro(n)||(n=2),n=$o(n);let e=(t-r)/n,o=r,a=[];for(let r=0;r<=n;r++)a.push(o),o+=e;return a}function _a(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Ro(t)||(t=30),t=$o(t);let e=wo(r);if(0===qr(e))return[];let o=On(n,"min",null);ao(o)||(o=ba(e)),o=yo(o);let a=On(n,"max",null);ao(a)||(a=wa(e)),a=yo(a);let i=xa(o,a,t),u=[];for(let r=0;r<qr(i)-1;r++){let t=0===r?">=":">",n="<=",e={min:i[r],max:i[r+1],avg:(i[r]+i[r+1])/2,minType:t,maxType:n};u.push(e)}return Un(ja(e,u),(r=>({min:r.min,max:r.max,avg:r.avg,arr:On(r,"items",[])})))}async function Ma(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!kr(r))return Promise.reject("arr is not an array");if(0===qr(r))return Promise.reject("arr is not an effective array");let n=On(t,"n");Ro(n)||(n=30),n=$o(n);let e=On(t,"min",null),o=On(t,"max",null),a=wo(r);if(a=Gn(a,(r=>r>0)),0===qr(a))return Promise.reject("no effective data");let i=_a(a,n,{min:e,max:o}),u=On(i,"0.max")-On(i,"0.min");i=Un(i,(r=>(r.counts=qr(r.arr),r)));let f=sa(Un(i,"counts"))*u;if(f<=0)throw new Error(`r[${f}<=0]`);i=Un(i,(r=>(r.pdf=r.counts/f,r)));let l=(r,t)=>{let n=[];return Uo(i,(e=>{let o=e.avg,a=e.pdf,i=((r,t,n)=>Eo.gamma.pdf(r,t,n))(o,r,t);if(!qo(i))throw console.log("x",o,"shape",r,"scale",t),new Error("yf is not number");n.push([o,a,i])})),n},c=await async function(r,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!pa(r))return Promise.reject("invalid fun");if(!eo(t))return Promise.reject("params is not an effective array");let e=qr(t),o=On(n,"maxIterations");ao(o)||(o=200*e),o=yo(o);let a=On(n,"nonZeroDelta");ao(a)||(a=1.05),a=yo(a);let i=On(n,"delta");ao(i)||(i=.001),i=yo(i);let u=On(n,"minErrorDelta");ao(u)||(u=1e-6),u=yo(u);let f=On(n,"minTolerance");ao(f)||(f=1e-5),f=yo(f);let l=On(n,"rho");ao(l)||(l=1),l=yo(l);let c=On(n,"chi");ao(c)||(c=2),c=yo(c);let s=On(n,"psi");ao(s)||(s=-.5),s=yo(s);let p=On(n,"sigma");ao(p)||(p=.5),p=yo(p);let h=0;async function m(){let t=r(...arguments);return ha(t)&&(t=await t),h++,t}let v=new Array(e+1);v[0]=t,v[0].y=await m(t),v[0].id=0;for(let r=0;r<e;++r){let n=t.slice();n[r]=n[r]?n[r]*a:i,v[r+1]=n,v[r+1].y=await m(n),v[r+1].id=r+1}let d,g=r=>{for(let t=0;t<r.length;t++)v[e][t]=r[t];v[e].y=r.y},b=t.slice(),y=t.slice(),w=t.slice(),j=t.slice();for(let r=0;r<o;++r){v.sort(va),d=0;for(let r=0;r<e;++r)d=Math.max(d,Math.abs(v[0][r]-v[1][r]));if(Math.abs(v[0].y-v[e].y)<u&&d<f)break;for(let r=0;r<e;++r){b[r]=0;for(let t=0;t<e;++t)b[r]+=v[t][r];b[r]/=e}let r=v[e];if(ma(y,1+l,b,-l,r),y.y=await m(y),y.y<v[0].y)ma(j,1+c,b,-c,r),j.y=await m(j),j.y<y.y?g(j):g(y);else if(y.y>=v[e-1].y){let t=!1;if(y.y>r.y?(ma(w,1+s,b,-s,r),w.y=await m(w),w.y<r.y?g(w):t=!0):(ma(w,1-s*l,b,s*l,r),w.y=await m(w),w.y<y.y?g(w):t=!0),t){if(p>=1)break;for(let r=1;r<v.length;++r)ma(v[r],1-p,v[0],p,v[r]),v[r].y=await m(v[r])}}else g(y)}v.sort(va);let x=[],_=v[0];for(let r=0;r<e;r++)x.push(_[r]);return{count:h,y:v[0].y,x:x}}((async r=>{let t=r[0],n=r[1],e=0;return Uo(l(t,n),(r=>{let t=r[1],n=r[2];e+=(t-n)**2})),e}),[1,1]),s=On(c,"x.0",null),p=On(c,"x.1",null),h=l(s,p);return{shape:s,scale:p,arr:a,arrPdf:h,arrCounts:Un(h,(r=>[r[0],r[1]*f,r[2]*f])),dx:u,bs:i}}var Pa=Fo("floor"),qa=Fo("ceil");async function Aa(r,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!pa(t))throw new Error("invalid fun");let e=wo(r);if(0===qr(e))return null;let o,a,i,u,f=On(n,"nCurve");if(Ro(f)||(f=100),f=$o(f),o=On(n,"dx",null),ao(o)){o=yo(o);let r=ba(e),t=wa(e);i=Pa(r/o)*o,u=qa(t/o)*o,a=To(u-i)/o}else a=On(n,"n"),Ro(a)||(a=30),a=$o(a),i=On(n,"min",null),u=On(n,"max",null);let l=_a(e,a,{min:i,max:u});ao(o)||(o=On(l,"0.max")-On(l,"0.min")),l=Un(l,(r=>(r.counts=qr(r.arr),r)));let c=[...Un(l,"min"),...Un(l,"max")],s=ba(c),p=wa(c),h=Un(l,"counts"),m=sa(h)*o,v=Un(h,(r=>r/m)),d=xa(s,p,f),g=t({arr:e,min:s,max:p,barWidth:o,bins:l,counts:h,pdfs:v,curveX:d});return ha(g)&&(g=await g),{arr:e,min:s,max:p,barWidth:o,bins:l,counts:h,pdfs:v,ratioForCountToPdf:1/m,curveX:d,curveY:g}}function Sa(r){return Sa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Sa(r)}function Ea(r){var t=function(r,t){if("object"!==Sa(r)||null===r)return r;var n=r[Symbol.toPrimitive];if(void 0!==n){var e=n.call(r,t||"default");if("object"!==Sa(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(r)}(r,"string");return"symbol"===Sa(t)?t:String(t)}function Oa(r,t,n){return(t=Ea(t))in r?Object.defineProperty(r,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[t]=n,r}function ka(r,t){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(r);t&&(e=e.filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.push.apply(n,e)}return n}function Na(r){if(!kr(r))return null;if(0===qr(r))return null;let t=_o(r),n=qr(t);if(0===n)return null;let e=0;Uo(t,(r=>{e+=Math.log(r)})),e/=n;try{e=Math.exp(e)}catch(r){return console.log(r),null}return e}async function Ia(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!kr(r))return Promise.reject("arr is not an array");if(0===qr(r))return Promise.reject("arr is not an effective array");let n=null,e=null,o=await Aa(r,(r=>{n=jo(r.arr),e=Oo(r.arr);let t=e*Math.sqrt(2*Math.PI);return Un(r.curveX,(r=>{let o=0;return 0!==t&&(o=1/t*Math.exp(-((r-n)**2)/(2*e**2))),o}))}),t),a=Un(o.bins,((r,t)=>(r.pdf=o.pdfs[t],r))),i=Un(o.curveX,((r,t)=>({x:r,pdf:o.curveY[t]})));return{avg:n,std:e,arr:o.arr,min:o.min,max:o.max,barWidth:o.barWidth,ratioForCountToPdf:o.ratioForCountToPdf,bins:a,curves:i}}async function za(r,t){if(!kr(r))return Promise.reject("arr is not an array");if(0===qr(r))return Promise.reject("arr is not an effective array");if(!ao(t))return Promise.reject(`ratio[${t}] is not a number`);if((t=yo(t))<0)return Promise.reject(`ratio[${t}] < 0`);if(t>1)return Promise.reject(`ratio[${t}] > 1`);let n=wo(r);if(0===qr(n))return Promise.reject("no effective data");let e=jo(n),o=Oo(n);return qo(e)?qo(o)?o<=0?Promise.reject(`std[${o}] <= 0`):{inv:Eo.normal.inv(t,e,o),avg:e,std:o,arr:n}:Promise.reject(`std[${o}] is not a number`):Promise.reject(`avg[${e}] is not a number`)}function Fa(r){if(0===r.length)return 0;var t,n=r[0],e=0;if("number"!=typeof n)return NaN;for(var o=1;o<r.length;o++){if("number"!=typeof r[o])return NaN;t=n+r[o],Math.abs(n)>=Math.abs(r[o])?e+=n-t+r[o]:e+=r[o]-t+n,n=t}return n+e}function Ta(r){if(0===r.length)throw new Error("mean requires at least one data point");return Fa(r)/r.length}function $a(r,t){var n,e,o=Ta(r),a=0;if(2===t)for(e=0;e<r.length;e++)a+=(n=r[e]-o)*n;else for(e=0;e<r.length;e++)a+=Math.pow(r[e]-o,t);return a}function Ra(r){if(0===r.length)throw new Error("variance requires at least one data point");return $a(r,2)/r.length}function Ca(r){if(1===r.length)return 0;var t=Ra(r);return Math.sqrt(t)}function Da(r){if(0===r.length)throw new Error("mode requires at least one data point");if(1===r.length)return r[0];for(var t=r[0],n=NaN,e=0,o=1,a=1;a<r.length+1;a++)r[a]!==t?(o>e&&(e=o,n=t),o=1,t=r[a]):o++;return n}function La(r){return r.slice().sort((function(r,t){return r-t}))}function Ua(r){if(0===r.length)throw new Error("min requires at least one data point");for(var t=r[0],n=1;n<r.length;n++)r[n]<t&&(t=r[n]);return t}function Ba(r){if(0===r.length)throw new Error("max requires at least one data point");for(var t=r[0],n=1;n<r.length;n++)r[n]>t&&(t=r[n]);return t}function Ga(r){for(var t=0,n=0;n<r.length;n++){if("number"!=typeof r[n])return NaN;t+=r[n]}return t}function Va(r,t){var n=r.length*t;if(0===r.length)throw new Error("quantile requires at least one data point.");if(t<0||t>1)throw new Error("quantiles must be between 0 and 1");return 1===t?r[r.length-1]:0===t?r[0]:n%1!=0?r[Math.ceil(n)-1]:r.length%2==0?(r[n-1]+r[n])/2:r[n]}function Wa(r,t,n,e){for(n=n||0,e=e||r.length-1;e>n;){if(e-n>600){var o=e-n+1,a=t-n+1,i=Math.log(o),u=.5*Math.exp(2*i/3),f=.5*Math.sqrt(i*u*(o-u)/o);a-o/2<0&&(f*=-1),Wa(r,t,Math.max(n,Math.floor(t-a*u/o+f)),Math.min(e,Math.floor(t+(o-a)*u/o+f)))}var l=r[t],c=n,s=e;for(Xa(r,n,t),r[e]>l&&Xa(r,n,e);c<s;){for(Xa(r,c,s),c++,s--;r[c]<l;)c++;for(;r[s]>l;)s--}r[n]===l?Xa(r,n,s):Xa(r,++s,e),s<=t&&(n=s+1),t<=s&&(e=s-1)}}function Xa(r,t,n){var e=r[t];r[t]=r[n],r[n]=e}function Ya(r,t){var n=r.slice();if(Array.isArray(t)){!function(r,t){for(var n=[0],e=0;e<t.length;e++)n.push(Ka(r.length,t[e]));n.push(r.length-1),n.sort(Qa);var o=[0,n.length-1];for(;o.length;){var a=Math.ceil(o.pop()),i=Math.floor(o.pop());if(!(a-i<=1)){var u=Math.floor((i+a)/2);Ha(r,n[u],Math.floor(n[i]),Math.ceil(n[a])),o.push(i,u,u,a)}}}(n,t);for(var e=[],o=0;o<t.length;o++)e[o]=Va(n,t[o]);return e}return Ha(n,Ka(n.length,t),0,n.length-1),Va(n,t)}function Ha(r,t,n,e){t%1==0?Wa(r,t,n,e):(Wa(r,t=Math.floor(t),n,e),Wa(r,t+1,t+1,e))}function Qa(r,t){return r-t}function Ka(r,t){var n=r*t;return 1===t?r-1:0===t?0:n%1!=0?Math.ceil(n)-1:r%2==0?n-.5:n}function Za(r,t){if(t<r[0])return 0;if(t>r[r.length-1])return 1;var n=function(r,t){var n=0,e=0,o=r.length;for(;e<o;)t<=r[n=e+o>>>1]?o=n:e=-~n;return e}(r,t);if(r[n]!==t)return n/r.length;n++;var e=function(r,t){var n=0,e=0,o=r.length;for(;e<o;)t>=r[n=e+o>>>1]?e=-~n:o=n;return e}(r,t);if(e===n)return n/r.length;var o=e-n+1;return o*(e+n)/2/o/r.length}function Ja(r){var t=Ya(r,.75),n=Ya(r,.25);if("number"==typeof t&&"number"==typeof n)return t-n}function ri(r){return+Ya(r,.5)}function ti(r){for(var t=ri(r),n=[],e=0;e<r.length;e++)n.push(Math.abs(r[e]-t));return ri(n)}function ni(r,t){t=t||Math.random;for(var n,e,o=r.length;o>0;)e=Math.floor(t()*o--),n=r[o],r[o]=r[e],r[e]=n;return r}function ei(r,t){return ni(r.slice(),t)}function oi(r,t,n){return ei(r,n).slice(0,t)}function ai(r,t){for(var n=[],e=0;e<r;e++){for(var o=[],a=0;a<t;a++)o.push(0);n.push(o)}return n}function ii(r){for(var t,n=0,e=0;e<r.length;e++)0!==e&&r[e]===t||(t=r[e],n++);return n}function ui(r,t,n,e){var o;if(r>0){var a=(n[t]-n[r-1])/(t-r+1);o=e[t]-e[r-1]-(t-r+1)*a*a}else o=e[t]-n[t]*n[t]/(t+1);return o<0?0:o}function fi(r,t,n,e,o,a,i){if(!(r>t)){var u=Math.floor((r+t)/2);e[n][u]=e[n-1][u-1],o[n][u]=u;var f=n;r>n&&(f=Math.max(f,o[n][r-1]||0)),f=Math.max(f,o[n-1][u]||0);var l,c,s,p=u-1;t<e[0].length-1&&(p=Math.min(p,o[n][t+1]||0));for(var h=p;h>=f&&!((l=ui(h,u,a,i))+e[n-1][f-1]>=e[n][u]);--h)(c=ui(f,u,a,i)+e[n-1][f-1])<e[n][u]&&(e[n][u]=c,o[n][u]=f),f++,(s=l+e[n-1][h-1])<e[n][u]&&(e[n][u]=s,o[n][u]=h);fi(r,u-1,n,e,o,a,i),fi(u+1,t,n,e,o,a,i)}}function li(r,t){if(r.length!==t.length)throw new Error("sampleCovariance requires samples with equal lengths");if(r.length<2)throw new Error("sampleCovariance requires at least two data points in each sample");for(var n=Ta(r),e=Ta(t),o=0,a=0;a<r.length;a++)o+=(r[a]-n)*(t[a]-e);return o/(r.length-1)}function ci(r){if(r.length<2)throw new Error("sampleVariance requires at least two data points");return $a(r,2)/(r.length-1)}function si(r){var t=ci(r);return Math.sqrt(t)}function pi(r,t){return li(r,t)/si(r)/si(t)}function hi(r,t,n,e){return(r*t+n*e)/(t+e)}function mi(r){if(0===r.length)throw new Error("meanSimple requires at least one data point");return Ga(r)/r.length}function vi(r){if(0===r.length)throw new Error("rootMeanSquare requires at least one data point");for(var t=0,n=0;n<r.length;n++)t+=Math.pow(r[n],2);return Math.sqrt(t/r.length)}var di=function(){this.totalCount=0,this.data={}};di.prototype.train=function(r,t){for(var n in this.data[t]||(this.data[t]={}),r){var e=r[n];void 0===this.data[t][n]&&(this.data[t][n]={}),void 0===this.data[t][n][e]&&(this.data[t][n][e]=0),this.data[t][n][e]++}this.totalCount++},di.prototype.score=function(r){var t,n={};for(var e in r){var o=r[e];for(t in this.data)n[t]={},this.data[t][e]?n[t][e+"_"+o]=(this.data[t][e][o]||0)/this.totalCount:n[t][e+"_"+o]=0}var a={};for(t in n)for(var i in a[t]=0,n[t])a[t]+=n[t][i];return a};var gi=function(){this.weights=[],this.bias=0};gi.prototype.predict=function(r){if(r.length!==this.weights.length)return null;for(var t=0,n=0;n<this.weights.length;n++)t+=this.weights[n]*r[n];return(t+=this.bias)>0?1:0},gi.prototype.train=function(r,t){if(0!==t&&1!==t)return null;r.length!==this.weights.length&&(this.weights=r,this.bias=1);var n=this.predict(r);if("number"==typeof n&&n!==t){for(var e=t-n,o=0;o<this.weights.length;o++)this.weights[o]+=e*r[o];this.bias+=e}return this};var bi=1e-4;function yi(r){if(r<0)throw new Error("factorial requires a non-negative value");if(Math.floor(r)!==r)throw new Error("factorial requires an integer input");for(var t=1,n=2;n<=r;n++)t*=n;return t}var wi=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],ji=Math.log(Math.sqrt(2*Math.PI));var xi={1:{.995:0,.99:0,.975:0,.95:0,.9:.02,.5:.45,.1:2.71,.05:3.84,.025:5.02,.01:6.63,.005:7.88},2:{.995:.01,.99:.02,.975:.05,.95:.1,.9:.21,.5:1.39,.1:4.61,.05:5.99,.025:7.38,.01:9.21,.005:10.6},3:{.995:.07,.99:.11,.975:.22,.95:.35,.9:.58,.5:2.37,.1:6.25,.05:7.81,.025:9.35,.01:11.34,.005:12.84},4:{.995:.21,.99:.3,.975:.48,.95:.71,.9:1.06,.5:3.36,.1:7.78,.05:9.49,.025:11.14,.01:13.28,.005:14.86},5:{.995:.41,.99:.55,.975:.83,.95:1.15,.9:1.61,.5:4.35,.1:9.24,.05:11.07,.025:12.83,.01:15.09,.005:16.75},6:{.995:.68,.99:.87,.975:1.24,.95:1.64,.9:2.2,.5:5.35,.1:10.65,.05:12.59,.025:14.45,.01:16.81,.005:18.55},7:{.995:.99,.99:1.25,.975:1.69,.95:2.17,.9:2.83,.5:6.35,.1:12.02,.05:14.07,.025:16.01,.01:18.48,.005:20.28},8:{.995:1.34,.99:1.65,.975:2.18,.95:2.73,.9:3.49,.5:7.34,.1:13.36,.05:15.51,.025:17.53,.01:20.09,.005:21.96},9:{.995:1.73,.99:2.09,.975:2.7,.95:3.33,.9:4.17,.5:8.34,.1:14.68,.05:16.92,.025:19.02,.01:21.67,.005:23.59},10:{.995:2.16,.99:2.56,.975:3.25,.95:3.94,.9:4.87,.5:9.34,.1:15.99,.05:18.31,.025:20.48,.01:23.21,.005:25.19},11:{.995:2.6,.99:3.05,.975:3.82,.95:4.57,.9:5.58,.5:10.34,.1:17.28,.05:19.68,.025:21.92,.01:24.72,.005:26.76},12:{.995:3.07,.99:3.57,.975:4.4,.95:5.23,.9:6.3,.5:11.34,.1:18.55,.05:21.03,.025:23.34,.01:26.22,.005:28.3},13:{.995:3.57,.99:4.11,.975:5.01,.95:5.89,.9:7.04,.5:12.34,.1:19.81,.05:22.36,.025:24.74,.01:27.69,.005:29.82},14:{.995:4.07,.99:4.66,.975:5.63,.95:6.57,.9:7.79,.5:13.34,.1:21.06,.05:23.68,.025:26.12,.01:29.14,.005:31.32},15:{.995:4.6,.99:5.23,.975:6.27,.95:7.26,.9:8.55,.5:14.34,.1:22.31,.05:25,.025:27.49,.01:30.58,.005:32.8},16:{.995:5.14,.99:5.81,.975:6.91,.95:7.96,.9:9.31,.5:15.34,.1:23.54,.05:26.3,.025:28.85,.01:32,.005:34.27},17:{.995:5.7,.99:6.41,.975:7.56,.95:8.67,.9:10.09,.5:16.34,.1:24.77,.05:27.59,.025:30.19,.01:33.41,.005:35.72},18:{.995:6.26,.99:7.01,.975:8.23,.95:9.39,.9:10.87,.5:17.34,.1:25.99,.05:28.87,.025:31.53,.01:34.81,.005:37.16},19:{.995:6.84,.99:7.63,.975:8.91,.95:10.12,.9:11.65,.5:18.34,.1:27.2,.05:30.14,.025:32.85,.01:36.19,.005:38.58},20:{.995:7.43,.99:8.26,.975:9.59,.95:10.85,.9:12.44,.5:19.34,.1:28.41,.05:31.41,.025:34.17,.01:37.57,.005:40},21:{.995:8.03,.99:8.9,.975:10.28,.95:11.59,.9:13.24,.5:20.34,.1:29.62,.05:32.67,.025:35.48,.01:38.93,.005:41.4},22:{.995:8.64,.99:9.54,.975:10.98,.95:12.34,.9:14.04,.5:21.34,.1:30.81,.05:33.92,.025:36.78,.01:40.29,.005:42.8},23:{.995:9.26,.99:10.2,.975:11.69,.95:13.09,.9:14.85,.5:22.34,.1:32.01,.05:35.17,.025:38.08,.01:41.64,.005:44.18},24:{.995:9.89,.99:10.86,.975:12.4,.95:13.85,.9:15.66,.5:23.34,.1:33.2,.05:36.42,.025:39.36,.01:42.98,.005:45.56},25:{.995:10.52,.99:11.52,.975:13.12,.95:14.61,.9:16.47,.5:24.34,.1:34.28,.05:37.65,.025:40.65,.01:44.31,.005:46.93},26:{.995:11.16,.99:12.2,.975:13.84,.95:15.38,.9:17.29,.5:25.34,.1:35.56,.05:38.89,.025:41.92,.01:45.64,.005:48.29},27:{.995:11.81,.99:12.88,.975:14.57,.95:16.15,.9:18.11,.5:26.34,.1:36.74,.05:40.11,.025:43.19,.01:46.96,.005:49.65},28:{.995:12.46,.99:13.57,.975:15.31,.95:16.93,.9:18.94,.5:27.34,.1:37.92,.05:41.34,.025:44.46,.01:48.28,.005:50.99},29:{.995:13.12,.99:14.26,.975:16.05,.95:17.71,.9:19.77,.5:28.34,.1:39.09,.05:42.56,.025:45.72,.01:49.59,.005:52.34},30:{.995:13.79,.99:14.95,.975:16.79,.95:18.49,.9:20.6,.5:29.34,.1:40.26,.05:43.77,.025:46.98,.01:50.89,.005:53.67},40:{.995:20.71,.99:22.16,.975:24.43,.95:26.51,.9:29.05,.5:39.34,.1:51.81,.05:55.76,.025:59.34,.01:63.69,.005:66.77},50:{.995:27.99,.99:29.71,.975:32.36,.95:34.76,.9:37.69,.5:49.33,.1:63.17,.05:67.5,.025:71.42,.01:76.15,.005:79.49},60:{.995:35.53,.99:37.48,.975:40.48,.95:43.19,.9:46.46,.5:59.33,.1:74.4,.05:79.08,.025:83.3,.01:88.38,.005:91.95},70:{.995:43.28,.99:45.44,.975:48.76,.95:51.74,.9:55.33,.5:69.33,.1:85.53,.05:90.53,.025:95.02,.01:100.42,.005:104.22},80:{.995:51.17,.99:53.54,.975:57.15,.95:60.39,.9:64.28,.5:79.33,.1:96.58,.05:101.88,.025:106.63,.01:112.33,.005:116.32},90:{.995:59.2,.99:61.75,.975:65.65,.95:69.13,.9:73.29,.5:89.33,.1:107.57,.05:113.14,.025:118.14,.01:124.12,.005:128.3},100:{.995:67.33,.99:70.06,.975:74.22,.95:77.93,.9:82.36,.5:99.33,.1:118.5,.05:124.34,.025:129.56,.01:135.81,.005:140.17}};var _i=Math.sqrt(2*Math.PI),Mi={gaussian:function(r){return Math.exp(-.5*r*r)/_i}},Pi={nrd:function(r){var t=si(r),n=Ja(r);return"number"==typeof n&&(t=Math.min(t,n/1.34)),1.06*t*Math.pow(r.length,-.2)}};function qi(r,t,n){var e,o;if(void 0===t)e=Mi.gaussian;else if("string"==typeof t){if(!Mi[t])throw new Error('Unknown kernel "'+t+'"');e=Mi[t]}else e=t;if(void 0===n)o=Pi.nrd(r);else if("string"==typeof n){if(!Pi[n])throw new Error('Unknown bandwidth method "'+n+'"');o=Pi[n](r)}else o=n;return function(t){var n=0,a=0;for(n=0;n<r.length;n++)a+=e((t-r[n])/o);return a/o/r.length}}var Ai=Math.sqrt(2*Math.PI);function Si(r){for(var t=r,n=r,e=1;e<15;e++)t+=n*=r*r/(2*e+1);return Math.round(1e4*(.5+t/Ai*Math.exp(-r*r/2)))/1e4}for(var Ei=[],Oi=0;Oi<=3.09;Oi+=.01)Ei.push(Si(Oi));function ki(r){var t=1/(1+.5*Math.abs(r)),n=t*Math.exp(-r*r+((((((((.17087277*t-.82215223)*t+1.48851587)*t-1.13520398)*t+.27886807)*t-.18628806)*t+.09678418)*t+.37409196)*t+1.00002368)*t-1.26551223);return r>=0?1-n:n-1}function Ni(r){var t=8*(Math.PI-3)/(3*Math.PI*(4-Math.PI)),n=Math.sqrt(Math.sqrt(Math.pow(2/(Math.PI*t)+Math.log(1-r*r)/2,2)-Math.log(1-r*r)/t)-(2/(Math.PI*t)+Math.log(1-r*r)/2));return r>=0?n:-n}function Ii(r){if("number"==typeof r)return r<0?-1:0===r?0:1;throw new TypeError("not a number")}function zi(r,t){for(var n=0,e=0;e<r.length;e++){var o=r[e]-t[e];n+=o*o}return Math.sqrt(n)}function Fi(r,t){return r.map((function(r){for(var n=Number.MAX_VALUE,e=-1,o=0;o<t.length;o++){var a=zi(r,t[o]);a<n&&(n=a,e=o)}return e}))}function Ti(r,t,n){for(var e=r[0].length,o=ai(n,e),a=Array(n).fill(0),i=r.length,u=0;u<i;u++){for(var f=r[u],l=t[u],c=o[l],s=0;s<e;s++)c[s]+=f[s];a[l]+=1}for(var p=0;p<n;p++){if(0===a[p])throw new Error("Centroid "+p+" has no friends");for(var h=o[p],m=0;m<e;m++)h[m]/=a[p]}return o}function $i(r,t){for(var n=0,e=0;e<r.length;e++)n+=zi(r[e],t[e]);return n}function Ri(r,t){if(r.length!==t.length)throw new Error("must have exactly as many labels as points");for(var n=function(r){for(var t=1+Ba(r),n=Array(t),e=0;e<r.length;e++){var o=r[e];void 0===n[o]&&(n[o]=[]),n[o].push(e)}return n}(t),e=function(r){for(var t=r.length,n=ai(t,t),e=0;e<t;e++)for(var o=0;o<e;o++)n[e][o]=zi(r[e],r[o]),n[o][e]=n[e][o];return n}(r),o=[],a=0;a<r.length;a++){var i=0;if(n[t[a]].length>1){var u=Di(a,n[t[a]],e),f=Ci(a,t,n,e);i=(f-u)/Math.max(u,f)}o.push(i)}return o}function Ci(r,t,n,e){for(var o=t[r],a=Number.MAX_VALUE,i=0;i<n.length;i++)if(i!==o){var u=Di(r,n[i],e);u<a&&(a=u)}return a}function Di(r,t,n){for(var e=0,o=0;o<t.length;o++)e+=n[r][t[o]];return e/t.length}function Li(r,t){return 0===r&&0===t?0:Math.abs((r-t)/t)}var Ui=Object.freeze({__proto__:null,BayesianClassifier:di,PerceptronModel:gi,addToMean:function(r,t,n){return r+(n-r)/(t+1)},approxEqual:function(r,t,n){return void 0===n&&(n=bi),Li(r,t)<=n},average:Ta,averageSimple:mi,bayesian:di,bernoulliDistribution:function(r){if(r<0||r>1)throw new Error("bernoulliDistribution requires probability to be between 0 and 1 inclusive");return[1-r,r]},binomialDistribution:function(r,t){if(!(t<0||t>1||r<=0||r%1!=0)){var n=0,e=0,o=[],a=1;do{o[n]=a*Math.pow(t,n)*Math.pow(1-t,r-n),e+=o[n],a=a*(r-++n+1)/n}while(e<1-bi);return o}},bisect:function(r,t,n,e,o){if("function"!=typeof r)throw new TypeError("func must be a function");for(var a=0;a<e;a++){var i=(t+n)/2;if(0===r(i)||Math.abs((n-t)/2)<o)return i;Ii(r(i))===Ii(r(t))?t=i:n=i}throw new Error("maximum number of iterations exceeded")},chiSquaredDistributionTable:xi,chiSquaredGoodnessOfFit:function(r,t,n){for(var e=0,o=t(Ta(r)),a=[],i=[],u=0;u<r.length;u++)void 0===a[r[u]]&&(a[r[u]]=0),a[r[u]]++;for(var f=0;f<a.length;f++)void 0===a[f]&&(a[f]=0);for(var l in o)l in a&&(i[+l]=o[l]*r.length);for(var c=i.length-1;c>=0;c--)i[c]<3&&(i[c-1]+=i[c],i.pop(),a[c-1]+=a[c],a.pop());for(var s=0;s<a.length;s++)e+=Math.pow(a[s]-i[s],2)/i[s];var p=a.length-1-1;return xi[p][n]<e},chunk:function(r,t){var n=[];if(t<1)throw new Error("chunk size must be a positive number");if(Math.floor(t)!==t)throw new Error("chunk size must be an integer");for(var e=0;e<r.length;e+=t)n.push(r.slice(e,e+t));return n},ckmeans:function(r,t){if(t>r.length)throw new Error("cannot generate more classes than there are data values");var n=La(r);if(1===ii(n))return[n];var e=ai(t,n.length),o=ai(t,n.length);!function(r,t,n){for(var e=t[0].length,o=r[Math.floor(e/2)],a=[],i=[],u=0,f=void 0;u<e;++u)f=r[u]-o,0===u?(a.push(f),i.push(f*f)):(a.push(a[u-1]+f),i.push(i[u-1]+f*f)),t[0][u]=ui(0,u,a,i),n[0][u]=0;for(var l=1;l<t.length;++l)fi(l<t.length-1?l:e-1,e-1,l,t,n,a,i)}(n,e,o);for(var a=[],i=o[0].length-1,u=o.length-1;u>=0;u--){var f=o[u][i];a[u]=n.slice(f,i+1),u>0&&(i=f-1)}return a},coefficientOfVariation:function(r){return si(r)/Ta(r)},combinations:function r(t,n){var e,o,a,i,u=[];for(e=0;e<t.length;e++)if(1===n)u.push([t[e]]);else for(a=r(t.slice(e+1,t.length),n-1),o=0;o<a.length;o++)(i=a[o]).unshift(t[e]),u.push(i);return u},combinationsReplacement:function r(t,n){for(var e=[],o=0;o<t.length;o++)if(1===n)e.push([t[o]]);else for(var a=r(t.slice(o,t.length),n-1),i=0;i<a.length;i++)e.push([t[o]].concat(a[i]));return e},combineMeans:hi,combineVariances:function(r,t,n,e,o,a){var i=hi(t,n,o,a);return(n*(r+Math.pow(t-i,2))+a*(e+Math.pow(o-i,2)))/(n+a)},cumulativeStdLogisticProbability:function(r){return 1/(Math.exp(-r)+1)},cumulativeStdNormalProbability:function(r){var t=Math.abs(r),n=Math.min(Math.round(100*t),Ei.length-1);return r>=0?Ei[n]:+(1-Ei[n]).toFixed(4)},epsilon:bi,equalIntervalBreaks:function(r,t){if(r.length<2)return r;for(var n=Ua(r),e=Ba(r),o=[n],a=(e-n)/t,i=1;i<t;i++)o.push(o[0]+a*i);return o.push(e),o},erf:ki,errorFunction:ki,extent:function(r){if(0===r.length)throw new Error("extent requires at least one data point");for(var t=r[0],n=r[0],e=1;e<r.length;e++)r[e]>n&&(n=r[e]),r[e]<t&&(t=r[e]);return[t,n]},extentSorted:function(r){return[r[0],r[r.length-1]]},factorial:yi,gamma:function r(t){if(Number.isInteger(t))return t<=0?NaN:yi(t-1);if(--t<0)return Math.PI/(Math.sin(Math.PI*-t)*r(-t));var n=t+1/4;return Math.pow(t/Math.E,t)*Math.sqrt(2*Math.PI*(t+1/6))*(1+1/144/Math.pow(n,2)-1/12960/Math.pow(n,3)-257/207360/Math.pow(n,4)-52/2612736/Math.pow(n,5)+5741173/9405849600/Math.pow(n,6)+37529/18811699200/Math.pow(n,7))},gammaln:function(r){if(r<=0)return 1/0;r--;for(var t=wi[0],n=1;n<15;n++)t+=wi[n]/(r+n);var e=5.2421875+r;return ji+Math.log(t)-e+(r+.5)*Math.log(e)},geometricMean:function(r){if(0===r.length)throw new Error("geometricMean requires at least one data point");for(var t=1,n=0;n<r.length;n++){if(r[n]<0)throw new Error("geometricMean requires only non-negative numbers as input");t*=r[n]}return Math.pow(t,1/r.length)},harmonicMean:function(r){if(0===r.length)throw new Error("harmonicMean requires at least one data point");for(var t=0,n=0;n<r.length;n++){if(r[n]<=0)throw new Error("harmonicMean requires only positive numbers as input");t+=1/r[n]}return r.length/t},interquartileRange:Ja,inverseErrorFunction:Ni,iqr:Ja,jenks:function(r,t){if(t>r.length)return null;var n=function(r,t){var n,e,o=[],a=[],i=0;for(n=0;n<r.length+1;n++){var u=[],f=[];for(e=0;e<t+1;e++)u.push(0),f.push(0);o.push(u),a.push(f)}for(n=1;n<t+1;n++)for(o[1][n]=1,a[1][n]=0,e=2;e<r.length+1;e++)a[e][n]=1/0;for(var l=2;l<r.length+1;l++){for(var c=0,s=0,p=0,h=0,m=1;m<l+1;m++){var v=l-m+1,d=r[v-1];if(i=(s+=d*d)-(c+=d)*c/++p,0!=(h=v-1))for(e=2;e<t+1;e++)a[l][e]>=i+a[h][e-1]&&(o[l][e]=v,a[l][e]=i+a[h][e-1])}o[l][1]=1,a[l][1]=i}return{lowerClassLimits:o,varianceCombinations:a}}(r=r.slice().sort((function(r,t){return r-t})),t);return function(r,t,n){var e=r.length,o=[],a=n;for(o[n]=r[r.length-1];a>0;)o[a-1]=r[t[e][a]-1],e=t[e][a]-1,a--;return o}(r,n.lowerClassLimits,t)},kMeansCluster:function(r,t,n){void 0===n&&(n=Math.random);for(var e=null,o=oi(r,t,n),a=null,i=Number.MAX_VALUE;0!==i;)e=o,i=$i(o=Ti(r,a=Fi(r,o),t),e);return{labels:a,centroids:o}},kde:qi,kernelDensityEstimation:qi,linearRegression:function(r){var t,n,e=r.length;if(1===e)t=0,n=r[0][1];else{for(var o,a,i,u=0,f=0,l=0,c=0,s=0;s<e;s++)u+=a=(o=r[s])[0],f+=i=o[1],l+=a*a,c+=a*i;n=f/e-(t=(e*c-u*f)/(e*l-u*u))*u/e}return{m:t,b:n}},linearRegressionLine:function(r){return function(t){return r.b+r.m*t}},logAverage:function(r){if(0===r.length)throw new Error("logAverage requires at least one data point");for(var t=0,n=0;n<r.length;n++){if(r[n]<0)throw new Error("logAverage requires only non-negative numbers as input");t+=Math.log(r[n])}return Math.exp(t/r.length)},logit:function(r){if(r<=0||r>=1)throw new Error("p must be strictly between zero and one");return Math.log(r/(1-r))},mad:ti,max:Ba,maxSorted:function(r){return r[r.length-1]},mean:Ta,meanSimple:mi,median:ri,medianAbsoluteDeviation:ti,medianSorted:function(r){return Va(r,.5)},min:Ua,minSorted:function(r){return r[0]},mode:function(r){return Da(La(r))},modeFast:function(r){for(var t,n=new Map,e=0,o=0;o<r.length;o++){var a=n.get(r[o]);void 0===a?a=1:a++,a>e&&(t=r[o],e=a),n.set(r[o],a)}if(0===e)throw new Error("mode requires at last one data point");return t},modeSorted:Da,numericSort:La,perceptron:gi,permutationTest:function(r,t,n,e,o){if(void 0===e&&(e=1e4),void 0===n&&(n="two_side"),"two_side"!==n&&"greater"!==n&&"less"!==n)throw new Error("`alternative` must be either 'two_side', 'greater', or 'less'.");for(var a=Ta(r)-Ta(t),i=new Array(e),u=r.concat(t),f=Math.floor(u.length/2),l=0;l<e;l++){ni(u,o);var c=u.slice(0,f),s=u.slice(f,u.length),p=Ta(c)-Ta(s);i[l]=p}var h=0;if("two_side"===n)for(var m=0;m<=e;m++)Math.abs(i[m])>=Math.abs(a)&&(h+=1);else if("greater"===n)for(var v=0;v<=e;v++)i[v]>=a&&(h+=1);else for(var d=0;d<=e;d++)i[d]<=a&&(h+=1);return h/e},permutationsHeap:function(r){for(var t=new Array(r.length),n=[r.slice()],e=0;e<r.length;e++)t[e]=0;for(var o=0;o<r.length;)if(t[o]<o){var a=0;o%2!=0&&(a=t[o]);var i=r[a];r[a]=r[o],r[o]=i,n.push(r.slice()),t[o]++,o=0}else t[o]=0,o++;return n},poissonDistribution:function(r){if(!(r<=0)){var t=0,n=0,e=[],o=1;do{e[t]=Math.exp(-r)*Math.pow(r,t)/o,n+=e[t],o*=++t}while(n<1-bi);return e}},probit:function(r){return 0===r?r=bi:r>=1&&(r=1-bi),Math.sqrt(2)*Ni(2*r-1)},product:function(r){for(var t=1,n=0;n<r.length;n++)t*=r[n];return t},quantile:Ya,quantileRank:function(r,t){return Za(La(r),t)},quantileRankSorted:Za,quantileSorted:Va,quickselect:Wa,rSquared:function(r,t){if(r.length<2)return 1;for(var n=0,e=0;e<r.length;e++)n+=r[e][1];for(var o=n/r.length,a=0,i=0;i<r.length;i++)a+=Math.pow(o-r[i][1],2);for(var u=0,f=0;f<r.length;f++)u+=Math.pow(r[f][1]-t(r[f][0]),2);return 1-u/a},relativeError:Li,rms:vi,rootMeanSquare:vi,sample:oi,sampleCorrelation:pi,sampleCovariance:li,sampleKurtosis:function(r){var t=r.length;if(t<4)throw new Error("sampleKurtosis requires at least four data points");for(var n,e=Ta(r),o=0,a=0,i=0;i<t;i++)o+=(n=r[i]-e)*n,a+=n*n*n*n;return(t-1)/((t-2)*(t-3))*(t*(t+1)*a/(o*o)-3*(t-1))},sampleRankCorrelation:function(r,t){for(var n=r.map((function(r,t){return[r,t]})).sort((function(r,t){return r[0]-t[0]})).map((function(r){return r[1]})),e=t.map((function(r,t){return[r,t]})).sort((function(r,t){return r[0]-t[0]})).map((function(r){return r[1]})),o=Array(n.length),a=Array(n.length),i=0;i<n.length;i++)o[n[i]]=i,a[e[i]]=i;return pi(o,a)},sampleSkewness:function(r){if(r.length<3)throw new Error("sampleSkewness requires at least three data points");for(var t,n=Ta(r),e=0,o=0,a=0;a<r.length;a++)e+=(t=r[a]-n)*t,o+=t*t*t;var i=r.length-1,u=Math.sqrt(e/i),f=r.length;return f*o/((f-1)*(f-2)*Math.pow(u,3))},sampleStandardDeviation:si,sampleVariance:ci,sampleWithReplacement:function(r,t,n){if(0===r.length)return[];n=n||Math.random;for(var e=r.length,o=[],a=0;a<t;a++){var i=Math.floor(n()*e);o.push(r[i])}return o},shuffle:ei,shuffleInPlace:ni,sign:Ii,silhouette:Ri,silhouetteMetric:function(r,t){return Ba(Ri(r,t))},standardDeviation:Ca,standardNormalTable:Ei,subtractFromMean:function(r,t,n){return(r*t-n)/(t-1)},sum:Fa,sumNthPowerDeviations:$a,sumSimple:Ga,tTest:function(r,t){return(Ta(r)-t)/(Ca(r)/Math.sqrt(r.length))},tTestTwoSample:function(r,t,n){var e=r.length,o=t.length;if(!e||!o)return null;n||(n=0);var a=Ta(r),i=Ta(t),u=ci(r),f=ci(t);if("number"==typeof a&&"number"==typeof i&&"number"==typeof u&&"number"==typeof f){var l=((e-1)*u+(o-1)*f)/(e+o-2);return(a-i-n)/Math.sqrt(l*(1/e+1/o))}},uniqueCountSorted:ii,variance:Ra,wilcoxonRankSum:function(r,t){if(!r.length||!t.length)throw new Error("Neither sample can be empty");for(var n=r.map((function(r){return{label:"x",value:r}})).concat(t.map((function(r){return{label:"y",value:r}}))).sort((function(r,t){return r.value-t.value})),e=0;e<n.length;e++)n[e].rank=e;for(var o=[n[0].rank],a=1;a<n.length;a++)n[a].value===n[a-1].value?(o.push(n[a].rank),a===n.length-1&&i(n,o)):o.length>1?i(n,o):o=[n[a].rank];function i(r,t){for(var n=(t[0]+t[t.length-1])/2,e=0;e<t.length;e++)r[t[e]].rank=n}for(var u=0,f=0;f<n.length;f++){var l=n[f];"x"===l.label&&(u+=l.rank+1)}return u},zScore:function(r,t,n){return(r-t)/n}});let Bi=On(Gi=Ui,"default.default")?Gi.default.default:On(Gi,"default")?Gi.default:Gi;var Gi;var Vi="[object Boolean]";function Wi(r){return!0===(t=r)||!1===t||ir(t)&&y(t)==Vi;var t}function Xi(r){if(Je(r)){for(let t in r)return!0;return!1}return!1}function Yi(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=On(t,"interpX");ao(n)||(n=null);let e=On(t,"useRegIntercept");Wi(e)||(e=!0);let o=On(t,"useSync");Wi(o)||(o=!1);let a=()=>{let t=[];if(Uo(r,(r=>{let n=On(r,0),e=On(r,1);ao(n)&&ao(e)&&t.push([yo(n),yo(e)])})),0===qr(t))return null;let o=null;if(e)o=Bi.linearRegression(t);else{let r=0,n=0;Uo(t,(t=>{r+=t[0]**2,n+=t[0]*t[1]}));let e=null;0!==r&&(e=n/r),o={m:e,b:0}}if(ao(n)){n=yo(n);let r=Bi.linearRegressionLine(o)(n);o.interpY=r}return o};return o?a():(async()=>{let r=null;try{return r=a(),Xi(r)?r:Promise.reject("no effective data")}catch(r){return console.log(r),Promise.reject(r.toString())}})()}var Hi=9007199254740991,Qi=4294967295,Ki=Math.min;r.arrAverage=jo,r.arrAverageWithLogNormCI=async function(r,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"two-tailed";if(!kr(r))return Promise.reject("arr is not an array");if(0===qr(r))return Promise.reject("arr is not an effective array");if(!ao(t))return Promise.reject(`p[${t}] is not a number`);if((t=yo(t))<0)return Promise.reject(`p[${t}] < 0`);if(t>1)return Promise.reject(`p[${t}] > 1`);if("two-tailed"!==n&&"upper-tail"!==n&&"lower-tail"!==n)return Promise.reject(`mode[${n}] is not 'two-tailed', 'upper-tail' or 'lower-tail'`);let e=Mo(r);if(0===qr(e))return Promise.reject("no effective data");let o=await Do(e,t,n);return o=kr(o)?[Math.exp(o[0]),Math.exp(o[1])]:Math.exp(o),o},r.arrAverageWithNormCI=Do,r.arrCount=function(r){if(!kr(r))return[];if(0===qr(r))return[];let t=[];if(Uo(r,(r=>{(ao(r)||oo(r))&&t.push(function(r){if(!oo(r)&&!ao(r)&&!fn(r))return"";let t="";try{t=String(r)}catch(r){}try{t=r.toString()}catch(r){}return t}(r))})),0===qr(t))return[];t=Un(t,(r=>({v:r})));let n=Ho(t,"v");var e;return n=Un(n,((r,t)=>({key:t,count:qr(r)}))),n=la(n,"count"),n=null==(e=n)?e:ca.call(e),n},r.arrGammaFit=Ma,r.arrGammaHist=async function(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!kr(r))return Promise.reject("arr is not an array");if(0===qr(r))return Promise.reject("arr is not an effective array");let n=wo(r);n=Gn(n,(r=>r>0));let e=await Ma(r,t),o=await Aa(n,(r=>Un(r.curveX,(r=>Eo.gamma.pdf(r,e.shape,e.scale)))),t),a=Un(o.bins,((r,t)=>(r.pdf=o.pdfs[t],r))),i=Un(o.curveX,((r,t)=>({x:r,pdf:o.curveY[t]})));return{shape:e.shape,scale:e.scale,arr:o.arr,min:o.min,max:o.max,barWidth:o.barWidth,ratioForCountToPdf:o.ratioForCountToPdf,bins:a,curves:i}},r.arrGammaInv=async function(r,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!kr(r))return Promise.reject("arr is not an array");if(0===qr(r))return Promise.reject("arr is not an effective array");if(!ao(t))return Promise.reject(`ratio[${t}] is not a number`);if((t=yo(t))<0)return Promise.reject(`ratio[${t}] < 0`);if(t>1)return Promise.reject(`ratio[${t}] > 1`);let e=On(n,"n");Ro(e)||(e=30),e=$o(e);let o=On(n,"min",null),a=On(n,"max",null),i=await Ma(r,{n:e,min:o,max:a});return function(r){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ka(Object(n),!0).forEach((function(t){Oa(r,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):ka(Object(n)).forEach((function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(n,t))}))}return r}({inv:Eo.gamma.inv(t,i.shape,i.scale)},i)},r.arrGeometricAverage=Na,r.arrGeometricStd=function(r){if(!kr(r))return null;if(0===qr(r))return null;let t=Mo(r),n=qr(t);if(0===n)return null;if(n<=1)return null;let e=Oo(t);return Math.exp(e)},r.arrLogNormHist=async function(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!kr(r))return Promise.reject("arr is not an array");if(0===qr(r))return Promise.reject("arr is not an effective array");let n=await Ia(r,t),e=Mo(r),o=await Ia(e),a=Un(o.curves,(r=>({x:Math.exp(r.x),pdf:r.pdf}))),i=n.ratioForCountToPdf/o.ratioForCountToPdf;a=Un(a,(r=>(r.pdf*=i,r)));let u=Na(n.arr);return{avg:n.avg,std:n.std,avg_geo:u,avg_log:o.avg,std_log:o.std,arr:n.arr,min:n.min,max:n.max,barWidth:n.barWidth,ratioForCountToPdf:n.ratioForCountToPdf,bins:n.bins,curves:a}},r.arrLogNormInv=async function(r,t){if(!kr(r))return Promise.reject("arr is not an array");if(0===qr(r))return Promise.reject("arr is not an effective array");if(!ao(t))return Promise.reject(`ratio[${t}] is not a number`);if((t=yo(t))<0)return Promise.reject(`ratio[${t}] < 0`);if(t>1)return Promise.reject(`ratio[${t}] > 1`);let n=Mo(r);if(0===qr(n))return Promise.reject("no effective data");let e=await za(n,t);return qo(On(e,"inv"))?(e={inv:Math.exp(e.inv),avg:Math.exp(e.avg),std:Math.exp(e.std),arr:Un(e.arr,(r=>Math.exp(r)))},e):Promise.reject("invalid value from arrNormInv")},r.arrMovingAverage=function(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!kr(r))return[];if(0===qr(r))return[];let n=On(t,"selectCountHalf");var e;No(e=n)&&$o(e)>=0||(n=2),n=$o(n);let o=qr(r);if(0===o)return[];let a=Ze(r);return Uo(r,((t,e)=>{let i=e-n;i=Math.max(i,0),i=Math.min(i,o-1);let u=Math.max(e+n,0);u=Math.max(u,0),u=Math.min(u,o-1);let f=[];for(let t=i;t<=u;t++)f.push(r[t]);let l=jo(f);a[e]=l})),a},r.arrNormHist=Ia,r.arrNormInv=za,r.arrQuartile=function(r,t){if(!kr(r))return null;if(0===qr(r))return null;if(!xo(t))return null;(t=yo(t))<0&&(t=0),t>1&&(t=1);let n=wo(r);return 0===qr(n)?null:Bi.quantile(n,t)},r.arrStd=Oo,r.bin=_a,r.histGen=Aa,r.jStat=Eo,r.regLine=Yi,r.regPower=function(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=On(t,"interpX");ao(n)||(n=null);let e=On(t,"useSync");Wi(e)||(e=!1);let o=()=>{Uo(r,(r=>{let t=On(r,0),n=On(r,1);ao(t)&&ao(n)&&(t=yo(t),n=yo(n))}));let t=Yi(Un(r,(r=>[Math.log(r[0]),Math.log(r[1])])),{useRegIntercept:!0,useSync:!0});if(!Xi(t))return null;let e={a:Math.exp(t.b),b:t.m};if(ao(n)){n=yo(n);let r=e.a*n**e.b;e.interpY=r}return e};return e?o():(async()=>{let r=null;try{return r=o(),Xi(r)?r:Promise.reject("no effective data")}catch(r){return console.log(r),Promise.reject(r.toString())}})()},r.sampleRandom=async function(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null;if("beta"===r){let e=On(t,"alpha");if(!qo(e))return Promise.reject("opt.alpha is not a number");let o=On(t,"beta");if(!qo(o))return Promise.reject("opt.beta is not a number");n=()=>Eo[r].sample(e,o)}else if("centralF"===r){let e=On(t,"df1");if(!qo(e))return Promise.reject("opt.df1 is not a number");let o=On(t,"df2");if(!qo(o))return Promise.reject("opt.df2 is not a number");n=()=>Eo[r].sample(e,o)}else if("cauchy"===r){let e=On(t,"local");if(!qo(e))return Promise.reject("opt.local is not a number");let o=On(t,"scale");if(!qo(o))return Promise.reject("opt.scale is not a number");n=()=>Eo[r].sample(e,o)}else if("chisquare"===r){let e=On(t,"dof");if(!qo(e))return Promise.reject("opt.dof is not a number");n=()=>Eo[r].sample(e)}else if("exponential"===r){let e=On(t,"rate");if(!qo(e))return Promise.reject("opt.rate is not a number");n=()=>Eo[r].sample(e)}else if("gamma"===r){let e=On(t,"shape");if(!qo(e))return Promise.reject("opt.shape is not a number");let o=On(t,"scale");if(!qo(o))return Promise.reject("opt.scale is not a number");n=()=>Eo[r].sample(e,o)}else if("invgamma"===r){let e=On(t,"shape");if(!qo(e))return Promise.reject("opt.shape is not a number");let o=On(t,"scale");if(!qo(o))return Promise.reject("opt.scale is not a number");n=()=>Eo[r].sample(e,o)}else if("kumaraswamy"===r){let e=On(t,"alpha");if(!qo(e))return Promise.reject("opt.alpha is not a number");let o=On(t,"beta");if(!qo(o))return Promise.reject("opt.beta is not a number");n=()=>Eo[r].sample(e,o)}else if("lognormal"===r){let e=On(t,"mu");if(!qo(e))return Promise.reject("opt.mu is not a number");let o=On(t,"sigma");if(!qo(o))return Promise.reject("opt.sigma is not a number");n=()=>Eo[r].sample(e,o)}else if("normal"===r){let e=On(t,"mu");if(!qo(e))return Promise.reject("opt.mu is not a number");let o=On(t,"sigma");if(!qo(o))return Promise.reject("opt.sigma is not a number");n=()=>Eo[r].sample(e,o)}else{if("pareto"===r)return Promise.reject("invalid pareto.sample");if("studentt"===r){let e=On(t,"dof");if(!qo(e))return Promise.reject("opt.dof is not a number");n=()=>Eo[r].sample(e)}else{if("tukey"===r)return Promise.reject("invalid tukey.sample");if("weibull"===r){let e=On(t,"scale");if(!qo(e))return Promise.reject("opt.scale is not a number");let o=On(t,"shape");if(!qo(o))return Promise.reject("opt.shape is not a number");n=()=>Eo[r].sample(e,o)}else if("uniform"===r){let e=On(t,"a");if(!qo(e))return Promise.reject("opt.a is not a number");let o=On(t,"b");if(!qo(o))return Promise.reject("opt.b is not a number");n=()=>Eo[r].sample(e,o)}else{if("binomial"===r)return Promise.reject("invalid binomial.sample");if("negbin"===r)return Promise.reject("invalid negbin.sample");if("hypgeom"===r)return Promise.reject("invalid hypgeom.sample");if("poisson"===r){let e=On(t,"l");if(!qo(e))return Promise.reject("opt.l is not a number");n=()=>Eo[r].sample(e)}else if("triangular"===r){let e=On(t,"a");if(!qo(e))return Promise.reject("opt.a is not a number");let o=On(t,"b");if(!qo(o))return Promise.reject("opt.b is not a number");let a=On(t,"c");if(!qo(a))return Promise.reject("opt.c is not a number");n=()=>Eo[r].sample(e,o,a)}else{if("arcsine"!==r)return Promise.reject(`invalid name[${r}]`);{let e=On(t,"a");if(!qo(e))return Promise.reject("opt.a is not a number");let o=On(t,"b");if(!qo(o))return Promise.reject("opt.b is not a number");n=()=>Eo[r].sample(e,o)}}}}}let e=On(t,"num");e=$o(e),e<=0&&(e=1);let o=On(t,"low");o=ao(o)?yo(o):null;let a=On(t,"up");if(a=ao(a)?yo(a):null,null!==o&&null!==a&&o>=a)throw new Error(`low[${o}] >= up[${a}]`);let i=()=>{let r=n();return null!==o&&r<o&&(r=i()),null!==a&&r>a&&(r=i()),r},u=Un(function(r,t){if((r=ko(r))<1||r>Hi)return[];var n=Qi,e=Ki(r,Qi);t=Lo(t),r-=Qi;for(var o=wt(e,t);++n<r;)t(n);return o}(e),(()=>i()));return 1===e&&(u=u[0]),u},r.simpleStatistics=Bi,r.studentTInv=Co}));
//# sourceMappingURL=w-statistic.umd.js.map
