/*!
 * w-statistic v1.0.17
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((t="undefined"!=typeof globalThis?globalThis:t||self)["w-statistic"]={})}(this,(function(t){"use strict";var r=Object.prototype;function e(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||r)}function n(t,r){return function(e){return t(r(e))}}var o=n(Object.keys,Object),i=Object.prototype.hasOwnProperty;function s(t){if(!e(t))return o(t);var r=[];for(var n in Object(t))i.call(t,n)&&"constructor"!=n&&r.push(n);return r}var a="object"==typeof global&&global&&global.Object===Object&&global,u="object"==typeof self&&self&&self.Object===Object&&self,l=a||u||Function("return this")(),f=l.Symbol,c=Object.prototype,h=c.hasOwnProperty,m=c.toString,g=f?f.toStringTag:void 0;var p=Object.prototype.toString;var d="[object Null]",w="[object Undefined]",v=f?f.toStringTag:void 0;function y(t){return null==t?void 0===t?w:d:v&&v in Object(t)?function(t){var r=h.call(t,g),e=t[g];try{t[g]=void 0;var n=!0}catch(t){}var o=m.call(t);return n&&(r?t[g]=e:delete t[g]),o}(t):function(t){return p.call(t)}(t)}function b(t){var r=typeof t;return null!=t&&("object"==r||"function"==r)}var M="[object AsyncFunction]",x="[object Function]",j="[object GeneratorFunction]",E="[object Proxy]";function S(t){if(!b(t))return!1;var r=y(t);return r==x||r==j||r==M||r==E}var _,A=l["__core-js_shared__"],q=(_=/[^.]+$/.exec(A&&A.keys&&A.keys.IE_PROTO||""))?"Symbol(src)_1."+_:"";var P=Function.prototype.toString;function k(t){if(null!=t){try{return P.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var R=/^\[object .+?Constructor\]$/,N=Function.prototype,I=Object.prototype,O=N.toString,T=I.hasOwnProperty,C=RegExp("^"+O.call(T).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function F(t){return!(!b(t)||(r=t,q&&q in r))&&(S(t)?C:R).test(k(t));var r}function z(t,r){var e=function(t,r){return null==t?void 0:t[r]}(t,r);return F(e)?e:void 0}var $=z(l,"DataView"),V=z(l,"Map"),D=z(l,"Promise"),L=z(l,"Set"),U=z(l,"WeakMap"),B="[object Map]",W="[object Promise]",G="[object Set]",X="[object WeakMap]",Y="[object DataView]",Q=k($),H=k(V),J=k(D),K=k(L),Z=k(U),tt=y;($&&tt(new $(new ArrayBuffer(1)))!=Y||V&&tt(new V)!=B||D&&tt(D.resolve())!=W||L&&tt(new L)!=G||U&&tt(new U)!=X)&&(tt=function(t){var r=y(t),e="[object Object]"==r?t.constructor:void 0,n=e?k(e):"";if(n)switch(n){case Q:return Y;case H:return B;case J:return W;case K:return G;case Z:return X}return r});var rt=tt,et=9007199254740991;function nt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=et}function ot(t){return null!=t&&nt(t.length)&&!S(t)}var it=Array.isArray;function st(t){return null!=t&&"object"==typeof t}var at="[object String]";function ut(t){return function(r){return null==r?void 0:r[t]}}var lt=ut("length"),ft=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var ct="\\ud800-\\udfff",ht="["+ct+"]",mt="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",gt="\\ud83c[\\udffb-\\udfff]",pt="[^"+ct+"]",dt="(?:\\ud83c[\\udde6-\\uddff]){2}",wt="[\\ud800-\\udbff][\\udc00-\\udfff]",vt="(?:"+mt+"|"+gt+")"+"?",yt="[\\ufe0e\\ufe0f]?",bt=yt+vt+("(?:\\u200d(?:"+[pt,dt,wt].join("|")+")"+yt+vt+")*"),Mt="(?:"+[pt+mt+"?",mt,dt,wt,ht].join("|")+")",xt=RegExp(gt+"(?="+gt+")|"+Mt+bt,"g");function jt(t){return function(t){return ft.test(t)}(t)?function(t){for(var r=xt.lastIndex=0;xt.test(t);)++r;return r}(t):lt(t)}var Et="[object Map]",St="[object Set]";function _t(t){if(null==t)return 0;if(ot(t))return"string"==typeof(r=t)||!it(r)&&st(r)&&y(r)==at?jt(t):t.length;var r,e=rt(t);return e==Et||e==St?t.size:s(t).length}function At(t,r){for(var e,n=-1,o=t.length;++n<o;){var i=r(t[n]);void 0!==i&&(e=void 0===e?i:e+i)}return e}var qt=NaN;function Pt(t){return t}function kt(t){return function(t,r){var e=null==t?0:t.length;return e?At(t,r)/e:qt}(t,Pt)}function Rt(t){return"[object Array]"===Object.prototype.toString.call(t)}function Nt(t,r){for(var e=-1,n=null==t?0:t.length,o=Array(n);++e<n;)o[e]=r(t[e],e,t);return o}function It(t,r){return t===r||t!=t&&r!=r}function Ot(t,r){for(var e=t.length;e--;)if(It(t[e][0],r))return e;return-1}var Tt=Array.prototype.splice;function Ct(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}Ct.prototype.clear=function(){this.__data__=[],this.size=0},Ct.prototype.delete=function(t){var r=this.__data__,e=Ot(r,t);return!(e<0)&&(e==r.length-1?r.pop():Tt.call(r,e,1),--this.size,!0)},Ct.prototype.get=function(t){var r=this.__data__,e=Ot(r,t);return e<0?void 0:r[e][1]},Ct.prototype.has=function(t){return Ot(this.__data__,t)>-1},Ct.prototype.set=function(t,r){var e=this.__data__,n=Ot(e,t);return n<0?(++this.size,e.push([t,r])):e[n][1]=r,this};var Ft=z(Object,"create");var zt=Object.prototype.hasOwnProperty;var $t=Object.prototype.hasOwnProperty;function Vt(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}function Dt(t,r){var e,n,o=t.__data__;return("string"==(n=typeof(e=r))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==e:null===e)?o["string"==typeof r?"string":"hash"]:o.map}function Lt(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}Vt.prototype.clear=function(){this.__data__=Ft?Ft(null):{},this.size=0},Vt.prototype.delete=function(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r},Vt.prototype.get=function(t){var r=this.__data__;if(Ft){var e=r[t];return"__lodash_hash_undefined__"===e?void 0:e}return zt.call(r,t)?r[t]:void 0},Vt.prototype.has=function(t){var r=this.__data__;return Ft?void 0!==r[t]:$t.call(r,t)},Vt.prototype.set=function(t,r){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=Ft&&void 0===r?"__lodash_hash_undefined__":r,this},Lt.prototype.clear=function(){this.size=0,this.__data__={hash:new Vt,map:new(V||Ct),string:new Vt}},Lt.prototype.delete=function(t){var r=Dt(this,t).delete(t);return this.size-=r?1:0,r},Lt.prototype.get=function(t){return Dt(this,t).get(t)},Lt.prototype.has=function(t){return Dt(this,t).has(t)},Lt.prototype.set=function(t,r){var e=Dt(this,t),n=e.size;return e.set(t,r),this.size+=e.size==n?0:1,this};function Ut(t){var r=this.__data__=new Ct(t);this.size=r.size}Ut.prototype.clear=function(){this.__data__=new Ct,this.size=0},Ut.prototype.delete=function(t){var r=this.__data__,e=r.delete(t);return this.size=r.size,e},Ut.prototype.get=function(t){return this.__data__.get(t)},Ut.prototype.has=function(t){return this.__data__.has(t)},Ut.prototype.set=function(t,r){var e=this.__data__;if(e instanceof Ct){var n=e.__data__;if(!V||n.length<199)return n.push([t,r]),this.size=++e.size,this;e=this.__data__=new Lt(n)}return e.set(t,r),this.size=e.size,this};function Bt(t){var r=-1,e=null==t?0:t.length;for(this.__data__=new Lt;++r<e;)this.add(t[r])}function Wt(t,r){for(var e=-1,n=null==t?0:t.length;++e<n;)if(r(t[e],e,t))return!0;return!1}Bt.prototype.add=Bt.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Bt.prototype.has=function(t){return this.__data__.has(t)};var Gt=1,Xt=2;function Yt(t,r,e,n,o,i){var s=e&Gt,a=t.length,u=r.length;if(a!=u&&!(s&&u>a))return!1;var l=i.get(t),f=i.get(r);if(l&&f)return l==r&&f==t;var c=-1,h=!0,m=e&Xt?new Bt:void 0;for(i.set(t,r),i.set(r,t);++c<a;){var g=t[c],p=r[c];if(n)var d=s?n(p,g,c,r,t,i):n(g,p,c,t,r,i);if(void 0!==d){if(d)continue;h=!1;break}if(m){if(!Wt(r,(function(t,r){if(s=r,!m.has(s)&&(g===t||o(g,t,e,n,i)))return m.push(r);var s}))){h=!1;break}}else if(g!==p&&!o(g,p,e,n,i)){h=!1;break}}return i.delete(t),i.delete(r),h}var Qt=l.Uint8Array;function Ht(t){var r=-1,e=Array(t.size);return t.forEach((function(t,n){e[++r]=[n,t]})),e}function Jt(t){var r=-1,e=Array(t.size);return t.forEach((function(t){e[++r]=t})),e}var Kt=1,Zt=2,tr="[object Boolean]",rr="[object Date]",er="[object Error]",nr="[object Map]",or="[object Number]",ir="[object RegExp]",sr="[object Set]",ar="[object String]",ur="[object Symbol]",lr="[object ArrayBuffer]",fr="[object DataView]",cr=f?f.prototype:void 0,hr=cr?cr.valueOf:void 0;function mr(t,r){for(var e=-1,n=r.length,o=t.length;++e<n;)t[o+e]=r[e];return t}function gr(t,r,e){var n=r(t);return it(t)?n:mr(n,e(t))}function pr(t,r){for(var e=-1,n=null==t?0:t.length,o=0,i=[];++e<n;){var s=t[e];r(s,e,t)&&(i[o++]=s)}return i}function dr(){return[]}var wr=Object.prototype.propertyIsEnumerable,vr=Object.getOwnPropertySymbols,yr=vr?function(t){return null==t?[]:(t=Object(t),pr(vr(t),(function(r){return wr.call(t,r)})))}:dr;function br(t,r){for(var e=-1,n=Array(t);++e<t;)n[e]=r(e);return n}function Mr(t){return st(t)&&"[object Arguments]"==y(t)}var xr=Object.prototype,jr=xr.hasOwnProperty,Er=xr.propertyIsEnumerable,Sr=Mr(function(){return arguments}())?Mr:function(t){return st(t)&&jr.call(t,"callee")&&!Er.call(t,"callee")},_r=Sr;var Ar="object"==typeof t&&t&&!t.nodeType&&t,qr=Ar&&"object"==typeof module&&module&&!module.nodeType&&module,Pr=qr&&qr.exports===Ar?l.Buffer:void 0,kr=(Pr?Pr.isBuffer:void 0)||function(){return!1},Rr=9007199254740991,Nr=/^(?:0|[1-9]\d*)$/;function Ir(t,r){var e=typeof t;return!!(r=null==r?Rr:r)&&("number"==e||"symbol"!=e&&Nr.test(t))&&t>-1&&t%1==0&&t<r}var Or={};function Tr(t){return function(r){return t(r)}}Or["[object Float32Array]"]=Or["[object Float64Array]"]=Or["[object Int8Array]"]=Or["[object Int16Array]"]=Or["[object Int32Array]"]=Or["[object Uint8Array]"]=Or["[object Uint8ClampedArray]"]=Or["[object Uint16Array]"]=Or["[object Uint32Array]"]=!0,Or["[object Arguments]"]=Or["[object Array]"]=Or["[object ArrayBuffer]"]=Or["[object Boolean]"]=Or["[object DataView]"]=Or["[object Date]"]=Or["[object Error]"]=Or["[object Function]"]=Or["[object Map]"]=Or["[object Number]"]=Or["[object Object]"]=Or["[object RegExp]"]=Or["[object Set]"]=Or["[object String]"]=Or["[object WeakMap]"]=!1;var Cr="object"==typeof t&&t&&!t.nodeType&&t,Fr=Cr&&"object"==typeof module&&module&&!module.nodeType&&module,zr=Fr&&Fr.exports===Cr&&a.process,$r=function(){try{var t=Fr&&Fr.require&&Fr.require("util").types;return t||zr&&zr.binding&&zr.binding("util")}catch(t){}}(),Vr=$r&&$r.isTypedArray,Dr=Vr?Tr(Vr):function(t){return st(t)&&nt(t.length)&&!!Or[y(t)]},Lr=Object.prototype.hasOwnProperty;function Ur(t,r){var e=it(t),n=!e&&_r(t),o=!e&&!n&&kr(t),i=!e&&!n&&!o&&Dr(t),s=e||n||o||i,a=s?br(t.length,String):[],u=a.length;for(var l in t)!r&&!Lr.call(t,l)||s&&("length"==l||o&&("offset"==l||"parent"==l)||i&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Ir(l,u))||a.push(l);return a}function Br(t){return ot(t)?Ur(t):s(t)}function Wr(t){return gr(t,Br,yr)}var Gr=1,Xr=Object.prototype.hasOwnProperty;var Yr=1,Qr="[object Arguments]",Hr="[object Array]",Jr="[object Object]",Kr=Object.prototype.hasOwnProperty;function Zr(t,r,e,n,o,i){var s=it(t),a=it(r),u=s?Hr:rt(t),l=a?Hr:rt(r),f=(u=u==Qr?Jr:u)==Jr,c=(l=l==Qr?Jr:l)==Jr,h=u==l;if(h&&kr(t)){if(!kr(r))return!1;s=!0,f=!1}if(h&&!f)return i||(i=new Ut),s||Dr(t)?Yt(t,r,e,n,o,i):function(t,r,e,n,o,i,s){switch(e){case fr:if(t.byteLength!=r.byteLength||t.byteOffset!=r.byteOffset)return!1;t=t.buffer,r=r.buffer;case lr:return!(t.byteLength!=r.byteLength||!i(new Qt(t),new Qt(r)));case tr:case rr:case or:return It(+t,+r);case er:return t.name==r.name&&t.message==r.message;case ir:case ar:return t==r+"";case nr:var a=Ht;case sr:var u=n&Kt;if(a||(a=Jt),t.size!=r.size&&!u)return!1;var l=s.get(t);if(l)return l==r;n|=Zt,s.set(t,r);var f=Yt(a(t),a(r),n,o,i,s);return s.delete(t),f;case ur:if(hr)return hr.call(t)==hr.call(r)}return!1}(t,r,u,e,n,o,i);if(!(e&Yr)){var m=f&&Kr.call(t,"__wrapped__"),g=c&&Kr.call(r,"__wrapped__");if(m||g){var p=m?t.value():t,d=g?r.value():r;return i||(i=new Ut),o(p,d,e,n,i)}}return!!h&&(i||(i=new Ut),function(t,r,e,n,o,i){var s=e&Gr,a=Wr(t),u=a.length;if(u!=Wr(r).length&&!s)return!1;for(var l=u;l--;){var f=a[l];if(!(s?f in r:Xr.call(r,f)))return!1}var c=i.get(t),h=i.get(r);if(c&&h)return c==r&&h==t;var m=!0;i.set(t,r),i.set(r,t);for(var g=s;++l<u;){var p=t[f=a[l]],d=r[f];if(n)var w=s?n(d,p,f,r,t,i):n(p,d,f,t,r,i);if(!(void 0===w?p===d||o(p,d,e,n,i):w)){m=!1;break}g||(g="constructor"==f)}if(m&&!g){var v=t.constructor,y=r.constructor;v==y||!("constructor"in t)||!("constructor"in r)||"function"==typeof v&&v instanceof v&&"function"==typeof y&&y instanceof y||(m=!1)}return i.delete(t),i.delete(r),m}(t,r,e,n,o,i))}function te(t,r,e,n,o){return t===r||(null==t||null==r||!st(t)&&!st(r)?t!=t&&r!=r:Zr(t,r,e,n,te,o))}var re=1,ee=2;function ne(t){return t==t&&!b(t)}function oe(t,r){return function(e){return null!=e&&(e[t]===r&&(void 0!==r||t in Object(e)))}}function ie(t){var r=function(t){for(var r=Br(t),e=r.length;e--;){var n=r[e],o=t[n];r[e]=[n,o,ne(o)]}return r}(t);return 1==r.length&&r[0][2]?oe(r[0][0],r[0][1]):function(e){return e===t||function(t,r,e,n){var o=e.length,i=o,s=!n;if(null==t)return!i;for(t=Object(t);o--;){var a=e[o];if(s&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++o<i;){var u=(a=e[o])[0],l=t[u],f=a[1];if(s&&a[2]){if(void 0===l&&!(u in t))return!1}else{var c=new Ut;if(n)var h=n(l,f,u,t,r,c);if(!(void 0===h?te(f,l,re|ee,n,c):h))return!1}}return!0}(e,t,r)}}var se="[object Symbol]";function ae(t){return"symbol"==typeof t||st(t)&&y(t)==se}var ue=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,le=/^\w*$/;function fe(t,r){if(it(t))return!1;var e=typeof t;return!("number"!=e&&"symbol"!=e&&"boolean"!=e&&null!=t&&!ae(t))||(le.test(t)||!ue.test(t)||null!=r&&t in Object(r))}var ce="Expected a function";function he(t,r){if("function"!=typeof t||null!=r&&"function"!=typeof r)throw new TypeError(ce);var e=function(){var n=arguments,o=r?r.apply(this,n):n[0],i=e.cache;if(i.has(o))return i.get(o);var s=t.apply(this,n);return e.cache=i.set(o,s)||i,s};return e.cache=new(he.Cache||Lt),e}he.Cache=Lt;var me,ge,pe,de=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,we=/\\(\\)?/g,ve=(me=function(t){var r=[];return 46===t.charCodeAt(0)&&r.push(""),t.replace(de,(function(t,e,n,o){r.push(n?o.replace(we,"$1"):e||t)})),r},ge=he(me,(function(t){return 500===pe.size&&pe.clear(),t})),pe=ge.cache,ge),ye=ve,be=1/0,Me=f?f.prototype:void 0,xe=Me?Me.toString:void 0;function je(t){if("string"==typeof t)return t;if(it(t))return Nt(t,je)+"";if(ae(t))return xe?xe.call(t):"";var r=t+"";return"0"==r&&1/t==-be?"-0":r}function Ee(t){return null==t?"":je(t)}function Se(t,r){return it(t)?t:fe(t,r)?[t]:ye(Ee(t))}var _e=1/0;function Ae(t){if("string"==typeof t||ae(t))return t;var r=t+"";return"0"==r&&1/t==-_e?"-0":r}function qe(t,r){for(var e=0,n=(r=Se(r,t)).length;null!=t&&e<n;)t=t[Ae(r[e++])];return e&&e==n?t:void 0}function Pe(t,r,e){var n=null==t?void 0:qe(t,r);return void 0===n?e:n}function ke(t,r){return null!=t&&r in Object(t)}function Re(t,r){return null!=t&&function(t,r,e){for(var n=-1,o=(r=Se(r,t)).length,i=!1;++n<o;){var s=Ae(r[n]);if(!(i=null!=t&&e(t,s)))break;t=t[s]}return i||++n!=o?i:!!(o=null==t?0:t.length)&&nt(o)&&Ir(s,o)&&(it(t)||_r(t))}(t,r,ke)}var Ne=1,Ie=2;function Oe(t){return fe(t)?ut(Ae(t)):function(t){return function(r){return qe(r,t)}}(t)}function Te(t){return"function"==typeof t?t:null==t?Pt:"object"==typeof t?it(t)?(r=t[0],e=t[1],fe(r)&&ne(e)?oe(Ae(r),e):function(t){var n=Pe(t,r);return void 0===n&&n===e?Re(t,r):te(e,n,Ne|Ie)}):ie(t):Oe(t);var r,e}var Ce,Fe=function(t,r,e){for(var n=-1,o=Object(t),i=e(t),s=i.length;s--;){var a=i[Ce?s:++n];if(!1===r(o[a],a,o))break}return t};var ze=function(t,r){return function(e,n){if(null==e)return e;if(!ot(e))return t(e,n);for(var o=e.length,i=r?o:-1,s=Object(e);(r?i--:++i<o)&&!1!==n(s[i],i,s););return e}}((function(t,r){return t&&Fe(t,r,Br)})),$e=ze;function Ve(t,r){var e=-1,n=ot(t)?Array(t.length):[];return $e(t,(function(t,o,i){n[++e]=r(t,o,i)})),n}function De(t,r){return(it(t)?Nt:Ve)(t,Te(r))}function Le(t,r){var e=[];return $e(t,(function(t,n,o){r(t,n,o)&&e.push(t)})),e}function Ue(t,r){return(it(t)?pr:Le)(t,Te(r))}function Be(t,r){for(var e=-1,n=null==t?0:t.length;++e<n&&!1!==r(t[e],e,t););return t}var We=function(){try{var t=z(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),Ge=We;function Xe(t,r,e){"__proto__"==r&&Ge?Ge(t,r,{configurable:!0,enumerable:!0,value:e,writable:!0}):t[r]=e}var Ye=Object.prototype.hasOwnProperty;function Qe(t,r,e){var n=t[r];Ye.call(t,r)&&It(n,e)&&(void 0!==e||r in t)||Xe(t,r,e)}function He(t,r,e,n){var o=!e;e||(e={});for(var i=-1,s=r.length;++i<s;){var a=r[i],u=n?n(e[a],t[a],a,e,t):void 0;void 0===u&&(u=t[a]),o?Xe(e,a,u):Qe(e,a,u)}return e}var Je=Object.prototype.hasOwnProperty;function Ke(t){if(!b(t))return function(t){var r=[];if(null!=t)for(var e in Object(t))r.push(e);return r}(t);var r=e(t),n=[];for(var o in t)("constructor"!=o||!r&&Je.call(t,o))&&n.push(o);return n}function Ze(t){return ot(t)?Ur(t,!0):Ke(t)}var tn="object"==typeof t&&t&&!t.nodeType&&t,rn=tn&&"object"==typeof module&&module&&!module.nodeType&&module,en=rn&&rn.exports===tn?l.Buffer:void 0,nn=en?en.allocUnsafe:void 0;var on=n(Object.getPrototypeOf,Object),sn=Object.getOwnPropertySymbols?function(t){for(var r=[];t;)mr(r,yr(t)),t=on(t);return r}:dr,an=sn;function un(t){return gr(t,Ze,an)}var ln=Object.prototype.hasOwnProperty;function fn(t){var r=new t.constructor(t.byteLength);return new Qt(r).set(new Qt(t)),r}var cn=/\w*$/;var hn=f?f.prototype:void 0,mn=hn?hn.valueOf:void 0;var gn="[object Boolean]",pn="[object Date]",dn="[object Map]",wn="[object Number]",vn="[object RegExp]",yn="[object Set]",bn="[object String]",Mn="[object Symbol]",xn="[object ArrayBuffer]",jn="[object DataView]",En="[object Float32Array]",Sn="[object Float64Array]",_n="[object Int8Array]",An="[object Int16Array]",qn="[object Int32Array]",Pn="[object Uint8Array]",kn="[object Uint8ClampedArray]",Rn="[object Uint16Array]",Nn="[object Uint32Array]";function In(t,r,e){var n,o=t.constructor;switch(r){case xn:return fn(t);case gn:case pn:return new o(+t);case jn:return function(t,r){var e=r?fn(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.byteLength)}(t,e);case En:case Sn:case _n:case An:case qn:case Pn:case kn:case Rn:case Nn:return function(t,r){var e=r?fn(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)}(t,e);case dn:return new o;case wn:case bn:return new o(t);case vn:return function(t){var r=new t.constructor(t.source,cn.exec(t));return r.lastIndex=t.lastIndex,r}(t);case yn:return new o;case Mn:return n=t,mn?Object(mn.call(n)):{}}}var On=Object.create,Tn=function(){function t(){}return function(r){if(!b(r))return{};if(On)return On(r);t.prototype=r;var e=new t;return t.prototype=void 0,e}}(),Cn=Tn;var Fn=$r&&$r.isMap,zn=Fn?Tr(Fn):function(t){return st(t)&&"[object Map]"==rt(t)};var $n=$r&&$r.isSet,Vn=$n?Tr($n):function(t){return st(t)&&"[object Set]"==rt(t)},Dn=1,Ln=2,Un=4,Bn="[object Arguments]",Wn="[object Function]",Gn="[object GeneratorFunction]",Xn="[object Object]",Yn={};function Qn(t,r,n,o,i,s){var a,u=r&Dn,l=r&Ln,f=r&Un;if(n&&(a=i?n(t,o,i,s):n(t)),void 0!==a)return a;if(!b(t))return t;var c=it(t);if(c){if(a=function(t){var r=t.length,e=new t.constructor(r);return r&&"string"==typeof t[0]&&ln.call(t,"index")&&(e.index=t.index,e.input=t.input),e}(t),!u)return function(t,r){var e=-1,n=t.length;for(r||(r=Array(n));++e<n;)r[e]=t[e];return r}(t,a)}else{var h=rt(t),m=h==Wn||h==Gn;if(kr(t))return function(t,r){if(r)return t.slice();var e=t.length,n=nn?nn(e):new t.constructor(e);return t.copy(n),n}(t,u);if(h==Xn||h==Bn||m&&!i){if(a=l||m?{}:function(t){return"function"!=typeof t.constructor||e(t)?{}:Cn(on(t))}(t),!u)return l?function(t,r){return He(t,an(t),r)}(t,function(t,r){return t&&He(r,Ze(r),t)}(a,t)):function(t,r){return He(t,yr(t),r)}(t,function(t,r){return t&&He(r,Br(r),t)}(a,t))}else{if(!Yn[h])return i?t:{};a=In(t,h,u)}}s||(s=new Ut);var g=s.get(t);if(g)return g;s.set(t,a),Vn(t)?t.forEach((function(e){a.add(Qn(e,r,n,e,t,s))})):zn(t)&&t.forEach((function(e,o){a.set(o,Qn(e,r,n,o,t,s))}));var p=c?void 0:(f?l?un:Wr:l?Ze:Br)(t);return Be(p||t,(function(e,o){p&&(e=t[o=e]),Qe(a,o,Qn(e,r,n,o,t,s))})),a}Yn[Bn]=Yn["[object Array]"]=Yn["[object ArrayBuffer]"]=Yn["[object DataView]"]=Yn["[object Boolean]"]=Yn["[object Date]"]=Yn["[object Float32Array]"]=Yn["[object Float64Array]"]=Yn["[object Int8Array]"]=Yn["[object Int16Array]"]=Yn["[object Int32Array]"]=Yn["[object Map]"]=Yn["[object Number]"]=Yn[Xn]=Yn["[object RegExp]"]=Yn["[object Set]"]=Yn["[object String]"]=Yn["[object Symbol]"]=Yn["[object Uint8Array]"]=Yn["[object Uint8ClampedArray]"]=Yn["[object Uint16Array]"]=Yn["[object Uint32Array]"]=!0,Yn["[object Error]"]=Yn[Wn]=Yn["[object WeakMap]"]=!1;var Hn=1,Jn=4;function Kn(t){return Qn(t,Hn|Jn)}function Zn(t){return"[object Object]"===Object.prototype.toString.call(t)}function to(t){return"[object String]"===Object.prototype.toString.call(t)}function ro(t){return t!=t}function eo(t){return!!function(t){return"[object Undefined]"===Object.prototype.toString.call(t)}(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!function(t){if(Zn(t)){for(let r in t)return!1;return!0}return!1}(t)||(!!function(t){return!(!to(t)||""!==t)}(t)||(!!function(t){return!!Rt(t)&&0===t.length}(t)||!!ro(t)))))}function no(t){return!!Rt(t)&&(0!==t.length&&(1!==t.length||!eo(t[0])))}function oo(t){return!(!to(t)||""===t)}function io(t){let r=!1;if(oo(t))r=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(ro(t))return!1;r=!0}return r}var so=/\s/;var ao=/^\s+/;function uo(t){return t?t.slice(0,function(t){for(var r=t.length;r--&&so.test(t.charAt(r)););return r}(t)+1).replace(ao,""):t}var lo=NaN,fo=/^[-+]0x[0-9a-f]+$/i,co=/^0b[01]+$/i,ho=/^0o[0-7]+$/i,mo=parseInt;function go(t){if("number"==typeof t)return t;if(ae(t))return lo;if(b(t)){var r="function"==typeof t.valueOf?t.valueOf():t;t=b(r)?r+"":r}if("string"!=typeof t)return 0===t?t:+t;t=uo(t);var e=co.test(t);return e||ho.test(t)?mo(t.slice(2),e?2:8):fo.test(t)?lo:+t}var po=1/0,wo=17976931348623157e292;function vo(t){return t?(t=go(t))===po||t===-po?(t<0?-1:1)*wo:t==t?t:0:0===t?t:0}function yo(t){if(!io(t))return 0;return vo(t)}function bo(t){return no(t)?t=De(t=Ue(t=Kn(t),io),yo):[]}function Mo(t){if(!Rt(t))return null;if(0===_t(t))return null;let r=bo(t);return 0===_t(r)?null:kt(r)}function xo(t){if(!io(t))return!1;return yo(t)>0}function jo(t){return no(t)?t=De(t=Ue(t=Kn(t),xo),yo):[]}function Eo(t){return no(t)?t=De(t=jo(t),Math.log):[]}var So="[object Number]";function _o(t){return"number"==typeof t||st(t)&&y(t)==So}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function Ao(t){if(t.__esModule)return t;var r=t.default;if("function"==typeof r){var e=function t(){if(this instanceof t){var e=[null];return e.push.apply(e,arguments),new(Function.bind.apply(r,e))}return r.apply(this,arguments)};e.prototype=r.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(t).forEach((function(r){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})})),e}var qo={};!function(t,r){t.exports=function(){var t=function(t,r){var e=Array.prototype.concat,n=Array.prototype.slice,o=Object.prototype.toString;function i(r,e){var n=r>e?r:e;return t.pow(10,17-~~(t.log(n>0?n:-n)*t.LOG10E))}var s=Array.isArray||function(t){return"[object Array]"===o.call(t)};function a(t){return"[object Function]"===o.call(t)}function u(t){return"number"==typeof t&&t-t==0}function l(t){return e.apply([],t)}function f(){return new f._init(arguments)}function c(){return 0}function h(){return 1}function m(t,r){return t===r?1:0}f.fn=f.prototype,f._init=function(t){if(s(t[0]))if(s(t[0][0])){a(t[1])&&(t[0]=f.map(t[0],t[1]));for(var r=0;r<t[0].length;r++)this[r]=t[0][r];this.length=t[0].length}else this[0]=a(t[1])?f.map(t[0],t[1]):t[0],this.length=1;else if(u(t[0]))this[0]=f.seq.apply(null,t),this.length=1;else{if(t[0]instanceof f)return f(t[0].toArray());this[0]=[],this.length=1}return this},f._init.prototype=f.prototype,f._init.constructor=f,f.utils={calcRdx:i,isArray:s,isFunction:a,isNumber:u,toVector:l},f._random_fn=t.random,f.setRandom=function(t){if("function"!=typeof t)throw new TypeError("fn is not a function");f._random_fn=t},f.extend=function(t){var r,e;if(1===arguments.length){for(e in t)f[e]=t[e];return this}for(r=1;r<arguments.length;r++)for(e in arguments[r])t[e]=arguments[r][e];return t},f.rows=function(t){return t.length||1},f.cols=function(t){return t[0].length||1},f.dimensions=function(t){return{rows:f.rows(t),cols:f.cols(t)}},f.row=function(t,r){return s(r)?r.map((function(r){return f.row(t,r)})):t[r]},f.rowa=function(t,r){return f.row(t,r)},f.col=function(t,r){if(s(r)){var e=f.arange(t.length).map((function(){return new Array(r.length)}));return r.forEach((function(r,n){f.arange(t.length).forEach((function(o){e[o][n]=t[o][r]}))})),e}for(var n=new Array(t.length),o=0;o<t.length;o++)n[o]=[t[o][r]];return n},f.cola=function(t,r){return f.col(t,r).map((function(t){return t[0]}))},f.diag=function(t){for(var r=f.rows(t),e=new Array(r),n=0;n<r;n++)e[n]=[t[n][n]];return e},f.antidiag=function(t){for(var r=f.rows(t)-1,e=new Array(r),n=0;r>=0;r--,n++)e[n]=[t[n][r]];return e},f.transpose=function(t){var r,e,n,o,i,a=[];for(s(t[0])||(t=[t]),e=t.length,n=t[0].length,i=0;i<n;i++){for(r=new Array(e),o=0;o<e;o++)r[o]=t[o][i];a.push(r)}return 1===a.length?a[0]:a},f.map=function(t,r,e){var n,o,i,a,u;for(s(t[0])||(t=[t]),o=t.length,i=t[0].length,a=e?t:new Array(o),n=0;n<o;n++)for(a[n]||(a[n]=new Array(i)),u=0;u<i;u++)a[n][u]=r(t[n][u],n,u);return 1===a.length?a[0]:a},f.cumreduce=function(t,r,e){var n,o,i,a,u;for(s(t[0])||(t=[t]),o=t.length,i=t[0].length,a=e?t:new Array(o),n=0;n<o;n++)for(a[n]||(a[n]=new Array(i)),i>0&&(a[n][0]=t[n][0]),u=1;u<i;u++)a[n][u]=r(a[n][u-1],t[n][u]);return 1===a.length?a[0]:a},f.alter=function(t,r){return f.map(t,r,!0)},f.create=function(t,r,e){var n,o,i=new Array(t);for(a(r)&&(e=r,r=t),n=0;n<t;n++)for(i[n]=new Array(r),o=0;o<r;o++)i[n][o]=e(n,o);return i},f.zeros=function(t,r){return u(r)||(r=t),f.create(t,r,c)},f.ones=function(t,r){return u(r)||(r=t),f.create(t,r,h)},f.rand=function(t,r){return u(r)||(r=t),f.create(t,r,f._random_fn)},f.identity=function(t,r){return u(r)||(r=t),f.create(t,r,m)},f.symmetric=function(t){var r,e,n=t.length;if(t.length!==t[0].length)return!1;for(r=0;r<n;r++)for(e=0;e<n;e++)if(t[e][r]!==t[r][e])return!1;return!0},f.clear=function(t){return f.alter(t,c)},f.seq=function(t,r,e,n){a(n)||(n=!1);var o,s=[],u=i(t,r),l=(r*u-t*u)/((e-1)*u),f=t;for(o=0;f<=r&&o<e;f=(t*u+l*u*++o)/u)s.push(n?n(f,o):f);return s},f.arange=function(t,e,n){var o,i=[];if(n=n||1,e===r&&(e=t,t=0),t===e||0===n)return[];if(t<e&&n<0)return[];if(t>e&&n>0)return[];if(n>0)for(o=t;o<e;o+=n)i.push(o);else for(o=t;o>e;o+=n)i.push(o);return i},f.slice=function(){function t(t,e,n,o){var i,s=[],a=t.length;if(e===r&&n===r&&o===r)return f.copy(t);if(o=o||1,(e=(e=e||0)>=0?e:a+e)===(n=(n=n||t.length)>=0?n:a+n)||0===o)return[];if(e<n&&o<0)return[];if(e>n&&o>0)return[];if(o>0)for(i=e;i<n;i+=o)s.push(t[i]);else for(i=e;i>n;i+=o)s.push(t[i]);return s}function e(r,e){var n,o;return u((e=e||{}).row)?u(e.col)?r[e.row][e.col]:t(f.rowa(r,e.row),(n=e.col||{}).start,n.end,n.step):u(e.col)?t(f.cola(r,e.col),(o=e.row||{}).start,o.end,o.step):(o=e.row||{},n=e.col||{},t(r,o.start,o.end,o.step).map((function(r){return t(r,n.start,n.end,n.step)})))}return e}(),f.sliceAssign=function(e,n,o){var i,s;if(u(n.row)){if(u(n.col))return e[n.row][n.col]=o;n.col=n.col||{},n.col.start=n.col.start||0,n.col.end=n.col.end||e[0].length,n.col.step=n.col.step||1,i=f.arange(n.col.start,t.min(e.length,n.col.end),n.col.step);var a=n.row;return i.forEach((function(t,r){e[a][t]=o[r]})),e}if(u(n.col)){n.row=n.row||{},n.row.start=n.row.start||0,n.row.end=n.row.end||e.length,n.row.step=n.row.step||1,s=f.arange(n.row.start,t.min(e[0].length,n.row.end),n.row.step);var l=n.col;return s.forEach((function(t,r){e[t][l]=o[r]})),e}return o[0].length===r&&(o=[o]),n.row.start=n.row.start||0,n.row.end=n.row.end||e.length,n.row.step=n.row.step||1,n.col.start=n.col.start||0,n.col.end=n.col.end||e[0].length,n.col.step=n.col.step||1,s=f.arange(n.row.start,t.min(e.length,n.row.end),n.row.step),i=f.arange(n.col.start,t.min(e[0].length,n.col.end),n.col.step),s.forEach((function(t,r){i.forEach((function(n,i){e[t][n]=o[r][i]}))})),e},f.diagonal=function(t){var r=f.zeros(t.length,t.length);return t.forEach((function(t,e){r[e][e]=t})),r},f.copy=function(t){return t.map((function(t){return u(t)?t:t.map((function(t){return t}))}))};var g=f.prototype;return g.length=0,g.push=Array.prototype.push,g.sort=Array.prototype.sort,g.splice=Array.prototype.splice,g.slice=Array.prototype.slice,g.toArray=function(){return this.length>1?n.call(this):n.call(this)[0]},g.map=function(t,r){return f(f.map(this,t,r))},g.cumreduce=function(t,r){return f(f.cumreduce(this,t,r))},g.alter=function(t){return f.alter(this,t),this},function(t){for(var r=0;r<t.length;r++)!function(t){g[t]=function(r){var e,n=this;return r?(setTimeout((function(){r.call(n,g[t].call(n))})),this):(e=f[t](this),s(e)?f(e):e)}}(t[r])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(t){for(var r=0;r<t.length;r++)!function(t){g[t]=function(r,e){var n=this;return e?(setTimeout((function(){e.call(n,g[t].call(n,r))})),this):f(f[t](this,r))}}(t[r])}("row col".split(" ")),function(t){for(var r=0;r<t.length;r++)!function(t){g[t]=function(){return f(f[t].apply(null,arguments))}}(t[r])}("create zeros ones rand identity".split(" ")),f}(Math);return function(t,r){var e=t.utils.isFunction;function n(t,r){return t-r}function o(t,e,n){return r.max(e,r.min(t,n))}t.sum=function(t){for(var r=0,e=t.length;--e>=0;)r+=t[e];return r},t.sumsqrd=function(t){for(var r=0,e=t.length;--e>=0;)r+=t[e]*t[e];return r},t.sumsqerr=function(r){for(var e,n=t.mean(r),o=0,i=r.length;--i>=0;)o+=(e=r[i]-n)*e;return o},t.sumrow=function(t){for(var r=0,e=t.length;--e>=0;)r+=t[e];return r},t.product=function(t){for(var r=1,e=t.length;--e>=0;)r*=t[e];return r},t.min=function(t){for(var r=t[0],e=0;++e<t.length;)t[e]<r&&(r=t[e]);return r},t.max=function(t){for(var r=t[0],e=0;++e<t.length;)t[e]>r&&(r=t[e]);return r},t.unique=function(t){for(var r={},e=[],n=0;n<t.length;n++)r[t[n]]||(r[t[n]]=!0,e.push(t[n]));return e},t.mean=function(r){return t.sum(r)/r.length},t.meansqerr=function(r){return t.sumsqerr(r)/r.length},t.geomean=function(e){var n=e.map(r.log),o=t.mean(n);return r.exp(o)},t.median=function(t){var r=t.length,e=t.slice().sort(n);return 1&r?e[r/2|0]:(e[r/2-1]+e[r/2])/2},t.cumsum=function(r){return t.cumreduce(r,(function(t,r){return t+r}))},t.cumprod=function(r){return t.cumreduce(r,(function(t,r){return t*r}))},t.diff=function(t){var r,e=[],n=t.length;for(r=1;r<n;r++)e.push(t[r]-t[r-1]);return e},t.rank=function(t){var r,e=[],o={};for(r=0;r<t.length;r++)o[u=t[r]]?o[u]++:(o[u]=1,e.push(u));var i=e.sort(n),s={},a=1;for(r=0;r<i.length;r++){var u,l=o[u=i[r]],f=(a+(a+l-1))/2;s[u]=f,a+=l}return t.map((function(t){return s[t]}))},t.mode=function(t){var r,e=t.length,o=t.slice().sort(n),i=1,s=0,a=0,u=[];for(r=0;r<e;r++)o[r]===o[r+1]?i++:(i>s?(u=[o[r]],s=i,a=0):i===s&&(u.push(o[r]),a++),i=1);return 0===a?u[0]:u},t.range=function(r){return t.max(r)-t.min(r)},t.variance=function(r,e){return t.sumsqerr(r)/(r.length-(e?1:0))},t.pooledvariance=function(r){return r.reduce((function(r,e){return r+t.sumsqerr(e)}),0)/(r.reduce((function(t,r){return t+r.length}),0)-r.length)},t.deviation=function(r){for(var e=t.mean(r),n=r.length,o=new Array(n),i=0;i<n;i++)o[i]=r[i]-e;return o},t.stdev=function(e,n){return r.sqrt(t.variance(e,n))},t.pooledstdev=function(e){return r.sqrt(t.pooledvariance(e))},t.meandev=function(e){for(var n=t.mean(e),o=[],i=e.length-1;i>=0;i--)o.push(r.abs(e[i]-n));return t.mean(o)},t.meddev=function(e){for(var n=t.median(e),o=[],i=e.length-1;i>=0;i--)o.push(r.abs(e[i]-n));return t.median(o)},t.coeffvar=function(r){return t.stdev(r)/t.mean(r)},t.quartiles=function(t){var e=t.length,o=t.slice().sort(n);return[o[r.round(e/4)-1],o[r.round(e/2)-1],o[r.round(3*e/4)-1]]},t.quantiles=function(t,e,i,s){var a,u,l,f,c,h=t.slice().sort(n),m=[e.length],g=t.length;for(void 0===i&&(i=3/8),void 0===s&&(s=3/8),a=0;a<e.length;a++)l=g*(u=e[a])+(i+u*(1-i-s)),f=r.floor(o(l,1,g-1)),c=o(l-f,0,1),m[a]=(1-c)*h[f-1]+c*h[f];return m},t.percentile=function(t,r,e){var o=t.slice().sort(n),i=r*(o.length+(e?1:-1))+(e?0:1),s=parseInt(i),a=i-s;return s+1<o.length?o[s-1]+a*(o[s]-o[s-1]):o[s-1]},t.percentileOfScore=function(t,r,e){var n,o,i=0,s=t.length,a=!1;for("strict"===e&&(a=!0),o=0;o<s;o++)n=t[o],(a&&n<r||!a&&n<=r)&&i++;return i/s},t.histogram=function(e,n){n=n||4;var o,i=t.min(e),s=(t.max(e)-i)/n,a=e.length,u=[];for(o=0;o<n;o++)u[o]=0;for(o=0;o<a;o++)u[r.min(r.floor((e[o]-i)/s),n-1)]+=1;return u},t.covariance=function(r,e){var n,o=t.mean(r),i=t.mean(e),s=r.length,a=new Array(s);for(n=0;n<s;n++)a[n]=(r[n]-o)*(e[n]-i);return t.sum(a)/(s-1)},t.corrcoeff=function(r,e){return t.covariance(r,e)/t.stdev(r,1)/t.stdev(e,1)},t.spearmancoeff=function(r,e){return r=t.rank(r),e=t.rank(e),t.corrcoeff(r,e)},t.stanMoment=function(e,n){for(var o=t.mean(e),i=t.stdev(e),s=e.length,a=0,u=0;u<s;u++)a+=r.pow((e[u]-o)/i,n);return a/e.length},t.skewness=function(r){return t.stanMoment(r,3)},t.kurtosis=function(r){return t.stanMoment(r,4)-3};var i=t.prototype;!function(r){for(var n=0;n<r.length;n++)!function(r){i[r]=function(n,o){var s=[],a=0,u=this;if(e(n)&&(o=n,n=!1),o)return setTimeout((function(){o.call(u,i[r].call(u,n))})),this;if(this.length>1){for(u=!0===n?this:this.transpose();a<u.length;a++)s[a]=t[r](u[a]);return s}return t[r](this[0],n)}}(r[n])}("cumsum cumprod".split(" ")),function(r){for(var n=0;n<r.length;n++)!function(r){i[r]=function(n,o){var s=[],a=0,u=this;if(e(n)&&(o=n,n=!1),o)return setTimeout((function(){o.call(u,i[r].call(u,n))})),this;if(this.length>1){for("sumrow"!==r&&(u=!0===n?this:this.transpose());a<u.length;a++)s[a]=t[r](u[a]);return!0===n?t[r](t.utils.toVector(s)):s}return t[r](this[0],n)}}(r[n])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(r){for(var n=0;n<r.length;n++)!function(r){i[r]=function(){var n,o=[],s=0,a=this,u=Array.prototype.slice.call(arguments);if(e(u[u.length-1])){n=u[u.length-1];var l=u.slice(0,u.length-1);return setTimeout((function(){n.call(a,i[r].apply(a,l))})),this}n=void 0;var f=function(e){return t[r].apply(a,[e].concat(u))};if(this.length>1){for(a=a.transpose();s<a.length;s++)o[s]=f(a[s]);return o}return f(this[0])}}(r[n])}("quantiles percentileOfScore".split(" "))}(t,Math),function(t,r){t.gammaln=function(t){var e,n,o,i=0,s=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],a=1.000000000190015;for(o=(n=e=t)+5.5,o-=(e+.5)*r.log(o);i<6;i++)a+=s[i]/++n;return r.log(2.5066282746310007*a/e)-o},t.loggam=function(t){var e,n,o,i,s,a,u,l=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(e=t,u=0,1==t||2==t)return 0;for(t<=7&&(e=t+(u=r.floor(7-t))),n=1/(e*e),o=2*r.PI,s=l[9],a=8;a>=0;a--)s*=n,s+=l[a];if(i=s/e+.5*r.log(o)+(e-.5)*r.log(e)-e,t<=7)for(a=1;a<=u;a++)i-=r.log(e-1),e-=1;return i},t.gammafn=function(t){var e,n,o,i,s=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],a=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],u=!1,l=0,f=0,c=0,h=t;if(t>171.6243769536076)return 1/0;if(h<=0){if(!(i=h%1+36e-17))return 1/0;u=(1&h?-1:1)*r.PI/r.sin(r.PI*i),h=1-h}for(o=h,n=h<1?h++:(h-=l=(0|h)-1)-1,e=0;e<8;++e)c=(c+s[e])*n,f=f*n+a[e];if(i=c/f+1,o<h)i/=o;else if(o>h)for(e=0;e<l;++e)i*=h,h++;return u&&(i=u/i),i},t.gammap=function(r,e){return t.lowRegGamma(r,e)*t.gammafn(r)},t.lowRegGamma=function(e,n){var o,i=t.gammaln(e),s=e,a=1/e,u=a,l=n+1-e,f=1/1e-30,c=1/l,h=c,m=1,g=-~(8.5*r.log(e>=1?e:1/e)+.4*e+17);if(n<0||e<=0)return NaN;if(n<e+1){for(;m<=g;m++)a+=u*=n/++s;return a*r.exp(-n+e*r.log(n)-i)}for(;m<=g;m++)h*=(c=1/(c=(o=-m*(m-e))*c+(l+=2)))*(f=l+o/f);return 1-h*r.exp(-n+e*r.log(n)-i)},t.factorialln=function(r){return r<0?NaN:t.gammaln(r+1)},t.factorial=function(r){return r<0?NaN:t.gammafn(r+1)},t.combination=function(e,n){return e>170||n>170?r.exp(t.combinationln(e,n)):t.factorial(e)/t.factorial(n)/t.factorial(e-n)},t.combinationln=function(r,e){return t.factorialln(r)-t.factorialln(e)-t.factorialln(r-e)},t.permutation=function(r,e){return t.factorial(r)/t.factorial(r-e)},t.betafn=function(e,n){if(!(e<=0||n<=0))return e+n>170?r.exp(t.betaln(e,n)):t.gammafn(e)*t.gammafn(n)/t.gammafn(e+n)},t.betaln=function(r,e){return t.gammaln(r)+t.gammaln(e)-t.gammaln(r+e)},t.betacf=function(t,e,n){var o,i,s,a,u=1e-30,l=1,f=e+n,c=e+1,h=e-1,m=1,g=1-f*t/c;for(r.abs(g)<u&&(g=u),a=g=1/g;l<=100&&(g=1+(i=l*(n-l)*t/((h+(o=2*l))*(e+o)))*g,r.abs(g)<u&&(g=u),m=1+i/m,r.abs(m)<u&&(m=u),a*=(g=1/g)*m,g=1+(i=-(e+l)*(f+l)*t/((e+o)*(c+o)))*g,r.abs(g)<u&&(g=u),m=1+i/m,r.abs(m)<u&&(m=u),a*=s=(g=1/g)*m,!(r.abs(s-1)<3e-7));l++);return a},t.gammapinv=function(e,n){var o,i,s,a,u,l,f=0,c=n-1,h=1e-8,m=t.gammaln(n);if(e>=1)return r.max(100,n+100*r.sqrt(n));if(e<=0)return 0;for(n>1?(u=r.log(c),l=r.exp(c*(u-1)-m),a=e<.5?e:1-e,o=(2.30753+.27061*(i=r.sqrt(-2*r.log(a))))/(1+i*(.99229+.04481*i))-i,e<.5&&(o=-o),o=r.max(.001,n*r.pow(1-1/(9*n)-o/(3*r.sqrt(n)),3))):o=e<(i=1-n*(.253+.12*n))?r.pow(e/i,1/n):1-r.log(1-(e-i)/(1-i));f<12;f++){if(o<=0)return 0;if((o-=i=(s=(t.lowRegGamma(n,o)-e)/(i=n>1?l*r.exp(-(o-c)+c*(r.log(o)-u)):r.exp(-o+c*r.log(o)-m)))/(1-.5*r.min(1,s*((n-1)/o-1))))<=0&&(o=.5*(o+i)),r.abs(i)<h*o)break}return o},t.erf=function(t){var e,n,o,i,s=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],a=s.length-1,u=!1,l=0,f=0;for(t<0&&(t=-t,u=!0),n=4*(e=2/(2+t))-2;a>0;a--)o=l,l=n*l-f+s[a],f=o;return i=e*r.exp(-t*t+.5*(s[0]+n*l)-f),u?i-1:1-i},t.erfc=function(r){return 1-t.erf(r)},t.erfcinv=function(e){var n,o,i,s,a=0;if(e>=2)return-100;if(e<=0)return 100;for(s=e<1?e:2-e,n=-.70711*((2.30753+.27061*(i=r.sqrt(-2*r.log(s/2))))/(1+i*(.99229+.04481*i))-i);a<2;a++)n+=(o=t.erfc(n)-s)/(1.1283791670955126*r.exp(-n*n)-n*o);return e<1?n:-n},t.ibetainv=function(e,n,o){var i,s,a,u,l,f,c,h,m,g,p=1e-8,d=n-1,w=o-1,v=0;if(e<=0)return 0;if(e>=1)return 1;for(n>=1&&o>=1?(a=e<.5?e:1-e,f=(2.30753+.27061*(u=r.sqrt(-2*r.log(a))))/(1+u*(.99229+.04481*u))-u,e<.5&&(f=-f),c=(f*f-3)/6,h=2/(1/(2*n-1)+1/(2*o-1)),m=f*r.sqrt(c+h)/h-(1/(2*o-1)-1/(2*n-1))*(c+5/6-2/(3*h)),f=n/(n+o*r.exp(2*m))):(i=r.log(n/(n+o)),s=r.log(o/(n+o)),f=e<(u=r.exp(n*i)/n)/(m=u+(l=r.exp(o*s)/o))?r.pow(n*m*e,1/n):1-r.pow(o*m*(1-e),1/o)),g=-t.gammaln(n)-t.gammaln(o)+t.gammaln(n+o);v<10;v++){if(0===f||1===f)return f;if((f-=u=(l=(t.ibeta(f,n,o)-e)/(u=r.exp(d*r.log(f)+w*r.log(1-f)+g)))/(1-.5*r.min(1,l*(d/f-w/(1-f)))))<=0&&(f=.5*(f+u)),f>=1&&(f=.5*(f+u+1)),r.abs(u)<p*f&&v>0)break}return f},t.ibeta=function(e,n,o){var i=0===e||1===e?0:r.exp(t.gammaln(n+o)-t.gammaln(n)-t.gammaln(o)+n*r.log(e)+o*r.log(1-e));return!(e<0||e>1)&&(e<(n+1)/(n+o+2)?i*t.betacf(e,n,o)/n:1-i*t.betacf(1-e,o,n)/o)},t.randn=function(e,n){var o,i,s,a,u;if(n||(n=e),e)return t.create(e,n,(function(){return t.randn()}));do{o=t._random_fn(),i=1.7156*(t._random_fn()-.5),u=(s=o-.449871)*s+(a=r.abs(i)+.386595)*(.196*a-.25472*s)}while(u>.27597&&(u>.27846||i*i>-4*r.log(o)*o*o));return i/o},t.randg=function(e,n,o){var i,s,a,u,l,f,c=e;if(o||(o=n),e||(e=1),n)return(f=t.zeros(n,o)).alter((function(){return t.randg(e)})),f;e<1&&(e+=1),i=e-1/3,s=1/r.sqrt(9*i);do{do{u=1+s*(l=t.randn())}while(u<=0);u*=u*u,a=t._random_fn()}while(a>1-.331*r.pow(l,4)&&r.log(a)>.5*l*l+i*(1-u+r.log(u)));if(e==c)return i*u;do{a=t._random_fn()}while(0===a);return r.pow(a,1/c)*i*u},function(r){for(var e=0;e<r.length;e++)!function(r){t.fn[r]=function(){return t(t.map(this,(function(e){return t[r](e)})))}}(r[e])}("gammaln gammafn factorial factorialln".split(" ")),function(r){for(var e=0;e<r.length;e++)!function(r){t.fn[r]=function(){return t(t[r].apply(null,arguments))}}(r[e])}("randn".split(" "))}(t,Math),function(t,r){function e(t,e,n,o){for(var i,s=0,a=1,u=1,l=1,f=0,c=0;r.abs((u-c)/u)>o;)c=u,a=l+(i=-(e+f)*(e+n+f)*t/(e+2*f)/(e+2*f+1))*a,u=(s=u+i*s)+(i=(f+=1)*(n-f)*t/(e+2*f-1)/(e+2*f))*u,s/=l=a+i*l,a/=l,u/=l,l=1;return u/e}function n(t){return t/r.abs(t)}function o(e,n,o){var i=12,s=6,a=-30,u=-50,l=60,f=8,c=3,h=2,m=3,g=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],p=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],d=.5*e;if(d>=f)return 1;var w,v=2*t.normal.cdf(d,0,1,1,0)-1;v=v>=r.exp(u/o)?r.pow(v,o):0;for(var y=d,b=(f-d)/(w=e>c?h:m),M=y+b,x=0,j=o-1,E=1;E<=w;E++){for(var S=0,_=.5*(M+y),A=.5*(M-y),q=1;q<=i;q++){var P,k=_+A*(s<q?g[(P=i-q+1)-1]:-g[(P=q)-1]),R=k*k;if(R>l)break;var N=2*t.normal.cdf(k,0,1,1,0)*.5-2*t.normal.cdf(k,e,1,1,0)*.5;N>=r.exp(a/j)&&(S+=N=p[P-1]*r.exp(-.5*R)*r.pow(N,j))}x+=S*=2*A*o/r.sqrt(2*r.PI),y=M,M+=b}return(v+=x)<=r.exp(a/n)?0:(v=r.pow(v,n))>=1?1:v}function i(t,e,n){var o=.322232421088,i=.099348462606,s=-1,a=.588581570495,u=-.342242088547,l=.531103462366,f=-.204231210125,c=.10353775285,h=-453642210148e-16,m=.0038560700634,g=.8832,p=.2368,d=1.214,w=1.208,v=1.4142,y=120,b=.5-.5*t,M=r.sqrt(r.log(1/(b*b))),x=M+((((M*h+f)*M+u)*M+s)*M+o)/((((M*m+c)*M+l)*M+a)*M+i);n<y&&(x+=(x*x*x+x)/n/4);var j=g-p*x;return n<y&&(j+=-d/n+w*x/n),x*(j*r.log(e-1)+v)}!function(r){for(var e=0;e<r.length;e++)!function(r){t[r]=function t(r,e,n){return this instanceof t?(this._a=r,this._b=e,this._c=n,this):new t(r,e,n)},t.fn[r]=function(e,n,o){var i=t[r](e,n,o);return i.data=this,i},t[r].prototype.sample=function(e){var n=this._a,o=this._b,i=this._c;return e?t.alter(e,(function(){return t[r].sample(n,o,i)})):t[r].sample(n,o,i)},function(e){for(var n=0;n<e.length;n++)!function(e){t[r].prototype[e]=function(n){var o=this._a,i=this._b,s=this._c;return n||0===n||(n=this.data),"number"!=typeof n?t.fn.map.call(n,(function(n){return t[r][e](n,o,i,s)})):t[r][e](n,o,i,s)}}(e[n])}("pdf cdf inv".split(" ")),function(e){for(var n=0;n<e.length;n++)!function(e){t[r].prototype[e]=function(){return t[r][e](this._a,this._b,this._c)}}(e[n])}("mean median mode variance".split(" "))}(r[e])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),t.extend(t.beta,{pdf:function(e,n,o){return e>1||e<0?0:1==n&&1==o?1:n<512&&o<512?r.pow(e,n-1)*r.pow(1-e,o-1)/t.betafn(n,o):r.exp((n-1)*r.log(e)+(o-1)*r.log(1-e)-t.betaln(n,o))},cdf:function(r,e,n){return r>1||r<0?1*(r>1):t.ibeta(r,e,n)},inv:function(r,e,n){return t.ibetainv(r,e,n)},mean:function(t,r){return t/(t+r)},median:function(r,e){return t.ibetainv(.5,r,e)},mode:function(t,r){return(t-1)/(t+r-2)},sample:function(r,e){var n=t.randg(r);return n/(n+t.randg(e))},variance:function(t,e){return t*e/(r.pow(t+e,2)*(t+e+1))}}),t.extend(t.centralF,{pdf:function(e,n,o){var i;return e<0?0:n<=2?0===e&&n<2?1/0:0===e&&2===n?1:1/t.betafn(n/2,o/2)*r.pow(n/o,n/2)*r.pow(e,n/2-1)*r.pow(1+n/o*e,-(n+o)/2):(i=n*e/(o+e*n),n*(o/(o+e*n))/2*t.binomial.pdf((n-2)/2,(n+o-2)/2,i))},cdf:function(r,e,n){return r<0?0:t.ibeta(e*r/(e*r+n),e/2,n/2)},inv:function(r,e,n){return n/(e*(1/t.ibetainv(r,e/2,n/2)-1))},mean:function(t,r){return r>2?r/(r-2):void 0},mode:function(t,r){return t>2?r*(t-2)/(t*(r+2)):void 0},sample:function(r,e){return 2*t.randg(r/2)/r/(2*t.randg(e/2)/e)},variance:function(t,r){if(!(r<=4))return 2*r*r*(t+r-2)/(t*(r-2)*(r-2)*(r-4))}}),t.extend(t.cauchy,{pdf:function(t,e,n){return n<0?0:n/(r.pow(t-e,2)+r.pow(n,2))/r.PI},cdf:function(t,e,n){return r.atan((t-e)/n)/r.PI+.5},inv:function(t,e,n){return e+n*r.tan(r.PI*(t-.5))},median:function(t){return t},mode:function(t){return t},sample:function(e,n){return t.randn()*r.sqrt(1/(2*t.randg(.5)))*n+e}}),t.extend(t.chisquare,{pdf:function(e,n){return e<0?0:0===e&&2===n?.5:r.exp((n/2-1)*r.log(e)-e/2-n/2*r.log(2)-t.gammaln(n/2))},cdf:function(r,e){return r<0?0:t.lowRegGamma(e/2,r/2)},inv:function(r,e){return 2*t.gammapinv(r,.5*e)},mean:function(t){return t},median:function(t){return t*r.pow(1-2/(9*t),3)},mode:function(t){return t-2>0?t-2:0},sample:function(r){return 2*t.randg(r/2)},variance:function(t){return 2*t}}),t.extend(t.exponential,{pdf:function(t,e){return t<0?0:e*r.exp(-e*t)},cdf:function(t,e){return t<0?0:1-r.exp(-e*t)},inv:function(t,e){return-r.log(1-t)/e},mean:function(t){return 1/t},median:function(t){return 1/t*r.log(2)},mode:function(){return 0},sample:function(e){return-1/e*r.log(t._random_fn())},variance:function(t){return r.pow(t,-2)}}),t.extend(t.gamma,{pdf:function(e,n,o){return e<0?0:0===e&&1===n?1/o:r.exp((n-1)*r.log(e)-e/o-t.gammaln(n)-n*r.log(o))},cdf:function(r,e,n){return r<0?0:t.lowRegGamma(e,r/n)},inv:function(r,e,n){return t.gammapinv(r,e)*n},mean:function(t,r){return t*r},mode:function(t,r){if(t>1)return(t-1)*r},sample:function(r,e){return t.randg(r)*e},variance:function(t,r){return t*r*r}}),t.extend(t.invgamma,{pdf:function(e,n,o){return e<=0?0:r.exp(-(n+1)*r.log(e)-o/e-t.gammaln(n)+n*r.log(o))},cdf:function(r,e,n){return r<=0?0:1-t.lowRegGamma(e,n/r)},inv:function(r,e,n){return n/t.gammapinv(1-r,e)},mean:function(t,r){return t>1?r/(t-1):void 0},mode:function(t,r){return r/(t+1)},sample:function(r,e){return e/t.randg(r)},variance:function(t,r){if(!(t<=2))return r*r/((t-1)*(t-1)*(t-2))}}),t.extend(t.kumaraswamy,{pdf:function(t,e,n){return 0===t&&1===e?n:1===t&&1===n?e:r.exp(r.log(e)+r.log(n)+(e-1)*r.log(t)+(n-1)*r.log(1-r.pow(t,e)))},cdf:function(t,e,n){return t<0?0:t>1?1:1-r.pow(1-r.pow(t,e),n)},inv:function(t,e,n){return r.pow(1-r.pow(1-t,1/n),1/e)},mean:function(r,e){return e*t.gammafn(1+1/r)*t.gammafn(e)/t.gammafn(1+1/r+e)},median:function(t,e){return r.pow(1-r.pow(2,-1/e),1/t)},mode:function(t,e){if(t>=1&&e>=1&&1!==t&&1!==e)return r.pow((t-1)/(t*e-1),1/t)},variance:function(){throw new Error("variance not yet implemented")}}),t.extend(t.lognormal,{pdf:function(t,e,n){return t<=0?0:r.exp(-r.log(t)-.5*r.log(2*r.PI)-r.log(n)-r.pow(r.log(t)-e,2)/(2*n*n))},cdf:function(e,n,o){return e<0?0:.5+.5*t.erf((r.log(e)-n)/r.sqrt(2*o*o))},inv:function(e,n,o){return r.exp(-1.4142135623730951*o*t.erfcinv(2*e)+n)},mean:function(t,e){return r.exp(t+e*e/2)},median:function(t){return r.exp(t)},mode:function(t,e){return r.exp(t-e*e)},sample:function(e,n){return r.exp(t.randn()*n+e)},variance:function(t,e){return(r.exp(e*e)-1)*r.exp(2*t+e*e)}}),t.extend(t.noncentralt,{pdf:function(e,n,o){var i=1e-14;return r.abs(o)<i?t.studentt.pdf(e,n):r.abs(e)<i?r.exp(t.gammaln((n+1)/2)-o*o/2-.5*r.log(r.PI*n)-t.gammaln(n/2)):n/e*(t.noncentralt.cdf(e*r.sqrt(1+2/n),n+2,o)-t.noncentralt.cdf(e,n,o))},cdf:function(e,n,o){var i=1e-14,s=200;if(r.abs(o)<i)return t.studentt.cdf(e,n);var a=!1;e<0&&(a=!0,o=-o);for(var u=t.normal.cdf(-o,0,1),l=i+1,f=l,c=e*e/(e*e+n),h=0,m=r.exp(-o*o/2),g=r.exp(-o*o/2-.5*r.log(2)-t.gammaln(1.5))*o;h<s||f>i||l>i;)f=l,h>0&&(m*=o*o/(2*h),g*=o*o/(2*(h+.5))),u+=.5*(l=m*t.beta.cdf(c,h+.5,n/2)+g*t.beta.cdf(c,h+1,n/2)),h++;return a?1-u:u}}),t.extend(t.normal,{pdf:function(t,e,n){return r.exp(-.5*r.log(2*r.PI)-r.log(n)-r.pow(t-e,2)/(2*n*n))},cdf:function(e,n,o){return.5*(1+t.erf((e-n)/r.sqrt(2*o*o)))},inv:function(r,e,n){return-1.4142135623730951*n*t.erfcinv(2*r)+e},mean:function(t){return t},median:function(t){return t},mode:function(t){return t},sample:function(r,e){return t.randn()*e+r},variance:function(t,r){return r*r}}),t.extend(t.pareto,{pdf:function(t,e,n){return t<e?0:n*r.pow(e,n)/r.pow(t,n+1)},cdf:function(t,e,n){return t<e?0:1-r.pow(e/t,n)},inv:function(t,e,n){return e/r.pow(1-t,1/n)},mean:function(t,e){if(!(e<=1))return e*r.pow(t,e)/(e-1)},median:function(t,e){return t*(e*r.SQRT2)},mode:function(t){return t},variance:function(t,e){if(!(e<=2))return t*t*e/(r.pow(e-1,2)*(e-2))}}),t.extend(t.studentt,{pdf:function(e,n){return n=n>1e100?1e100:n,1/(r.sqrt(n)*t.betafn(.5,n/2))*r.pow(1+e*e/n,-(n+1)/2)},cdf:function(e,n){var o=n/2;return t.ibeta((e+r.sqrt(e*e+n))/(2*r.sqrt(e*e+n)),o,o)},inv:function(e,n){var o=t.ibetainv(2*r.min(e,1-e),.5*n,.5);return o=r.sqrt(n*(1-o)/o),e>.5?o:-o},mean:function(t){return t>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(e){return t.randn()*r.sqrt(e/(2*t.randg(e/2)))},variance:function(t){return t>2?t/(t-2):t>1?1/0:void 0}}),t.extend(t.weibull,{pdf:function(t,e,n){return t<0||e<0||n<0?0:n/e*r.pow(t/e,n-1)*r.exp(-r.pow(t/e,n))},cdf:function(t,e,n){return t<0?0:1-r.exp(-r.pow(t/e,n))},inv:function(t,e,n){return e*r.pow(-r.log(1-t),1/n)},mean:function(r,e){return r*t.gammafn(1+1/e)},median:function(t,e){return t*r.pow(r.log(2),1/e)},mode:function(t,e){return e<=1?0:t*r.pow((e-1)/e,1/e)},sample:function(e,n){return e*r.pow(-r.log(t._random_fn()),1/n)},variance:function(e,n){return e*e*t.gammafn(1+2/n)-r.pow(t.weibull.mean(e,n),2)}}),t.extend(t.uniform,{pdf:function(t,r,e){return t<r||t>e?0:1/(e-r)},cdf:function(t,r,e){return t<r?0:t<e?(t-r)/(e-r):1},inv:function(t,r,e){return r+t*(e-r)},mean:function(t,r){return.5*(t+r)},median:function(r,e){return t.mean(r,e)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(r,e){return r/2+e/2+(e/2-r/2)*(2*t._random_fn()-1)},variance:function(t,e){return r.pow(e-t,2)/12}}),t.extend(t.binomial,{pdf:function(e,n,o){return 0===o||1===o?n*o===e?1:0:t.combination(n,e)*r.pow(o,e)*r.pow(1-o,n-e)},cdf:function(n,o,i){var s,a=1e-10;if(n<0)return 0;if(n>=o)return 1;if(i<0||i>1||o<=0)return NaN;var u=i,l=(n=r.floor(n))+1,f=o-n,c=l+f,h=r.exp(t.gammaln(c)-t.gammaln(f)-t.gammaln(l)+l*r.log(u)+f*r.log(1-u));return s=u<(l+1)/(c+2)?h*e(u,l,f,a):1-h*e(1-u,f,l,a),r.round(1/a*(1-s))/(1/a)}}),t.extend(t.negbin,{pdf:function(e,n,o){return e===e>>>0&&(e<0?0:t.combination(e+n-1,n-1)*r.pow(1-o,e)*r.pow(o,n))},cdf:function(r,e,n){var o=0,i=0;if(r<0)return 0;for(;i<=r;i++)o+=t.negbin.pdf(i,e,n);return o}}),t.extend(t.hypgeom,{pdf:function(e,n,o,i){if(e!=e|0)return!1;if(e<0||e<o-(n-i))return 0;if(e>i||e>o)return 0;if(2*o>n)return 2*i>n?t.hypgeom.pdf(n-o-i+e,n,n-o,n-i):t.hypgeom.pdf(i-e,n,n-o,i);if(2*i>n)return t.hypgeom.pdf(o-e,n,o,n-i);if(o<i)return t.hypgeom.pdf(e,n,i,o);for(var s=1,a=0,u=0;u<e;u++){for(;s>1&&a<i;)s*=1-o/(n-a),a++;s*=(i-u)*(o-u)/((u+1)*(n-o-i+u+1))}for(;a<i;a++)s*=1-o/(n-a);return r.min(1,r.max(0,s))},cdf:function(e,n,o,i){if(e<0||e<o-(n-i))return 0;if(e>=i||e>=o)return 1;if(2*o>n)return 2*i>n?t.hypgeom.cdf(n-o-i+e,n,n-o,n-i):1-t.hypgeom.cdf(i-e-1,n,n-o,i);if(2*i>n)return 1-t.hypgeom.cdf(o-e-1,n,o,n-i);if(o<i)return t.hypgeom.cdf(e,n,i,o);for(var s=1,a=1,u=0,l=0;l<e;l++){for(;s>1&&u<i;){var f=1-o/(n-u);a*=f,s*=f,u++}s+=a*=(i-l)*(o-l)/((l+1)*(n-o-i+l+1))}for(;u<i;u++)s*=1-o/(n-u);return r.min(1,r.max(0,s))}}),t.extend(t.poisson,{pdf:function(e,n){return n<0||e%1!=0||e<0?0:r.pow(n,e)*r.exp(-n)/t.factorial(e)},cdf:function(r,e){var n=[],o=0;if(r<0)return 0;for(;o<=r;o++)n.push(t.poisson.pdf(o,e));return t.sum(n)},mean:function(t){return t},variance:function(t){return t},sampleSmall:function(e){var n=1,o=0,i=r.exp(-e);do{o++,n*=t._random_fn()}while(n>i);return o-1},sampleLarge:function(e){var n,o,i,s,a,u,l,f,c,h,m=e;for(s=r.sqrt(m),a=r.log(m),u=.02483*(l=.931+2.53*s)-.059,f=1.1239+1.1328/(l-3.4),c=.9277-3.6224/(l-2);;){if(o=r.random()-.5,i=r.random(),h=.5-r.abs(o),n=r.floor((2*u/h+l)*o+m+.43),h>=.07&&i<=c)return n;if(!(n<0||h<.013&&i>h)&&r.log(i)+r.log(f)-r.log(u/(h*h)+l)<=n*a-m-t.loggam(n+1))return n}},sample:function(t){return t<10?this.sampleSmall(t):this.sampleLarge(t)}}),t.extend(t.triangular,{pdf:function(t,r,e,n){return e<=r||n<r||n>e?NaN:t<r||t>e?0:t<n?2*(t-r)/((e-r)*(n-r)):t===n?2/(e-r):2*(e-t)/((e-r)*(e-n))},cdf:function(t,e,n,o){return n<=e||o<e||o>n?NaN:t<=e?0:t>=n?1:t<=o?r.pow(t-e,2)/((n-e)*(o-e)):1-r.pow(n-t,2)/((n-e)*(n-o))},inv:function(t,e,n,o){return n<=e||o<e||o>n?NaN:t<=(o-e)/(n-e)?e+(n-e)*r.sqrt(t*((o-e)/(n-e))):e+(n-e)*(1-r.sqrt((1-t)*(1-(o-e)/(n-e))))},mean:function(t,r,e){return(t+r+e)/3},median:function(t,e,n){return n<=(t+e)/2?e-r.sqrt((e-t)*(e-n))/r.sqrt(2):n>(t+e)/2?t+r.sqrt((e-t)*(n-t))/r.sqrt(2):void 0},mode:function(t,r,e){return e},sample:function(e,n,o){var i=t._random_fn();return i<(o-e)/(n-e)?e+r.sqrt(i*(n-e)*(o-e)):n-r.sqrt((1-i)*(n-e)*(n-o))},variance:function(t,r,e){return(t*t+r*r+e*e-t*r-t*e-r*e)/18}}),t.extend(t.arcsine,{pdf:function(t,e,n){return n<=e?NaN:t<=e||t>=n?0:2/r.PI*r.pow(r.pow(n-e,2)-r.pow(2*t-e-n,2),-.5)},cdf:function(t,e,n){return t<e?0:t<n?2/r.PI*r.asin(r.sqrt((t-e)/(n-e))):1},inv:function(t,e,n){return e+(.5-.5*r.cos(r.PI*t))*(n-e)},mean:function(t,r){return r<=t?NaN:(t+r)/2},median:function(t,r){return r<=t?NaN:(t+r)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(e,n){return(e+n)/2+(n-e)/2*r.sin(2*r.PI*t.uniform.sample(0,1))},variance:function(t,e){return e<=t?NaN:r.pow(e-t,2)/8}}),t.extend(t.laplace,{pdf:function(t,e,n){return n<=0?0:r.exp(-r.abs(t-e)/n)/(2*n)},cdf:function(t,e,n){return n<=0?0:t<e?.5*r.exp((t-e)/n):1-.5*r.exp(-(t-e)/n)},mean:function(t){return t},median:function(t){return t},mode:function(t){return t},variance:function(t,r){return 2*r*r},sample:function(e,o){var i=t._random_fn()-.5;return e-o*n(i)*r.log(1-2*r.abs(i))}}),t.extend(t.tukey,{cdf:function(e,n,i){var s=1,a=n,u=16,l=8,f=-30,c=1e-14,h=100,m=800,g=5e3,p=25e3,d=1,w=.5,v=.25,y=.125,b=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],M=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(e<=0)return 0;if(i<2||s<1||a<2)return NaN;if(!Number.isFinite(e))return 1;if(i>p)return o(e,s,a);var x,j=.5*i,E=j*r.log(i)-i*r.log(2)-t.gammaln(j),S=j-1,_=.25*i;x=i<=h?d:i<=m?w:i<=g?v:y,E+=r.log(x);for(var A=0,q=1;q<=50;q++){for(var P=0,k=(2*q-1)*x,R=1;R<=u;R++){var N,I;l<R?(N=R-l-1,I=E+S*r.log(k+b[N]*x)-(b[N]*x+k)*_):(N=R-1,I=E+S*r.log(k-b[N]*x)+(b[N]*x-k)*_),I>=f&&(P+=o(l<R?e*r.sqrt(.5*(b[N]*x+k)):e*r.sqrt(.5*(-b[N]*x+k)),s,a)*M[N]*r.exp(I))}if(q*x>=1&&P<=c)break;A+=P}if(P>c)throw new Error("tukey.cdf failed to converge");return A>1&&(A=1),A},inv:function(e,n,o){var s=1e-4,a=50;if(o<2||n<2)return NaN;if(e<0||e>1)return NaN;if(0===e)return 0;if(1===e)return 1/0;var u,l=i(e,n,o),f=t.tukey.cdf(l,n,o)-e;u=f>0?r.max(0,l-1):l+1;for(var c,h=t.tukey.cdf(u,n,o)-e,m=1;m<a;m++)if(c=u-h*(u-l)/(h-f),f=h,l=u,c<0&&(c=0,h=-e),h=t.tukey.cdf(c,n,o)-e,u=c,r.abs(u-l)<s)return c;throw new Error("tukey.inv failed to converge")}})}(t,Math),function(t,r){var e=Array.prototype.push,n=t.utils.isArray;function o(r){return n(r)||r instanceof t}t.extend({add:function(r,e){return o(e)?(o(e[0])||(e=[e]),t.map(r,(function(t,r,n){return t+e[r][n]}))):t.map(r,(function(t){return t+e}))},subtract:function(r,e){return o(e)?(o(e[0])||(e=[e]),t.map(r,(function(t,r,n){return t-e[r][n]||0}))):t.map(r,(function(t){return t-e}))},divide:function(r,e){return o(e)?(o(e[0])||(e=[e]),t.multiply(r,t.inv(e))):t.map(r,(function(t){return t/e}))},multiply:function(r,e){var n,i,s,a,u,l,f,c;if(void 0===r.length&&void 0===e.length)return r*e;if(u=r.length,l=r[0].length,f=t.zeros(u,s=o(e)?e[0].length:l),c=0,o(e)){for(;c<s;c++)for(n=0;n<u;n++){for(a=0,i=0;i<l;i++)a+=r[n][i]*e[i][c];f[n][c]=a}return 1===u&&1===c?f[0][0]:f}return t.map(r,(function(t){return t*e}))},outer:function(r,e){return t.multiply(r.map((function(t){return[t]})),[e])},dot:function(r,e){o(r[0])||(r=[r]),o(e[0])||(e=[e]);for(var n,i,s=1===r[0].length&&1!==r.length?t.transpose(r):r,a=1===e[0].length&&1!==e.length?t.transpose(e):e,u=[],l=0,f=s.length,c=s[0].length;l<f;l++){for(u[l]=[],n=0,i=0;i<c;i++)n+=s[l][i]*a[l][i];u[l]=n}return 1===u.length?u[0]:u},pow:function(e,n){return t.map(e,(function(t){return r.pow(t,n)}))},exp:function(e){return t.map(e,(function(t){return r.exp(t)}))},log:function(e){return t.map(e,(function(t){return r.log(t)}))},abs:function(e){return t.map(e,(function(t){return r.abs(t)}))},norm:function(t,e){var n=0,i=0;for(isNaN(e)&&(e=2),o(t[0])&&(t=t[0]);i<t.length;i++)n+=r.pow(r.abs(t[i]),e);return r.pow(n,1/e)},angle:function(e,n){return r.acos(t.dot(e,n)/(t.norm(e)*t.norm(n)))},aug:function(t,r){var n,o=[];for(n=0;n<t.length;n++)o.push(t[n].slice());for(n=0;n<o.length;n++)e.apply(o[n],r[n]);return o},inv:function(r){for(var e,n=r.length,o=r[0].length,i=t.identity(n,o),s=t.gauss_jordan(r,i),a=[],u=0;u<n;u++)for(a[u]=[],e=o;e<s[0].length;e++)a[u][e-o]=s[u][e];return a},det:function t(r){if(2===r.length)return r[0][0]*r[1][1]-r[0][1]*r[1][0];for(var e=0,n=0;n<r.length;n++){for(var o=[],i=1;i<r.length;i++){o[i-1]=[];for(var s=0;s<r.length;s++)s<n?o[i-1][s]=r[i][s]:s>n&&(o[i-1][s-1]=r[i][s])}var a=n%2?-1:1;e+=t(o)*r[0][n]*a}return e},gauss_elimination:function(e,n){var o,i,s,a,u=0,l=0,f=e.length,c=e[0].length,h=1,m=0,g=[];for(o=(e=t.aug(e,n))[0].length,u=0;u<f;u++){for(i=e[u][u],l=u,a=u+1;a<c;a++)i<r.abs(e[a][u])&&(i=e[a][u],l=a);if(l!=u)for(a=0;a<o;a++)s=e[u][a],e[u][a]=e[l][a],e[l][a]=s;for(l=u+1;l<f;l++)for(h=e[l][u]/e[u][u],a=u;a<o;a++)e[l][a]=e[l][a]-h*e[u][a]}for(u=f-1;u>=0;u--){for(m=0,l=u+1;l<=f-1;l++)m+=g[l]*e[u][l];g[u]=(e[u][o-1]-m)/e[u][u]}return g},gauss_jordan:function(e,n){var o,i,s,a=t.aug(e,n),u=a.length,l=a[0].length,f=0;for(i=0;i<u;i++){var c=i;for(s=i+1;s<u;s++)r.abs(a[s][i])>r.abs(a[c][i])&&(c=s);var h=a[i];for(a[i]=a[c],a[c]=h,s=i+1;s<u;s++)for(f=a[s][i]/a[i][i],o=i;o<l;o++)a[s][o]-=a[i][o]*f}for(i=u-1;i>=0;i--){for(f=a[i][i],s=0;s<i;s++)for(o=l-1;o>i-1;o--)a[s][o]-=a[i][o]*a[s][i]/f;for(a[i][i]/=f,o=u;o<l;o++)a[i][o]/=f}return a},triaUpSolve:function(r,e){var n,o=r[0].length,i=t.zeros(1,o)[0],s=!1;return null!=e[0].length&&(e=e.map((function(t){return t[0]})),s=!0),t.arange(o-1,-1,-1).forEach((function(s){n=t.arange(s+1,o).map((function(t){return i[t]*r[s][t]})),i[s]=(e[s]-t.sum(n))/r[s][s]})),s?i.map((function(t){return[t]})):i},triaLowSolve:function(r,e){var n,o=r[0].length,i=t.zeros(1,o)[0],s=!1;return null!=e[0].length&&(e=e.map((function(t){return t[0]})),s=!0),t.arange(o).forEach((function(o){n=t.arange(o).map((function(t){return r[o][t]*i[t]})),i[o]=(e[o]-t.sum(n))/r[o][o]})),s?i.map((function(t){return[t]})):i},lu:function(r){var e,n=r.length,o=t.identity(n),i=t.zeros(r.length,r[0].length);return t.arange(n).forEach((function(t){i[0][t]=r[0][t]})),t.arange(1,n).forEach((function(s){t.arange(s).forEach((function(n){e=t.arange(n).map((function(t){return o[s][t]*i[t][n]})),o[s][n]=(r[s][n]-t.sum(e))/i[n][n]})),t.arange(s,n).forEach((function(n){e=t.arange(s).map((function(t){return o[s][t]*i[t][n]})),i[s][n]=r[e.length][n]-t.sum(e)}))})),[o,i]},cholesky:function(e){var n,o=e.length,i=t.zeros(e.length,e[0].length);return t.arange(o).forEach((function(s){n=t.arange(s).map((function(t){return r.pow(i[s][t],2)})),i[s][s]=r.sqrt(e[s][s]-t.sum(n)),t.arange(s+1,o).forEach((function(r){n=t.arange(s).map((function(t){return i[s][t]*i[r][t]})),i[r][s]=(e[s][r]-t.sum(n))/i[s][s]}))})),i},gauss_jacobi:function(e,n,o,i){for(var s,a,u,l,f=0,c=0,h=e.length,m=[],g=[],p=[];f<h;f++)for(m[f]=[],g[f]=[],p[f]=[],c=0;c<h;c++)f>c?(m[f][c]=e[f][c],g[f][c]=p[f][c]=0):f<c?(g[f][c]=e[f][c],m[f][c]=p[f][c]=0):(p[f][c]=e[f][c],m[f][c]=g[f][c]=0);for(u=t.multiply(t.multiply(t.inv(p),t.add(m,g)),-1),a=t.multiply(t.inv(p),n),s=o,l=t.add(t.multiply(u,o),a),f=2;r.abs(t.norm(t.subtract(l,s)))>i;)s=l,l=t.add(t.multiply(u,s),a),f++;return l},gauss_seidel:function(e,n,o,i){for(var s,a,u,l,f,c=0,h=e.length,m=[],g=[],p=[];c<h;c++)for(m[c]=[],g[c]=[],p[c]=[],s=0;s<h;s++)c>s?(m[c][s]=e[c][s],g[c][s]=p[c][s]=0):c<s?(g[c][s]=e[c][s],m[c][s]=p[c][s]=0):(p[c][s]=e[c][s],m[c][s]=g[c][s]=0);for(l=t.multiply(t.multiply(t.inv(t.add(p,m)),g),-1),u=t.multiply(t.inv(t.add(p,m)),n),a=o,f=t.add(t.multiply(l,o),u),c=2;r.abs(t.norm(t.subtract(f,a)))>i;)a=f,f=t.add(t.multiply(l,a),u),c+=1;return f},SOR:function(e,n,o,i,s){for(var a,u,l,f,c,h=0,m=e.length,g=[],p=[],d=[];h<m;h++)for(g[h]=[],p[h]=[],d[h]=[],a=0;a<m;a++)h>a?(g[h][a]=e[h][a],p[h][a]=d[h][a]=0):h<a?(p[h][a]=e[h][a],g[h][a]=d[h][a]=0):(d[h][a]=e[h][a],g[h][a]=p[h][a]=0);for(f=t.multiply(t.inv(t.add(d,t.multiply(g,s))),t.subtract(t.multiply(d,1-s),t.multiply(p,s))),l=t.multiply(t.multiply(t.inv(t.add(d,t.multiply(g,s))),n),s),u=o,c=t.add(t.multiply(f,o),l),h=2;r.abs(t.norm(t.subtract(c,u)))>i;)u=c,c=t.add(t.multiply(f,u),l),h++;return c},householder:function(e){for(var n,o,i,s,a=e.length,u=e[0].length,l=0,f=[],c=[];l<a-1;l++){for(n=0,s=l+1;s<u;s++)n+=e[s][l]*e[s][l];for(n=(e[l+1][l]>0?-1:1)*r.sqrt(n),o=r.sqrt((n*n-e[l+1][l]*n)/2),(f=t.zeros(a,1))[l+1][0]=(e[l+1][l]-n)/(2*o),i=l+2;i<a;i++)f[i][0]=e[i][l]/(2*o);c=t.subtract(t.identity(a,u),t.multiply(t.multiply(f,t.transpose(f)),2)),e=t.multiply(c,t.multiply(e,c))}return e},QR:function(){var e=t.sum,n=t.arange;function o(o){var i,s,a,u=o.length,l=o[0].length,f=t.zeros(l,l);for(o=t.copy(o),s=0;s<l;s++){for(f[s][s]=r.sqrt(e(n(u).map((function(t){return o[t][s]*o[t][s]})))),i=0;i<u;i++)o[i][s]=o[i][s]/f[s][s];for(a=s+1;a<l;a++)for(f[s][a]=e(n(u).map((function(t){return o[t][s]*o[t][a]}))),i=0;i<u;i++)o[i][a]=o[i][a]-o[i][s]*f[s][a]}return[o,f]}return o}(),lstsq:function(){function r(r){var e=(r=t.copy(r)).length,n=t.identity(e);return t.arange(e-1,-1,-1).forEach((function(e){t.sliceAssign(n,{row:e},t.divide(t.slice(n,{row:e}),r[e][e])),t.sliceAssign(r,{row:e},t.divide(t.slice(r,{row:e}),r[e][e])),t.arange(e).forEach((function(o){var i=t.multiply(r[o][e],-1),s=t.slice(r,{row:o}),a=t.multiply(t.slice(r,{row:e}),i);t.sliceAssign(r,{row:o},t.add(s,a));var u=t.slice(n,{row:o}),l=t.multiply(t.slice(n,{row:e}),i);t.sliceAssign(n,{row:o},t.add(u,l))}))})),n}function e(e,n){var o=!1;void 0===n[0].length&&(n=n.map((function(t){return[t]})),o=!0);var i=t.QR(e),s=i[0],a=i[1],u=e[0].length,l=t.slice(s,{col:{end:u}}),f=r(t.slice(a,{row:{end:u}})),c=t.transpose(l);void 0===c[0].length&&(c=[c]);var h=t.multiply(t.multiply(f,c),n);return void 0===h.length&&(h=[[h]]),o?h.map((function(t){return t[0]})):h}return e}(),jacobi:function(e){for(var n,o,i,s,a,u,l,f=1,c=e.length,h=t.identity(c,c),m=[];1===f;){for(a=e[0][1],i=0,s=1,n=0;n<c;n++)for(o=0;o<c;o++)n!=o&&a<r.abs(e[n][o])&&(a=r.abs(e[n][o]),i=n,s=o);for(u=e[i][i]===e[s][s]?e[i][s]>0?r.PI/4:-r.PI/4:r.atan(2*e[i][s]/(e[i][i]-e[s][s]))/2,(l=t.identity(c,c))[i][i]=r.cos(u),l[i][s]=-r.sin(u),l[s][i]=r.sin(u),l[s][s]=r.cos(u),h=t.multiply(h,l),e=t.multiply(t.multiply(t.inv(l),e),l),f=0,n=1;n<c;n++)for(o=1;o<c;o++)n!=o&&r.abs(e[n][o])>.001&&(f=1)}for(n=0;n<c;n++)m.push(e[n][n]);return[h,m]},rungekutta:function(t,r,e,n,o,i){var s,a,u;if(2===i)for(;n<=e;)o+=((s=r*t(n,o))+(a=r*t(n+r,o+s)))/2,n+=r;if(4===i)for(;n<=e;)o+=((s=r*t(n,o))+2*(a=r*t(n+r/2,o+s/2))+2*(u=r*t(n+r/2,o+a/2))+r*t(n+r,o+u))/6,n+=r;return o},romberg:function(t,e,n,o){for(var i,s,a,u,l,f=0,c=(n-e)/2,h=[],m=[],g=[];f<o/2;){for(l=t(e),a=e,u=0;a<=n;a+=c,u++)h[u]=a;for(i=h.length,a=1;a<i-1;a++)l+=(a%2!=0?4:2)*t(h[a]);l=c/3*(l+t(n)),g[f]=l,c/=2,f++}for(s=g.length,i=1;1!==s;){for(a=0;a<s-1;a++)m[a]=(r.pow(4,i)*g[a+1]-g[a])/(r.pow(4,i)-1);s=m.length,g=m,m=[],i++}return g},richardson:function(t,e,n,o){function i(t,r){for(var e,n=0,o=t.length;n<o;n++)t[n]===r&&(e=n);return e}for(var s,a,u,l,f,c=r.abs(n-t[i(t,n)+1]),h=0,m=[],g=[];o>=c;)s=i(t,n+o),a=i(t,n),m[h]=(e[s]-2*e[a]+e[2*a-s])/(o*o),o/=2,h++;for(l=m.length,u=1;1!=l;){for(f=0;f<l-1;f++)g[f]=(r.pow(4,u)*m[f+1]-m[f])/(r.pow(4,u)-1);l=g.length,m=g,g=[],u++}return m},simpson:function(t,r,e,n){for(var o,i=(e-r)/n,s=t(r),a=[],u=r,l=0,f=1;u<=e;u+=i,l++)a[l]=u;for(o=a.length;f<o-1;f++)s+=(f%2!=0?4:2)*t(a[f]);return i/3*(s+t(e))},hermite:function(t,r,e,n){for(var o,i=t.length,s=0,a=0,u=[],l=[],f=[],c=[];a<i;a++){for(u[a]=1,o=0;o<i;o++)a!=o&&(u[a]*=(n-t[o])/(t[a]-t[o]));for(l[a]=0,o=0;o<i;o++)a!=o&&(l[a]+=1/(t[a]-t[o]));f[a]=(1-2*(n-t[a])*l[a])*(u[a]*u[a]),c[a]=(n-t[a])*(u[a]*u[a]),s+=f[a]*r[a]+c[a]*e[a]}return s},lagrange:function(t,r,e){for(var n,o,i=0,s=0,a=t.length;s<a;s++){for(o=r[s],n=0;n<a;n++)s!=n&&(o*=(e-t[n])/(t[s]-t[n]));i+=o}return i},cubic_spline:function(r,e,n){for(var o,i=r.length,s=0,a=[],u=[],l=[],f=[],c=[],h=[],m=[];s<i-1;s++)c[s]=r[s+1]-r[s];for(l[0]=0,s=1;s<i-1;s++)l[s]=3/c[s]*(e[s+1]-e[s])-3/c[s-1]*(e[s]-e[s-1]);for(s=1;s<i-1;s++)a[s]=[],u[s]=[],a[s][s-1]=c[s-1],a[s][s]=2*(c[s-1]+c[s]),a[s][s+1]=c[s],u[s][0]=l[s];for(f=t.multiply(t.inv(a),u),o=0;o<i-1;o++)h[o]=(e[o+1]-e[o])/c[o]-c[o]*(f[o+1][0]+2*f[o][0])/3,m[o]=(f[o+1][0]-f[o][0])/(3*c[o]);for(o=0;o<i&&!(r[o]>n);o++);return e[o-=1]+(n-r[o])*h[o]+t.sq(n-r[o])*f[o]+(n-r[o])*t.sq(n-r[o])*m[o]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(r){var e,n,o=r.length,i=r[0].length,s=0,a=[],u=[],l=[],f=[],c=[],h=[],m=[],g=[],p=[],d=[];for(s=0;s<o;s++)a[s]=t.sum(r[s])/i;for(s=0;s<i;s++)for(m[s]=[],e=0;e<o;e++)m[s][e]=r[e][s]-a[e];for(m=t.transpose(m),s=0;s<o;s++)for(g[s]=[],e=0;e<o;e++)g[s][e]=t.dot([m[s]],[m[e]])/(i-1);for(p=(l=t.jacobi(g))[0],u=l[1],d=t.transpose(p),s=0;s<u.length;s++)for(e=s;e<u.length;e++)u[s]<u[e]&&(n=u[s],u[s]=u[e],u[e]=n,f=d[s],d[s]=d[e],d[e]=f);for(h=t.transpose(m),s=0;s<o;s++)for(c[s]=[],e=0;e<h.length;e++)c[s][e]=t.dot([d[s]],[h[e]]);return[r,u,d,c]}}),function(r){for(var e=0;e<r.length;e++)!function(r){t.fn[r]=function(e,n){var o=this;return n?(setTimeout((function(){n.call(o,t.fn[r].call(o,e))}),15),this):"number"==typeof t[r](this,e)?t[r](this,e):t(t[r](this,e))}}(r[e])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(t,Math),function(t,r){var e=[].slice,n=t.utils.isNumber,o=t.utils.isArray;function i(t,e,n,o){if(t>1||n>1||t<=0||n<=0)throw new Error("Proportions should be greater than 0 and less than 1");var i=(t*e+n*o)/(e+o);return(t-n)/r.sqrt(i*(1-i)*(1/e+1/o))}t.extend({zscore:function(){var r=e.call(arguments);return n(r[1])?(r[0]-r[1])/r[2]:(r[0]-t.mean(r[1]))/t.stdev(r[1],r[2])},ztest:function(){var n,i=e.call(arguments);return o(i[1])?(n=t.zscore(i[0],i[1],i[3]),1===i[2]?t.normal.cdf(-r.abs(n),0,1):2*t.normal.cdf(-r.abs(n),0,1)):i.length>2?(n=t.zscore(i[0],i[1],i[2]),1===i[3]?t.normal.cdf(-r.abs(n),0,1):2*t.normal.cdf(-r.abs(n),0,1)):(n=i[0],1===i[1]?t.normal.cdf(-r.abs(n),0,1):2*t.normal.cdf(-r.abs(n),0,1))}}),t.extend(t.fn,{zscore:function(t,r){return(t-this.mean())/this.stdev(r)},ztest:function(e,n,o){var i=r.abs(this.zscore(e,o));return 1===n?t.normal.cdf(-i,0,1):2*t.normal.cdf(-i,0,1)}}),t.extend({tscore:function(){var n=e.call(arguments);return 4===n.length?(n[0]-n[1])/(n[2]/r.sqrt(n[3])):(n[0]-t.mean(n[1]))/(t.stdev(n[1],!0)/r.sqrt(n[1].length))},ttest:function(){var o,i=e.call(arguments);return 5===i.length?(o=r.abs(t.tscore(i[0],i[1],i[2],i[3])),1===i[4]?t.studentt.cdf(-o,i[3]-1):2*t.studentt.cdf(-o,i[3]-1)):n(i[1])?(o=r.abs(i[0]),1==i[2]?t.studentt.cdf(-o,i[1]-1):2*t.studentt.cdf(-o,i[1]-1)):(o=r.abs(t.tscore(i[0],i[1])),1==i[2]?t.studentt.cdf(-o,i[1].length-1):2*t.studentt.cdf(-o,i[1].length-1))}}),t.extend(t.fn,{tscore:function(t){return(t-this.mean())/(this.stdev(!0)/r.sqrt(this.cols()))},ttest:function(e,n){return 1===n?1-t.studentt.cdf(r.abs(this.tscore(e)),this.cols()-1):2*t.studentt.cdf(-r.abs(this.tscore(e)),this.cols()-1)}}),t.extend({anovafscore:function(){var n,o,i,s,a,u,l,f,c=e.call(arguments);if(1===c.length){for(a=new Array(c[0].length),l=0;l<c[0].length;l++)a[l]=c[0][l];c=a}for(o=new Array,l=0;l<c.length;l++)o=o.concat(c[l]);for(i=t.mean(o),n=0,l=0;l<c.length;l++)n+=c[l].length*r.pow(t.mean(c[l])-i,2);for(n/=c.length-1,u=0,l=0;l<c.length;l++)for(s=t.mean(c[l]),f=0;f<c[l].length;f++)u+=r.pow(c[l][f]-s,2);return n/(u/=o.length-c.length)},anovaftest:function(){var r,o,i,s,a=e.call(arguments);if(n(a[0]))return 1-t.centralF.cdf(a[0],a[1],a[2]);var u=t.anovafscore(a);for(r=a.length-1,i=0,s=0;s<a.length;s++)i+=a[s].length;return o=i-r-1,1-t.centralF.cdf(u,r,o)},ftest:function(r,e,n){return 1-t.centralF.cdf(r,e,n)}}),t.extend(t.fn,{anovafscore:function(){return t.anovafscore(this.toArray())},anovaftes:function(){var r,e=0;for(r=0;r<this.length;r++)e+=this[r].length;return t.ftest(this.anovafscore(),this.length-1,e-this.length)}}),t.extend({qscore:function(){var o,i,s,a,u,l=e.call(arguments);return n(l[0])?(o=l[0],i=l[1],s=l[2],a=l[3],u=l[4]):(o=t.mean(l[0]),i=t.mean(l[1]),s=l[0].length,a=l[1].length,u=l[2]),r.abs(o-i)/(u*r.sqrt((1/s+1/a)/2))},qtest:function(){var r,n=e.call(arguments);3===n.length?(r=n[0],n=n.slice(1)):7===n.length?(r=t.qscore(n[0],n[1],n[2],n[3],n[4]),n=n.slice(5)):(r=t.qscore(n[0],n[1],n[2]),n=n.slice(3));var o=n[0],i=n[1];return 1-t.tukey.cdf(r,i,o-i)},tukeyhsd:function(r){for(var e=t.pooledstdev(r),n=r.map((function(r){return t.mean(r)})),o=r.reduce((function(t,r){return t+r.length}),0),i=[],s=0;s<r.length;++s)for(var a=s+1;a<r.length;++a){var u=t.qtest(n[s],n[a],r[s].length,r[a].length,e,o,r.length);i.push([[s,a],u])}return i}}),t.extend({normalci:function(){var n,o=e.call(arguments),i=new Array(2);return n=4===o.length?r.abs(t.normal.inv(o[1]/2,0,1)*o[2]/r.sqrt(o[3])):r.abs(t.normal.inv(o[1]/2,0,1)*t.stdev(o[2])/r.sqrt(o[2].length)),i[0]=o[0]-n,i[1]=o[0]+n,i},tci:function(){var n,o=e.call(arguments),i=new Array(2);return n=4===o.length?r.abs(t.studentt.inv(o[1]/2,o[3]-1)*o[2]/r.sqrt(o[3])):r.abs(t.studentt.inv(o[1]/2,o[2].length-1)*t.stdev(o[2],!0)/r.sqrt(o[2].length)),i[0]=o[0]-n,i[1]=o[0]+n,i},significant:function(t,r){return t<r}}),t.extend(t.fn,{normalci:function(r,e){return t.normalci(r,e,this.toArray())},tci:function(r,e){return t.tci(r,e,this.toArray())}}),t.extend(t.fn,{oneSidedDifferenceOfProportions:function(r,e,n,o){var s=i(r,e,n,o);return t.ztest(s,1)},twoSidedDifferenceOfProportions:function(r,e,n,o){var s=i(r,e,n,o);return t.ztest(s,2)}})}(t,Math),t.models=function(){function r(r){var n=r[0].length;return t.arange(n).map((function(o){var i=t.arange(n).filter((function(t){return t!==o}));return e(t.col(r,o).map((function(t){return t[0]})),t.col(r,i))}))}function e(r,e){var n=r.length,o=e[0].length-1,i=n-o-1,s=t.lstsq(e,r),a=t.multiply(e,s.map((function(t){return[t]}))).map((function(t){return t[0]})),u=t.subtract(r,a),l=t.mean(r),f=t.sum(a.map((function(t){return Math.pow(t-l,2)}))),c=t.sum(r.map((function(t,r){return Math.pow(t-a[r],2)}))),h=f+c;return{exog:e,endog:r,nobs:n,df_model:o,df_resid:i,coef:s,predict:a,resid:u,ybar:l,SST:h,SSE:f,SSR:c,R2:f/h}}function n(e){var n=r(e.exog),o=Math.sqrt(e.SSR/e.df_resid),i=n.map((function(t){var r=t.SST,e=t.R2;return o/Math.sqrt(r*(1-e))})),s=e.coef.map((function(t,r){return(t-0)/i[r]})),a=s.map((function(r){var n=t.studentt.cdf(r,e.df_resid);return 2*(n>.5?1-n:n)})),u=t.studentt.inv(.975,e.df_resid),l=e.coef.map((function(t,r){var e=u*i[r];return[t-e,t+e]}));return{se:i,t:s,p:a,sigmaHat:o,interval95:l}}function o(r){var e,n,o,i=r.R2/r.df_model/((1-r.R2)/r.df_resid);return{F_statistic:i,pvalue:1-(e=i,n=r.df_model,o=r.df_resid,t.beta.cdf(e/(o/n+e),n/2,o/2))}}function i(t,r){var i=e(t,r),s=n(i),a=o(i),u=1-(1-i.R2)*((i.nobs-1)/i.df_resid);return i.t=s,i.f=a,i.adjust_R2=u,i}return{ols:i}}(),t.extend({buildxmatrix:function(){for(var r=new Array(arguments.length),e=0;e<arguments.length;e++){var n=[1];r[e]=n.concat(arguments[e])}return t(r)},builddxmatrix:function(){for(var r=new Array(arguments[0].length),e=0;e<arguments[0].length;e++){var n=[1];r[e]=n.concat(arguments[0][e])}return t(r)},buildjxmatrix:function(r){for(var e=new Array(r.length),n=0;n<r.length;n++)e[n]=r[n];return t.builddxmatrix(e)},buildymatrix:function(r){return t(r).transpose()},buildjymatrix:function(t){return t.transpose()},matrixmult:function(r,e){var n,o,i,s,a;if(r.cols()==e.rows()){if(e.rows()>1){for(s=[],n=0;n<r.rows();n++)for(s[n]=[],o=0;o<e.cols();o++){for(a=0,i=0;i<r.cols();i++)a+=r.toArray()[n][i]*e.toArray()[i][o];s[n][o]=a}return t(s)}for(s=[],n=0;n<r.rows();n++)for(s[n]=[],o=0;o<e.cols();o++){for(a=0,i=0;i<r.cols();i++)a+=r.toArray()[n][i]*e.toArray()[o];s[n][o]=a}return t(s)}},regress:function(r,e){var n=t.xtranspxinv(r),o=r.transpose(),i=t.matrixmult(t(n),o);return t.matrixmult(i,e)},regresst:function(r,e,n){var o=t.regress(r,e),i={anova:{}},s=t.jMatYBar(r,o);i.yBar=s;var a=e.mean();i.anova.residuals=t.residuals(e,s),i.anova.ssr=t.ssr(s,a),i.anova.msr=i.anova.ssr/(r[0].length-1),i.anova.sse=t.sse(e,s),i.anova.mse=i.anova.sse/(e.length-(r[0].length-1)-1),i.anova.sst=t.sst(e,a),i.anova.mst=i.anova.sst/(e.length-1),i.anova.r2=1-i.anova.sse/i.anova.sst,i.anova.r2<0&&(i.anova.r2=0),i.anova.fratio=i.anova.msr/i.anova.mse,i.anova.pvalue=t.anovaftest(i.anova.fratio,r[0].length-1,e.length-(r[0].length-1)-1),i.anova.rmse=Math.sqrt(i.anova.mse),i.anova.r2adj=1-i.anova.mse/i.anova.mst,i.anova.r2adj<0&&(i.anova.r2adj=0),i.stats=new Array(r[0].length);for(var u,l,f,c=t.xtranspxinv(r),h=0;h<o.length;h++)u=Math.sqrt(i.anova.mse*Math.abs(c[h][h])),l=Math.abs(o[h]/u),f=t.ttest(l,e.length-r[0].length-1,n),i.stats[h]=[o[h],u,l,f];return i.regress=o,i},xtranspx:function(r){return t.matrixmult(r.transpose(),r)},xtranspxinv:function(r){var e=t.matrixmult(r.transpose(),r);return t.inv(e)},jMatYBar:function(r,e){var n=t.matrixmult(r,e);return new t(n)},residuals:function(r,e){return t.matrixsubtract(r,e)},ssr:function(t,r){for(var e=0,n=0;n<t.length;n++)e+=Math.pow(t[n]-r,2);return e},sse:function(t,r){for(var e=0,n=0;n<t.length;n++)e+=Math.pow(t[n]-r[n],2);return e},sst:function(t,r){for(var e=0,n=0;n<t.length;n++)e+=Math.pow(t[n]-r,2);return e},matrixsubtract:function(r,e){for(var n=new Array(r.length),o=0;o<r.length;o++){n[o]=new Array(r[o].length);for(var i=0;i<r[o].length;i++)n[o][i]=r[o][i]-e[o][i]}return t(n)}}),t.jStat=t,t}()}({get exports(){return qo},set exports(t){qo=t}});let Po=qo.jStat,ko={beta:{pdf:Po.beta.pdf,cdf:Po.beta.cdf,inv:Po.beta.inv,sample:Po.beta.sample},centralF:{pdf:Po.centralF.pdf,cdf:Po.centralF.cdf,inv:Po.centralF.inv,sample:Po.centralF.sample},cauchy:{pdf:Po.cauchy.pdf,cdf:Po.cauchy.cdf,inv:Po.cauchy.inv,sample:Po.cauchy.sample},chisquare:{pdf:Po.chisquare.pdf,cdf:Po.chisquare.cdf,inv:Po.chisquare.inv,sample:Po.chisquare.sample},exponential:{pdf:Po.exponential.pdf,cdf:Po.exponential.cdf,inv:Po.exponential.inv,sample:Po.exponential.sample},gamma:{pdf:Po.gamma.pdf,cdf:Po.gamma.cdf,inv:Po.gamma.inv,sample:Po.gamma.sample},invgamma:{pdf:Po.invgamma.pdf,cdf:Po.invgamma.cdf,inv:Po.invgamma.inv,sample:Po.invgamma.sample},kumaraswamy:{pdf:Po.kumaraswamy.pdf,cdf:Po.kumaraswamy.cdf,inv:Po.kumaraswamy.inv,sample:Po.kumaraswamy.sample},lognormal:{pdf:Po.lognormal.pdf,cdf:Po.lognormal.cdf,inv:Po.lognormal.inv,sample:Po.lognormal.sample},normal:{pdf:Po.normal.pdf,cdf:Po.normal.cdf,inv:Po.normal.inv,sample:Po.normal.sample},pareto:{pdf:Po.pareto.pdf,cdf:Po.pareto.cdf,inv:Po.pareto.inv,sample:(t,r)=>{throw new Error("invalid pareto.sample")}},studentt:{pdf:Po.studentt.pdf,cdf:Po.studentt.cdf,inv:Po.studentt.inv,sample:Po.studentt.sample},tukey:{pdf:(t,r,e)=>{throw new Error("invalid tukey.pdf")},cdf:Po.tukey.cdf,inv:Po.tukey.inv,sample:(t,r)=>{throw new Error("invalid tukey.sample")}},weibull:{pdf:Po.weibull.pdf,cdf:Po.weibull.cdf,inv:Po.weibull.inv,sample:Po.weibull.sample},uniform:{pdf:Po.uniform.pdf,cdf:Po.uniform.cdf,inv:Po.uniform.inv,sample:Po.uniform.sample},binomial:{pdf:Po.binomial.pdf,cdf:Po.binomial.cdf,inv:(t,r,e)=>{throw new Error("invalid binomial.inv")},sample:(t,r)=>{throw new Error("invalid binomial.sample")}},negbin:{pdf:Po.negbin.pdf,cdf:Po.negbin.cdf,inv:(t,r,e)=>{throw new Error("invalid negbin.inv")},sample:(t,r)=>{throw new Error("invalid negbin.sample")}},hypgeom:{pdf:Po.hypgeom.pdf,cdf:Po.hypgeom.cdf,inv:(t,r,e,n)=>{throw new Error("invalid hypgeom.inv")},sample:(t,r,e)=>{throw new Error("invalid hypgeom.sample")}},poisson:{pdf:Po.poisson.pdf,cdf:Po.poisson.cdf,inv:(t,r)=>{throw new Error("invalid poisson.inv")},sample:Po.poisson.sample},triangular:{pdf:Po.triangular.pdf,cdf:Po.triangular.cdf,inv:(t,r,e,n)=>{throw new Error("invalid triangular.inv")},sample:Po.triangular.sample},arcsine:{pdf:Po.arcsine.pdf,cdf:Po.arcsine.cdf,inv:Po.arcsine.inv,sample:Po.arcsine.sample},std:t=>Po.stdev(t,!1),sampleStd:t=>Po.stdev(t,!0),emquantile:(t,r)=>Po.quantiles(t,[r],.4,.4)[0],emquantiles:Po.quantiles,percentile:Po.percentile};function Ro(t){if(!Rt(t))return null;if(0===_t(t))return null;if(_t(t=De(t=Ue(t,(t=>io(t))),yo))<=1)return null;return ko.sampleStd(t)}function No(t){var r=vo(t),e=r%1;return r==r?e?r-e:r:0}function Io(t){return!!io(t)&&(t=yo(t),"number"==typeof(r=t)&&r==No(r));var r}var Oo=l.isFinite,To=Math.min;function Co(t){var r=Math[t];return function(t,e){if(t=go(t),(e=null==e?0:To(No(e),292))&&Oo(t)){var n=(Ee(t)+"e").split("e");return+((n=(Ee(r(n[0]+"e"+(+n[1]+e)))+"e").split("e"))[0]+"e"+(+n[1]-e))}return r(t)}}var Fo=Co("round");function zo(t){if(!io(t))return 0;t=yo(t);let r=Fo(t);return"0"===String(r)?0:r}function $o(t){if(!Io(t))return!1;return zo(t)>0}async function Vo(t,r){if(!$o(t))return Promise.reject(`n[${t}] is not positive integer`);if((t=zo(t))<=1)return Promise.reject(`n[${t}] <= 1`);if(io(r)||(r=.95),(r=yo(r))<0)return Promise.reject(`p[${r}] < 0`);if(r>1)return Promise.reject(`p[${r}] > 1`);let e=t-1;return ko.studentt.inv(r,e)}async function Do(t,r){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"two-tailed";if(!Rt(t))return Promise.reject("arr is not an array");if(0===_t(t))return Promise.reject("arr is not an effective array");if(!io(r))return Promise.reject(`p[${r}] is not a number`);if((r=yo(r))<0)return Promise.reject(`p[${r}] < 0`);if(r>1)return Promise.reject(`p[${r}] > 1`);if("two-tailed"!==e&&"upper-tail"!==e&&"lower-tail"!==e)return Promise.reject(`mode[${e}] is not 'two-tailed', 'upper-tail' or 'lower-tail'`);let n=_t(bo(t));if(0===n)return Promise.reject("no effective data");let o=Mo(t),i=Ro(t);if(!_o(o))return Promise.reject(`avg[${o}] is not a number`);if(!_o(i))return Promise.reject(`sigma[${i}] is not a number`);let s=null;if("upper-tail"===e||"lower-tail"===e){let t=await Vo(n,r);s="upper-tail"===e?o+t*i/Math.sqrt(n):o-t*i/Math.sqrt(n)}else if("two-tailed"===e){let t=await Vo(n,r/2);s=[o-t*i/Math.sqrt(n),o+t*i/Math.sqrt(n)]}return s}function Lo(t){return"function"==typeof t?t:Pt}function Uo(t,r){return(it(t)?Be:$e)(t,Lo(r))}function Bo(t,r,e,n){for(var o=-1,i=null==t?0:t.length;++o<i;){var s=t[o];r(n,s,e(s),t)}return n}function Wo(t,r,e,n){return $e(t,(function(t,o,i){r(n,t,e(t),i)})),n}var Go,Xo,Yo=Object.prototype.hasOwnProperty,Qo=(Go=function(t,r,e){Yo.call(t,e)?t[e].push(r):Xe(t,e,[r])},function(t,r){var e=it(t)?Bo:Wo,n=Xo?Xo():{};return e(t,Go,Te(r),n)}),Ho=Qo,Jo=f?f.isConcatSpreadable:void 0;function Ko(t){return it(t)||_r(t)||!!(Jo&&t&&t[Jo])}function Zo(t,r,e,n,o){var i=-1,s=t.length;for(e||(e=Ko),o||(o=[]);++i<s;){var a=t[i];r>0&&e(a)?r>1?Zo(a,r-1,e,n,o):mr(o,a):n||(o[o.length]=a)}return o}function ti(t,r){if(t!==r){var e=void 0!==t,n=null===t,o=t==t,i=ae(t),s=void 0!==r,a=null===r,u=r==r,l=ae(r);if(!a&&!l&&!i&&t>r||i&&s&&u&&!a&&!l||n&&s&&u||!e&&u||!o)return 1;if(!n&&!i&&!l&&t<r||l&&e&&o&&!n&&!i||a&&e&&o||!s&&o||!u)return-1}return 0}function ri(t,r,e){r=r.length?Nt(r,(function(t){return it(t)?function(r){return qe(r,1===t.length?t[0]:t)}:t})):[Pt];var n=-1;return r=Nt(r,Tr(Te)),function(t,r){var e=t.length;for(t.sort(r);e--;)t[e]=t[e].value;return t}(Ve(t,(function(t,e,o){return{criteria:Nt(r,(function(r){return r(t)})),index:++n,value:t}})),(function(t,r){return function(t,r,e){for(var n=-1,o=t.criteria,i=r.criteria,s=o.length,a=e.length;++n<s;){var u=ti(o[n],i[n]);if(u)return n>=a?u:u*("desc"==e[n]?-1:1)}return t.index-r.index}(t,r,e)}))}var ei=Math.max;var ni=Ge?function(t,r){return Ge(t,"toString",{configurable:!0,enumerable:!1,value:(e=r,function(){return e}),writable:!0});var e}:Pt,oi=ni,ii=Date.now;var si=function(t){var r=0,e=0;return function(){var n=ii(),o=16-(n-e);if(e=n,o>0){if(++r>=800)return arguments[0]}else r=0;return t.apply(void 0,arguments)}}(oi),ai=si;function ui(t,r,e){if(!b(e))return!1;var n=typeof r;return!!("number"==n?ot(e)&&Ir(r,e.length):"string"==n&&r in e)&&It(e[r],t)}var li=function(t,r){return ai(function(t,r,e){return r=ei(void 0===r?t.length-1:r,0),function(){for(var n=arguments,o=-1,i=ei(n.length-r,0),s=Array(i);++o<i;)s[o]=n[r+o];o=-1;for(var a=Array(r+1);++o<r;)a[o]=n[o];return a[r]=e(s),function(t,r,e){switch(e.length){case 0:return t.call(r);case 1:return t.call(r,e[0]);case 2:return t.call(r,e[0],e[1]);case 3:return t.call(r,e[0],e[1],e[2])}return t.apply(r,e)}(t,this,a)}}(t,r,Pt),t+"")}((function(t,r){if(null==t)return[];var e=r.length;return e>1&&ui(t,r[0],r[1])?r=[]:e>2&&ui(r[0],r[1],r[2])&&(r=[r[0]]),ri(t,Zo(r,1),[])})),fi=li,ci=Array.prototype.reverse;function hi(t){return t&&t.length?At(t,Pt):0}function mi(t){let r=Object.prototype.toString.call(t);return"[object Function]"===r||"[object AsyncFunction]"===r}function gi(t){let r,e=Object.prototype.toString.call(t);if(r="[object Promise]"===e,r)return!0;if("[object Function]"!==e)return!1;try{r="function"!=typeof t.subscribe&&"function"==typeof t.then}catch(t){}return r}function pi(t,r,e,n,o){for(let i=0;i<t.length;++i)t[i]=r*e[i]+n*o[i]}function di(t,r){return t.y-r.y}function wi(t,r,e){for(var n=-1,o=t.length;++n<o;){var i=t[n],s=r(i);if(null!=s&&(void 0===a?s==s&&!ae(s):e(s,a)))var a=s,u=i}return u}function vi(t,r){return t<r}function yi(t){return t&&t.length?wi(t,Pt,vi):void 0}function bi(t,r){return t>r}function Mi(t){return t&&t.length?wi(t,Pt,bi):void 0}function xi(t,r){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=Pe(e,"keyMax");oo(n)||(n="max");let o=Pe(e,"keyMin");oo(o)||(o="min");let i=Pe(e,"keyValue");oo(i)||(i="value");let s=Pe(e,"keyItems");if(oo(s)||(s="items"),!no(t))return[];if(!no(r))return[];let a=Kn(r);return Uo(t,((t,e)=>{let u=Pe(t,i);io(u)?u=yo(u):io(t)&&(u=yo(t)),_o(u)&&Uo(r,((r,e)=>{let i=Pe(r,n,null),l=Pe(r,o,null);if(null!==i&&null!==l&&io(i)&&io(l)){let n=Pe(r,"maxType");"<="!==n&&"<"!==n&&(n="<=");let o,h,m=Pe(r,"minType");">="!==m&&">"!==m&&(m=">="),i=yo(i),l=yo(l),o=">="===m?u>=l:u>l,h="<="===n?u<=i:u<i,o&&h&&(f=a[e],c=s,Zn(f)&&(oo(c)||io(c))&&c in f||(a[e][s]=[]),a[e][s].push(t))}var f,c}))})),a}function ji(t,r){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(!io(t))return[];if(t=yo(t),!io(r))return[];r=yo(r),$o(e)||(e=2),e=zo(e);let n=(r-t)/e,o=t,i=[];for(let t=0;t<=e;t++)i.push(o),o+=n;return i}function Ei(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};$o(r)||(r=30),r=zo(r);let n=bo(t);if(0===_t(n))return[];let o=Pe(e,"min",null);io(o)||(o=yi(n)),o=yo(o);let i=Pe(e,"max",null);io(i)||(i=Mi(n)),i=yo(i);let s=ji(o,i,r),a=[];for(let t=0;t<_t(s)-1;t++){let r=0===t?">=":">",e="<=",n={min:s[t],max:s[t+1],avg:(s[t]+s[t+1])/2,minType:r,maxType:e};a.push(n)}return De(xi(n,a),(t=>({min:t.min,max:t.max,avg:t.avg,arr:Pe(t,"items",[])})))}async function Si(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Rt(t))return Promise.reject("arr is not an array");if(0===_t(t))return Promise.reject("arr is not an effective array");let e=Pe(r,"n");$o(e)||(e=30),e=zo(e);let n=Pe(r,"min",null),o=Pe(r,"max",null),i=bo(t);if(i=Ue(i,(t=>t>0)),0===_t(i))return Promise.reject("no effective data");let s=Ei(i,e,{min:n,max:o}),a=Pe(s,"0.max")-Pe(s,"0.min");s=De(s,(t=>(t.counts=_t(t.arr),t)));let u=hi(De(s,"counts"))*a;if(u<=0)throw new Error(`r[${u}<=0]`);s=De(s,(t=>(t.pdf=t.counts/u,t)));let l=(t,r)=>{let e=[];return Uo(s,(n=>{let o=n.avg,i=n.pdf,s=((t,r,e)=>ko.gamma.pdf(t,r,e))(o,t,r);if(!_o(s))throw console.log("x",o,"shape",t,"scale",r),new Error("yf is not number");e.push([o,i,s])})),e},f=await async function(t,r){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!mi(t))return Promise.reject("invalid fun");if(!no(r))return Promise.reject("params is not an effective array");let n=_t(r),o=Pe(e,"maxIterations");io(o)||(o=200*n),o=yo(o);let i=Pe(e,"nonZeroDelta");io(i)||(i=1.05),i=yo(i);let s=Pe(e,"delta");io(s)||(s=.001),s=yo(s);let a=Pe(e,"minErrorDelta");io(a)||(a=1e-6),a=yo(a);let u=Pe(e,"minTolerance");io(u)||(u=1e-5),u=yo(u);let l=Pe(e,"rho");io(l)||(l=1),l=yo(l);let f=Pe(e,"chi");io(f)||(f=2),f=yo(f);let c=Pe(e,"psi");io(c)||(c=-.5),c=yo(c);let h=Pe(e,"sigma");io(h)||(h=.5),h=yo(h);let m=0;async function g(){let r=t(...arguments);return gi(r)&&(r=await r),m++,r}let p=new Array(n+1);p[0]=r,p[0].y=await g(r),p[0].id=0;for(let t=0;t<n;++t){let e=r.slice();e[t]=e[t]?e[t]*i:s,p[t+1]=e,p[t+1].y=await g(e),p[t+1].id=t+1}let d,w=t=>{for(let r=0;r<t.length;r++)p[n][r]=t[r];p[n].y=t.y},v=r.slice(),y=r.slice(),b=r.slice(),M=r.slice();for(let t=0;t<o;++t){p.sort(di),d=0;for(let t=0;t<n;++t)d=Math.max(d,Math.abs(p[0][t]-p[1][t]));if(Math.abs(p[0].y-p[n].y)<a&&d<u)break;for(let t=0;t<n;++t){v[t]=0;for(let r=0;r<n;++r)v[t]+=p[r][t];v[t]/=n}let t=p[n];if(pi(y,1+l,v,-l,t),y.y=await g(y),y.y<p[0].y)pi(M,1+f,v,-f,t),M.y=await g(M),M.y<y.y?w(M):w(y);else if(y.y>=p[n-1].y){let r=!1;if(y.y>t.y?(pi(b,1+c,v,-c,t),b.y=await g(b),b.y<t.y?w(b):r=!0):(pi(b,1-c*l,v,c*l,t),b.y=await g(b),b.y<y.y?w(b):r=!0),r){if(h>=1)break;for(let t=1;t<p.length;++t)pi(p[t],1-h,p[0],h,p[t]),p[t].y=await g(p[t])}}else w(y)}p.sort(di);let x=[],j=p[0];for(let t=0;t<n;t++)x.push(j[t]);return{count:m,y:p[0].y,x:x}}((async t=>{let r=t[0],e=t[1],n=0;return Uo(l(r,e),(t=>{let r=t[1],e=t[2];n+=(r-e)**2})),n}),[1,1]),c=Pe(f,"x.0",null),h=Pe(f,"x.1",null),m=l(c,h);return{shape:c,scale:h,arr:i,arrPdf:m,arrCounts:De(m,(t=>[t[0],t[1]*u,t[2]*u])),dx:a,bs:s}}var _i=Co("floor"),Ai=Co("ceil");async function qi(t,r){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!mi(r))throw new Error("invalid fun");let n=bo(t);if(0===_t(n))return null;let o,i,s,a,u=Pe(e,"nCurve");if($o(u)||(u=100),u=zo(u),o=Pe(e,"dx",null),io(o)){o=yo(o);let t=yi(n),r=Mi(n);s=_i(t/o)*o,a=Ai(r/o)*o,i=Fo(a-s)/o}else i=Pe(e,"n"),$o(i)||(i=30),i=zo(i),s=Pe(e,"min",null),a=Pe(e,"max",null);let l=Ei(n,i,{min:s,max:a});io(o)||(o=Pe(l,"0.max")-Pe(l,"0.min")),l=De(l,(t=>(t.counts=_t(t.arr),t)));let f=[...De(l,"min"),...De(l,"max")],c=yi(f),h=Mi(f),m=De(l,"counts"),g=hi(m)*o,p=De(m,(t=>t/g)),d=ji(c,h,u),w=r({arr:n,min:c,max:h,barWidth:o,bins:l,counts:m,pdfs:p,curveX:d});return gi(w)&&(w=await w),{arr:n,min:c,max:h,barWidth:o,bins:l,counts:m,pdfs:p,ratioForCountToPdf:1/g,curveX:d,curveY:w}}function Pi(t){return Pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pi(t)}function ki(t){var r=function(t,r){if("object"!==Pi(t)||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,r||"default");if("object"!==Pi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"===Pi(r)?r:String(r)}function Ri(t,r,e){return(r=ki(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function Ni(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),e.push.apply(e,n)}return e}function Ii(t){if(!Rt(t))return null;if(0===_t(t))return null;let r=jo(t),e=_t(r);if(0===e)return null;let n=0;Uo(r,(t=>{n+=Math.log(t)})),n/=e;try{n=Math.exp(n)}catch(t){return console.log(t),null}return n}async function Oi(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Rt(t))return Promise.reject("arr is not an array");if(0===_t(t))return Promise.reject("arr is not an effective array");let e=null,n=null,o=await qi(t,(t=>{e=Mo(t.arr),n=Ro(t.arr);let r=n*Math.sqrt(2*Math.PI);return De(t.curveX,(t=>{let o=0;return 0!==r&&(o=1/r*Math.exp(-((t-e)**2)/(2*n**2))),o}))}),r),i=De(o.bins,((t,r)=>(t.pdf=o.pdfs[r],t))),s=De(o.curveX,((t,r)=>({x:t,pdf:o.curveY[r]})));return{avg:e,std:n,arr:o.arr,min:o.min,max:o.max,barWidth:o.barWidth,ratioForCountToPdf:o.ratioForCountToPdf,bins:i,curves:s}}async function Ti(t,r){if(!Rt(t))return Promise.reject("arr is not an array");if(0===_t(t))return Promise.reject("arr is not an effective array");if(!io(r))return Promise.reject(`ratio[${r}] is not a number`);if((r=yo(r))<0)return Promise.reject(`ratio[${r}] < 0`);if(r>1)return Promise.reject(`ratio[${r}] > 1`);let e=bo(t);if(0===_t(e))return Promise.reject("no effective data");let n=Mo(e),o=Ro(e);return _o(n)?_o(o)?o<=0?Promise.reject(`std[${o}] <= 0`):{inv:ko.normal.inv(r,n,o),avg:n,std:o,arr:e}:Promise.reject(`std[${o}] is not a number`):Promise.reject(`avg[${n}] is not a number`)}function Ci(t){if(0===t.length)return 0;var r,e=t[0],n=0;if("number"!=typeof e)return NaN;for(var o=1;o<t.length;o++){if("number"!=typeof t[o])return NaN;r=e+t[o],Math.abs(e)>=Math.abs(t[o])?n+=e-r+t[o]:n+=t[o]-r+e,e=r}return e+n}function Fi(t){if(0===t.length)throw new Error("mean requires at least one data point");return Ci(t)/t.length}function zi(t,r){var e,n,o=Fi(t),i=0;if(2===r)for(n=0;n<t.length;n++)i+=(e=t[n]-o)*e;else for(n=0;n<t.length;n++)i+=Math.pow(t[n]-o,r);return i}function $i(t){if(0===t.length)throw new Error("variance requires at least one data point");return zi(t,2)/t.length}function Vi(t){if(1===t.length)return 0;var r=$i(t);return Math.sqrt(r)}function Di(t){if(0===t.length)throw new Error("mode requires at least one data point");if(1===t.length)return t[0];for(var r=t[0],e=NaN,n=0,o=1,i=1;i<t.length+1;i++)t[i]!==r?(o>n&&(n=o,e=r),o=1,r=t[i]):o++;return e}function Li(t){return t.slice().sort((function(t,r){return t-r}))}function Ui(t){if(0===t.length)throw new Error("min requires at least one data point");for(var r=t[0],e=1;e<t.length;e++)t[e]<r&&(r=t[e]);return r}function Bi(t){if(0===t.length)throw new Error("max requires at least one data point");for(var r=t[0],e=1;e<t.length;e++)t[e]>r&&(r=t[e]);return r}function Wi(t){for(var r=0,e=0;e<t.length;e++){if("number"!=typeof t[e])return NaN;r+=t[e]}return r}function Gi(t,r){var e=t.length*r;if(0===t.length)throw new Error("quantile requires at least one data point.");if(r<0||r>1)throw new Error("quantiles must be between 0 and 1");return 1===r?t[t.length-1]:0===r?t[0]:e%1!=0?t[Math.ceil(e)-1]:t.length%2==0?(t[e-1]+t[e])/2:t[e]}function Xi(t,r,e,n){for(e=e||0,n=n||t.length-1;n>e;){if(n-e>600){var o=n-e+1,i=r-e+1,s=Math.log(o),a=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*a*(o-a)/o);i-o/2<0&&(u*=-1),Xi(t,r,Math.max(e,Math.floor(r-i*a/o+u)),Math.min(n,Math.floor(r+(o-i)*a/o+u)))}var l=t[r],f=e,c=n;for(Yi(t,e,r),t[n]>l&&Yi(t,e,n);f<c;){for(Yi(t,f,c),f++,c--;t[f]<l;)f++;for(;t[c]>l;)c--}t[e]===l?Yi(t,e,c):Yi(t,++c,n),c<=r&&(e=c+1),r<=c&&(n=c-1)}}function Yi(t,r,e){var n=t[r];t[r]=t[e],t[e]=n}function Qi(t,r){var e=t.slice();if(Array.isArray(r)){!function(t,r){for(var e=[0],n=0;n<r.length;n++)e.push(Ki(t.length,r[n]));e.push(t.length-1),e.sort(Ji);var o=[0,e.length-1];for(;o.length;){var i=Math.ceil(o.pop()),s=Math.floor(o.pop());if(!(i-s<=1)){var a=Math.floor((s+i)/2);Hi(t,e[a],Math.floor(e[s]),Math.ceil(e[i])),o.push(s,a,a,i)}}}(e,r);for(var n=[],o=0;o<r.length;o++)n[o]=Gi(e,r[o]);return n}return Hi(e,Ki(e.length,r),0,e.length-1),Gi(e,r)}function Hi(t,r,e,n){r%1==0?Xi(t,r,e,n):(Xi(t,r=Math.floor(r),e,n),Xi(t,r+1,r+1,n))}function Ji(t,r){return t-r}function Ki(t,r){var e=t*r;return 1===r?t-1:0===r?0:e%1!=0?Math.ceil(e)-1:t%2==0?e-.5:e}function Zi(t,r){if(r<t[0])return 0;if(r>t[t.length-1])return 1;var e=function(t,r){var e=0,n=0,o=t.length;for(;n<o;)r<=t[e=n+o>>>1]?o=e:n=-~e;return n}(t,r);if(t[e]!==r)return e/t.length;e++;var n=function(t,r){var e=0,n=0,o=t.length;for(;n<o;)r>=t[e=n+o>>>1]?n=-~e:o=e;return n}(t,r);if(n===e)return e/t.length;var o=n-e+1;return o*(n+e)/2/o/t.length}function ts(t){var r=Qi(t,.75),e=Qi(t,.25);if("number"==typeof r&&"number"==typeof e)return r-e}function rs(t){return+Qi(t,.5)}function es(t){for(var r=rs(t),e=[],n=0;n<t.length;n++)e.push(Math.abs(t[n]-r));return rs(e)}function ns(t,r){r=r||Math.random;for(var e,n,o=t.length;o>0;)n=Math.floor(r()*o--),e=t[o],t[o]=t[n],t[n]=e;return t}function os(t,r){return ns(t.slice(),r)}function is(t,r,e){return os(t,e).slice(0,r)}function ss(t,r){for(var e=[],n=0;n<t;n++){for(var o=[],i=0;i<r;i++)o.push(0);e.push(o)}return e}function as(t){for(var r,e=0,n=0;n<t.length;n++)0!==n&&t[n]===r||(r=t[n],e++);return e}function us(t,r,e,n){var o;if(t>0){var i=(e[r]-e[t-1])/(r-t+1);o=n[r]-n[t-1]-(r-t+1)*i*i}else o=n[r]-e[r]*e[r]/(r+1);return o<0?0:o}function ls(t,r,e,n,o,i,s){if(!(t>r)){var a=Math.floor((t+r)/2);n[e][a]=n[e-1][a-1],o[e][a]=a;var u=e;t>e&&(u=Math.max(u,o[e][t-1]||0)),u=Math.max(u,o[e-1][a]||0);var l,f,c,h=a-1;r<n[0].length-1&&(h=Math.min(h,o[e][r+1]||0));for(var m=h;m>=u&&!((l=us(m,a,i,s))+n[e-1][u-1]>=n[e][a]);--m)(f=us(u,a,i,s)+n[e-1][u-1])<n[e][a]&&(n[e][a]=f,o[e][a]=u),u++,(c=l+n[e-1][m-1])<n[e][a]&&(n[e][a]=c,o[e][a]=m);ls(t,a-1,e,n,o,i,s),ls(a+1,r,e,n,o,i,s)}}function fs(t,r){if(t.length!==r.length)throw new Error("sampleCovariance requires samples with equal lengths");if(t.length<2)throw new Error("sampleCovariance requires at least two data points in each sample");for(var e=Fi(t),n=Fi(r),o=0,i=0;i<t.length;i++)o+=(t[i]-e)*(r[i]-n);return o/(t.length-1)}function cs(t){if(t.length<2)throw new Error("sampleVariance requires at least two data points");return zi(t,2)/(t.length-1)}function hs(t){var r=cs(t);return Math.sqrt(r)}function ms(t,r){return fs(t,r)/hs(t)/hs(r)}function gs(t,r,e,n){return(t*r+e*n)/(r+n)}function ps(t){if(0===t.length)throw new Error("meanSimple requires at least one data point");return Wi(t)/t.length}function ds(t){if(0===t.length)throw new Error("rootMeanSquare requires at least one data point");for(var r=0,e=0;e<t.length;e++)r+=Math.pow(t[e],2);return Math.sqrt(r/t.length)}var ws=function(){this.totalCount=0,this.data={}};ws.prototype.train=function(t,r){for(var e in this.data[r]||(this.data[r]={}),t){var n=t[e];void 0===this.data[r][e]&&(this.data[r][e]={}),void 0===this.data[r][e][n]&&(this.data[r][e][n]=0),this.data[r][e][n]++}this.totalCount++},ws.prototype.score=function(t){var r,e={};for(var n in t){var o=t[n];for(r in this.data)e[r]={},this.data[r][n]?e[r][n+"_"+o]=(this.data[r][n][o]||0)/this.totalCount:e[r][n+"_"+o]=0}var i={};for(r in e)for(var s in i[r]=0,e[r])i[r]+=e[r][s];return i};var vs=function(){this.weights=[],this.bias=0};vs.prototype.predict=function(t){if(t.length!==this.weights.length)return null;for(var r=0,e=0;e<this.weights.length;e++)r+=this.weights[e]*t[e];return(r+=this.bias)>0?1:0},vs.prototype.train=function(t,r){if(0!==r&&1!==r)return null;t.length!==this.weights.length&&(this.weights=t,this.bias=1);var e=this.predict(t);if("number"==typeof e&&e!==r){for(var n=r-e,o=0;o<this.weights.length;o++)this.weights[o]+=n*t[o];this.bias+=n}return this};var ys=1e-4;function bs(t){if(t<0)throw new Error("factorial requires a non-negative value");if(Math.floor(t)!==t)throw new Error("factorial requires an integer input");for(var r=1,e=2;e<=t;e++)r*=e;return r}var Ms=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],xs=Math.log(Math.sqrt(2*Math.PI));var js={1:{.995:0,.99:0,.975:0,.95:0,.9:.02,.5:.45,.1:2.71,.05:3.84,.025:5.02,.01:6.63,.005:7.88},2:{.995:.01,.99:.02,.975:.05,.95:.1,.9:.21,.5:1.39,.1:4.61,.05:5.99,.025:7.38,.01:9.21,.005:10.6},3:{.995:.07,.99:.11,.975:.22,.95:.35,.9:.58,.5:2.37,.1:6.25,.05:7.81,.025:9.35,.01:11.34,.005:12.84},4:{.995:.21,.99:.3,.975:.48,.95:.71,.9:1.06,.5:3.36,.1:7.78,.05:9.49,.025:11.14,.01:13.28,.005:14.86},5:{.995:.41,.99:.55,.975:.83,.95:1.15,.9:1.61,.5:4.35,.1:9.24,.05:11.07,.025:12.83,.01:15.09,.005:16.75},6:{.995:.68,.99:.87,.975:1.24,.95:1.64,.9:2.2,.5:5.35,.1:10.65,.05:12.59,.025:14.45,.01:16.81,.005:18.55},7:{.995:.99,.99:1.25,.975:1.69,.95:2.17,.9:2.83,.5:6.35,.1:12.02,.05:14.07,.025:16.01,.01:18.48,.005:20.28},8:{.995:1.34,.99:1.65,.975:2.18,.95:2.73,.9:3.49,.5:7.34,.1:13.36,.05:15.51,.025:17.53,.01:20.09,.005:21.96},9:{.995:1.73,.99:2.09,.975:2.7,.95:3.33,.9:4.17,.5:8.34,.1:14.68,.05:16.92,.025:19.02,.01:21.67,.005:23.59},10:{.995:2.16,.99:2.56,.975:3.25,.95:3.94,.9:4.87,.5:9.34,.1:15.99,.05:18.31,.025:20.48,.01:23.21,.005:25.19},11:{.995:2.6,.99:3.05,.975:3.82,.95:4.57,.9:5.58,.5:10.34,.1:17.28,.05:19.68,.025:21.92,.01:24.72,.005:26.76},12:{.995:3.07,.99:3.57,.975:4.4,.95:5.23,.9:6.3,.5:11.34,.1:18.55,.05:21.03,.025:23.34,.01:26.22,.005:28.3},13:{.995:3.57,.99:4.11,.975:5.01,.95:5.89,.9:7.04,.5:12.34,.1:19.81,.05:22.36,.025:24.74,.01:27.69,.005:29.82},14:{.995:4.07,.99:4.66,.975:5.63,.95:6.57,.9:7.79,.5:13.34,.1:21.06,.05:23.68,.025:26.12,.01:29.14,.005:31.32},15:{.995:4.6,.99:5.23,.975:6.27,.95:7.26,.9:8.55,.5:14.34,.1:22.31,.05:25,.025:27.49,.01:30.58,.005:32.8},16:{.995:5.14,.99:5.81,.975:6.91,.95:7.96,.9:9.31,.5:15.34,.1:23.54,.05:26.3,.025:28.85,.01:32,.005:34.27},17:{.995:5.7,.99:6.41,.975:7.56,.95:8.67,.9:10.09,.5:16.34,.1:24.77,.05:27.59,.025:30.19,.01:33.41,.005:35.72},18:{.995:6.26,.99:7.01,.975:8.23,.95:9.39,.9:10.87,.5:17.34,.1:25.99,.05:28.87,.025:31.53,.01:34.81,.005:37.16},19:{.995:6.84,.99:7.63,.975:8.91,.95:10.12,.9:11.65,.5:18.34,.1:27.2,.05:30.14,.025:32.85,.01:36.19,.005:38.58},20:{.995:7.43,.99:8.26,.975:9.59,.95:10.85,.9:12.44,.5:19.34,.1:28.41,.05:31.41,.025:34.17,.01:37.57,.005:40},21:{.995:8.03,.99:8.9,.975:10.28,.95:11.59,.9:13.24,.5:20.34,.1:29.62,.05:32.67,.025:35.48,.01:38.93,.005:41.4},22:{.995:8.64,.99:9.54,.975:10.98,.95:12.34,.9:14.04,.5:21.34,.1:30.81,.05:33.92,.025:36.78,.01:40.29,.005:42.8},23:{.995:9.26,.99:10.2,.975:11.69,.95:13.09,.9:14.85,.5:22.34,.1:32.01,.05:35.17,.025:38.08,.01:41.64,.005:44.18},24:{.995:9.89,.99:10.86,.975:12.4,.95:13.85,.9:15.66,.5:23.34,.1:33.2,.05:36.42,.025:39.36,.01:42.98,.005:45.56},25:{.995:10.52,.99:11.52,.975:13.12,.95:14.61,.9:16.47,.5:24.34,.1:34.28,.05:37.65,.025:40.65,.01:44.31,.005:46.93},26:{.995:11.16,.99:12.2,.975:13.84,.95:15.38,.9:17.29,.5:25.34,.1:35.56,.05:38.89,.025:41.92,.01:45.64,.005:48.29},27:{.995:11.81,.99:12.88,.975:14.57,.95:16.15,.9:18.11,.5:26.34,.1:36.74,.05:40.11,.025:43.19,.01:46.96,.005:49.65},28:{.995:12.46,.99:13.57,.975:15.31,.95:16.93,.9:18.94,.5:27.34,.1:37.92,.05:41.34,.025:44.46,.01:48.28,.005:50.99},29:{.995:13.12,.99:14.26,.975:16.05,.95:17.71,.9:19.77,.5:28.34,.1:39.09,.05:42.56,.025:45.72,.01:49.59,.005:52.34},30:{.995:13.79,.99:14.95,.975:16.79,.95:18.49,.9:20.6,.5:29.34,.1:40.26,.05:43.77,.025:46.98,.01:50.89,.005:53.67},40:{.995:20.71,.99:22.16,.975:24.43,.95:26.51,.9:29.05,.5:39.34,.1:51.81,.05:55.76,.025:59.34,.01:63.69,.005:66.77},50:{.995:27.99,.99:29.71,.975:32.36,.95:34.76,.9:37.69,.5:49.33,.1:63.17,.05:67.5,.025:71.42,.01:76.15,.005:79.49},60:{.995:35.53,.99:37.48,.975:40.48,.95:43.19,.9:46.46,.5:59.33,.1:74.4,.05:79.08,.025:83.3,.01:88.38,.005:91.95},70:{.995:43.28,.99:45.44,.975:48.76,.95:51.74,.9:55.33,.5:69.33,.1:85.53,.05:90.53,.025:95.02,.01:100.42,.005:104.22},80:{.995:51.17,.99:53.54,.975:57.15,.95:60.39,.9:64.28,.5:79.33,.1:96.58,.05:101.88,.025:106.63,.01:112.33,.005:116.32},90:{.995:59.2,.99:61.75,.975:65.65,.95:69.13,.9:73.29,.5:89.33,.1:107.57,.05:113.14,.025:118.14,.01:124.12,.005:128.3},100:{.995:67.33,.99:70.06,.975:74.22,.95:77.93,.9:82.36,.5:99.33,.1:118.5,.05:124.34,.025:129.56,.01:135.81,.005:140.17}};var Es=Math.sqrt(2*Math.PI),Ss={gaussian:function(t){return Math.exp(-.5*t*t)/Es}},_s={nrd:function(t){var r=hs(t),e=ts(t);return"number"==typeof e&&(r=Math.min(r,e/1.34)),1.06*r*Math.pow(t.length,-.2)}};function As(t,r,e){var n,o;if(void 0===r)n=Ss.gaussian;else if("string"==typeof r){if(!Ss[r])throw new Error('Unknown kernel "'+r+'"');n=Ss[r]}else n=r;if(void 0===e)o=_s.nrd(t);else if("string"==typeof e){if(!_s[e])throw new Error('Unknown bandwidth method "'+e+'"');o=_s[e](t)}else o=e;return function(r){var e=0,i=0;for(e=0;e<t.length;e++)i+=n((r-t[e])/o);return i/o/t.length}}var qs=Math.sqrt(2*Math.PI);function Ps(t){for(var r=t,e=t,n=1;n<15;n++)r+=e*=t*t/(2*n+1);return Math.round(1e4*(.5+r/qs*Math.exp(-t*t/2)))/1e4}for(var ks=[],Rs=0;Rs<=3.09;Rs+=.01)ks.push(Ps(Rs));function Ns(t){var r=1/(1+.5*Math.abs(t)),e=r*Math.exp(-t*t+((((((((.17087277*r-.82215223)*r+1.48851587)*r-1.13520398)*r+.27886807)*r-.18628806)*r+.09678418)*r+.37409196)*r+1.00002368)*r-1.26551223);return t>=0?1-e:e-1}function Is(t){var r=8*(Math.PI-3)/(3*Math.PI*(4-Math.PI)),e=Math.sqrt(Math.sqrt(Math.pow(2/(Math.PI*r)+Math.log(1-t*t)/2,2)-Math.log(1-t*t)/r)-(2/(Math.PI*r)+Math.log(1-t*t)/2));return t>=0?e:-e}function Os(t){if("number"==typeof t)return t<0?-1:0===t?0:1;throw new TypeError("not a number")}function Ts(t,r){for(var e=0,n=0;n<t.length;n++){var o=t[n]-r[n];e+=o*o}return Math.sqrt(e)}function Cs(t,r){return t.map((function(t){for(var e=Number.MAX_VALUE,n=-1,o=0;o<r.length;o++){var i=Ts(t,r[o]);i<e&&(e=i,n=o)}return n}))}function Fs(t,r,e){for(var n=t[0].length,o=ss(e,n),i=Array(e).fill(0),s=t.length,a=0;a<s;a++){for(var u=t[a],l=r[a],f=o[l],c=0;c<n;c++)f[c]+=u[c];i[l]+=1}for(var h=0;h<e;h++){if(0===i[h])throw new Error("Centroid "+h+" has no friends");for(var m=o[h],g=0;g<n;g++)m[g]/=i[h]}return o}function zs(t,r){for(var e=0,n=0;n<t.length;n++)e+=Ts(t[n],r[n]);return e}function $s(t,r){if(t.length!==r.length)throw new Error("must have exactly as many labels as points");for(var e=function(t){for(var r=1+Bi(t),e=Array(r),n=0;n<t.length;n++){var o=t[n];void 0===e[o]&&(e[o]=[]),e[o].push(n)}return e}(r),n=function(t){for(var r=t.length,e=ss(r,r),n=0;n<r;n++)for(var o=0;o<n;o++)e[n][o]=Ts(t[n],t[o]),e[o][n]=e[n][o];return e}(t),o=[],i=0;i<t.length;i++){var s=0;if(e[r[i]].length>1){var a=Ds(i,e[r[i]],n),u=Vs(i,r,e,n);s=(u-a)/Math.max(a,u)}o.push(s)}return o}function Vs(t,r,e,n){for(var o=r[t],i=Number.MAX_VALUE,s=0;s<e.length;s++)if(s!==o){var a=Ds(t,e[s],n);a<i&&(i=a)}return i}function Ds(t,r,e){for(var n=0,o=0;o<r.length;o++)n+=e[t][r[o]];return n/r.length}function Ls(t,r){return 0===t&&0===r?0:Math.abs((t-r)/r)}var Us=Object.freeze({__proto__:null,BayesianClassifier:ws,PerceptronModel:vs,addToMean:function(t,r,e){return t+(e-t)/(r+1)},approxEqual:function(t,r,e){return void 0===e&&(e=ys),Ls(t,r)<=e},average:Fi,averageSimple:ps,bayesian:ws,bernoulliDistribution:function(t){if(t<0||t>1)throw new Error("bernoulliDistribution requires probability to be between 0 and 1 inclusive");return[1-t,t]},binomialDistribution:function(t,r){if(!(r<0||r>1||t<=0||t%1!=0)){var e=0,n=0,o=[],i=1;do{o[e]=i*Math.pow(r,e)*Math.pow(1-r,t-e),n+=o[e],i=i*(t-++e+1)/e}while(n<1-ys);return o}},bisect:function(t,r,e,n,o){if("function"!=typeof t)throw new TypeError("func must be a function");for(var i=0;i<n;i++){var s=(r+e)/2;if(0===t(s)||Math.abs((e-r)/2)<o)return s;Os(t(s))===Os(t(r))?r=s:e=s}throw new Error("maximum number of iterations exceeded")},chiSquaredDistributionTable:js,chiSquaredGoodnessOfFit:function(t,r,e){for(var n=0,o=r(Fi(t)),i=[],s=[],a=0;a<t.length;a++)void 0===i[t[a]]&&(i[t[a]]=0),i[t[a]]++;for(var u=0;u<i.length;u++)void 0===i[u]&&(i[u]=0);for(var l in o)l in i&&(s[+l]=o[l]*t.length);for(var f=s.length-1;f>=0;f--)s[f]<3&&(s[f-1]+=s[f],s.pop(),i[f-1]+=i[f],i.pop());for(var c=0;c<i.length;c++)n+=Math.pow(i[c]-s[c],2)/s[c];var h=i.length-1-1;return js[h][e]<n},chunk:function(t,r){var e=[];if(r<1)throw new Error("chunk size must be a positive number");if(Math.floor(r)!==r)throw new Error("chunk size must be an integer");for(var n=0;n<t.length;n+=r)e.push(t.slice(n,n+r));return e},ckmeans:function(t,r){if(r>t.length)throw new Error("cannot generate more classes than there are data values");var e=Li(t);if(1===as(e))return[e];var n=ss(r,e.length),o=ss(r,e.length);!function(t,r,e){for(var n=r[0].length,o=t[Math.floor(n/2)],i=[],s=[],a=0,u=void 0;a<n;++a)u=t[a]-o,0===a?(i.push(u),s.push(u*u)):(i.push(i[a-1]+u),s.push(s[a-1]+u*u)),r[0][a]=us(0,a,i,s),e[0][a]=0;for(var l=1;l<r.length;++l)ls(l<r.length-1?l:n-1,n-1,l,r,e,i,s)}(e,n,o);for(var i=[],s=o[0].length-1,a=o.length-1;a>=0;a--){var u=o[a][s];i[a]=e.slice(u,s+1),a>0&&(s=u-1)}return i},coefficientOfVariation:function(t){return hs(t)/Fi(t)},combinations:function t(r,e){var n,o,i,s,a=[];for(n=0;n<r.length;n++)if(1===e)a.push([r[n]]);else for(i=t(r.slice(n+1,r.length),e-1),o=0;o<i.length;o++)(s=i[o]).unshift(r[n]),a.push(s);return a},combinationsReplacement:function t(r,e){for(var n=[],o=0;o<r.length;o++)if(1===e)n.push([r[o]]);else for(var i=t(r.slice(o,r.length),e-1),s=0;s<i.length;s++)n.push([r[o]].concat(i[s]));return n},combineMeans:gs,combineVariances:function(t,r,e,n,o,i){var s=gs(r,e,o,i);return(e*(t+Math.pow(r-s,2))+i*(n+Math.pow(o-s,2)))/(e+i)},cumulativeStdLogisticProbability:function(t){return 1/(Math.exp(-t)+1)},cumulativeStdNormalProbability:function(t){var r=Math.abs(t),e=Math.min(Math.round(100*r),ks.length-1);return t>=0?ks[e]:+(1-ks[e]).toFixed(4)},epsilon:ys,equalIntervalBreaks:function(t,r){if(t.length<2)return t;for(var e=Ui(t),n=Bi(t),o=[e],i=(n-e)/r,s=1;s<r;s++)o.push(o[0]+i*s);return o.push(n),o},erf:Ns,errorFunction:Ns,extent:function(t){if(0===t.length)throw new Error("extent requires at least one data point");for(var r=t[0],e=t[0],n=1;n<t.length;n++)t[n]>e&&(e=t[n]),t[n]<r&&(r=t[n]);return[r,e]},extentSorted:function(t){return[t[0],t[t.length-1]]},factorial:bs,gamma:function t(r){if(Number.isInteger(r))return r<=0?NaN:bs(r-1);if(--r<0)return Math.PI/(Math.sin(Math.PI*-r)*t(-r));var e=r+1/4;return Math.pow(r/Math.E,r)*Math.sqrt(2*Math.PI*(r+1/6))*(1+1/144/Math.pow(e,2)-1/12960/Math.pow(e,3)-257/207360/Math.pow(e,4)-52/2612736/Math.pow(e,5)+5741173/9405849600/Math.pow(e,6)+37529/18811699200/Math.pow(e,7))},gammaln:function(t){if(t<=0)return 1/0;t--;for(var r=Ms[0],e=1;e<15;e++)r+=Ms[e]/(t+e);var n=5.2421875+t;return xs+Math.log(r)-n+(t+.5)*Math.log(n)},geometricMean:function(t){if(0===t.length)throw new Error("geometricMean requires at least one data point");for(var r=1,e=0;e<t.length;e++){if(t[e]<0)throw new Error("geometricMean requires only non-negative numbers as input");r*=t[e]}return Math.pow(r,1/t.length)},harmonicMean:function(t){if(0===t.length)throw new Error("harmonicMean requires at least one data point");for(var r=0,e=0;e<t.length;e++){if(t[e]<=0)throw new Error("harmonicMean requires only positive numbers as input");r+=1/t[e]}return t.length/r},interquartileRange:ts,inverseErrorFunction:Is,iqr:ts,jenks:function(t,r){if(r>t.length)return null;var e=function(t,r){var e,n,o=[],i=[],s=0;for(e=0;e<t.length+1;e++){var a=[],u=[];for(n=0;n<r+1;n++)a.push(0),u.push(0);o.push(a),i.push(u)}for(e=1;e<r+1;e++)for(o[1][e]=1,i[1][e]=0,n=2;n<t.length+1;n++)i[n][e]=1/0;for(var l=2;l<t.length+1;l++){for(var f=0,c=0,h=0,m=0,g=1;g<l+1;g++){var p=l-g+1,d=t[p-1];if(s=(c+=d*d)-(f+=d)*f/++h,0!=(m=p-1))for(n=2;n<r+1;n++)i[l][n]>=s+i[m][n-1]&&(o[l][n]=p,i[l][n]=s+i[m][n-1])}o[l][1]=1,i[l][1]=s}return{lowerClassLimits:o,varianceCombinations:i}}(t=t.slice().sort((function(t,r){return t-r})),r);return function(t,r,e){var n=t.length,o=[],i=e;for(o[e]=t[t.length-1];i>0;)o[i-1]=t[r[n][i]-1],n=r[n][i]-1,i--;return o}(t,e.lowerClassLimits,r)},kMeansCluster:function(t,r,e){void 0===e&&(e=Math.random);for(var n=null,o=is(t,r,e),i=null,s=Number.MAX_VALUE;0!==s;)n=o,s=zs(o=Fs(t,i=Cs(t,o),r),n);return{labels:i,centroids:o}},kde:As,kernelDensityEstimation:As,linearRegression:function(t){var r,e,n=t.length;if(1===n)r=0,e=t[0][1];else{for(var o,i,s,a=0,u=0,l=0,f=0,c=0;c<n;c++)a+=i=(o=t[c])[0],u+=s=o[1],l+=i*i,f+=i*s;e=u/n-(r=(n*f-a*u)/(n*l-a*a))*a/n}return{m:r,b:e}},linearRegressionLine:function(t){return function(r){return t.b+t.m*r}},logAverage:function(t){if(0===t.length)throw new Error("logAverage requires at least one data point");for(var r=0,e=0;e<t.length;e++){if(t[e]<0)throw new Error("logAverage requires only non-negative numbers as input");r+=Math.log(t[e])}return Math.exp(r/t.length)},logit:function(t){if(t<=0||t>=1)throw new Error("p must be strictly between zero and one");return Math.log(t/(1-t))},mad:es,max:Bi,maxSorted:function(t){return t[t.length-1]},mean:Fi,meanSimple:ps,median:rs,medianAbsoluteDeviation:es,medianSorted:function(t){return Gi(t,.5)},min:Ui,minSorted:function(t){return t[0]},mode:function(t){return Di(Li(t))},modeFast:function(t){for(var r,e=new Map,n=0,o=0;o<t.length;o++){var i=e.get(t[o]);void 0===i?i=1:i++,i>n&&(r=t[o],n=i),e.set(t[o],i)}if(0===n)throw new Error("mode requires at last one data point");return r},modeSorted:Di,numericSort:Li,perceptron:vs,permutationTest:function(t,r,e,n,o){if(void 0===n&&(n=1e4),void 0===e&&(e="two_side"),"two_side"!==e&&"greater"!==e&&"less"!==e)throw new Error("`alternative` must be either 'two_side', 'greater', or 'less'.");for(var i=Fi(t)-Fi(r),s=new Array(n),a=t.concat(r),u=Math.floor(a.length/2),l=0;l<n;l++){ns(a,o);var f=a.slice(0,u),c=a.slice(u,a.length),h=Fi(f)-Fi(c);s[l]=h}var m=0;if("two_side"===e)for(var g=0;g<=n;g++)Math.abs(s[g])>=Math.abs(i)&&(m+=1);else if("greater"===e)for(var p=0;p<=n;p++)s[p]>=i&&(m+=1);else for(var d=0;d<=n;d++)s[d]<=i&&(m+=1);return m/n},permutationsHeap:function(t){for(var r=new Array(t.length),e=[t.slice()],n=0;n<t.length;n++)r[n]=0;for(var o=0;o<t.length;)if(r[o]<o){var i=0;o%2!=0&&(i=r[o]);var s=t[i];t[i]=t[o],t[o]=s,e.push(t.slice()),r[o]++,o=0}else r[o]=0,o++;return e},poissonDistribution:function(t){if(!(t<=0)){var r=0,e=0,n=[],o=1;do{n[r]=Math.exp(-t)*Math.pow(t,r)/o,e+=n[r],o*=++r}while(e<1-ys);return n}},probit:function(t){return 0===t?t=ys:t>=1&&(t=1-ys),Math.sqrt(2)*Is(2*t-1)},product:function(t){for(var r=1,e=0;e<t.length;e++)r*=t[e];return r},quantile:Qi,quantileRank:function(t,r){return Zi(Li(t),r)},quantileRankSorted:Zi,quantileSorted:Gi,quickselect:Xi,rSquared:function(t,r){if(t.length<2)return 1;for(var e=0,n=0;n<t.length;n++)e+=t[n][1];for(var o=e/t.length,i=0,s=0;s<t.length;s++)i+=Math.pow(o-t[s][1],2);for(var a=0,u=0;u<t.length;u++)a+=Math.pow(t[u][1]-r(t[u][0]),2);return 1-a/i},relativeError:Ls,rms:ds,rootMeanSquare:ds,sample:is,sampleCorrelation:ms,sampleCovariance:fs,sampleKurtosis:function(t){var r=t.length;if(r<4)throw new Error("sampleKurtosis requires at least four data points");for(var e,n=Fi(t),o=0,i=0,s=0;s<r;s++)o+=(e=t[s]-n)*e,i+=e*e*e*e;return(r-1)/((r-2)*(r-3))*(r*(r+1)*i/(o*o)-3*(r-1))},sampleRankCorrelation:function(t,r){for(var e=t.map((function(t,r){return[t,r]})).sort((function(t,r){return t[0]-r[0]})).map((function(t){return t[1]})),n=r.map((function(t,r){return[t,r]})).sort((function(t,r){return t[0]-r[0]})).map((function(t){return t[1]})),o=Array(e.length),i=Array(e.length),s=0;s<e.length;s++)o[e[s]]=s,i[n[s]]=s;return ms(o,i)},sampleSkewness:function(t){if(t.length<3)throw new Error("sampleSkewness requires at least three data points");for(var r,e=Fi(t),n=0,o=0,i=0;i<t.length;i++)n+=(r=t[i]-e)*r,o+=r*r*r;var s=t.length-1,a=Math.sqrt(n/s),u=t.length;return u*o/((u-1)*(u-2)*Math.pow(a,3))},sampleStandardDeviation:hs,sampleVariance:cs,sampleWithReplacement:function(t,r,e){if(0===t.length)return[];e=e||Math.random;for(var n=t.length,o=[],i=0;i<r;i++){var s=Math.floor(e()*n);o.push(t[s])}return o},shuffle:os,shuffleInPlace:ns,sign:Os,silhouette:$s,silhouetteMetric:function(t,r){return Bi($s(t,r))},standardDeviation:Vi,standardNormalTable:ks,subtractFromMean:function(t,r,e){return(t*r-e)/(r-1)},sum:Ci,sumNthPowerDeviations:zi,sumSimple:Wi,tTest:function(t,r){return(Fi(t)-r)/(Vi(t)/Math.sqrt(t.length))},tTestTwoSample:function(t,r,e){var n=t.length,o=r.length;if(!n||!o)return null;e||(e=0);var i=Fi(t),s=Fi(r),a=cs(t),u=cs(r);if("number"==typeof i&&"number"==typeof s&&"number"==typeof a&&"number"==typeof u){var l=((n-1)*a+(o-1)*u)/(n+o-2);return(i-s-e)/Math.sqrt(l*(1/n+1/o))}},uniqueCountSorted:as,variance:$i,wilcoxonRankSum:function(t,r){if(!t.length||!r.length)throw new Error("Neither sample can be empty");for(var e=t.map((function(t){return{label:"x",value:t}})).concat(r.map((function(t){return{label:"y",value:t}}))).sort((function(t,r){return t.value-r.value})),n=0;n<e.length;n++)e[n].rank=n;for(var o=[e[0].rank],i=1;i<e.length;i++)e[i].value===e[i-1].value?(o.push(e[i].rank),i===e.length-1&&s(e,o)):o.length>1?s(e,o):o=[e[i].rank];function s(t,r){for(var e=(r[0]+r[r.length-1])/2,n=0;n<r.length;n++)t[r[n]].rank=e}for(var a=0,u=0;u<e.length;u++){var l=e[u];"x"===l.label&&(a+=l.rank+1)}return a},zScore:function(t,r,e){return(t-r)/e}});let Bs=Pe(Ws=Us,"default.default")?Ws.default.default:Pe(Ws,"default")?Ws.default:Ws;var Ws;var Gs="[object Boolean]";function Xs(t){return!0===(r=t)||!1===r||st(r)&&y(r)==Gs;var r}function Ys(t){if(Zn(t)){for(let r in t)return!0;return!1}return!1}function Qs(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=Pe(r,"interpX");io(e)||(e=null);let n=Pe(r,"useRegIntercept");Xs(n)||(n=!0);let o=Pe(r,"useSync");Xs(o)||(o=!1);let i=()=>{if(!no(t))throw new Error("arr is not an effective array");let r=[];if(Uo(t,(t=>{let e=Pe(t,0),n=Pe(t,1);io(e)&&io(n)&&r.push([yo(e),yo(n)])})),0===_t(r))throw new Error("no effective data");let o=null;if(n)o=Bs.linearRegression(r);else{let t=0,e=0;Uo(r,(r=>{t+=r[0]**2,e+=r[0]*r[1]}));let n=null;0!==t&&(n=e/t),o={m:n,b:0}}if(io(e)){e=yo(e);let t=Bs.linearRegressionLine(o)(e);o.interpY=t}return o};return o?i():(async()=>{let t=null;try{return t=i(),Ys(t)?t:Promise.reject("no effective data")}catch(t){return console.log(t),Promise.reject(t.message)}})()}function Hs(t,r,e){if(!r.has(t))throw new TypeError("attempted to "+e+" private field on non-instance");return r.get(t)}function Js(t,r,e){return function(t,r,e){if(r.set)r.set.call(t,e);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=e}}(t,Hs(t,r,"set"),e),e}function Ks(t,r){return function(t,r){return r.get?r.get.call(t):r.value}(t,Hs(t,r,"get"))}var Zs={};const ta=Object.prototype.toString;function ra(t){const r=ta.call(t);return r.endsWith("Array]")&&!r.includes("Big")}var ea=Ao(Object.freeze({__proto__:null,isAnyArray:ra}));var na=Object.freeze({__proto__:null,default:function(t){var r,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!ra(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==e.output){if(!ra(e.output))throw new TypeError("output option must be an array if specified");r=e.output}else r=new Array(t.length);var n=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!ra(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var e=r.fromIndex,n=void 0===e?0:e,o=r.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=t[n],a=n+1;a<i;a++)t[a]<s&&(s=t[a]);return s}(t),o=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!ra(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var e=r.fromIndex,n=void 0===e?0:e,o=r.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=t[n],a=n+1;a<i;a++)t[a]>s&&(s=t[a]);return s}(t);if(n===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var i=e.min,s=void 0===i?e.autoMinMax?n:0:i,a=e.max,u=void 0===a?e.autoMinMax?o:1:a;if(s>=u)throw new RangeError("min option must be smaller than max option");for(var l=(u-s)/(o-n),f=0;f<t.length;f++)r[f]=(t[f]-n)*l+s;return r}}),oa=Ao(na);function ia(t,r){if(r.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sa(t,r,e){if(!r.has(t))throw new TypeError("attempted to get private field on non-instance");return e}Object.defineProperty(Zs,"__esModule",{value:!0});var aa=ea,ua=oa;const la=" ".repeat(2),fa=" ".repeat(4);function ca(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{maxRows:e=15,maxColumns:n=10,maxNumSize:o=8,padMinus:i="auto"}=r;return`${t.constructor.name} {\n${la}[\n${fa}${function(t,r,e,n,o){const{rows:i,columns:s}=t,a=Math.min(i,r),u=Math.min(s,e),l=[];if("auto"===o){o=!1;t:for(let r=0;r<a;r++)for(let e=0;e<u;e++)if(t.get(r,e)<0){o=!0;break t}}for(let r=0;r<a;r++){let e=[];for(let i=0;i<u;i++)e.push(ha(t.get(r,i),n,o));l.push(`${e.join(" ")}`)}u!==s&&(l[l.length-1]+=` ... ${s-e} more columns`);a!==i&&l.push(`... ${i-r} more rows`);return l.join(`\n${fa}`)}(t,e,n,o,i)}\n${la}]\n${la}rows: ${t.rows}\n${la}columns: ${t.columns}\n}`}function ha(t,r,e){return(t>=0&&e?` ${ma(t,r-1)}`:ma(t,r)).padEnd(r)}function ma(t,r){let e=t.toString();if(e.length<=r)return e;let n=t.toFixed(r);if(n.length>r&&(n=t.toFixed(Math.max(0,r-(n.length-r)))),n.length<=r&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let o=t.toExponential(r);return o.length>r&&(o=t.toExponential(Math.max(0,r-(o.length-r)))),o.slice(0)}function ga(t,r,e){let n=e?t.rows:t.rows-1;if(r<0||r>n)throw new RangeError("Row index out of range")}function pa(t,r,e){let n=e?t.columns:t.columns-1;if(r<0||r>n)throw new RangeError("Column index out of range")}function da(t,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return r}function wa(t,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return r}function va(t,r){if(!aa.isAnyArray(r))throw new TypeError("row indices must be an array");for(let e=0;e<r.length;e++)if(r[e]<0||r[e]>=t.rows)throw new RangeError("row indices are out of range")}function ya(t,r){if(!aa.isAnyArray(r))throw new TypeError("column indices must be an array");for(let e=0;e<r.length;e++)if(r[e]<0||r[e]>=t.columns)throw new RangeError("column indices are out of range")}function ba(t,r,e,n,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(xa("startRow",r),xa("endRow",e),xa("startColumn",n),xa("endColumn",o),r>e||n>o||r<0||r>=t.rows||e<0||e>=t.rows||n<0||n>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function Ma(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=[];for(let n=0;n<t;n++)e.push(r);return e}function xa(t,r){if("number"!=typeof r)throw new TypeError(`${t} must be a number`)}function ja(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class Ea{static from1DArray(t,r,e){if(t*r!==e.length)throw new RangeError("data length does not match given dimensions");let n=new Aa(t,r);for(let o=0;o<t;o++)for(let t=0;t<r;t++)n.set(o,t,e[o*r+t]);return n}static rowVector(t){let r=new Aa(1,t.length);for(let e=0;e<t.length;e++)r.set(0,e,t[e]);return r}static columnVector(t){let r=new Aa(t.length,1);for(let e=0;e<t.length;e++)r.set(e,0,t[e]);return r}static zeros(t,r){return new Aa(t,r)}static ones(t,r){return new Aa(t,r).fill(1)}static rand(t,r){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("object"!=typeof e)throw new TypeError("options must be an object");const{random:n=Math.random}=e;let o=new Aa(t,r);for(let e=0;e<t;e++)for(let t=0;t<r;t++)o.set(e,t,n());return o}static randInt(t,r){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("object"!=typeof e)throw new TypeError("options must be an object");const{min:n=0,max:o=1e3,random:i=Math.random}=e;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(n>=o)throw new RangeError("min must be smaller than max");let s=o-n,a=new Aa(t,r);for(let e=0;e<t;e++)for(let t=0;t<r;t++){let r=n+Math.round(i()*s);a.set(e,t,r)}return a}static eye(t,r,e){void 0===r&&(r=t),void 0===e&&(e=1);let n=Math.min(t,r),o=this.zeros(t,r);for(let t=0;t<n;t++)o.set(t,t,e);return o}static diag(t,r,e){let n=t.length;void 0===r&&(r=n),void 0===e&&(e=r);let o=Math.min(n,r,e),i=this.zeros(r,e);for(let r=0;r<o;r++)i.set(r,r,t[r]);return i}static min(t,r){t=this.checkMatrix(t),r=this.checkMatrix(r);let e=t.rows,n=t.columns,o=new Aa(e,n);for(let i=0;i<e;i++)for(let e=0;e<n;e++)o.set(i,e,Math.min(t.get(i,e),r.get(i,e)));return o}static max(t,r){t=this.checkMatrix(t),r=this.checkMatrix(r);let e=t.rows,n=t.columns,o=new this(e,n);for(let i=0;i<e;i++)for(let e=0;e<n;e++)o.set(i,e,Math.max(t.get(i,e),r.get(i,e)));return o}static checkMatrix(t){return Ea.isMatrix(t)?t:new Aa(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)t.call(this,r,e);return this}to1DArray(){let t=[];for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)t.push(this.get(r,e));return t}to2DArray(){let t=[];for(let r=0;r<this.rows;r++){t.push([]);for(let e=0;e<this.columns;e++)t[r].push(this.get(r,e))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let r=0;r<=t;r++)if(this.get(t,r)!==this.get(r,t))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let t=0;t<this.rows;t++)if(0!==this.get(t,t))return!1;return!0}isEchelonForm(){let t=0,r=0,e=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(r=0,o=!1;r<this.columns&&!1===o;)0===this.get(t,r)?r++:1===this.get(t,r)&&r>e?(o=!0,e=r):(n=!1,o=!0);t++}return n}isReducedEchelonForm(){let t=0,r=0,e=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(r=0,o=!1;r<this.columns&&!1===o;)0===this.get(t,r)?r++:1===this.get(t,r)&&r>e?(o=!0,e=r):(n=!1,o=!0);for(let e=r+1;e<this.rows;e++)0!==this.get(t,e)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),r=0,e=0;for(;r<t.rows&&e<t.columns;){let n=r;for(let o=r;o<t.rows;o++)t.get(o,e)>t.get(n,e)&&(n=o);if(0===t.get(n,e))e++;else{t.swapRows(r,n);let o=t.get(r,e);for(let n=e;n<t.columns;n++)t.set(r,n,t.get(r,n)/o);for(let n=r+1;n<t.rows;n++){let o=t.get(n,e)/t.get(r,e);t.set(n,e,0);for(let i=e+1;i<t.columns;i++)t.set(n,i,t.get(n,i)-t.get(r,i)*o)}r++,e++}}return t}reducedEchelonForm(){let t=this.echelonForm(),r=t.columns,e=t.rows,n=e-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let o=0,i=!1;for(;o<e&&!1===i;)1===t.get(n,o)?i=!0:o++;for(let e=0;e<n;e++){let i=t.get(e,o);for(let s=o;s<r;s++){let r=t.get(e,s)-i*t.get(n,s);t.set(e,s,r)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:r=1,columns:e=1}=t;if(!Number.isInteger(r)||r<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(e)||e<=0)throw new TypeError("columns must be a positive integer");let n=new Aa(this.rows*r,this.columns*e);for(let t=0;t<r;t++)for(let r=0;r<e;r++)n.setSubMatrix(this,this.rows*t,this.columns*r);return n}fill(t){for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,t);return this}neg(){return this.mulS(-1)}getRow(t){ga(this,t);let r=[];for(let e=0;e<this.columns;e++)r.push(this.get(t,e));return r}getRowVector(t){return Aa.rowVector(this.getRow(t))}setRow(t,r){ga(this,t),r=da(this,r);for(let e=0;e<this.columns;e++)this.set(t,e,r[e]);return this}swapRows(t,r){ga(this,t),ga(this,r);for(let e=0;e<this.columns;e++){let n=this.get(t,e);this.set(t,e,this.get(r,e)),this.set(r,e,n)}return this}getColumn(t){pa(this,t);let r=[];for(let e=0;e<this.rows;e++)r.push(this.get(e,t));return r}getColumnVector(t){return Aa.columnVector(this.getColumn(t))}setColumn(t,r){pa(this,t),r=wa(this,r);for(let e=0;e<this.rows;e++)this.set(e,t,r[e]);return this}swapColumns(t,r){pa(this,t),pa(this,r);for(let e=0;e<this.rows;e++){let n=this.get(e,t);this.set(e,t,this.get(e,r)),this.set(e,r,n)}return this}addRowVector(t){t=da(this,t);for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)+t[e]);return this}subRowVector(t){t=da(this,t);for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)-t[e]);return this}mulRowVector(t){t=da(this,t);for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t[e]);return this}divRowVector(t){t=da(this,t);for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)/t[e]);return this}addColumnVector(t){t=wa(this,t);for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)+t[r]);return this}subColumnVector(t){t=wa(this,t);for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)-t[r]);return this}mulColumnVector(t){t=wa(this,t);for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t[r]);return this}divColumnVector(t){t=wa(this,t);for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)/t[r]);return this}mulRow(t,r){ga(this,t);for(let e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)*r);return this}mulColumn(t,r){pa(this,t);for(let e=0;e<this.rows;e++)this.set(e,t,this.get(e,t)*r);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.get(r,e)>t[r]&&(t[r]=this.get(r,e));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.get(r,e)>t[e]&&(t[e]=this.get(r,e));return t}case void 0:{let t=this.get(0,0);for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.get(r,e)>t&&(t=this.get(r,e));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){ja(this);let t=this.get(0,0),r=[0,0];for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n),r[0]=e,r[1]=n);return r}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.get(r,e)<t[r]&&(t[r]=this.get(r,e));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.get(r,e)<t[e]&&(t[e]=this.get(r,e));return t}case void 0:{let t=this.get(0,0);for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.get(r,e)<t&&(t=this.get(r,e));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){ja(this);let t=this.get(0,0),r=[0,0];for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n),r[0]=e,r[1]=n);return r}maxRow(t){if(ga(this,t),this.isEmpty())return NaN;let r=this.get(t,0);for(let e=1;e<this.columns;e++)this.get(t,e)>r&&(r=this.get(t,e));return r}maxRowIndex(t){ga(this,t),ja(this);let r=this.get(t,0),e=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>r&&(r=this.get(t,n),e[1]=n);return e}minRow(t){if(ga(this,t),this.isEmpty())return NaN;let r=this.get(t,0);for(let e=1;e<this.columns;e++)this.get(t,e)<r&&(r=this.get(t,e));return r}minRowIndex(t){ga(this,t),ja(this);let r=this.get(t,0),e=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<r&&(r=this.get(t,n),e[1]=n);return e}maxColumn(t){if(pa(this,t),this.isEmpty())return NaN;let r=this.get(0,t);for(let e=1;e<this.rows;e++)this.get(e,t)>r&&(r=this.get(e,t));return r}maxColumnIndex(t){pa(this,t),ja(this);let r=this.get(0,t),e=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>r&&(r=this.get(n,t),e[0]=n);return e}minColumn(t){if(pa(this,t),this.isEmpty())return NaN;let r=this.get(0,t);for(let e=1;e<this.rows;e++)this.get(e,t)<r&&(r=this.get(e,t));return r}minColumnIndex(t){pa(this,t),ja(this);let r=this.get(0,t),e=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<r&&(r=this.get(n,t),e[0]=n);return e}diag(){let t=Math.min(this.rows,this.columns),r=[];for(let e=0;e<t;e++)r.push(this.get(e,e));return r}norm(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"frobenius";switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${t}`)}}cumulativeSum(){let t=0;for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)t+=this.get(r,e),this.set(r,e,t);return this}dot(t){Ea.isMatrix(t)&&(t=t.to1DArray());let r=this.to1DArray();if(r.length!==t.length)throw new RangeError("vectors do not have the same size");let e=0;for(let n=0;n<r.length;n++)e+=r[n]*t[n];return e}mmul(t){t=Aa.checkMatrix(t);let r=this.rows,e=this.columns,n=t.columns,o=new Aa(r,n),i=new Float64Array(e);for(let s=0;s<n;s++){for(let r=0;r<e;r++)i[r]=t.get(r,s);for(let t=0;t<r;t++){let r=0;for(let n=0;n<e;n++)r+=this.get(t,n)*i[n];o.set(t,s,r)}}return o}strassen2x2(t){t=Aa.checkMatrix(t);let r=new Aa(2,2);const e=this.get(0,0),n=t.get(0,0),o=this.get(0,1),i=t.get(0,1),s=this.get(1,0),a=t.get(1,0),u=this.get(1,1),l=t.get(1,1),f=(e+u)*(n+l),c=(s+u)*n,h=e*(i-l),m=u*(a-n),g=(e+o)*l,p=f+m-g+(o-u)*(a+l),d=h+g,w=c+m,v=f-c+h+(s-e)*(n+i);return r.set(0,0,p),r.set(0,1,d),r.set(1,0,w),r.set(1,1,v),r}strassen3x3(t){t=Aa.checkMatrix(t);let r=new Aa(3,3);const e=this.get(0,0),n=this.get(0,1),o=this.get(0,2),i=this.get(1,0),s=this.get(1,1),a=this.get(1,2),u=this.get(2,0),l=this.get(2,1),f=this.get(2,2),c=t.get(0,0),h=t.get(0,1),m=t.get(0,2),g=t.get(1,0),p=t.get(1,1),d=t.get(1,2),w=t.get(2,0),v=t.get(2,1),y=t.get(2,2),b=(e-i)*(-h+p),M=(-e+i+s)*(c-h+p),x=(i+s)*(-c+h),j=e*c,E=(-e+u+l)*(c-m+d),S=(-e+u)*(m-d),_=(u+l)*(-c+m),A=(-o+l+f)*(p+w-v),q=(o-f)*(p-v),P=o*w,k=(l+f)*(-w+v),R=(-o+s+a)*(d+w-y),N=(o-a)*(d-y),I=(s+a)*(-w+y),O=j+P+n*g,T=(e+n+o-i-s-l-f)*p+M+x+j+A+P+k,C=j+E+_+(e+n+o-s-a-u-l)*d+P+R+I,F=b+s*(-c+h+g-p-d-w+y)+M+j+P+R+N,z=b+M+x+j+a*v,$=P+R+N+I+i*m,V=j+E+S+l*(-c+m+g-p-d-w+v)+A+q+P,D=A+q+P+k+u*h,L=j+E+S+_+f*y;return r.set(0,0,O),r.set(0,1,T),r.set(0,2,C),r.set(1,0,F),r.set(1,1,z),r.set(1,2,$),r.set(2,0,V),r.set(2,1,D),r.set(2,2,L),r}mmulStrassen(t){t=Aa.checkMatrix(t);let r=this.clone(),e=r.rows,n=r.columns,o=t.rows,i=t.columns;function s(t,r,e){let n=t.rows,o=t.columns;if(n===r&&o===e)return t;{let n=Ea.zeros(r,e);return n=n.setSubMatrix(t,0,0),n}}n!==o&&console.warn(`Multiplying ${e} x ${n} and ${o} x ${i} matrix: dimensions do not match.`);let a=Math.max(e,o),u=Math.max(n,i);return r=s(r,a,u),function t(r,e,n,o){if(n<=512||o<=512)return r.mmul(e);n%2==1&&o%2==1?(r=s(r,n+1,o+1),e=s(e,n+1,o+1)):n%2==1?(r=s(r,n+1,o),e=s(e,n+1,o)):o%2==1&&(r=s(r,n,o+1),e=s(e,n,o+1));let i=parseInt(r.rows/2,10),a=parseInt(r.columns/2,10),u=r.subMatrix(0,i-1,0,a-1),l=e.subMatrix(0,i-1,0,a-1),f=r.subMatrix(0,i-1,a,r.columns-1),c=e.subMatrix(0,i-1,a,e.columns-1),h=r.subMatrix(i,r.rows-1,0,a-1),m=e.subMatrix(i,e.rows-1,0,a-1),g=r.subMatrix(i,r.rows-1,a,r.columns-1),p=e.subMatrix(i,e.rows-1,a,e.columns-1),d=t(Ea.add(u,g),Ea.add(l,p),i,a),w=t(Ea.add(h,g),l,i,a),v=t(u,Ea.sub(c,p),i,a),y=t(g,Ea.sub(m,l),i,a),b=t(Ea.add(u,f),p,i,a),M=t(Ea.sub(h,u),Ea.add(l,c),i,a),x=t(Ea.sub(f,g),Ea.add(m,p),i,a),j=Ea.add(d,y);j.sub(b),j.add(x);let E=Ea.add(v,b),S=Ea.add(w,y),_=Ea.sub(d,w);_.add(v),_.add(M);let A=Ea.zeros(2*j.rows,2*j.columns);return A=A.setSubMatrix(j,0,0),A=A.setSubMatrix(E,j.rows,0),A=A.setSubMatrix(S,0,j.columns),A=A.setSubMatrix(_,j.rows,j.columns),A.subMatrix(0,n-1,0,o-1)}(r,t=s(t,a,u),a,u)}scaleRows(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"!=typeof t)throw new TypeError("options must be an object");const{min:r=0,max:e=1}=t;if(!Number.isFinite(r))throw new TypeError("min must be a number");if(!Number.isFinite(e))throw new TypeError("max must be a number");if(r>=e)throw new RangeError("min must be smaller than max");let n=new Aa(this.rows,this.columns);for(let t=0;t<this.rows;t++){const o=this.getRow(t);o.length>0&&ua(o,{min:r,max:e,output:o}),n.setRow(t,o)}return n}scaleColumns(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"!=typeof t)throw new TypeError("options must be an object");const{min:r=0,max:e=1}=t;if(!Number.isFinite(r))throw new TypeError("min must be a number");if(!Number.isFinite(e))throw new TypeError("max must be a number");if(r>=e)throw new RangeError("min must be smaller than max");let n=new Aa(this.rows,this.columns);for(let t=0;t<this.columns;t++){const o=this.getColumn(t);o.length&&ua(o,{min:r,max:e,output:o}),n.setColumn(t,o)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let r=0;r<this.rows;r++)for(let e=0;e<t;e++){let t=this.get(r,e),n=this.get(r,this.columns-1-e);this.set(r,e,n),this.set(r,this.columns-1-e,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let r=0;r<this.columns;r++)for(let e=0;e<t;e++){let t=this.get(e,r),n=this.get(this.rows-1-e,r);this.set(e,r,n),this.set(this.rows-1-e,r,t)}return this}kroneckerProduct(t){t=Aa.checkMatrix(t);let r=this.rows,e=this.columns,n=t.rows,o=t.columns,i=new Aa(r*n,e*o);for(let s=0;s<r;s++)for(let r=0;r<e;r++)for(let e=0;e<n;e++)for(let a=0;a<o;a++)i.set(n*s+e,o*r+a,this.get(s,r)*t.get(e,a));return i}kroneckerSum(t){if(t=Aa.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let r=this.rows,e=t.rows,n=this.kroneckerProduct(Aa.eye(e,e)),o=Aa.eye(r,r).kroneckerProduct(t);return n.add(o)}transpose(){let t=new Aa(this.columns,this.rows);for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)t.set(e,r,this.get(r,e));return t}sortRows(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Sa;for(let r=0;r<this.rows;r++)this.setRow(r,this.getRow(r).sort(t));return this}sortColumns(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Sa;for(let r=0;r<this.columns;r++)this.setColumn(r,this.getColumn(r).sort(t));return this}subMatrix(t,r,e,n){ba(this,t,r,e,n);let o=new Aa(r-t+1,n-e+1);for(let i=t;i<=r;i++)for(let r=e;r<=n;r++)o.set(i-t,r-e,this.get(i,r));return o}subMatrixRow(t,r,e){if(void 0===r&&(r=0),void 0===e&&(e=this.columns-1),r>e||r<0||r>=this.columns||e<0||e>=this.columns)throw new RangeError("Argument out of range");let n=new Aa(t.length,e-r+1);for(let o=0;o<t.length;o++)for(let i=r;i<=e;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);n.set(o,i-r,this.get(t[o],i))}return n}subMatrixColumn(t,r,e){if(void 0===r&&(r=0),void 0===e&&(e=this.rows-1),r>e||r<0||r>=this.rows||e<0||e>=this.rows)throw new RangeError("Argument out of range");let n=new Aa(e-r+1,t.length);for(let o=0;o<t.length;o++)for(let i=r;i<=e;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);n.set(i-r,o,this.get(i,t[o]))}return n}setSubMatrix(t,r,e){if((t=Aa.checkMatrix(t)).isEmpty())return this;ba(this,r,r+t.rows-1,e,e+t.columns-1);for(let n=0;n<t.rows;n++)for(let o=0;o<t.columns;o++)this.set(r+n,e+o,t.get(n,o));return this}selection(t,r){va(this,t),ya(this,r);let e=new Aa(t.length,r.length);for(let n=0;n<t.length;n++){let o=t[n];for(let t=0;t<r.length;t++){let i=r[t];e.set(n,t,this.get(o,i))}}return e}trace(){let t=Math.min(this.rows,this.columns),r=0;for(let e=0;e<t;e++)r+=this.get(e,e);return r}clone(){return this.constructor.copy(this,new Aa(this.rows,this.columns))}static copy(t,r){for(const[e,n,o]of t.entries())r.set(e,n,o);return r}sum(t){switch(t){case"row":return function(t){let r=Ma(t.rows);for(let e=0;e<t.rows;++e)for(let n=0;n<t.columns;++n)r[e]+=t.get(e,n);return r}(this);case"column":return function(t){let r=Ma(t.columns);for(let e=0;e<t.rows;++e)for(let n=0;n<t.columns;++n)r[n]+=t.get(e,n);return r}(this);case void 0:return function(t){let r=0;for(let e=0;e<t.rows;e++)for(let n=0;n<t.columns;n++)r+=t.get(e,n);return r}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let r=Ma(t.rows,1);for(let e=0;e<t.rows;++e)for(let n=0;n<t.columns;++n)r[e]*=t.get(e,n);return r}(this);case"column":return function(t){let r=Ma(t.columns,1);for(let e=0;e<t.rows;++e)for(let n=0;n<t.columns;++n)r[n]*=t.get(e,n);return r}(this);case void 0:return function(t){let r=1;for(let e=0;e<t.rows;e++)for(let n=0;n<t.columns;n++)r*=t.get(e,n);return r}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const r=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)r[t]/=this.columns;return r;case"column":for(let t=0;t<this.columns;t++)r[t]/=this.rows;return r;case void 0:return r/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"==typeof t&&(r=t,t=void 0),"object"!=typeof r)throw new TypeError("options must be an object");const{unbiased:e=!0,mean:n=this.mean(t)}=r;if("boolean"!=typeof e)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!aa.isAnyArray(n))throw new TypeError("mean must be an array");return function(t,r,e){const n=t.rows,o=t.columns,i=[];for(let s=0;s<n;s++){let n=0,a=0,u=0;for(let r=0;r<o;r++)u=t.get(s,r)-e[s],n+=u,a+=u*u;r?i.push((a-n*n/o)/(o-1)):i.push((a-n*n/o)/o)}return i}(this,e,n);case"column":if(!aa.isAnyArray(n))throw new TypeError("mean must be an array");return function(t,r,e){const n=t.rows,o=t.columns,i=[];for(let s=0;s<o;s++){let o=0,a=0,u=0;for(let r=0;r<n;r++)u=t.get(r,s)-e[s],o+=u,a+=u*u;r?i.push((a-o*o/n)/(n-1)):i.push((a-o*o/n)/n)}return i}(this,e,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,r,e){const n=t.rows,o=t.columns,i=n*o;let s=0,a=0,u=0;for(let r=0;r<n;r++)for(let n=0;n<o;n++)u=t.get(r,n)-e,s+=u,a+=u*u;return r?(a-s*s/i)/(i-1):(a-s*s/i)/i}(this,e,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,r){"object"==typeof t&&(r=t,t=void 0);const e=this.variance(t,r);if(void 0===t)return Math.sqrt(e);for(let t=0;t<e.length;t++)e[t]=Math.sqrt(e[t]);return e}center(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"==typeof t&&(r=t,t=void 0),"object"!=typeof r)throw new TypeError("options must be an object");const{center:e=this.mean(t)}=r;switch(t){case"row":if(!aa.isAnyArray(e))throw new TypeError("center must be an array");return function(t,r){for(let e=0;e<t.rows;e++)for(let n=0;n<t.columns;n++)t.set(e,n,t.get(e,n)-r[e])}(this,e),this;case"column":if(!aa.isAnyArray(e))throw new TypeError("center must be an array");return function(t,r){for(let e=0;e<t.rows;e++)for(let n=0;n<t.columns;n++)t.set(e,n,t.get(e,n)-r[n])}(this,e),this;case void 0:if("number"!=typeof e)throw new TypeError("center must be a number");return function(t,r){for(let e=0;e<t.rows;e++)for(let n=0;n<t.columns;n++)t.set(e,n,t.get(e,n)-r)}(this,e),this;default:throw new Error(`invalid option: ${t}`)}}scale(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"==typeof t&&(r=t,t=void 0),"object"!=typeof r)throw new TypeError("options must be an object");let e=r.scale;switch(t){case"row":if(void 0===e)e=function(t){const r=[];for(let e=0;e<t.rows;e++){let n=0;for(let r=0;r<t.columns;r++)n+=t.get(e,r)**2/(t.columns-1);r.push(Math.sqrt(n))}return r}(this);else if(!aa.isAnyArray(e))throw new TypeError("scale must be an array");return function(t,r){for(let e=0;e<t.rows;e++)for(let n=0;n<t.columns;n++)t.set(e,n,t.get(e,n)/r[e])}(this,e),this;case"column":if(void 0===e)e=function(t){const r=[];for(let e=0;e<t.columns;e++){let n=0;for(let r=0;r<t.rows;r++)n+=t.get(r,e)**2/(t.rows-1);r.push(Math.sqrt(n))}return r}(this);else if(!aa.isAnyArray(e))throw new TypeError("scale must be an array");return function(t,r){for(let e=0;e<t.rows;e++)for(let n=0;n<t.columns;n++)t.set(e,n,t.get(e,n)/r[n])}(this,e),this;case void 0:if(void 0===e)e=function(t){const r=t.size-1;let e=0;for(let n=0;n<t.columns;n++)for(let o=0;o<t.rows;o++)e+=t.get(o,n)**2/r;return Math.sqrt(e)}(this);else if("number"!=typeof e)throw new TypeError("scale must be a number");return function(t,r){for(let e=0;e<t.rows;e++)for(let n=0;n<t.columns;n++)t.set(e,n,t.get(e,n)/r)}(this,e),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return ca(this,t)}[Symbol.iterator](){return this.entries()}*entries(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)yield[t,r,this.get(t,r)]}*values(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)yield this.get(t,r)}}function Sa(t,r){return t-r}Ea.prototype.klass="Matrix","undefined"!=typeof Symbol&&(Ea.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return ca(this)}),Ea.random=Ea.rand,Ea.randomInt=Ea.randInt,Ea.diagonal=Ea.diag,Ea.prototype.diagonal=Ea.prototype.diag,Ea.identity=Ea.eye,Ea.prototype.negate=Ea.prototype.neg,Ea.prototype.tensorProduct=Ea.prototype.kroneckerProduct;var _a=new WeakSet;let Aa=class t extends Ea{constructor(r,e){var n,o;if(super(),ia(n=this,o=_a),o.add(n),Ri(this,"data",void 0),t.isMatrix(r))sa(this,_a,qa).call(this,r.rows,r.columns),t.copy(r,this);else if(Number.isInteger(r)&&r>=0)sa(this,_a,qa).call(this,r,e);else{if(!aa.isAnyArray(r))throw new TypeError("First argument must be a positive number or an array");{const t=r;if("number"!=typeof(e=(r=t.length)?t[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<r;n++){if(t[n].length!==e)throw new RangeError("Inconsistent array dimensions");if(!t[n].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(t[n]))}this.rows=r,this.columns=e}}}set(t,r,e){return this.data[t][r]=e,this}get(t,r){return this.data[t][r]}removeRow(t){return ga(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,r){return void 0===r&&(r=t,t=this.rows),ga(this,t,!0),r=Float64Array.from(da(this,r)),this.data.splice(t,0,r),this.rows+=1,this}removeColumn(t){pa(this,t);for(let r=0;r<this.rows;r++){const e=new Float64Array(this.columns-1);for(let n=0;n<t;n++)e[n]=this.data[r][n];for(let n=t+1;n<this.columns;n++)e[n-1]=this.data[r][n];this.data[r]=e}return this.columns-=1,this}addColumn(t,r){void 0===r&&(r=t,t=this.columns),pa(this,t,!0),r=wa(this,r);for(let e=0;e<this.rows;e++){const n=new Float64Array(this.columns+1);let o=0;for(;o<t;o++)n[o]=this.data[e][o];for(n[o++]=r[e];o<this.columns+1;o++)n[o]=this.data[e][o-1];this.data[e]=n}return this.columns+=1,this}};function qa(t,r){if(this.data=[],!(Number.isInteger(r)&&r>=0))throw new TypeError("nColumns must be a positive integer");for(let e=0;e<t;e++)this.data.push(new Float64Array(r));this.rows=t,this.columns=r}!function(t,r){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)+t);return this},t.prototype.addM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)+t.get(r,e));return this},t.add=function(t,e){return new r(t).add(e)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)-t);return this},t.prototype.subM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)-t.get(r,e));return this},t.sub=function(t,e){return new r(t).sub(e)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t);return this},t.prototype.mulM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t.get(r,e));return this},t.mul=function(t,e){return new r(t).mul(e)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)/t);return this},t.prototype.divM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)/t.get(r,e));return this},t.div=function(t,e){return new r(t).div(e)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)%t);return this},t.prototype.modM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)%t.get(r,e));return this},t.mod=function(t,e){return new r(t).mod(e)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)&t);return this},t.prototype.andM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)&t.get(r,e));return this},t.and=function(t,e){return new r(t).and(e)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)|t);return this},t.prototype.orM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)|t.get(r,e));return this},t.or=function(t,e){return new r(t).or(e)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)^t);return this},t.prototype.xorM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)^t.get(r,e));return this},t.xor=function(t,e){return new r(t).xor(e)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)<<t);return this},t.prototype.leftShiftM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)<<t.get(r,e));return this},t.leftShift=function(t,e){return new r(t).leftShift(e)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)>>t.get(r,e));return this},t.signPropagatingRightShift=function(t,e){return new r(t).signPropagatingRightShift(e)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)>>>t.get(r,e));return this},t.rightShift=function(t,e){return new r(t).rightShift(e)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,~this.get(t,r));return this},t.not=function(t){return new r(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.abs(this.get(t,r)));return this},t.abs=function(t){return new r(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.acos(this.get(t,r)));return this},t.acos=function(t){return new r(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.acosh(this.get(t,r)));return this},t.acosh=function(t){return new r(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.asin(this.get(t,r)));return this},t.asin=function(t){return new r(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.asinh(this.get(t,r)));return this},t.asinh=function(t){return new r(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.atan(this.get(t,r)));return this},t.atan=function(t){return new r(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.atanh(this.get(t,r)));return this},t.atanh=function(t){return new r(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.cbrt(this.get(t,r)));return this},t.cbrt=function(t){return new r(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.ceil(this.get(t,r)));return this},t.ceil=function(t){return new r(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.clz32(this.get(t,r)));return this},t.clz32=function(t){return new r(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.cos(this.get(t,r)));return this},t.cos=function(t){return new r(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.cosh(this.get(t,r)));return this},t.cosh=function(t){return new r(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.exp(this.get(t,r)));return this},t.exp=function(t){return new r(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.expm1(this.get(t,r)));return this},t.expm1=function(t){return new r(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.floor(this.get(t,r)));return this},t.floor=function(t){return new r(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.fround(this.get(t,r)));return this},t.fround=function(t){return new r(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.log(this.get(t,r)));return this},t.log=function(t){return new r(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.log1p(this.get(t,r)));return this},t.log1p=function(t){return new r(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.log10(this.get(t,r)));return this},t.log10=function(t){return new r(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.log2(this.get(t,r)));return this},t.log2=function(t){return new r(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.round(this.get(t,r)));return this},t.round=function(t){return new r(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.sign(this.get(t,r)));return this},t.sign=function(t){return new r(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.sin(this.get(t,r)));return this},t.sin=function(t){return new r(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.sinh(this.get(t,r)));return this},t.sinh=function(t){return new r(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.sqrt(this.get(t,r)));return this},t.sqrt=function(t){return new r(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.tan(this.get(t,r)));return this},t.tan=function(t){return new r(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.tanh(this.get(t,r)));return this},t.tanh=function(t){return new r(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.trunc(this.get(t,r)));return this},t.trunc=function(t){return new r(t).trunc()},t.pow=function(t,e){return new r(t).pow(e)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)**t);return this},t.prototype.powM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)**t.get(r,e));return this}}(Ea,Aa);var Pa=new WeakMap;class ka extends Ea{get size(){return Ks(this,Pa).size}get rows(){return Ks(this,Pa).rows}get columns(){return Ks(this,Pa).columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(t){return Aa.isMatrix(t)&&"SymmetricMatrix"===t.klassType}static zeros(t){return new this(t)}static ones(t){return new this(t).fill(1)}constructor(t){var r,e,n;if(super(),n={writable:!0,value:void 0},ia(r=this,e=Pa),e.set(r,n),Aa.isMatrix(t)){if(!t.isSymmetric())throw new TypeError("not symmetric data");Js(this,Pa,Aa.copy(t,new Aa(t.rows,t.rows)))}else if(Number.isInteger(t)&&t>=0)Js(this,Pa,new Aa(t,t));else if(Js(this,Pa,new Aa(t)),!this.isSymmetric())throw new TypeError("not symmetric data")}clone(){const t=new ka(this.diagonalSize);for(const[r,e,n]of this.upperRightEntries())t.set(r,e,n);return t}toMatrix(){return new Aa(this)}get(t,r){return Ks(this,Pa).get(t,r)}set(t,r,e){return Ks(this,Pa).set(t,r,e),Ks(this,Pa).set(r,t,e),this}removeCross(t){return Ks(this,Pa).removeRow(t),Ks(this,Pa).removeColumn(t),this}addCross(t,r){void 0===r&&(r=t,t=this.diagonalSize);const e=r.slice();return e.splice(t,1),Ks(this,Pa).addRow(t,e),Ks(this,Pa).addColumn(t,r),this}applyMask(t){if(t.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const r=[];for(const[e,n]of t.entries())n||r.push(e);r.reverse();for(const t of r)this.removeCross(t);return this}toCompact(){const{diagonalSize:t}=this,r=new Array(t*(t+1)/2);for(let e=0,n=0,o=0;o<r.length;o++)r[o]=this.get(n,e),++e>=t&&(e=++n);return r}static fromCompact(t){const r=t.length,e=(Math.sqrt(8*r+1)-1)/2;if(!Number.isInteger(e))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(t)}`);const n=new ka(e);for(let o=0,i=0,s=0;s<r;s++)n.set(o,i,t[s]),++o>=e&&(o=++i);return n}*upperRightEntries(){for(let t=0,r=0;t<this.diagonalSize;void 0){const e=this.get(t,r);yield[t,r,e],++r>=this.diagonalSize&&(r=++t)}}*upperRightValues(){for(let t=0,r=0;t<this.diagonalSize;void 0){const e=this.get(t,r);yield e,++r>=this.diagonalSize&&(r=++t)}}}ka.prototype.klassType="SymmetricMatrix";class Ra extends ka{static isDistanceMatrix(t){return ka.isSymmetricMatrix(t)&&"DistanceMatrix"===t.klassSubType}constructor(t){if(super(t),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(t,r,e){return t===r&&(e=0),super.set(t,r,e)}addCross(t,r){return void 0===r&&(r=t,t=this.diagonalSize),(r=r.slice())[t]=0,super.addCross(t,r)}toSymmetricMatrix(){return new ka(this)}clone(){const t=new Ra(this.diagonalSize);for(const[r,e,n]of this.upperRightEntries())r!==e&&t.set(r,e,n);return t}toCompact(){const{diagonalSize:t}=this,r=new Array((t-1)*t/2);for(let e=1,n=0,o=0;o<r.length;o++)r[o]=this.get(n,e),++e>=t&&(e=1+ ++n);return r}static fromCompact(t){const r=t.length;if(0===r)return new this(0);const e=(Math.sqrt(8*r+1)+1)/2;if(!Number.isInteger(e))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(t)}`);const n=new this(e);for(let o=1,i=0,s=0;s<r;s++)n.set(o,i,t[s]),++o>=e&&(o=1+ ++i);return n}}Ra.prototype.klassSubType="DistanceMatrix";class Na extends Ea{constructor(t,r,e){super(),this.matrix=t,this.rows=r,this.columns=e}}class Ia extends Na{constructor(t,r,e){va(t,r),ya(t,e),super(t,r.length,e.length),this.rowIndices=r,this.columnIndices=e}set(t,r,e){return this.matrix.set(this.rowIndices[t],this.columnIndices[r],e),this}get(t,r){return this.matrix.get(this.rowIndices[t],this.columnIndices[r])}}class Oa extends Ea{constructor(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{rows:e=1}=r;if(t.length%e!=0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=e,this.columns=t.length/e,this.data=t}set(t,r,e){let n=this._calculateIndex(t,r);return this.data[n]=e,this}get(t,r){let e=this._calculateIndex(t,r);return this.data[e]}_calculateIndex(t,r){return t*this.columns+r}}class Ta extends Ea{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,r,e){return this.data[t][r]=e,this}get(t,r){return this.data[t][r]}}class Ca{constructor(t){let r,e,n,o,i,s,a,u,l,f=(t=Ta.checkMatrix(t)).clone(),c=f.rows,h=f.columns,m=new Float64Array(c),g=1;for(r=0;r<c;r++)m[r]=r;for(u=new Float64Array(c),e=0;e<h;e++){for(r=0;r<c;r++)u[r]=f.get(r,e);for(r=0;r<c;r++){for(l=Math.min(r,e),i=0,n=0;n<l;n++)i+=f.get(r,n)*u[n];u[r]-=i,f.set(r,e,u[r])}for(o=e,r=e+1;r<c;r++)Math.abs(u[r])>Math.abs(u[o])&&(o=r);if(o!==e){for(n=0;n<h;n++)s=f.get(o,n),f.set(o,n,f.get(e,n)),f.set(e,n,s);a=m[o],m[o]=m[e],m[e]=a,g=-g}if(e<c&&0!==f.get(e,e))for(r=e+1;r<c;r++)f.set(r,e,f.get(r,e)/f.get(e,e))}this.LU=f,this.pivotVector=m,this.pivotSign=g}isSingular(){let t=this.LU,r=t.columns;for(let e=0;e<r;e++)if(0===t.get(e,e))return!0;return!1}solve(t){t=Aa.checkMatrix(t);let r=this.LU;if(r.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let e,n,o,i=t.columns,s=t.subMatrixRow(this.pivotVector,0,i-1),a=r.columns;for(o=0;o<a;o++)for(e=o+1;e<a;e++)for(n=0;n<i;n++)s.set(e,n,s.get(e,n)-s.get(o,n)*r.get(e,o));for(o=a-1;o>=0;o--){for(n=0;n<i;n++)s.set(o,n,s.get(o,n)/r.get(o,o));for(e=0;e<o;e++)for(n=0;n<i;n++)s.set(e,n,s.get(e,n)-s.get(o,n)*r.get(e,o))}return s}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let r=this.pivotSign,e=t.columns;for(let n=0;n<e;n++)r*=t.get(n,n);return r}get lowerTriangularMatrix(){let t=this.LU,r=t.rows,e=t.columns,n=new Aa(r,e);for(let o=0;o<r;o++)for(let r=0;r<e;r++)o>r?n.set(o,r,t.get(o,r)):o===r?n.set(o,r,1):n.set(o,r,0);return n}get upperTriangularMatrix(){let t=this.LU,r=t.rows,e=t.columns,n=new Aa(r,e);for(let o=0;o<r;o++)for(let r=0;r<e;r++)o<=r?n.set(o,r,t.get(o,r)):n.set(o,r,0);return n}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function Fa(t,r){let e=0;return Math.abs(t)>Math.abs(r)?(e=r/t,Math.abs(t)*Math.sqrt(1+e*e)):0!==r?(e=t/r,Math.abs(r)*Math.sqrt(1+e*e)):0}class za{constructor(t){let r,e,n,o,i=(t=Ta.checkMatrix(t)).clone(),s=t.rows,a=t.columns,u=new Float64Array(a);for(n=0;n<a;n++){let t=0;for(r=n;r<s;r++)t=Fa(t,i.get(r,n));if(0!==t){for(i.get(n,n)<0&&(t=-t),r=n;r<s;r++)i.set(r,n,i.get(r,n)/t);for(i.set(n,n,i.get(n,n)+1),e=n+1;e<a;e++){for(o=0,r=n;r<s;r++)o+=i.get(r,n)*i.get(r,e);for(o=-o/i.get(n,n),r=n;r<s;r++)i.set(r,e,i.get(r,e)+o*i.get(r,n))}}u[n]=-t}this.QR=i,this.Rdiag=u}solve(t){t=Aa.checkMatrix(t);let r=this.QR,e=r.rows;if(t.rows!==e)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let n,o,i,s,a=t.columns,u=t.clone(),l=r.columns;for(i=0;i<l;i++)for(o=0;o<a;o++){for(s=0,n=i;n<e;n++)s+=r.get(n,i)*u.get(n,o);for(s=-s/r.get(i,i),n=i;n<e;n++)u.set(n,o,u.get(n,o)+s*r.get(n,i))}for(i=l-1;i>=0;i--){for(o=0;o<a;o++)u.set(i,o,u.get(i,o)/this.Rdiag[i]);for(n=0;n<i;n++)for(o=0;o<a;o++)u.set(n,o,u.get(n,o)-u.get(i,o)*r.get(n,i))}return u.subMatrix(0,l-1,0,a-1)}isFullRank(){let t=this.QR.columns;for(let r=0;r<t;r++)if(0===this.Rdiag[r])return!1;return!0}get upperTriangularMatrix(){let t,r,e=this.QR,n=e.columns,o=new Aa(n,n);for(t=0;t<n;t++)for(r=0;r<n;r++)t<r?o.set(t,r,e.get(t,r)):t===r?o.set(t,r,this.Rdiag[t]):o.set(t,r,0);return o}get orthogonalMatrix(){let t,r,e,n,o=this.QR,i=o.rows,s=o.columns,a=new Aa(i,s);for(e=s-1;e>=0;e--){for(t=0;t<i;t++)a.set(t,e,0);for(a.set(e,e,1),r=e;r<s;r++)if(0!==o.get(e,e)){for(n=0,t=e;t<i;t++)n+=o.get(t,e)*a.get(t,r);for(n=-n/o.get(e,e),t=e;t<i;t++)a.set(t,r,a.get(t,r)+n*o.get(t,e))}}return a}}class $a{constructor(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((t=Ta.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let e=t.rows,n=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:s=!1}=r;let a,u=Boolean(o),l=Boolean(i),f=!1;if(e<n)if(s){a=t.transpose(),e=a.rows,n=a.columns,f=!0;let r=u;u=l,l=r}else a=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else a=t.clone();let c=Math.min(e,n),h=Math.min(e+1,n),m=new Float64Array(h),g=new Aa(e,c),p=new Aa(n,n),d=new Float64Array(n),w=new Float64Array(e),v=new Float64Array(h);for(let t=0;t<h;t++)v[t]=t;let y=Math.min(e-1,n),b=Math.max(0,Math.min(n-2,e)),M=Math.max(y,b);for(let t=0;t<M;t++){if(t<y){m[t]=0;for(let r=t;r<e;r++)m[t]=Fa(m[t],a.get(r,t));if(0!==m[t]){a.get(t,t)<0&&(m[t]=-m[t]);for(let r=t;r<e;r++)a.set(r,t,a.get(r,t)/m[t]);a.set(t,t,a.get(t,t)+1)}m[t]=-m[t]}for(let r=t+1;r<n;r++){if(t<y&&0!==m[t]){let n=0;for(let o=t;o<e;o++)n+=a.get(o,t)*a.get(o,r);n=-n/a.get(t,t);for(let o=t;o<e;o++)a.set(o,r,a.get(o,r)+n*a.get(o,t))}d[r]=a.get(t,r)}if(u&&t<y)for(let r=t;r<e;r++)g.set(r,t,a.get(r,t));if(t<b){d[t]=0;for(let r=t+1;r<n;r++)d[t]=Fa(d[t],d[r]);if(0!==d[t]){d[t+1]<0&&(d[t]=0-d[t]);for(let r=t+1;r<n;r++)d[r]/=d[t];d[t+1]+=1}if(d[t]=-d[t],t+1<e&&0!==d[t]){for(let r=t+1;r<e;r++)w[r]=0;for(let r=t+1;r<e;r++)for(let e=t+1;e<n;e++)w[r]+=d[e]*a.get(r,e);for(let r=t+1;r<n;r++){let n=-d[r]/d[t+1];for(let o=t+1;o<e;o++)a.set(o,r,a.get(o,r)+n*w[o])}}if(l)for(let r=t+1;r<n;r++)p.set(r,t,d[r])}}let x=Math.min(n,e+1);if(y<n&&(m[y]=a.get(y,y)),e<x&&(m[x-1]=0),b+1<x&&(d[b]=a.get(b,x-1)),d[x-1]=0,u){for(let t=y;t<c;t++){for(let r=0;r<e;r++)g.set(r,t,0);g.set(t,t,1)}for(let t=y-1;t>=0;t--)if(0!==m[t]){for(let r=t+1;r<c;r++){let n=0;for(let o=t;o<e;o++)n+=g.get(o,t)*g.get(o,r);n=-n/g.get(t,t);for(let o=t;o<e;o++)g.set(o,r,g.get(o,r)+n*g.get(o,t))}for(let r=t;r<e;r++)g.set(r,t,-g.get(r,t));g.set(t,t,1+g.get(t,t));for(let r=0;r<t-1;r++)g.set(r,t,0)}else{for(let r=0;r<e;r++)g.set(r,t,0);g.set(t,t,1)}}if(l)for(let t=n-1;t>=0;t--){if(t<b&&0!==d[t])for(let r=t+1;r<n;r++){let e=0;for(let o=t+1;o<n;o++)e+=p.get(o,t)*p.get(o,r);e=-e/p.get(t+1,t);for(let o=t+1;o<n;o++)p.set(o,r,p.get(o,r)+e*p.get(o,t))}for(let r=0;r<n;r++)p.set(r,t,0);p.set(t,t,1)}let j=x-1,E=Number.EPSILON;for(;x>0;){let t,r;for(t=x-2;t>=-1&&-1!==t;t--){const r=Number.MIN_VALUE+E*Math.abs(m[t]+Math.abs(m[t+1]));if(Math.abs(d[t])<=r||Number.isNaN(d[t])){d[t]=0;break}}if(t===x-2)r=4;else{let e;for(e=x-1;e>=t&&e!==t;e--){let r=(e!==x?Math.abs(d[e]):0)+(e!==t+1?Math.abs(d[e-1]):0);if(Math.abs(m[e])<=E*r){m[e]=0;break}}e===t?r=3:e===x-1?r=1:(r=2,t=e)}switch(t++,r){case 1:{let r=d[x-2];d[x-2]=0;for(let e=x-2;e>=t;e--){let o=Fa(m[e],r),i=m[e]/o,s=r/o;if(m[e]=o,e!==t&&(r=-s*d[e-1],d[e-1]=i*d[e-1]),l)for(let t=0;t<n;t++)o=i*p.get(t,e)+s*p.get(t,x-1),p.set(t,x-1,-s*p.get(t,e)+i*p.get(t,x-1)),p.set(t,e,o)}break}case 2:{let r=d[t-1];d[t-1]=0;for(let n=t;n<x;n++){let o=Fa(m[n],r),i=m[n]/o,s=r/o;if(m[n]=o,r=-s*d[n],d[n]=i*d[n],u)for(let r=0;r<e;r++)o=i*g.get(r,n)+s*g.get(r,t-1),g.set(r,t-1,-s*g.get(r,n)+i*g.get(r,t-1)),g.set(r,n,o)}break}case 3:{const r=Math.max(Math.abs(m[x-1]),Math.abs(m[x-2]),Math.abs(d[x-2]),Math.abs(m[t]),Math.abs(d[t])),o=m[x-1]/r,i=m[x-2]/r,s=d[x-2]/r,a=m[t]/r,f=d[t]/r,c=((i+o)*(i-o)+s*s)/2,h=o*s*(o*s);let w=0;0===c&&0===h||(w=c<0?0-Math.sqrt(c*c+h):Math.sqrt(c*c+h),w=h/(c+w));let v=(a+o)*(a-o)+w,y=a*f;for(let r=t;r<x-1;r++){let o=Fa(v,y);0===o&&(o=Number.MIN_VALUE);let i=v/o,s=y/o;if(r!==t&&(d[r-1]=o),v=i*m[r]+s*d[r],d[r]=i*d[r]-s*m[r],y=s*m[r+1],m[r+1]=i*m[r+1],l)for(let t=0;t<n;t++)o=i*p.get(t,r)+s*p.get(t,r+1),p.set(t,r+1,-s*p.get(t,r)+i*p.get(t,r+1)),p.set(t,r,o);if(o=Fa(v,y),0===o&&(o=Number.MIN_VALUE),i=v/o,s=y/o,m[r]=o,v=i*d[r]+s*m[r+1],m[r+1]=-s*d[r]+i*m[r+1],y=s*d[r+1],d[r+1]=i*d[r+1],u&&r<e-1)for(let t=0;t<e;t++)o=i*g.get(t,r)+s*g.get(t,r+1),g.set(t,r+1,-s*g.get(t,r)+i*g.get(t,r+1)),g.set(t,r,o)}d[x-2]=v;break}case 4:if(m[t]<=0&&(m[t]=m[t]<0?-m[t]:0,l))for(let r=0;r<=j;r++)p.set(r,t,-p.get(r,t));for(;t<j&&!(m[t]>=m[t+1]);){let r=m[t];if(m[t]=m[t+1],m[t+1]=r,l&&t<n-1)for(let e=0;e<n;e++)r=p.get(e,t+1),p.set(e,t+1,p.get(e,t)),p.set(e,t,r);if(u&&t<e-1)for(let n=0;n<e;n++)r=g.get(n,t+1),g.set(n,t+1,g.get(n,t)),g.set(n,t,r);t++}x--}}if(f){let t=p;p=g,g=t}this.m=e,this.n=n,this.s=m,this.U=g,this.V=p}solve(t){let r=t,e=this.threshold,n=this.s.length,o=Aa.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=e?o.set(t,t,0):o.set(t,t,1/this.s[t]);let i=this.U,s=this.rightSingularVectors,a=s.mmul(o),u=s.rows,l=i.rows,f=Aa.zeros(u,l);for(let t=0;t<u;t++)for(let r=0;r<l;r++){let e=0;for(let o=0;o<n;o++)e+=a.get(t,o)*i.get(r,o);f.set(t,r,e)}return f.mmul(r)}solveForDiagonal(t){return this.solve(Aa.diag(t))}inverse(){let t=this.V,r=this.threshold,e=t.rows,n=t.columns,o=new Aa(e,this.s.length);for(let i=0;i<e;i++)for(let e=0;e<n;e++)Math.abs(this.s[e])>r&&o.set(i,e,t.get(i,e)/this.s[e]);let i=this.U,s=i.rows,a=i.columns,u=new Aa(e,s);for(let t=0;t<e;t++)for(let r=0;r<s;r++){let e=0;for(let n=0;n<a;n++)e+=o.get(t,n)*i.get(r,n);u.set(t,r,e)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,r=0,e=this.s;for(let n=0,o=e.length;n<o;n++)e[n]>t&&r++;return r}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return Aa.diag(this.s)}}function Va(t,r){let e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t=Ta.checkMatrix(t),r=Ta.checkMatrix(r),e?new $a(t).solve(r):t.isSquare()?new Ca(t).solve(r):new za(t).solve(r)}function Da(t,r){let e=[];for(let n=0;n<t;n++)n!==r&&e.push(n);return e}function La(t,r,e){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-9;if(t>(arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e-9))return new Array(r.rows+1).fill(0);{let t=r.addRow(e,[0]);for(let r=0;r<t.rows;r++)Math.abs(t.get(r,0))<n&&t.set(r,0,0);return t.to1DArray()}}class Ua{constructor(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{assumeSymmetric:e=!1}=r;if(!(t=Ta.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");if(t.isEmpty())throw new Error("Matrix must be non-empty");let n,o,i=t.columns,s=new Aa(i,i),a=new Float64Array(i),u=new Float64Array(i),l=t,f=!1;if(f=!!e||t.isSymmetric(),f){for(n=0;n<i;n++)for(o=0;o<i;o++)s.set(n,o,l.get(n,o));!function(t,r,e,n){let o,i,s,a,u,l,f,c;for(u=0;u<t;u++)e[u]=n.get(t-1,u);for(a=t-1;a>0;a--){for(c=0,s=0,l=0;l<a;l++)c+=Math.abs(e[l]);if(0===c)for(r[a]=e[a-1],u=0;u<a;u++)e[u]=n.get(a-1,u),n.set(a,u,0),n.set(u,a,0);else{for(l=0;l<a;l++)e[l]/=c,s+=e[l]*e[l];for(o=e[a-1],i=Math.sqrt(s),o>0&&(i=-i),r[a]=c*i,s-=o*i,e[a-1]=o-i,u=0;u<a;u++)r[u]=0;for(u=0;u<a;u++){for(o=e[u],n.set(u,a,o),i=r[u]+n.get(u,u)*o,l=u+1;l<=a-1;l++)i+=n.get(l,u)*e[l],r[l]+=n.get(l,u)*o;r[u]=i}for(o=0,u=0;u<a;u++)r[u]/=s,o+=r[u]*e[u];for(f=o/(s+s),u=0;u<a;u++)r[u]-=f*e[u];for(u=0;u<a;u++){for(o=e[u],i=r[u],l=u;l<=a-1;l++)n.set(l,u,n.get(l,u)-(o*r[l]+i*e[l]));e[u]=n.get(a-1,u),n.set(a,u,0)}}e[a]=s}for(a=0;a<t-1;a++){if(n.set(t-1,a,n.get(a,a)),n.set(a,a,1),s=e[a+1],0!==s){for(l=0;l<=a;l++)e[l]=n.get(l,a+1)/s;for(u=0;u<=a;u++){for(i=0,l=0;l<=a;l++)i+=n.get(l,a+1)*n.get(l,u);for(l=0;l<=a;l++)n.set(l,u,n.get(l,u)-i*e[l])}}for(l=0;l<=a;l++)n.set(l,a+1,0)}for(u=0;u<t;u++)e[u]=n.get(t-1,u),n.set(t-1,u,0);n.set(t-1,t-1,1),r[0]=0}(i,u,a,s),function(t,r,e,n){let o,i,s,a,u,l,f,c,h,m,g,p,d,w,v,y;for(s=1;s<t;s++)r[s-1]=r[s];r[t-1]=0;let b=0,M=0,x=Number.EPSILON;for(l=0;l<t;l++){for(M=Math.max(M,Math.abs(e[l])+Math.abs(r[l])),f=l;f<t&&!(Math.abs(r[f])<=x*M);)f++;if(f>l)do{for(o=e[l],c=(e[l+1]-o)/(2*r[l]),h=Fa(c,1),c<0&&(h=-h),e[l]=r[l]/(c+h),e[l+1]=r[l]*(c+h),m=e[l+1],i=o-e[l],s=l+2;s<t;s++)e[s]-=i;for(b+=i,c=e[f],g=1,p=g,d=g,w=r[l+1],v=0,y=0,s=f-1;s>=l;s--)for(d=p,p=g,y=v,o=g*r[s],i=g*c,h=Fa(c,r[s]),r[s+1]=v*h,v=r[s]/h,g=c/h,c=g*e[s]-v*o,e[s+1]=i+v*(g*o+v*e[s]),u=0;u<t;u++)i=n.get(u,s+1),n.set(u,s+1,v*n.get(u,s)+g*i),n.set(u,s,g*n.get(u,s)-v*i);c=-v*y*d*w*r[l]/m,r[l]=v*c,e[l]=g*c}while(Math.abs(r[l])>x*M);e[l]=e[l]+b,r[l]=0}for(s=0;s<t-1;s++){for(u=s,c=e[s],a=s+1;a<t;a++)e[a]<c&&(u=a,c=e[a]);if(u!==s)for(e[u]=e[s],e[s]=c,a=0;a<t;a++)c=n.get(a,s),n.set(a,s,n.get(a,u)),n.set(a,u,c)}}(i,u,a,s)}else{let t=new Aa(i,i),r=new Float64Array(i);for(o=0;o<i;o++)for(n=0;n<i;n++)t.set(n,o,l.get(n,o));!function(t,r,e,n){let o,i,s,a,u,l,f,c=0,h=t-1;for(l=c+1;l<=h-1;l++){for(f=0,a=l;a<=h;a++)f+=Math.abs(r.get(a,l-1));if(0!==f){for(s=0,a=h;a>=l;a--)e[a]=r.get(a,l-1)/f,s+=e[a]*e[a];for(i=Math.sqrt(s),e[l]>0&&(i=-i),s-=e[l]*i,e[l]=e[l]-i,u=l;u<t;u++){for(o=0,a=h;a>=l;a--)o+=e[a]*r.get(a,u);for(o/=s,a=l;a<=h;a++)r.set(a,u,r.get(a,u)-o*e[a])}for(a=0;a<=h;a++){for(o=0,u=h;u>=l;u--)o+=e[u]*r.get(a,u);for(o/=s,u=l;u<=h;u++)r.set(a,u,r.get(a,u)-o*e[u])}e[l]=f*e[l],r.set(l,l-1,f*i)}}for(a=0;a<t;a++)for(u=0;u<t;u++)n.set(a,u,a===u?1:0);for(l=h-1;l>=c+1;l--)if(0!==r.get(l,l-1)){for(a=l+1;a<=h;a++)e[a]=r.get(a,l-1);for(u=l;u<=h;u++){for(i=0,a=l;a<=h;a++)i+=e[a]*n.get(a,u);for(i=i/e[l]/r.get(l,l-1),a=l;a<=h;a++)n.set(a,u,n.get(a,u)+i*e[a])}}}(i,t,r,s),function(t,r,e,n,o){let i,s,a,u,l,f,c,h,m,g,p,d,w,v,y,b=t-1,M=0,x=t-1,j=Number.EPSILON,E=0,S=0,_=0,A=0,q=0,P=0,k=0,R=0;for(i=0;i<t;i++)for((i<M||i>x)&&(e[i]=o.get(i,i),r[i]=0),s=Math.max(i-1,0);s<t;s++)S+=Math.abs(o.get(i,s));for(;b>=M;){for(u=b;u>M&&(P=Math.abs(o.get(u-1,u-1))+Math.abs(o.get(u,u)),0===P&&(P=S),!(Math.abs(o.get(u,u-1))<j*P));)u--;if(u===b)o.set(b,b,o.get(b,b)+E),e[b]=o.get(b,b),r[b]=0,b--,R=0;else if(u===b-1){if(c=o.get(b,b-1)*o.get(b-1,b),_=(o.get(b-1,b-1)-o.get(b,b))/2,A=_*_+c,k=Math.sqrt(Math.abs(A)),o.set(b,b,o.get(b,b)+E),o.set(b-1,b-1,o.get(b-1,b-1)+E),h=o.get(b,b),A>=0){for(k=_>=0?_+k:_-k,e[b-1]=h+k,e[b]=e[b-1],0!==k&&(e[b]=h-c/k),r[b-1]=0,r[b]=0,h=o.get(b,b-1),P=Math.abs(h)+Math.abs(k),_=h/P,A=k/P,q=Math.sqrt(_*_+A*A),_/=q,A/=q,s=b-1;s<t;s++)k=o.get(b-1,s),o.set(b-1,s,A*k+_*o.get(b,s)),o.set(b,s,A*o.get(b,s)-_*k);for(i=0;i<=b;i++)k=o.get(i,b-1),o.set(i,b-1,A*k+_*o.get(i,b)),o.set(i,b,A*o.get(i,b)-_*k);for(i=M;i<=x;i++)k=n.get(i,b-1),n.set(i,b-1,A*k+_*n.get(i,b)),n.set(i,b,A*n.get(i,b)-_*k)}else e[b-1]=h+_,e[b]=h+_,r[b-1]=k,r[b]=-k;b-=2,R=0}else{if(h=o.get(b,b),m=0,c=0,u<b&&(m=o.get(b-1,b-1),c=o.get(b,b-1)*o.get(b-1,b)),10===R){for(E+=h,i=M;i<=b;i++)o.set(i,i,o.get(i,i)-h);P=Math.abs(o.get(b,b-1))+Math.abs(o.get(b-1,b-2)),h=m=.75*P,c=-.4375*P*P}if(30===R&&(P=(m-h)/2,P=P*P+c,P>0)){for(P=Math.sqrt(P),m<h&&(P=-P),P=h-c/((m-h)/2+P),i=M;i<=b;i++)o.set(i,i,o.get(i,i)-P);E+=P,h=m=c=.964}for(R+=1,l=b-2;l>=u&&(k=o.get(l,l),q=h-k,P=m-k,_=(q*P-c)/o.get(l+1,l)+o.get(l,l+1),A=o.get(l+1,l+1)-k-q-P,q=o.get(l+2,l+1),P=Math.abs(_)+Math.abs(A)+Math.abs(q),_/=P,A/=P,q/=P,l!==u)&&!(Math.abs(o.get(l,l-1))*(Math.abs(A)+Math.abs(q))<j*(Math.abs(_)*(Math.abs(o.get(l-1,l-1))+Math.abs(k)+Math.abs(o.get(l+1,l+1)))));)l--;for(i=l+2;i<=b;i++)o.set(i,i-2,0),i>l+2&&o.set(i,i-3,0);for(a=l;a<=b-1&&(v=a!==b-1,a!==l&&(_=o.get(a,a-1),A=o.get(a+1,a-1),q=v?o.get(a+2,a-1):0,h=Math.abs(_)+Math.abs(A)+Math.abs(q),0!==h&&(_/=h,A/=h,q/=h)),0!==h);a++)if(P=Math.sqrt(_*_+A*A+q*q),_<0&&(P=-P),0!==P){for(a!==l?o.set(a,a-1,-P*h):u!==l&&o.set(a,a-1,-o.get(a,a-1)),_+=P,h=_/P,m=A/P,k=q/P,A/=_,q/=_,s=a;s<t;s++)_=o.get(a,s)+A*o.get(a+1,s),v&&(_+=q*o.get(a+2,s),o.set(a+2,s,o.get(a+2,s)-_*k)),o.set(a,s,o.get(a,s)-_*h),o.set(a+1,s,o.get(a+1,s)-_*m);for(i=0;i<=Math.min(b,a+3);i++)_=h*o.get(i,a)+m*o.get(i,a+1),v&&(_+=k*o.get(i,a+2),o.set(i,a+2,o.get(i,a+2)-_*q)),o.set(i,a,o.get(i,a)-_),o.set(i,a+1,o.get(i,a+1)-_*A);for(i=M;i<=x;i++)_=h*n.get(i,a)+m*n.get(i,a+1),v&&(_+=k*n.get(i,a+2),n.set(i,a+2,n.get(i,a+2)-_*q)),n.set(i,a,n.get(i,a)-_),n.set(i,a+1,n.get(i,a+1)-_*A)}}}if(0===S)return;for(b=t-1;b>=0;b--)if(_=e[b],A=r[b],0===A)for(u=b,o.set(b,b,1),i=b-1;i>=0;i--){for(c=o.get(i,i)-_,q=0,s=u;s<=b;s++)q+=o.get(i,s)*o.get(s,b);if(r[i]<0)k=c,P=q;else if(u=i,0===r[i]?o.set(i,b,0!==c?-q/c:-q/(j*S)):(h=o.get(i,i+1),m=o.get(i+1,i),A=(e[i]-_)*(e[i]-_)+r[i]*r[i],f=(h*P-k*q)/A,o.set(i,b,f),o.set(i+1,b,Math.abs(h)>Math.abs(k)?(-q-c*f)/h:(-P-m*f)/k)),f=Math.abs(o.get(i,b)),j*f*f>1)for(s=i;s<=b;s++)o.set(s,b,o.get(s,b)/f)}else if(A<0)for(u=b-1,Math.abs(o.get(b,b-1))>Math.abs(o.get(b-1,b))?(o.set(b-1,b-1,A/o.get(b,b-1)),o.set(b-1,b,-(o.get(b,b)-_)/o.get(b,b-1))):(y=Ba(0,-o.get(b-1,b),o.get(b-1,b-1)-_,A),o.set(b-1,b-1,y[0]),o.set(b-1,b,y[1])),o.set(b,b-1,0),o.set(b,b,1),i=b-2;i>=0;i--){for(g=0,p=0,s=u;s<=b;s++)g+=o.get(i,s)*o.get(s,b-1),p+=o.get(i,s)*o.get(s,b);if(c=o.get(i,i)-_,r[i]<0)k=c,q=g,P=p;else if(u=i,0===r[i]?(y=Ba(-g,-p,c,A),o.set(i,b-1,y[0]),o.set(i,b,y[1])):(h=o.get(i,i+1),m=o.get(i+1,i),d=(e[i]-_)*(e[i]-_)+r[i]*r[i]-A*A,w=2*(e[i]-_)*A,0===d&&0===w&&(d=j*S*(Math.abs(c)+Math.abs(A)+Math.abs(h)+Math.abs(m)+Math.abs(k))),y=Ba(h*q-k*g+A*p,h*P-k*p-A*g,d,w),o.set(i,b-1,y[0]),o.set(i,b,y[1]),Math.abs(h)>Math.abs(k)+Math.abs(A)?(o.set(i+1,b-1,(-g-c*o.get(i,b-1)+A*o.get(i,b))/h),o.set(i+1,b,(-p-c*o.get(i,b)-A*o.get(i,b-1))/h)):(y=Ba(-q-m*o.get(i,b-1),-P-m*o.get(i,b),k,A),o.set(i+1,b-1,y[0]),o.set(i+1,b,y[1]))),f=Math.max(Math.abs(o.get(i,b-1)),Math.abs(o.get(i,b))),j*f*f>1)for(s=i;s<=b;s++)o.set(s,b-1,o.get(s,b-1)/f),o.set(s,b,o.get(s,b)/f)}for(i=0;i<t;i++)if(i<M||i>x)for(s=i;s<t;s++)n.set(i,s,o.get(i,s));for(s=t-1;s>=M;s--)for(i=M;i<=x;i++){for(k=0,a=M;a<=Math.min(s,x);a++)k+=n.get(i,a)*o.get(a,s);n.set(i,s,k)}}(i,u,a,s,t)}this.n=i,this.e=u,this.d=a,this.V=s}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t,r,e=this.n,n=this.e,o=this.d,i=new Aa(e,e);for(t=0;t<e;t++){for(r=0;r<e;r++)i.set(t,r,0);i.set(t,t,o[t]),n[t]>0?i.set(t,t+1,n[t]):n[t]<0&&i.set(t,t-1,n[t])}return i}}function Ba(t,r,e,n){let o,i;return Math.abs(e)>Math.abs(n)?(o=n/e,i=e+o*n,[(t+o*r)/i,(r-o*t)/i]):(o=e/n,i=n+o*e,[(o*t+r)/i,(o*r-t)/i])}class Wa{constructor(t){if(!(t=Ta.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");let r,e,n,o=t,i=o.rows,s=new Aa(i,i),a=!0;for(e=0;e<i;e++){let t=0;for(n=0;n<e;n++){let i=0;for(r=0;r<n;r++)i+=s.get(n,r)*s.get(e,r);i=(o.get(e,n)-i)/s.get(n,n),s.set(e,n,i),t+=i*i}for(t=o.get(e,e)-t,a&=t>0,s.set(e,e,Math.sqrt(Math.max(t,0))),n=e+1;n<i;n++)s.set(e,n,0)}this.L=s,this.positiveDefinite=Boolean(a)}isPositiveDefinite(){return this.positiveDefinite}solve(t){t=Ta.checkMatrix(t);let r=this.L,e=r.rows;if(t.rows!==e)throw new Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw new Error("Matrix is not positive definite");let n,o,i,s=t.columns,a=t.clone();for(i=0;i<e;i++)for(o=0;o<s;o++){for(n=0;n<i;n++)a.set(i,o,a.get(i,o)-a.get(n,o)*r.get(i,n));a.set(i,o,a.get(i,o)/r.get(i,i))}for(i=e-1;i>=0;i--)for(o=0;o<s;o++){for(n=i+1;n<e;n++)a.set(i,o,a.get(i,o)-a.get(n,o)*r.get(n,i));a.set(i,o,a.get(i,o)/r.get(i,i))}return a}get lowerTriangularMatrix(){return this.L}}class Ga{constructor(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=Ta.checkMatrix(t);let{Y:e}=r;const{scaleScores:n=!1,maxIterations:o=1e3,terminationCriteria:i=1e-10}=r;let s;if(e){if(e=aa.isAnyArray(e)&&"number"==typeof e[0]?Aa.columnVector(e):Ta.checkMatrix(e),e.rows!==t.rows)throw new Error("Y should have the same number of rows as X");s=e.getColumnVector(0)}else s=t.getColumnVector(0);let a,u,l,f,c=1;for(let r=0;r<o&&c>i;r++)l=t.transpose().mmul(s).div(s.transpose().mmul(s).get(0,0)),l=l.div(l.norm()),a=t.mmul(l).div(l.transpose().mmul(l).get(0,0)),r>0&&(c=a.clone().sub(f).pow(2).sum()),f=a.clone(),e?(u=e.transpose().mmul(a).div(a.transpose().mmul(a).get(0,0)),u=u.div(u.norm()),s=e.mmul(u).div(u.transpose().mmul(u).get(0,0))):s=a;if(e){let r=t.transpose().mmul(a).div(a.transpose().mmul(a).get(0,0));r=r.div(r.norm());let n=t.clone().sub(a.clone().mmul(r.transpose())),o=s.transpose().mmul(a).div(a.transpose().mmul(a).get(0,0)),i=e.clone().sub(a.clone().mulS(o.get(0,0)).mmul(u.transpose()));this.t=a,this.p=r.transpose(),this.w=l.transpose(),this.q=u,this.u=s,this.s=a.transpose().mmul(a),this.xResidual=n,this.yResidual=i,this.betas=o}else this.w=l.transpose(),this.s=a.transpose().mmul(a).sqrt(),this.t=n?a.clone().div(this.s.get(0,0)):a,this.xResidual=t.sub(a.mmul(l.transpose()))}}Zs.AbstractMatrix=Ea,Zs.CHO=Wa,Zs.CholeskyDecomposition=Wa,Zs.DistanceMatrix=Ra,Zs.EVD=Ua,Zs.EigenvalueDecomposition=Ua,Zs.LU=Ca,Zs.LuDecomposition=Ca;var Xa=Zs.Matrix=Aa;Zs.MatrixColumnSelectionView=class extends Na{constructor(t,r){ya(t,r),super(t,t.rows,r.length),this.columnIndices=r}set(t,r,e){return this.matrix.set(t,this.columnIndices[r],e),this}get(t,r){return this.matrix.get(t,this.columnIndices[r])}},Zs.MatrixColumnView=class extends Na{constructor(t,r){pa(t,r),super(t,t.rows,1),this.column=r}set(t,r,e){return this.matrix.set(t,this.column,e),this}get(t){return this.matrix.get(t,this.column)}},Zs.MatrixFlipColumnView=class extends Na{constructor(t){super(t,t.rows,t.columns)}set(t,r,e){return this.matrix.set(t,this.columns-r-1,e),this}get(t,r){return this.matrix.get(t,this.columns-r-1)}},Zs.MatrixFlipRowView=class extends Na{constructor(t){super(t,t.rows,t.columns)}set(t,r,e){return this.matrix.set(this.rows-t-1,r,e),this}get(t,r){return this.matrix.get(this.rows-t-1,r)}},Zs.MatrixRowSelectionView=class extends Na{constructor(t,r){va(t,r),super(t,r.length,t.columns),this.rowIndices=r}set(t,r,e){return this.matrix.set(this.rowIndices[t],r,e),this}get(t,r){return this.matrix.get(this.rowIndices[t],r)}},Zs.MatrixRowView=class extends Na{constructor(t,r){ga(t,r),super(t,1,t.columns),this.row=r}set(t,r,e){return this.matrix.set(this.row,r,e),this}get(t,r){return this.matrix.get(this.row,r)}},Zs.MatrixSelectionView=Ia,Zs.MatrixSubView=class extends Na{constructor(t,r,e,n,o){ba(t,r,e,n,o),super(t,e-r+1,o-n+1),this.startRow=r,this.startColumn=n}set(t,r,e){return this.matrix.set(this.startRow+t,this.startColumn+r,e),this}get(t,r){return this.matrix.get(this.startRow+t,this.startColumn+r)}};var Ya=Zs.MatrixTransposeView=class extends Na{constructor(t){super(t,t.columns,t.rows)}set(t,r,e){return this.matrix.set(r,t,e),this}get(t,r){return this.matrix.get(r,t)}};Zs.NIPALS=Ga,Zs.Nipals=Ga,Zs.QR=za,Zs.QrDecomposition=za,Zs.SVD=$a,Zs.SingularValueDecomposition=$a,Zs.SymmetricMatrix=ka,Zs.WrapperMatrix1D=Oa,Zs.WrapperMatrix2D=Ta,Zs.correlation=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t=new Aa(t);let n=!1;if("object"!=typeof r||Aa.isMatrix(r)||aa.isAnyArray(r)?r=new Aa(r):(e=r,r=t,n=!0),t.rows!==r.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:o=!0,scale:i=!0}=e;o&&(t.center("column"),n||r.center("column")),i&&(t.scale("column"),n||r.scale("column"));const s=t.standardDeviation("column",{unbiased:!0}),a=n?s:r.standardDeviation("column",{unbiased:!0}),u=t.transpose().mmul(r);for(let r=0;r<u.rows;r++)for(let e=0;e<u.columns;e++)u.set(r,e,u.get(r,e)*(1/(s[r]*a[e]))*(1/(t.rows-1)));return u},Zs.covariance=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t=new Aa(t);let n=!1;if("object"!=typeof r||Aa.isMatrix(r)||aa.isAnyArray(r)?r=new Aa(r):(e=r,r=t,n=!0),t.rows!==r.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:o=!0}=e;o&&(t=t.center("column"),n||(r=r.center("column")));const i=t.transpose().mmul(r);for(let r=0;r<i.rows;r++)for(let e=0;e<i.columns;e++)i.set(r,e,i.get(r,e)*(1/(t.rows-1)));return i};var Qa=Zs.default=Aa;Zs.determinant=function t(r){if((r=Aa.checkMatrix(r)).isSquare()){if(0===r.columns)return 1;let e,n,o,i;if(2===r.columns)return e=r.get(0,0),n=r.get(0,1),o=r.get(1,0),i=r.get(1,1),e*i-n*o;if(3===r.columns){let i,s,a;return i=new Ia(r,[1,2],[1,2]),s=new Ia(r,[1,2],[0,2]),a=new Ia(r,[1,2],[0,1]),e=r.get(0,0),n=r.get(0,1),o=r.get(0,2),e*t(i)-n*t(s)+o*t(a)}return new Ca(r).determinant}throw Error("determinant can only be calculated for a square matrix")},Zs.inverse=function(t){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t=Ta.checkMatrix(t),r?new $a(t).inverse():Va(t,Aa.eye(t.rows))},Zs.linearDependencies=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{thresholdValue:e=1e-9,thresholdError:n=1e-9}=r;let o=(t=Aa.checkMatrix(t)).rows,i=new Aa(o,o);for(let r=0;r<o;r++){let s=Aa.columnVector(t.getRow(r)),a=t.subMatrixRow(Da(o,r)).transpose(),u=new $a(a).solve(s),l=Aa.sub(s,a.mmul(u)).abs().max();i.setRow(r,La(l,u,r,e,n))}return i},Zs.pseudoInverse=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.EPSILON;if((t=Aa.checkMatrix(t)).isEmpty())return t.transpose();let e=new $a(t,{autoTranspose:!0}),n=e.leftSingularVectors,o=e.rightSingularVectors,i=e.diagonal;for(let t=0;t<i.length;t++)Math.abs(i[t])>r?i[t]=1/i[t]:i[t]=0;return o.mmul(Aa.diag(i).mmul(n.transpose()))};var Ha=Zs.solve=Va;Zs.wrap=function(t,r){if(aa.isAnyArray(t))return t[0]&&aa.isAnyArray(t[0])?new Ta(t):new Oa(t,r);throw new Error("the argument is not an array")};const Ja=Xa,Ka=Ya;Qa.Matrix&&Qa.Matrix;const Za=Ha;function tu(t,r){if(!ra(t)||!ra(r))throw new TypeError("x and y must be arrays");if(t.length!==r.length)throw new RangeError("x and y arrays must have the same length")}class ru{constructor(){if(new.target===ru)throw new Error("BaseRegression must be subclassed")}predict(t){if("number"==typeof t)return this._predict(t);if(ra(t)){const r=[];for(const e of t)r.push(this._predict(e));return r}throw new TypeError("x must be a number or array")}_predict(t){throw new Error("_predict must be implemented")}train(){}toString(t){return""}toLaTeX(t){return""}score(t,r){tu(t,r);const e=t.length,n=new Array(e);for(let r=0;r<e;r++)n[r]=this._predict(t[r]);let o=0,i=0,s=0,a=0,u=0,l=0,f=0;for(let t=0;t<e;t++)o+=n[t],i+=r[t],u+=n[t]*n[t],l+=r[t]*r[t],f+=n[t]*r[t],0!==r[t]&&(s+=(r[t]-n[t])*(r[t]-n[t])/r[t]),a+=(r[t]-n[t])*(r[t]-n[t]);const c=(e*f-o*i)/Math.sqrt((e*u-o*o)*(e*l-i*i));return{r:c,r2:c*c,chi2:s,rmsd:Math.sqrt(a/e)}}}function eu(t,r){return t<0?(t=0-t,"number"==typeof r?`- ${t.toPrecision(r)}`:`- ${t.toString()}`):"number"==typeof r?t.toPrecision(r):t.toString()}class nu extends ru{constructor(t,r,e){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(super(),!0===t)this.degree=r.degree,this.powers=r.powers,this.coefficients=r.coefficients;else{tu(t,r);const o=function(t,r,e){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const o=t.length;let{interceptAtZero:i=!1}=n,s=[];if(Array.isArray(e))s=e,i=!1;else if("number"==typeof e)if(i){s=new Array(e);for(let t=0;t<e;t++)s[t]=t+1}else{s=new Array(e+1);for(let t=0;t<=e;t++)s[t]=t}const a=s.length,u=new Ja(o,a),l=new Ja([r]);for(let r=0;r<a;r++)for(let e=0;e<o;e++)0===s[r]?u.set(e,r,1):u.set(e,r,t[e]**s[r]);const f=new Ka(u),c=f.mmul(u),h=f.mmul(new Ka(l));return{coefficients:Za(c,h).to1DArray(),degree:Math.max(...s),powers:s}}(t,r,e,n);this.degree=o.degree,this.powers=o.powers,this.coefficients=o.coefficients}}_predict(t){let r=0;for(let e=0;e<this.powers.length;e++)r+=this.coefficients[e]*t**this.powers[e];return r}toJSON(){return{name:"polynomialRegression",degree:this.degree,powers:this.powers,coefficients:this.coefficients}}toString(t){return this._toFormula(t,!1)}toLaTeX(t){return this._toFormula(t,!0)}_toFormula(t,r){let e="^",n="",o=" * ";r&&(e="^{",n="}",o="");let i="",s="";for(let r=0;r<this.coefficients.length;r++)s="",0!==this.coefficients[r]&&(s=0===this.powers[r]?eu(this.coefficients[r],t):1===this.powers[r]?`${eu(this.coefficients[r],t)+o}x`:`${eu(this.coefficients[r],t)+o}x${e}${this.powers[r]}${n}`,this.coefficients[r]>0&&r!==this.coefficients.length-1?s=` + ${s}`:r!==this.coefficients.length-1&&(s=` ${s}`)),i=s+i;return i.startsWith("+")&&(i=i.slice(1)),`f(x) = ${i}`}static load(t){if("polynomialRegression"!==t.name)throw new TypeError("not a polynomial regression model");return new nu(!0,t)}}var ou=9007199254740991,iu=4294967295,su=Math.min;t.arrAverage=Mo,t.arrAverageWithLogNormCI=async function(t,r){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"two-tailed";if(!Rt(t))return Promise.reject("arr is not an array");if(0===_t(t))return Promise.reject("arr is not an effective array");if(!io(r))return Promise.reject(`p[${r}] is not a number`);if((r=yo(r))<0)return Promise.reject(`p[${r}] < 0`);if(r>1)return Promise.reject(`p[${r}] > 1`);if("two-tailed"!==e&&"upper-tail"!==e&&"lower-tail"!==e)return Promise.reject(`mode[${e}] is not 'two-tailed', 'upper-tail' or 'lower-tail'`);let n=Eo(t);if(0===_t(n))return Promise.reject("no effective data");let o=await Do(n,r,e);return o=Rt(o)?[Math.exp(o[0]),Math.exp(o[1])]:Math.exp(o),o},t.arrAverageWithNormCI=Do,t.arrCount=function(t){if(!Rt(t))return[];if(0===_t(t))return[];let r=[];if(Uo(t,(t=>{(io(t)||oo(t))&&r.push(function(t){if(!oo(t)&&!io(t)&&!ae(t))return"";let r="";try{r=String(t)}catch(t){}try{r=t.toString()}catch(t){}return r}(t))})),0===_t(r))return[];r=De(r,(t=>({v:t})));let e=Ho(r,"v");var n;return e=De(e,((t,r)=>({key:r,count:_t(t)}))),e=fi(e,"count"),e=null==(n=e)?n:ci.call(n),e},t.arrGammaFit=Si,t.arrGammaHist=async function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Rt(t))return Promise.reject("arr is not an array");if(0===_t(t))return Promise.reject("arr is not an effective array");let e=bo(t);e=Ue(e,(t=>t>0));let n=await Si(t,r),o=await qi(e,(t=>De(t.curveX,(t=>ko.gamma.pdf(t,n.shape,n.scale)))),r),i=De(o.bins,((t,r)=>(t.pdf=o.pdfs[r],t))),s=De(o.curveX,((t,r)=>({x:t,pdf:o.curveY[r]})));return{shape:n.shape,scale:n.scale,arr:o.arr,min:o.min,max:o.max,barWidth:o.barWidth,ratioForCountToPdf:o.ratioForCountToPdf,bins:i,curves:s}},t.arrGammaInv=async function(t,r){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!Rt(t))return Promise.reject("arr is not an array");if(0===_t(t))return Promise.reject("arr is not an effective array");if(!io(r))return Promise.reject(`ratio[${r}] is not a number`);if((r=yo(r))<0)return Promise.reject(`ratio[${r}] < 0`);if(r>1)return Promise.reject(`ratio[${r}] > 1`);let n=Pe(e,"n");$o(n)||(n=30),n=zo(n);let o=Pe(e,"min",null),i=Pe(e,"max",null),s=await Si(t,{n:n,min:o,max:i});return function(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?Ni(Object(e),!0).forEach((function(r){Ri(t,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):Ni(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}))}return t}({inv:ko.gamma.inv(r,s.shape,s.scale)},s)},t.arrGeometricAverage=Ii,t.arrGeometricStd=function(t){if(!Rt(t))return null;if(0===_t(t))return null;let r=Eo(t),e=_t(r);if(0===e)return null;if(e<=1)return null;let n=Ro(r);return Math.exp(n)},t.arrLogNormHist=async function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Rt(t))return Promise.reject("arr is not an array");if(0===_t(t))return Promise.reject("arr is not an effective array");let e=await Oi(t,r),n=Eo(t),o=await Oi(n),i=De(o.curves,(t=>({x:Math.exp(t.x),pdf:t.pdf}))),s=e.ratioForCountToPdf/o.ratioForCountToPdf;i=De(i,(t=>(t.pdf*=s,t)));let a=Ii(e.arr);return{avg:e.avg,std:e.std,avg_geo:a,avg_log:o.avg,std_log:o.std,arr:e.arr,min:e.min,max:e.max,barWidth:e.barWidth,ratioForCountToPdf:e.ratioForCountToPdf,bins:e.bins,curves:i}},t.arrLogNormInv=async function(t,r){if(!Rt(t))return Promise.reject("arr is not an array");if(0===_t(t))return Promise.reject("arr is not an effective array");if(!io(r))return Promise.reject(`ratio[${r}] is not a number`);if((r=yo(r))<0)return Promise.reject(`ratio[${r}] < 0`);if(r>1)return Promise.reject(`ratio[${r}] > 1`);let e=Eo(t);if(0===_t(e))return Promise.reject("no effective data");let n=await Ti(e,r);return _o(Pe(n,"inv"))?(n={inv:Math.exp(n.inv),avg:Math.exp(n.avg),std:Math.exp(n.std),arr:De(n.arr,(t=>Math.exp(t)))},n):Promise.reject("invalid value from arrNormInv")},t.arrMovingAverage=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Rt(t))return[];if(0===_t(t))return[];let e=Pe(r,"selectCountHalf");var n;Io(n=e)&&zo(n)>=0||(e=2),e=zo(e);let o=_t(t);if(0===o)return[];let i=Kn(t);return Uo(t,((r,n)=>{let s=n-e;s=Math.max(s,0),s=Math.min(s,o-1);let a=Math.max(n+e,0);a=Math.max(a,0),a=Math.min(a,o-1);let u=[];for(let r=s;r<=a;r++)u.push(t[r]);let l=Mo(u);i[n]=l})),i},t.arrNormHist=Oi,t.arrNormInv=Ti,t.arrQuartile=function(t,r){if(!Rt(t))return null;if(0===_t(t))return null;if(!xo(r))return null;(r=yo(r))<0&&(r=0),r>1&&(r=1);let e=bo(t);return 0===_t(e)?null:Bs.quantile(e,r)},t.arrStd=Ro,t.bin=Ei,t.histGen=qi,t.jStat=ko,t.regLine=Qs,t.regPoly=function(t,r){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=Pe(e,"interpX");io(n)||(n=null);let o=Pe(e,"useSync");Xs(o)||(o=!1);let i=()=>{if(!no(t))throw new Error("arr is not an effective array");if(!$o(r))throw new Error(`degree[${r}] is not an integer`);if((r=zo(r))<2)throw new Error(`degree[${r}] < 2`);let e=[];if(Uo(t,(t=>{let r=Pe(t,0),n=Pe(t,1);io(r)&&io(n)&&e.push([yo(r),yo(n)])})),0===_t(e))throw new Error("no effective data");let o={},i=De(e,0),s=De(e,1),a=new nu(i,s,r);if(Uo(a.coefficients,((t,r)=>{0===r?o.b=t:o[`m${r}`]=t})),io(n)){n=yo(n);let t=a.predict(n);o.interpX=n,o.interpY=t}return o};return o?i():(async()=>{let t=null;try{return t=i(),Ys(t)?t:Promise.reject("no effective data")}catch(t){return console.log(t),Promise.reject(t.message)}})()},t.regPower=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=Pe(r,"interpX");io(e)||(e=null);let n=Pe(r,"useSync");Xs(n)||(n=!1);let o=()=>{if(!no(t))throw new Error("arr is not an effective array");let r=[];if(Uo(t,(t=>{let e=Pe(t,0),n=Pe(t,1);io(e)&&io(n)&&(e=yo(e),n=yo(n),e>0&&n>0&&r.push([e,n]))})),0===_t(r))throw new Error("no effective data");let n=Qs(De(t,(t=>[Math.log(t[0]),Math.log(t[1])])),{useRegIntercept:!0,useSync:!0});if(!Ys(n))return null;let o={a:Math.exp(n.b),b:n.m};if(io(e)){e=yo(e);let t=o.a*e**o.b;o.interpY=t}return o};return n?o():(async()=>{let t=null;try{return t=o(),Ys(t)?t:Promise.reject("no effective data")}catch(t){return console.log(t),Promise.reject(t.message)}})()},t.sampleRandom=async function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=null;if("beta"===t){let n=Pe(r,"alpha");if(!_o(n))return Promise.reject("opt.alpha is not a number");let o=Pe(r,"beta");if(!_o(o))return Promise.reject("opt.beta is not a number");e=()=>ko[t].sample(n,o)}else if("centralF"===t){let n=Pe(r,"df1");if(!_o(n))return Promise.reject("opt.df1 is not a number");let o=Pe(r,"df2");if(!_o(o))return Promise.reject("opt.df2 is not a number");e=()=>ko[t].sample(n,o)}else if("cauchy"===t){let n=Pe(r,"local");if(!_o(n))return Promise.reject("opt.local is not a number");let o=Pe(r,"scale");if(!_o(o))return Promise.reject("opt.scale is not a number");e=()=>ko[t].sample(n,o)}else if("chisquare"===t){let n=Pe(r,"dof");if(!_o(n))return Promise.reject("opt.dof is not a number");e=()=>ko[t].sample(n)}else if("exponential"===t){let n=Pe(r,"rate");if(!_o(n))return Promise.reject("opt.rate is not a number");e=()=>ko[t].sample(n)}else if("gamma"===t){let n=Pe(r,"shape");if(!_o(n))return Promise.reject("opt.shape is not a number");let o=Pe(r,"scale");if(!_o(o))return Promise.reject("opt.scale is not a number");e=()=>ko[t].sample(n,o)}else if("invgamma"===t){let n=Pe(r,"shape");if(!_o(n))return Promise.reject("opt.shape is not a number");let o=Pe(r,"scale");if(!_o(o))return Promise.reject("opt.scale is not a number");e=()=>ko[t].sample(n,o)}else if("kumaraswamy"===t){let n=Pe(r,"alpha");if(!_o(n))return Promise.reject("opt.alpha is not a number");let o=Pe(r,"beta");if(!_o(o))return Promise.reject("opt.beta is not a number");e=()=>ko[t].sample(n,o)}else if("lognormal"===t){let n=Pe(r,"mu");if(!_o(n))return Promise.reject("opt.mu is not a number");let o=Pe(r,"sigma");if(!_o(o))return Promise.reject("opt.sigma is not a number");e=()=>ko[t].sample(n,o)}else if("normal"===t){let n=Pe(r,"mu");if(!_o(n))return Promise.reject("opt.mu is not a number");let o=Pe(r,"sigma");if(!_o(o))return Promise.reject("opt.sigma is not a number");e=()=>ko[t].sample(n,o)}else{if("pareto"===t)return Promise.reject("invalid pareto.sample");if("studentt"===t){let n=Pe(r,"dof");if(!_o(n))return Promise.reject("opt.dof is not a number");e=()=>ko[t].sample(n)}else{if("tukey"===t)return Promise.reject("invalid tukey.sample");if("weibull"===t){let n=Pe(r,"scale");if(!_o(n))return Promise.reject("opt.scale is not a number");let o=Pe(r,"shape");if(!_o(o))return Promise.reject("opt.shape is not a number");e=()=>ko[t].sample(n,o)}else if("uniform"===t){let n=Pe(r,"a");if(!_o(n))return Promise.reject("opt.a is not a number");let o=Pe(r,"b");if(!_o(o))return Promise.reject("opt.b is not a number");e=()=>ko[t].sample(n,o)}else{if("binomial"===t)return Promise.reject("invalid binomial.sample");if("negbin"===t)return Promise.reject("invalid negbin.sample");if("hypgeom"===t)return Promise.reject("invalid hypgeom.sample");if("poisson"===t){let n=Pe(r,"l");if(!_o(n))return Promise.reject("opt.l is not a number");e=()=>ko[t].sample(n)}else if("triangular"===t){let n=Pe(r,"a");if(!_o(n))return Promise.reject("opt.a is not a number");let o=Pe(r,"b");if(!_o(o))return Promise.reject("opt.b is not a number");let i=Pe(r,"c");if(!_o(i))return Promise.reject("opt.c is not a number");e=()=>ko[t].sample(n,o,i)}else{if("arcsine"!==t)return Promise.reject(`invalid name[${t}]`);{let n=Pe(r,"a");if(!_o(n))return Promise.reject("opt.a is not a number");let o=Pe(r,"b");if(!_o(o))return Promise.reject("opt.b is not a number");e=()=>ko[t].sample(n,o)}}}}}let n=Pe(r,"num");n=zo(n),n<=0&&(n=1);let o=Pe(r,"low");o=io(o)?yo(o):null;let i=Pe(r,"up");if(i=io(i)?yo(i):null,null!==o&&null!==i&&o>=i)throw new Error(`low[${o}] >= up[${i}]`);let s=()=>{let t=e();return null!==o&&t<o&&(t=s()),null!==i&&t>i&&(t=s()),t},a=De(function(t,r){if((t=No(t))<1||t>ou)return[];var e=iu,n=su(t,iu);r=Lo(r),t-=iu;for(var o=br(n,r);++e<t;)r(e);return o}(n),(()=>s()));return 1===n&&(a=a[0]),a},t.simpleStatistics=Bs,t.studentTInv=Vo}));
//# sourceMappingURL=w-statistic.umd.js.map
