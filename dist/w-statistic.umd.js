/*!
 * w-statistic v1.0.8
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(r,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((r="undefined"!=typeof globalThis?globalThis:r||self)["w-statistic"]={})}(this,(function(r){"use strict";var n=Object.prototype;var t=function(r){var t=r&&r.constructor;return r===("function"==typeof t&&t.prototype||n)};var e=function(r,n){return function(t){return r(n(t))}},o=e(Object.keys,Object),a=Object.prototype.hasOwnProperty;var u=function(r){if(!t(r))return o(r);var n=[];for(var e in Object(r))a.call(r,e)&&"constructor"!=e&&n.push(e);return n};function i(r){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},i(r)}var f="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function c(r){var n={exports:{}};return r(n,n.exports),n.exports}var s="object"==i(f)&&f&&f.Object===Object&&f,l="object"==("undefined"==typeof self?"undefined":i(self))&&self&&self.Object===Object&&self,h=s||l||Function("return this")(),p=h.Symbol,v=Object.prototype,d=v.hasOwnProperty,m=v.toString,g=p?p.toStringTag:void 0;var b=function(r){var n=d.call(r,g),t=r[g];try{r[g]=void 0;var e=!0}catch(r){}var o=m.call(r);return e&&(n?r[g]=t:delete r[g]),o},y=Object.prototype.toString;var w=function(r){return y.call(r)},x=p?p.toStringTag:void 0;var j=function(r){return null==r?void 0===r?"[object Undefined]":"[object Null]":x&&x in Object(r)?b(r):w(r)};var _=function(r){var n=i(r);return null!=r&&("object"==n||"function"==n)};var M,k=function(r){if(!_(r))return!1;var n=j(r);return"[object Function]"==n||"[object GeneratorFunction]"==n||"[object AsyncFunction]"==n||"[object Proxy]"==n},q=h["__core-js_shared__"],A=(M=/[^.]+$/.exec(q&&q.keys&&q.keys.IE_PROTO||""))?"Symbol(src)_1."+M:"";var P=function(r){return!!A&&A in r},E=Function.prototype.toString;var O=function(r){if(null!=r){try{return E.call(r)}catch(r){}try{return r+""}catch(r){}}return""},S=/^\[object .+?Constructor\]$/,N=Function.prototype,I=Object.prototype,T=N.toString,F=I.hasOwnProperty,z=RegExp("^"+T.call(F).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var L=function(r){return!(!_(r)||P(r))&&(k(r)?z:S).test(O(r))};var R=function(r,n){return null==r?void 0:r[n]};var C=function(r,n){var t=R(r,n);return L(t)?t:void 0},D=C(h,"DataView"),G=C(h,"Map"),U=C(h,"Promise"),B=C(h,"Set"),V=C(h,"WeakMap"),W="[object Map]",$="[object Promise]",X="[object Set]",Y="[object WeakMap]",H="[object DataView]",Q=O(D),K=O(G),Z=O(U),J=O(B),rr=O(V),nr=j;(D&&nr(new D(new ArrayBuffer(1)))!=H||G&&nr(new G)!=W||U&&nr(U.resolve())!=$||B&&nr(new B)!=X||V&&nr(new V)!=Y)&&(nr=function(r){var n=j(r),t="[object Object]"==n?r.constructor:void 0,e=t?O(t):"";if(e)switch(e){case Q:return H;case K:return W;case Z:return $;case J:return X;case rr:return Y}return n});var tr=nr;var er=function(r){return"number"==typeof r&&r>-1&&r%1==0&&r<=9007199254740991};var or=function(r){return null!=r&&er(r.length)&&!k(r)},ar=Array.isArray;var ur=function(r){return null!=r&&"object"==i(r)};var ir=function(r){return"string"==typeof r||!ar(r)&&ur(r)&&"[object String]"==j(r)};var fr=function(r){return function(n){return null==n?void 0:n[r]}},cr=fr("length"),sr=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var lr=function(r){return sr.test(r)},hr="[\\ud800-\\udfff]",pr="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",vr="\\ud83c[\\udffb-\\udfff]",dr="[^\\ud800-\\udfff]",mr="(?:\\ud83c[\\udde6-\\uddff]){2}",gr="[\\ud800-\\udbff][\\udc00-\\udfff]",br="(?:"+pr+"|"+vr+")"+"?",yr="[\\ufe0e\\ufe0f]?",wr=yr+br+("(?:\\u200d(?:"+[dr,mr,gr].join("|")+")"+yr+br+")*"),xr="(?:"+[dr+pr+"?",pr,mr,gr,hr].join("|")+")",jr=RegExp(vr+"(?="+vr+")|"+xr+wr,"g");var _r=function(r){for(var n=jr.lastIndex=0;jr.test(r);)++n;return n};var Mr=function(r){return lr(r)?_r(r):cr(r)};var kr=function(r){if(null==r)return 0;if(or(r))return ir(r)?Mr(r):r.length;var n=tr(r);return"[object Map]"==n||"[object Set]"==n?r.size:u(r).length};var qr=function(r,n){for(var t,e=-1,o=r.length;++e<o;){var a=n(r[e]);void 0!==a&&(t=void 0===t?a:t+a)}return t};var Ar=function(r,n){var t=null==r?0:r.length;return t?qr(r,n)/t:NaN};var Pr=function(r){return r};var Er=function(r){return Ar(r,Pr)};function Or(r){return"[object Array]"===Object.prototype.toString.call(r)}var Sr=function(r,n){for(var t=-1,e=null==r?0:r.length,o=Array(e);++t<e;)o[t]=n(r[t],t,r);return o};var Nr=function(){this.__data__=[],this.size=0};var Ir=function(r,n){return r===n||r!=r&&n!=n};var Tr=function(r,n){for(var t=r.length;t--;)if(Ir(r[t][0],n))return t;return-1},Fr=Array.prototype.splice;var zr=function(r){var n=this.__data__,t=Tr(n,r);return!(t<0)&&(t==n.length-1?n.pop():Fr.call(n,t,1),--this.size,!0)};var Lr=function(r){var n=this.__data__,t=Tr(n,r);return t<0?void 0:n[t][1]};var Rr=function(r){return Tr(this.__data__,r)>-1};var Cr=function(r,n){var t=this.__data__,e=Tr(t,r);return e<0?(++this.size,t.push([r,n])):t[e][1]=n,this};function Dr(r){var n=-1,t=null==r?0:r.length;for(this.clear();++n<t;){var e=r[n];this.set(e[0],e[1])}}Dr.prototype.clear=Nr,Dr.prototype.delete=zr,Dr.prototype.get=Lr,Dr.prototype.has=Rr,Dr.prototype.set=Cr;var Gr=Dr;var Ur=function(){this.__data__=new Gr,this.size=0};var Br=function(r){var n=this.__data__,t=n.delete(r);return this.size=n.size,t};var Vr=function(r){return this.__data__.get(r)};var Wr=function(r){return this.__data__.has(r)},$r=C(Object,"create");var Xr=function(){this.__data__=$r?$r(null):{},this.size=0};var Yr=function(r){var n=this.has(r)&&delete this.__data__[r];return this.size-=n?1:0,n},Hr=Object.prototype.hasOwnProperty;var Qr=function(r){var n=this.__data__;if($r){var t=n[r];return"__lodash_hash_undefined__"===t?void 0:t}return Hr.call(n,r)?n[r]:void 0},Kr=Object.prototype.hasOwnProperty;var Zr=function(r){var n=this.__data__;return $r?void 0!==n[r]:Kr.call(n,r)};var Jr=function(r,n){var t=this.__data__;return this.size+=this.has(r)?0:1,t[r]=$r&&void 0===n?"__lodash_hash_undefined__":n,this};function rn(r){var n=-1,t=null==r?0:r.length;for(this.clear();++n<t;){var e=r[n];this.set(e[0],e[1])}}rn.prototype.clear=Xr,rn.prototype.delete=Yr,rn.prototype.get=Qr,rn.prototype.has=Zr,rn.prototype.set=Jr;var nn=rn;var tn=function(){this.size=0,this.__data__={hash:new nn,map:new(G||Gr),string:new nn}};var en=function(r){var n=i(r);return"string"==n||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r};var on=function(r,n){var t=r.__data__;return en(n)?t["string"==typeof n?"string":"hash"]:t.map};var an=function(r){var n=on(this,r).delete(r);return this.size-=n?1:0,n};var un=function(r){return on(this,r).get(r)};var fn=function(r){return on(this,r).has(r)};var cn=function(r,n){var t=on(this,r),e=t.size;return t.set(r,n),this.size+=t.size==e?0:1,this};function sn(r){var n=-1,t=null==r?0:r.length;for(this.clear();++n<t;){var e=r[n];this.set(e[0],e[1])}}sn.prototype.clear=tn,sn.prototype.delete=an,sn.prototype.get=un,sn.prototype.has=fn,sn.prototype.set=cn;var ln=sn;var hn=function(r,n){var t=this.__data__;if(t instanceof Gr){var e=t.__data__;if(!G||e.length<199)return e.push([r,n]),this.size=++t.size,this;t=this.__data__=new ln(e)}return t.set(r,n),this.size=t.size,this};function pn(r){var n=this.__data__=new Gr(r);this.size=n.size}pn.prototype.clear=Ur,pn.prototype.delete=Br,pn.prototype.get=Vr,pn.prototype.has=Wr,pn.prototype.set=hn;var vn=pn;var dn=function(r){return this.__data__.set(r,"__lodash_hash_undefined__"),this};var mn=function(r){return this.__data__.has(r)};function gn(r){var n=-1,t=null==r?0:r.length;for(this.__data__=new ln;++n<t;)this.add(r[n])}gn.prototype.add=gn.prototype.push=dn,gn.prototype.has=mn;var bn=gn;var yn=function(r,n){for(var t=-1,e=null==r?0:r.length;++t<e;)if(n(r[t],t,r))return!0;return!1};var wn=function(r,n){return r.has(n)};var xn=function(r,n,t,e,o,a){var u=1&t,i=r.length,f=n.length;if(i!=f&&!(u&&f>i))return!1;var c=a.get(r),s=a.get(n);if(c&&s)return c==n&&s==r;var l=-1,h=!0,p=2&t?new bn:void 0;for(a.set(r,n),a.set(n,r);++l<i;){var v=r[l],d=n[l];if(e)var m=u?e(d,v,l,n,r,a):e(v,d,l,r,n,a);if(void 0!==m){if(m)continue;h=!1;break}if(p){if(!yn(n,(function(r,n){if(!wn(p,n)&&(v===r||o(v,r,t,e,a)))return p.push(n)}))){h=!1;break}}else if(v!==d&&!o(v,d,t,e,a)){h=!1;break}}return a.delete(r),a.delete(n),h},jn=h.Uint8Array;var _n=function(r){var n=-1,t=Array(r.size);return r.forEach((function(r,e){t[++n]=[e,r]})),t};var Mn=function(r){var n=-1,t=Array(r.size);return r.forEach((function(r){t[++n]=r})),t},kn=p?p.prototype:void 0,qn=kn?kn.valueOf:void 0;var An=function(r,n,t,e,o,a,u){switch(t){case"[object DataView]":if(r.byteLength!=n.byteLength||r.byteOffset!=n.byteOffset)return!1;r=r.buffer,n=n.buffer;case"[object ArrayBuffer]":return!(r.byteLength!=n.byteLength||!a(new jn(r),new jn(n)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Ir(+r,+n);case"[object Error]":return r.name==n.name&&r.message==n.message;case"[object RegExp]":case"[object String]":return r==n+"";case"[object Map]":var i=_n;case"[object Set]":var f=1&e;if(i||(i=Mn),r.size!=n.size&&!f)return!1;var c=u.get(r);if(c)return c==n;e|=2,u.set(r,n);var s=xn(i(r),i(n),e,o,a,u);return u.delete(r),s;case"[object Symbol]":if(qn)return qn.call(r)==qn.call(n)}return!1};var Pn=function(r,n){for(var t=-1,e=n.length,o=r.length;++t<e;)r[o+t]=n[t];return r};var En=function(r,n,t){var e=n(r);return ar(r)?e:Pn(e,t(r))};var On=function(r,n){for(var t=-1,e=null==r?0:r.length,o=0,a=[];++t<e;){var u=r[t];n(u,t,r)&&(a[o++]=u)}return a};var Sn=function(){return[]},Nn=Object.prototype.propertyIsEnumerable,In=Object.getOwnPropertySymbols,Tn=In?function(r){return null==r?[]:(r=Object(r),On(In(r),(function(n){return Nn.call(r,n)})))}:Sn;var Fn=function(r,n){for(var t=-1,e=Array(r);++t<r;)e[t]=n(t);return e};var zn=function(r){return ur(r)&&"[object Arguments]"==j(r)},Ln=Object.prototype,Rn=Ln.hasOwnProperty,Cn=Ln.propertyIsEnumerable,Dn=zn(function(){return arguments}())?zn:function(r){return ur(r)&&Rn.call(r,"callee")&&!Cn.call(r,"callee")},Gn=Dn;var Un=function(){return!1},Bn=c((function(r,n){var t=n&&!n.nodeType&&n,e=t&&r&&!r.nodeType&&r,o=e&&e.exports===t?h.Buffer:void 0,a=(o?o.isBuffer:void 0)||Un;r.exports=a})),Vn=/^(?:0|[1-9]\d*)$/;var Wn=function(r,n){var t=i(r);return!!(n=null==n?9007199254740991:n)&&("number"==t||"symbol"!=t&&Vn.test(r))&&r>-1&&r%1==0&&r<n},$n={};$n["[object Float32Array]"]=$n["[object Float64Array]"]=$n["[object Int8Array]"]=$n["[object Int16Array]"]=$n["[object Int32Array]"]=$n["[object Uint8Array]"]=$n["[object Uint8ClampedArray]"]=$n["[object Uint16Array]"]=$n["[object Uint32Array]"]=!0,$n["[object Arguments]"]=$n["[object Array]"]=$n["[object ArrayBuffer]"]=$n["[object Boolean]"]=$n["[object DataView]"]=$n["[object Date]"]=$n["[object Error]"]=$n["[object Function]"]=$n["[object Map]"]=$n["[object Number]"]=$n["[object Object]"]=$n["[object RegExp]"]=$n["[object Set]"]=$n["[object String]"]=$n["[object WeakMap]"]=!1;var Xn=function(r){return ur(r)&&er(r.length)&&!!$n[j(r)]};var Yn=function(r){return function(n){return r(n)}},Hn=c((function(r,n){var t=n&&!n.nodeType&&n,e=t&&r&&!r.nodeType&&r,o=e&&e.exports===t&&s.process,a=function(){try{var r=e&&e.require&&e.require("util").types;return r||o&&o.binding&&o.binding("util")}catch(r){}}();r.exports=a})),Qn=Hn&&Hn.isTypedArray,Kn=Qn?Yn(Qn):Xn,Zn=Object.prototype.hasOwnProperty;var Jn=function(r,n){var t=ar(r),e=!t&&Gn(r),o=!t&&!e&&Bn(r),a=!t&&!e&&!o&&Kn(r),u=t||e||o||a,i=u?Fn(r.length,String):[],f=i.length;for(var c in r)!n&&!Zn.call(r,c)||u&&("length"==c||o&&("offset"==c||"parent"==c)||a&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Wn(c,f))||i.push(c);return i};var rt=function(r){return or(r)?Jn(r):u(r)};var nt=function(r){return En(r,rt,Tn)},tt=Object.prototype.hasOwnProperty;var et=function(r,n,t,e,o,a){var u=1&t,i=nt(r),f=i.length;if(f!=nt(n).length&&!u)return!1;for(var c=f;c--;){var s=i[c];if(!(u?s in n:tt.call(n,s)))return!1}var l=a.get(r),h=a.get(n);if(l&&h)return l==n&&h==r;var p=!0;a.set(r,n),a.set(n,r);for(var v=u;++c<f;){var d=r[s=i[c]],m=n[s];if(e)var g=u?e(m,d,s,n,r,a):e(d,m,s,r,n,a);if(!(void 0===g?d===m||o(d,m,t,e,a):g)){p=!1;break}v||(v="constructor"==s)}if(p&&!v){var b=r.constructor,y=n.constructor;b==y||!("constructor"in r)||!("constructor"in n)||"function"==typeof b&&b instanceof b&&"function"==typeof y&&y instanceof y||(p=!1)}return a.delete(r),a.delete(n),p},ot="[object Arguments]",at="[object Array]",ut="[object Object]",it=Object.prototype.hasOwnProperty;var ft=function(r,n,t,e,o,a){var u=ar(r),i=ar(n),f=u?at:tr(r),c=i?at:tr(n),s=(f=f==ot?ut:f)==ut,l=(c=c==ot?ut:c)==ut,h=f==c;if(h&&Bn(r)){if(!Bn(n))return!1;u=!0,s=!1}if(h&&!s)return a||(a=new vn),u||Kn(r)?xn(r,n,t,e,o,a):An(r,n,f,t,e,o,a);if(!(1&t)){var p=s&&it.call(r,"__wrapped__"),v=l&&it.call(n,"__wrapped__");if(p||v){var d=p?r.value():r,m=v?n.value():n;return a||(a=new vn),o(d,m,t,e,a)}}return!!h&&(a||(a=new vn),et(r,n,t,e,o,a))};var ct=function r(n,t,e,o,a){return n===t||(null==n||null==t||!ur(n)&&!ur(t)?n!=n&&t!=t:ft(n,t,e,o,r,a))};var st=function(r,n,t,e){var o=t.length,a=o,u=!e;if(null==r)return!a;for(r=Object(r);o--;){var i=t[o];if(u&&i[2]?i[1]!==r[i[0]]:!(i[0]in r))return!1}for(;++o<a;){var f=(i=t[o])[0],c=r[f],s=i[1];if(u&&i[2]){if(void 0===c&&!(f in r))return!1}else{var l=new vn;if(e)var h=e(c,s,f,r,n,l);if(!(void 0===h?ct(s,c,3,e,l):h))return!1}}return!0};var lt=function(r){return r==r&&!_(r)};var ht=function(r){for(var n=rt(r),t=n.length;t--;){var e=n[t],o=r[e];n[t]=[e,o,lt(o)]}return n};var pt=function(r,n){return function(t){return null!=t&&(t[r]===n&&(void 0!==n||r in Object(t)))}};var vt=function(r){var n=ht(r);return 1==n.length&&n[0][2]?pt(n[0][0],n[0][1]):function(t){return t===r||st(t,r,n)}};var dt=function(r){return"symbol"==i(r)||ur(r)&&"[object Symbol]"==j(r)},mt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,gt=/^\w*$/;var bt=function(r,n){if(ar(r))return!1;var t=i(r);return!("number"!=t&&"symbol"!=t&&"boolean"!=t&&null!=r&&!dt(r))||(gt.test(r)||!mt.test(r)||null!=n&&r in Object(n))};function yt(r,n){if("function"!=typeof r||null!=n&&"function"!=typeof n)throw new TypeError("Expected a function");var t=function t(){var e=arguments,o=n?n.apply(this,e):e[0],a=t.cache;if(a.has(o))return a.get(o);var u=r.apply(this,e);return t.cache=a.set(o,u)||a,u};return t.cache=new(yt.Cache||ln),t}yt.Cache=ln;var wt=yt;var xt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,jt=/\\(\\)?/g,_t=function(r){var n=wt(r,(function(r){return 500===t.size&&t.clear(),r})),t=n.cache;return n}((function(r){var n=[];return 46===r.charCodeAt(0)&&n.push(""),r.replace(xt,(function(r,t,e,o){n.push(e?o.replace(jt,"$1"):t||r)})),n})),Mt=p?p.prototype:void 0,kt=Mt?Mt.toString:void 0;var qt=function r(n){if("string"==typeof n)return n;if(ar(n))return Sr(n,r)+"";if(dt(n))return kt?kt.call(n):"";var t=n+"";return"0"==t&&1/n==-Infinity?"-0":t};var At=function(r){return null==r?"":qt(r)};var Pt=function(r,n){return ar(r)?r:bt(r,n)?[r]:_t(At(r))};var Et=function(r){if("string"==typeof r||dt(r))return r;var n=r+"";return"0"==n&&1/r==-Infinity?"-0":n};var Ot=function(r,n){for(var t=0,e=(n=Pt(n,r)).length;null!=r&&t<e;)r=r[Et(n[t++])];return t&&t==e?r:void 0};var St=function(r,n,t){var e=null==r?void 0:Ot(r,n);return void 0===e?t:e};var Nt=function(r,n){return null!=r&&n in Object(r)};var It=function(r,n,t){for(var e=-1,o=(n=Pt(n,r)).length,a=!1;++e<o;){var u=Et(n[e]);if(!(a=null!=r&&t(r,u)))break;r=r[u]}return a||++e!=o?a:!!(o=null==r?0:r.length)&&er(o)&&Wn(u,o)&&(ar(r)||Gn(r))};var Tt=function(r,n){return null!=r&&It(r,n,Nt)};var Ft=function(r,n){return bt(r)&&lt(n)?pt(Et(r),n):function(t){var e=St(t,r);return void 0===e&&e===n?Tt(t,r):ct(n,e,3)}};var zt=function(r){return function(n){return Ot(n,r)}};var Lt=function(r){return bt(r)?fr(Et(r)):zt(r)};var Rt=function(r){return"function"==typeof r?r:null==r?Pr:"object"==i(r)?ar(r)?Ft(r[0],r[1]):vt(r):Lt(r)};var Ct=function(r){return function(n,t,e){for(var o=-1,a=Object(n),u=e(n),i=u.length;i--;){var f=u[r?i:++o];if(!1===t(a[f],f,a))break}return n}}();var Dt=function(r,n){return function(t,e){if(null==t)return t;if(!or(t))return r(t,e);for(var o=t.length,a=n?o:-1,u=Object(t);(n?a--:++a<o)&&!1!==e(u[a],a,u););return t}}((function(r,n){return r&&Ct(r,n,rt)}));var Gt=function(r,n){var t=-1,e=or(r)?Array(r.length):[];return Dt(r,(function(r,o,a){e[++t]=n(r,o,a)})),e};var Ut=function(r,n){return(ar(r)?Sr:Gt)(r,Rt(n))};var Bt=function(r,n){var t=[];return Dt(r,(function(r,e,o){n(r,e,o)&&t.push(r)})),t};var Vt=function(r,n){return(ar(r)?On:Bt)(r,Rt(n))};var Wt=function(r,n){for(var t=-1,e=null==r?0:r.length;++t<e&&!1!==n(r[t],t,r););return r},$t=function(){try{var r=C(Object,"defineProperty");return r({},"",{}),r}catch(r){}}();var Xt=function(r,n,t){"__proto__"==n&&$t?$t(r,n,{configurable:!0,enumerable:!0,value:t,writable:!0}):r[n]=t},Yt=Object.prototype.hasOwnProperty;var Ht=function(r,n,t){var e=r[n];Yt.call(r,n)&&Ir(e,t)&&(void 0!==t||n in r)||Xt(r,n,t)};var Qt=function(r,n,t,e){var o=!t;t||(t={});for(var a=-1,u=n.length;++a<u;){var i=n[a],f=e?e(t[i],r[i],i,t,r):void 0;void 0===f&&(f=r[i]),o?Xt(t,i,f):Ht(t,i,f)}return t};var Kt=function(r,n){return r&&Qt(n,rt(n),r)};var Zt=function(r){var n=[];if(null!=r)for(var t in Object(r))n.push(t);return n},Jt=Object.prototype.hasOwnProperty;var re=function(r){if(!_(r))return Zt(r);var n=t(r),e=[];for(var o in r)("constructor"!=o||!n&&Jt.call(r,o))&&e.push(o);return e};var ne=function(r){return or(r)?Jn(r,!0):re(r)};var te=function(r,n){return r&&Qt(n,ne(n),r)},ee=c((function(r,n){var t=n&&!n.nodeType&&n,e=t&&r&&!r.nodeType&&r,o=e&&e.exports===t?h.Buffer:void 0,a=o?o.allocUnsafe:void 0;r.exports=function(r,n){if(n)return r.slice();var t=r.length,e=a?a(t):new r.constructor(t);return r.copy(e),e}}));var oe=function(r,n){var t=-1,e=r.length;for(n||(n=Array(e));++t<e;)n[t]=r[t];return n};var ae=function(r,n){return Qt(r,Tn(r),n)},ue=e(Object.getPrototypeOf,Object),ie=Object.getOwnPropertySymbols?function(r){for(var n=[];r;)Pn(n,Tn(r)),r=ue(r);return n}:Sn;var fe=function(r,n){return Qt(r,ie(r),n)};var ce=function(r){return En(r,ne,ie)},se=Object.prototype.hasOwnProperty;var le=function(r){var n=r.length,t=new r.constructor(n);return n&&"string"==typeof r[0]&&se.call(r,"index")&&(t.index=r.index,t.input=r.input),t};var he=function(r){var n=new r.constructor(r.byteLength);return new jn(n).set(new jn(r)),n};var pe=function(r,n){var t=n?he(r.buffer):r.buffer;return new r.constructor(t,r.byteOffset,r.byteLength)},ve=/\w*$/;var de=function(r){var n=new r.constructor(r.source,ve.exec(r));return n.lastIndex=r.lastIndex,n},me=p?p.prototype:void 0,ge=me?me.valueOf:void 0;var be=function(r){return ge?Object(ge.call(r)):{}};var ye=function(r,n){var t=n?he(r.buffer):r.buffer;return new r.constructor(t,r.byteOffset,r.length)};var we=function(r,n,t){var e=r.constructor;switch(n){case"[object ArrayBuffer]":return he(r);case"[object Boolean]":case"[object Date]":return new e(+r);case"[object DataView]":return pe(r,t);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return ye(r,t);case"[object Map]":case"[object Set]":return new e;case"[object Number]":case"[object String]":return new e(r);case"[object RegExp]":return de(r);case"[object Symbol]":return be(r)}},xe=Object.create,je=function(){function r(){}return function(n){if(!_(n))return{};if(xe)return xe(n);r.prototype=n;var t=new r;return r.prototype=void 0,t}}();var _e=function(r){return"function"!=typeof r.constructor||t(r)?{}:je(ue(r))};var Me=function(r){return ur(r)&&"[object Map]"==tr(r)},ke=Hn&&Hn.isMap,qe=ke?Yn(ke):Me;var Ae=function(r){return ur(r)&&"[object Set]"==tr(r)},Pe=Hn&&Hn.isSet,Ee=Pe?Yn(Pe):Ae,Oe="[object Arguments]",Se="[object Function]",Ne="[object Object]",Ie={};Ie[Oe]=Ie["[object Array]"]=Ie["[object ArrayBuffer]"]=Ie["[object DataView]"]=Ie["[object Boolean]"]=Ie["[object Date]"]=Ie["[object Float32Array]"]=Ie["[object Float64Array]"]=Ie["[object Int8Array]"]=Ie["[object Int16Array]"]=Ie["[object Int32Array]"]=Ie["[object Map]"]=Ie["[object Number]"]=Ie[Ne]=Ie["[object RegExp]"]=Ie["[object Set]"]=Ie["[object String]"]=Ie["[object Symbol]"]=Ie["[object Uint8Array]"]=Ie["[object Uint8ClampedArray]"]=Ie["[object Uint16Array]"]=Ie["[object Uint32Array]"]=!0,Ie["[object Error]"]=Ie[Se]=Ie["[object WeakMap]"]=!1;var Te=function r(n,t,e,o,a,u){var i,f=1&t,c=2&t,s=4&t;if(e&&(i=a?e(n,o,a,u):e(n)),void 0!==i)return i;if(!_(n))return n;var l=ar(n);if(l){if(i=le(n),!f)return oe(n,i)}else{var h=tr(n),p=h==Se||"[object GeneratorFunction]"==h;if(Bn(n))return ee(n,f);if(h==Ne||h==Oe||p&&!a){if(i=c||p?{}:_e(n),!f)return c?fe(n,te(i,n)):ae(n,Kt(i,n))}else{if(!Ie[h])return a?n:{};i=we(n,h,f)}}u||(u=new vn);var v=u.get(n);if(v)return v;u.set(n,i),Ee(n)?n.forEach((function(o){i.add(r(o,t,e,o,n,u))})):qe(n)&&n.forEach((function(o,a){i.set(a,r(o,t,e,a,n,u))}));var d=l?void 0:(s?c?ce:nt:c?ne:rt)(n);return Wt(d||n,(function(o,a){d&&(o=n[a=o]),Ht(i,a,r(o,t,e,a,n,u))})),i};var Fe=function(r){return Te(r,5)};function ze(r){return"[object Object]"===Object.prototype.toString.call(r)}function Le(r){return"[object String]"===Object.prototype.toString.call(r)}function Re(r){return!!function(r){return"[object Undefined]"===Object.prototype.toString.call(r)}(r)||(!!function(r){return"[object Null]"===Object.prototype.toString.call(r)}(r)||(!!function(r){if(ze(r)){for(var n in r)return!1;return!0}return!1}(r)||(!!function(r){return!(!Le(r)||""!==r)}(r)||!!function(r){return!!Or(r)&&0===r.length}(r))))}function Ce(r){return!!Or(r)&&(0!==r.length&&(1!==r.length||!Re(r[0])))}function De(r){return!(!Le(r)||""===r)}function Ge(r){var n=!1;return De(r)?n=!isNaN(Number(r)):function(r){return"[object Number]"===Object.prototype.toString.call(r)}(r)&&(n=!0),n}var Ue=/\s/;var Be=function(r){for(var n=r.length;n--&&Ue.test(r.charAt(n)););return n},Ve=/^\s+/;var We=function(r){return r?r.slice(0,Be(r)+1).replace(Ve,""):r},$e=/^[-+]0x[0-9a-f]+$/i,Xe=/^0b[01]+$/i,Ye=/^0o[0-7]+$/i,He=parseInt;var Qe=function(r){if("number"==typeof r)return r;if(dt(r))return NaN;if(_(r)){var n="function"==typeof r.valueOf?r.valueOf():r;r=_(n)?n+"":n}if("string"!=typeof r)return 0===r?r:+r;r=We(r);var t=Xe.test(r);return t||Ye.test(r)?He(r.slice(2),t?2:8):$e.test(r)?NaN:+r},Ke=1/0;var Ze=function(r){return r?(r=Qe(r))===Ke||r===-1/0?17976931348623157e292*(r<0?-1:1):r==r?r:0:0===r?r:0};function Je(r){return Ge(r)?Ze(r):0}function ro(r){return Ce(r)?(r=Fe(r),r=Vt(r,Ge),r=Ut(r,Je)):[]}function no(r){if(!Or(r))return null;if(0===kr(r))return null;var n=ro(r);return 0===kr(n)?null:Er(n)}function to(r,n,t,e,o,a,u){try{var i=r[a](u),f=i.value}catch(r){return void t(r)}i.done?n(f):Promise.resolve(f).then(e,o)}function eo(r){return function(){var n=this,t=arguments;return new Promise((function(e,o){var a=r.apply(n,t);function u(r){to(a,e,o,u,i,"next",r)}function i(r){to(a,e,o,u,i,"throw",r)}u(void 0)}))}}var oo=c((function(r){var n=function(r){var n,t=Object.prototype,e=t.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",f=o.toStringTag||"@@toStringTag";function c(r,n,t){return Object.defineProperty(r,n,{value:t,enumerable:!0,configurable:!0,writable:!0}),r[n]}try{c({},"")}catch(r){c=function(r,n,t){return r[n]=t}}function s(r,n,t,e){var o=n&&n.prototype instanceof g?n:g,a=Object.create(o.prototype),u=new E(e||[]);return a._invoke=function(r,n,t){var e=h;return function(o,a){if(e===v)throw new Error("Generator is already running");if(e===d){if("throw"===o)throw a;return S()}for(t.method=o,t.arg=a;;){var u=t.delegate;if(u){var i=q(u,t);if(i){if(i===m)continue;return i}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if(e===h)throw e=d,t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);e=v;var f=l(r,n,t);if("normal"===f.type){if(e=t.done?d:p,f.arg===m)continue;return{value:f.arg,done:t.done}}"throw"===f.type&&(e=d,t.method="throw",t.arg=f.arg)}}}(r,t,u),a}function l(r,n,t){try{return{type:"normal",arg:r.call(n,t)}}catch(r){return{type:"throw",arg:r}}}r.wrap=s;var h="suspendedStart",p="suspendedYield",v="executing",d="completed",m={};function g(){}function b(){}function y(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,j=x&&x(x(O([])));j&&j!==t&&e.call(j,a)&&(w=j);var _=y.prototype=g.prototype=Object.create(w);function M(r){["next","throw","return"].forEach((function(n){c(r,n,(function(r){return this._invoke(n,r)}))}))}function k(r,n){function t(o,a,u,f){var c=l(r[o],r,a);if("throw"!==c.type){var s=c.arg,h=s.value;return h&&"object"===i(h)&&e.call(h,"__await")?n.resolve(h.__await).then((function(r){t("next",r,u,f)}),(function(r){t("throw",r,u,f)})):n.resolve(h).then((function(r){s.value=r,u(s)}),(function(r){return t("throw",r,u,f)}))}f(c.arg)}var o;this._invoke=function(r,e){function a(){return new n((function(n,o){t(r,e,n,o)}))}return o=o?o.then(a,a):a()}}function q(r,t){var e=r.iterator[t.method];if(e===n){if(t.delegate=null,"throw"===t.method){if(r.iterator.return&&(t.method="return",t.arg=n,q(r,t),"throw"===t.method))return m;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var o=l(e,r.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,m;var a=o.arg;return a?a.done?(t[r.resultName]=a.value,t.next=r.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,m):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function A(r){var n={tryLoc:r[0]};1 in r&&(n.catchLoc=r[1]),2 in r&&(n.finallyLoc=r[2],n.afterLoc=r[3]),this.tryEntries.push(n)}function P(r){var n=r.completion||{};n.type="normal",delete n.arg,r.completion=n}function E(r){this.tryEntries=[{tryLoc:"root"}],r.forEach(A,this),this.reset(!0)}function O(r){if(r){var t=r[a];if(t)return t.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,u=function t(){for(;++o<r.length;)if(e.call(r,o))return t.value=r[o],t.done=!1,t;return t.value=n,t.done=!0,t};return u.next=u}}return{next:S}}function S(){return{value:n,done:!0}}return b.prototype=y,c(_,"constructor",y),c(y,"constructor",b),b.displayName=c(y,f,"GeneratorFunction"),r.isGeneratorFunction=function(r){var n="function"==typeof r&&r.constructor;return!!n&&(n===b||"GeneratorFunction"===(n.displayName||n.name))},r.mark=function(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,y):(r.__proto__=y,c(r,f,"GeneratorFunction")),r.prototype=Object.create(_),r},r.awrap=function(r){return{__await:r}},M(k.prototype),c(k.prototype,u,(function(){return this})),r.AsyncIterator=k,r.async=function(n,t,e,o,a){void 0===a&&(a=Promise);var u=new k(s(n,t,e,o),a);return r.isGeneratorFunction(t)?u:u.next().then((function(r){return r.done?r.value:u.next()}))},M(_),c(_,f,"Generator"),c(_,a,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),r.keys=function(r){var n=[];for(var t in r)n.push(t);return n.reverse(),function t(){for(;n.length;){var e=n.pop();if(e in r)return t.value=e,t.done=!1,t}return t.done=!0,t}},r.values=O,E.prototype={constructor:E,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(P),!r)for(var t in this)"t"===t.charAt(0)&&e.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var r=this.tryEntries[0].completion;if("throw"===r.type)throw r.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var t=this;function o(e,o){return i.type="throw",i.arg=r,t.next=e,o&&(t.method="next",t.arg=n),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var u=this.tryEntries[a],i=u.completion;if("root"===u.tryLoc)return o("end");if(u.tryLoc<=this.prev){var f=e.call(u,"catchLoc"),c=e.call(u,"finallyLoc");if(f&&c){if(this.prev<u.catchLoc)return o(u.catchLoc,!0);if(this.prev<u.finallyLoc)return o(u.finallyLoc)}else if(f){if(this.prev<u.catchLoc)return o(u.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<u.finallyLoc)return o(u.finallyLoc)}}}},abrupt:function(r,n){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc<=this.prev&&e.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===r||"continue"===r)&&a.tryLoc<=n&&n<=a.finallyLoc&&(a=null);var u=a?a.completion:{};return u.type=r,u.arg=n,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(u)},complete:function(r,n){if("throw"===r.type)throw r.arg;return"break"===r.type||"continue"===r.type?this.next=r.arg:"return"===r.type?(this.rval=this.arg=r.arg,this.method="return",this.next="end"):"normal"===r.type&&n&&(this.next=n),m},finish:function(r){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.finallyLoc===r)return this.complete(t.completion,t.afterLoc),P(t),m}},catch:function(r){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.tryLoc===r){var e=t.completion;if("throw"===e.type){var o=e.arg;P(t)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(r,t,e){return this.delegate={iterator:O(r),resultName:t,nextLoc:e},"next"===this.method&&(this.arg=n),m}},r}(r.exports);try{regeneratorRuntime=n}catch(r){"object"===("undefined"==typeof globalThis?"undefined":i(globalThis))?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}})),ao=oo;function uo(r){return!!Ge(r)&&Je(r)>0}function io(r){return Ce(r)?(r=Fe(r),r=Vt(r,uo),r=Ut(r,Je)):[]}function fo(r){return Ce(r)?(r=io(r),r=Ut(r,Math.log)):[]}var co=function(r){return"number"==typeof r||ur(r)&&"[object Number]"==j(r)},so=c((function(r,n){r.exports=function(){var r=function(r,n){var t=Array.prototype.concat,e=Array.prototype.slice,o=Object.prototype.toString;function a(n,t){var e=n>t?n:t;return r.pow(10,17-~~(r.log(e>0?e:-e)*r.LOG10E))}var u=Array.isArray||function(r){return"[object Array]"===o.call(r)};function i(r){return"[object Function]"===o.call(r)}function f(r){return"number"==typeof r&&r-r==0}function c(r){return t.apply([],r)}function s(){return new s._init(arguments)}function l(){return 0}function h(){return 1}function p(r,n){return r===n?1:0}s.fn=s.prototype,s._init=function(r){if(u(r[0]))if(u(r[0][0])){i(r[1])&&(r[0]=s.map(r[0],r[1]));for(var n=0;n<r[0].length;n++)this[n]=r[0][n];this.length=r[0].length}else this[0]=i(r[1])?s.map(r[0],r[1]):r[0],this.length=1;else if(f(r[0]))this[0]=s.seq.apply(null,r),this.length=1;else{if(r[0]instanceof s)return s(r[0].toArray());this[0]=[],this.length=1}return this},s._init.prototype=s.prototype,s._init.constructor=s,s.utils={calcRdx:a,isArray:u,isFunction:i,isNumber:f,toVector:c},s._random_fn=r.random,s.setRandom=function(r){if("function"!=typeof r)throw new TypeError("fn is not a function");s._random_fn=r},s.extend=function(r){var n,t;if(1===arguments.length){for(t in r)s[t]=r[t];return this}for(n=1;n<arguments.length;n++)for(t in arguments[n])r[t]=arguments[n][t];return r},s.rows=function(r){return r.length||1},s.cols=function(r){return r[0].length||1},s.dimensions=function(r){return{rows:s.rows(r),cols:s.cols(r)}},s.row=function(r,n){return u(n)?n.map((function(n){return s.row(r,n)})):r[n]},s.rowa=function(r,n){return s.row(r,n)},s.col=function(r,n){if(u(n)){var t=s.arange(r.length).map((function(){return new Array(n.length)}));return n.forEach((function(n,e){s.arange(r.length).forEach((function(o){t[o][e]=r[o][n]}))})),t}for(var e=new Array(r.length),o=0;o<r.length;o++)e[o]=[r[o][n]];return e},s.cola=function(r,n){return s.col(r,n).map((function(r){return r[0]}))},s.diag=function(r){for(var n=s.rows(r),t=new Array(n),e=0;e<n;e++)t[e]=[r[e][e]];return t},s.antidiag=function(r){for(var n=s.rows(r)-1,t=new Array(n),e=0;n>=0;n--,e++)t[e]=[r[e][n]];return t},s.transpose=function(r){var n,t,e,o,a,i=[];for(u(r[0])||(r=[r]),t=r.length,e=r[0].length,a=0;a<e;a++){for(n=new Array(t),o=0;o<t;o++)n[o]=r[o][a];i.push(n)}return 1===i.length?i[0]:i},s.map=function(r,n,t){var e,o,a,i,f;for(u(r[0])||(r=[r]),o=r.length,a=r[0].length,i=t?r:new Array(o),e=0;e<o;e++)for(i[e]||(i[e]=new Array(a)),f=0;f<a;f++)i[e][f]=n(r[e][f],e,f);return 1===i.length?i[0]:i},s.cumreduce=function(r,n,t){var e,o,a,i,f;for(u(r[0])||(r=[r]),o=r.length,a=r[0].length,i=t?r:new Array(o),e=0;e<o;e++)for(i[e]||(i[e]=new Array(a)),a>0&&(i[e][0]=r[e][0]),f=1;f<a;f++)i[e][f]=n(i[e][f-1],r[e][f]);return 1===i.length?i[0]:i},s.alter=function(r,n){return s.map(r,n,!0)},s.create=function(r,n,t){var e,o,a=new Array(r);for(i(n)&&(t=n,n=r),e=0;e<r;e++)for(a[e]=new Array(n),o=0;o<n;o++)a[e][o]=t(e,o);return a},s.zeros=function(r,n){return f(n)||(n=r),s.create(r,n,l)},s.ones=function(r,n){return f(n)||(n=r),s.create(r,n,h)},s.rand=function(r,n){return f(n)||(n=r),s.create(r,n,s._random_fn)},s.identity=function(r,n){return f(n)||(n=r),s.create(r,n,p)},s.symmetric=function(r){var n,t,e=r.length;if(r.length!==r[0].length)return!1;for(n=0;n<e;n++)for(t=0;t<e;t++)if(r[t][n]!==r[n][t])return!1;return!0},s.clear=function(r){return s.alter(r,l)},s.seq=function(r,n,t,e){i(e)||(e=!1);var o,u=[],f=a(r,n),c=(n*f-r*f)/((t-1)*f),s=r;for(o=0;s<=n&&o<t;s=(r*f+c*f*++o)/f)u.push(e?e(s,o):s);return u},s.arange=function(r,t,e){var o,a=[];if(e=e||1,t===n&&(t=r,r=0),r===t||0===e)return[];if(r<t&&e<0)return[];if(r>t&&e>0)return[];if(e>0)for(o=r;o<t;o+=e)a.push(o);else for(o=r;o>t;o+=e)a.push(o);return a},s.slice=function(){function r(r,t,e,o){var a,u=[],i=r.length;if(t===n&&e===n&&o===n)return s.copy(r);if(o=o||1,(t=(t=t||0)>=0?t:i+t)===(e=(e=e||r.length)>=0?e:i+e)||0===o)return[];if(t<e&&o<0)return[];if(t>e&&o>0)return[];if(o>0)for(a=t;a<e;a+=o)u.push(r[a]);else for(a=t;a>e;a+=o)u.push(r[a]);return u}function t(n,t){var e,o;return f((t=t||{}).row)?f(t.col)?n[t.row][t.col]:r(s.rowa(n,t.row),(e=t.col||{}).start,e.end,e.step):f(t.col)?r(s.cola(n,t.col),(o=t.row||{}).start,o.end,o.step):(o=t.row||{},e=t.col||{},r(n,o.start,o.end,o.step).map((function(n){return r(n,e.start,e.end,e.step)})))}return t}(),s.sliceAssign=function(t,e,o){var a,u;if(f(e.row)){if(f(e.col))return t[e.row][e.col]=o;e.col=e.col||{},e.col.start=e.col.start||0,e.col.end=e.col.end||t[0].length,e.col.step=e.col.step||1,a=s.arange(e.col.start,r.min(t.length,e.col.end),e.col.step);var i=e.row;return a.forEach((function(r,n){t[i][r]=o[n]})),t}if(f(e.col)){e.row=e.row||{},e.row.start=e.row.start||0,e.row.end=e.row.end||t.length,e.row.step=e.row.step||1,u=s.arange(e.row.start,r.min(t[0].length,e.row.end),e.row.step);var c=e.col;return u.forEach((function(r,n){t[r][c]=o[n]})),t}return o[0].length===n&&(o=[o]),e.row.start=e.row.start||0,e.row.end=e.row.end||t.length,e.row.step=e.row.step||1,e.col.start=e.col.start||0,e.col.end=e.col.end||t[0].length,e.col.step=e.col.step||1,u=s.arange(e.row.start,r.min(t.length,e.row.end),e.row.step),a=s.arange(e.col.start,r.min(t[0].length,e.col.end),e.col.step),u.forEach((function(r,n){a.forEach((function(e,a){t[r][e]=o[n][a]}))})),t},s.diagonal=function(r){var n=s.zeros(r.length,r.length);return r.forEach((function(r,t){n[t][t]=r})),n},s.copy=function(r){return r.map((function(r){return f(r)?r:r.map((function(r){return r}))}))};var v=s.prototype;return v.length=0,v.push=Array.prototype.push,v.sort=Array.prototype.sort,v.splice=Array.prototype.splice,v.slice=Array.prototype.slice,v.toArray=function(){return this.length>1?e.call(this):e.call(this)[0]},v.map=function(r,n){return s(s.map(this,r,n))},v.cumreduce=function(r,n){return s(s.cumreduce(this,r,n))},v.alter=function(r){return s.alter(this,r),this},function(r){for(var n=0;n<r.length;n++)!function(r){v[r]=function(n){var t,e=this;return n?(setTimeout((function(){n.call(e,v[r].call(e))})),this):(t=s[r](this),u(t)?s(t):t)}}(r[n])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(r){for(var n=0;n<r.length;n++)!function(r){v[r]=function(n,t){var e=this;return t?(setTimeout((function(){t.call(e,v[r].call(e,n))})),this):s(s[r](this,n))}}(r[n])}("row col".split(" ")),function(r){for(var n=0;n<r.length;n++)!function(r){v[r]=function(){return s(s[r].apply(null,arguments))}}(r[n])}("create zeros ones rand identity".split(" ")),s}(Math);return function(r,n){var t=r.utils.isFunction;function e(r,n){return r-n}function o(r,t,e){return n.max(t,n.min(r,e))}r.sum=function(r){for(var n=0,t=r.length;--t>=0;)n+=r[t];return n},r.sumsqrd=function(r){for(var n=0,t=r.length;--t>=0;)n+=r[t]*r[t];return n},r.sumsqerr=function(n){for(var t,e=r.mean(n),o=0,a=n.length;--a>=0;)o+=(t=n[a]-e)*t;return o},r.sumrow=function(r){for(var n=0,t=r.length;--t>=0;)n+=r[t];return n},r.product=function(r){for(var n=1,t=r.length;--t>=0;)n*=r[t];return n},r.min=function(r){for(var n=r[0],t=0;++t<r.length;)r[t]<n&&(n=r[t]);return n},r.max=function(r){for(var n=r[0],t=0;++t<r.length;)r[t]>n&&(n=r[t]);return n},r.unique=function(r){for(var n={},t=[],e=0;e<r.length;e++)n[r[e]]||(n[r[e]]=!0,t.push(r[e]));return t},r.mean=function(n){return r.sum(n)/n.length},r.meansqerr=function(n){return r.sumsqerr(n)/n.length},r.geomean=function(t){return n.pow(r.product(t),1/t.length)},r.median=function(r){var n=r.length,t=r.slice().sort(e);return 1&n?t[n/2|0]:(t[n/2-1]+t[n/2])/2},r.cumsum=function(n){return r.cumreduce(n,(function(r,n){return r+n}))},r.cumprod=function(n){return r.cumreduce(n,(function(r,n){return r*n}))},r.diff=function(r){var n,t=[],e=r.length;for(n=1;n<e;n++)t.push(r[n]-r[n-1]);return t},r.rank=function(r){var n,t=[],o={};for(n=0;n<r.length;n++)o[f=r[n]]?o[f]++:(o[f]=1,t.push(f));var a=t.sort(e),u={},i=1;for(n=0;n<a.length;n++){var f,c=o[f=a[n]],s=(i+(i+c-1))/2;u[f]=s,i+=c}return r.map((function(r){return u[r]}))},r.mode=function(r){var n,t=r.length,o=r.slice().sort(e),a=1,u=0,i=0,f=[];for(n=0;n<t;n++)o[n]===o[n+1]?a++:(a>u?(f=[o[n]],u=a,i=0):a===u&&(f.push(o[n]),i++),a=1);return 0===i?f[0]:f},r.range=function(n){return r.max(n)-r.min(n)},r.variance=function(n,t){return r.sumsqerr(n)/(n.length-(t?1:0))},r.pooledvariance=function(n){return n.reduce((function(n,t){return n+r.sumsqerr(t)}),0)/(n.reduce((function(r,n){return r+n.length}),0)-n.length)},r.deviation=function(n){for(var t=r.mean(n),e=n.length,o=new Array(e),a=0;a<e;a++)o[a]=n[a]-t;return o},r.stdev=function(t,e){return n.sqrt(r.variance(t,e))},r.pooledstdev=function(t){return n.sqrt(r.pooledvariance(t))},r.meandev=function(t){for(var e=r.mean(t),o=[],a=t.length-1;a>=0;a--)o.push(n.abs(t[a]-e));return r.mean(o)},r.meddev=function(t){for(var e=r.median(t),o=[],a=t.length-1;a>=0;a--)o.push(n.abs(t[a]-e));return r.median(o)},r.coeffvar=function(n){return r.stdev(n)/r.mean(n)},r.quartiles=function(r){var t=r.length,o=r.slice().sort(e);return[o[n.round(t/4)-1],o[n.round(t/2)-1],o[n.round(3*t/4)-1]]},r.quantiles=function(r,t,a,u){var i,f,c,s,l,h=r.slice().sort(e),p=[t.length],v=r.length;for(void 0===a&&(a=3/8),void 0===u&&(u=3/8),i=0;i<t.length;i++)c=v*(f=t[i])+(a+f*(1-a-u)),s=n.floor(o(c,1,v-1)),l=o(c-s,0,1),p[i]=(1-l)*h[s-1]+l*h[s];return p},r.percentile=function(r,n,t){var o=r.slice().sort(e),a=n*(o.length+(t?1:-1))+(t?0:1),u=parseInt(a),i=a-u;return u+1<o.length?o[u-1]+i*(o[u]-o[u-1]):o[u-1]},r.percentileOfScore=function(r,n,t){var e,o,a=0,u=r.length,i=!1;for("strict"===t&&(i=!0),o=0;o<u;o++)e=r[o],(i&&e<n||!i&&e<=n)&&a++;return a/u},r.histogram=function(t,e){e=e||4;var o,a=r.min(t),u=(r.max(t)-a)/e,i=t.length,f=[];for(o=0;o<e;o++)f[o]=0;for(o=0;o<i;o++)f[n.min(n.floor((t[o]-a)/u),e-1)]+=1;return f},r.covariance=function(n,t){var e,o=r.mean(n),a=r.mean(t),u=n.length,i=new Array(u);for(e=0;e<u;e++)i[e]=(n[e]-o)*(t[e]-a);return r.sum(i)/(u-1)},r.corrcoeff=function(n,t){return r.covariance(n,t)/r.stdev(n,1)/r.stdev(t,1)},r.spearmancoeff=function(n,t){return n=r.rank(n),t=r.rank(t),r.corrcoeff(n,t)},r.stanMoment=function(t,e){for(var o=r.mean(t),a=r.stdev(t),u=t.length,i=0,f=0;f<u;f++)i+=n.pow((t[f]-o)/a,e);return i/t.length},r.skewness=function(n){return r.stanMoment(n,3)},r.kurtosis=function(n){return r.stanMoment(n,4)-3};var a=r.prototype;!function(n){for(var e=0;e<n.length;e++)!function(n){a[n]=function(e,o){var u=[],i=0,f=this;if(t(e)&&(o=e,e=!1),o)return setTimeout((function(){o.call(f,a[n].call(f,e))})),this;if(this.length>1){for(f=!0===e?this:this.transpose();i<f.length;i++)u[i]=r[n](f[i]);return u}return r[n](this[0],e)}}(n[e])}("cumsum cumprod".split(" ")),function(n){for(var e=0;e<n.length;e++)!function(n){a[n]=function(e,o){var u=[],i=0,f=this;if(t(e)&&(o=e,e=!1),o)return setTimeout((function(){o.call(f,a[n].call(f,e))})),this;if(this.length>1){for("sumrow"!==n&&(f=!0===e?this:this.transpose());i<f.length;i++)u[i]=r[n](f[i]);return!0===e?r[n](r.utils.toVector(u)):u}return r[n](this[0],e)}}(n[e])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(n){for(var e=0;e<n.length;e++)!function(n){a[n]=function(){var e,o=[],u=0,i=this,f=Array.prototype.slice.call(arguments);if(t(f[f.length-1])){e=f[f.length-1];var c=f.slice(0,f.length-1);return setTimeout((function(){e.call(i,a[n].apply(i,c))})),this}e=void 0;var s=function(t){return r[n].apply(i,[t].concat(f))};if(this.length>1){for(i=i.transpose();u<i.length;u++)o[u]=s(i[u]);return o}return s(this[0])}}(n[e])}("quantiles percentileOfScore".split(" "))}(r,Math),function(r,n){r.gammaln=function(r){var t,e,o,a=0,u=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],i=1.000000000190015;for(o=(e=t=r)+5.5,o-=(t+.5)*n.log(o);a<6;a++)i+=u[a]/++e;return n.log(2.5066282746310007*i/t)-o},r.loggam=function(r){var t,e,o,a,u,i,f,c=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(t=r,f=0,1==r||2==r)return 0;for(r<=7&&(t=r+(f=n.floor(7-r))),e=1/(t*t),o=2*n.PI,u=c[9],i=8;i>=0;i--)u*=e,u+=c[i];if(a=u/t+.5*n.log(o)+(t-.5)*n.log(t)-t,r<=7)for(i=1;i<=f;i++)a-=n.log(t-1),t-=1;return a},r.gammafn=function(r){var t,e,o,a,u=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],i=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],f=!1,c=0,s=0,l=0,h=r;if(r>171.6243769536076)return 1/0;if(h<=0){if(!(a=h%1+36e-17))return 1/0;f=(1&h?-1:1)*n.PI/n.sin(n.PI*a),h=1-h}for(o=h,e=h<1?h++:(h-=c=(0|h)-1)-1,t=0;t<8;++t)l=(l+u[t])*e,s=s*e+i[t];if(a=l/s+1,o<h)a/=o;else if(o>h)for(t=0;t<c;++t)a*=h,h++;return f&&(a=f/a),a},r.gammap=function(n,t){return r.lowRegGamma(n,t)*r.gammafn(n)},r.lowRegGamma=function(t,e){var o,a=r.gammaln(t),u=t,i=1/t,f=i,c=e+1-t,s=1/1e-30,l=1/c,h=l,p=1,v=-~(8.5*n.log(t>=1?t:1/t)+.4*t+17);if(e<0||t<=0)return NaN;if(e<t+1){for(;p<=v;p++)i+=f*=e/++u;return i*n.exp(-e+t*n.log(e)-a)}for(;p<=v;p++)h*=(l=1/(l=(o=-p*(p-t))*l+(c+=2)))*(s=c+o/s);return 1-h*n.exp(-e+t*n.log(e)-a)},r.factorialln=function(n){return n<0?NaN:r.gammaln(n+1)},r.factorial=function(n){return n<0?NaN:r.gammafn(n+1)},r.combination=function(t,e){return t>170||e>170?n.exp(r.combinationln(t,e)):r.factorial(t)/r.factorial(e)/r.factorial(t-e)},r.combinationln=function(n,t){return r.factorialln(n)-r.factorialln(t)-r.factorialln(n-t)},r.permutation=function(n,t){return r.factorial(n)/r.factorial(n-t)},r.betafn=function(t,e){if(!(t<=0||e<=0))return t+e>170?n.exp(r.betaln(t,e)):r.gammafn(t)*r.gammafn(e)/r.gammafn(t+e)},r.betaln=function(n,t){return r.gammaln(n)+r.gammaln(t)-r.gammaln(n+t)},r.betacf=function(r,t,e){var o,a,u,i,f=1e-30,c=1,s=t+e,l=t+1,h=t-1,p=1,v=1-s*r/l;for(n.abs(v)<f&&(v=f),i=v=1/v;c<=100&&(v=1+(a=c*(e-c)*r/((h+(o=2*c))*(t+o)))*v,n.abs(v)<f&&(v=f),p=1+a/p,n.abs(p)<f&&(p=f),i*=(v=1/v)*p,v=1+(a=-(t+c)*(s+c)*r/((t+o)*(l+o)))*v,n.abs(v)<f&&(v=f),p=1+a/p,n.abs(p)<f&&(p=f),i*=u=(v=1/v)*p,!(n.abs(u-1)<3e-7));c++);return i},r.gammapinv=function(t,e){var o,a,u,i,f,c,s=0,l=e-1,h=1e-8,p=r.gammaln(e);if(t>=1)return n.max(100,e+100*n.sqrt(e));if(t<=0)return 0;for(e>1?(f=n.log(l),c=n.exp(l*(f-1)-p),i=t<.5?t:1-t,o=(2.30753+.27061*(a=n.sqrt(-2*n.log(i))))/(1+a*(.99229+.04481*a))-a,t<.5&&(o=-o),o=n.max(.001,e*n.pow(1-1/(9*e)-o/(3*n.sqrt(e)),3))):o=t<(a=1-e*(.253+.12*e))?n.pow(t/a,1/e):1-n.log(1-(t-a)/(1-a));s<12;s++){if(o<=0)return 0;if((o-=a=(u=(r.lowRegGamma(e,o)-t)/(a=e>1?c*n.exp(-(o-l)+l*(n.log(o)-f)):n.exp(-o+l*n.log(o)-p)))/(1-.5*n.min(1,u*((e-1)/o-1))))<=0&&(o=.5*(o+a)),n.abs(a)<h*o)break}return o},r.erf=function(r){var t,e,o,a,u=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],i=u.length-1,f=!1,c=0,s=0;for(r<0&&(r=-r,f=!0),e=4*(t=2/(2+r))-2;i>0;i--)o=c,c=e*c-s+u[i],s=o;return a=t*n.exp(-r*r+.5*(u[0]+e*c)-s),f?a-1:1-a},r.erfc=function(n){return 1-r.erf(n)},r.erfcinv=function(t){var e,o,a,u,i=0;if(t>=2)return-100;if(t<=0)return 100;for(u=t<1?t:2-t,e=-.70711*((2.30753+.27061*(a=n.sqrt(-2*n.log(u/2))))/(1+a*(.99229+.04481*a))-a);i<2;i++)e+=(o=r.erfc(e)-u)/(1.1283791670955126*n.exp(-e*e)-e*o);return t<1?e:-e},r.ibetainv=function(t,e,o){var a,u,i,f,c,s,l,h,p,v,d=1e-8,m=e-1,g=o-1,b=0;if(t<=0)return 0;if(t>=1)return 1;for(e>=1&&o>=1?(i=t<.5?t:1-t,s=(2.30753+.27061*(f=n.sqrt(-2*n.log(i))))/(1+f*(.99229+.04481*f))-f,t<.5&&(s=-s),l=(s*s-3)/6,h=2/(1/(2*e-1)+1/(2*o-1)),p=s*n.sqrt(l+h)/h-(1/(2*o-1)-1/(2*e-1))*(l+5/6-2/(3*h)),s=e/(e+o*n.exp(2*p))):(a=n.log(e/(e+o)),u=n.log(o/(e+o)),s=t<(f=n.exp(e*a)/e)/(p=f+(c=n.exp(o*u)/o))?n.pow(e*p*t,1/e):1-n.pow(o*p*(1-t),1/o)),v=-r.gammaln(e)-r.gammaln(o)+r.gammaln(e+o);b<10;b++){if(0===s||1===s)return s;if((s-=f=(c=(r.ibeta(s,e,o)-t)/(f=n.exp(m*n.log(s)+g*n.log(1-s)+v)))/(1-.5*n.min(1,c*(m/s-g/(1-s)))))<=0&&(s=.5*(s+f)),s>=1&&(s=.5*(s+f+1)),n.abs(f)<d*s&&b>0)break}return s},r.ibeta=function(t,e,o){var a=0===t||1===t?0:n.exp(r.gammaln(e+o)-r.gammaln(e)-r.gammaln(o)+e*n.log(t)+o*n.log(1-t));return!(t<0||t>1)&&(t<(e+1)/(e+o+2)?a*r.betacf(t,e,o)/e:1-a*r.betacf(1-t,o,e)/o)},r.randn=function(t,e){var o,a,u,i,f;if(e||(e=t),t)return r.create(t,e,(function(){return r.randn()}));do{o=r._random_fn(),a=1.7156*(r._random_fn()-.5),f=(u=o-.449871)*u+(i=n.abs(a)+.386595)*(.196*i-.25472*u)}while(f>.27597&&(f>.27846||a*a>-4*n.log(o)*o*o));return a/o},r.randg=function(t,e,o){var a,u,i,f,c,s,l=t;if(o||(o=e),t||(t=1),e)return(s=r.zeros(e,o)).alter((function(){return r.randg(t)})),s;t<1&&(t+=1),a=t-1/3,u=1/n.sqrt(9*a);do{do{f=1+u*(c=r.randn())}while(f<=0);f*=f*f,i=r._random_fn()}while(i>1-.331*n.pow(c,4)&&n.log(i)>.5*c*c+a*(1-f+n.log(f)));if(t==l)return a*f;do{i=r._random_fn()}while(0===i);return n.pow(i,1/l)*a*f},function(n){for(var t=0;t<n.length;t++)!function(n){r.fn[n]=function(){return r(r.map(this,(function(t){return r[n](t)})))}}(n[t])}("gammaln gammafn factorial factorialln".split(" ")),function(n){for(var t=0;t<n.length;t++)!function(n){r.fn[n]=function(){return r(r[n].apply(null,arguments))}}(n[t])}("randn".split(" "))}(r,Math),function(r,n){function t(r,t,e,o){for(var a,u=0,i=1,f=1,c=1,s=0,l=0;n.abs((f-l)/f)>o;)l=f,i=c+(a=-(t+s)*(t+e+s)*r/(t+2*s)/(t+2*s+1))*i,f=(u=f+a*u)+(a=(s+=1)*(e-s)*r/(t+2*s-1)/(t+2*s))*f,u/=c=i+a*c,i/=c,f/=c,c=1;return f/t}function e(r){return r/n.abs(r)}function o(t,e,o){var a=12,u=6,i=-30,f=-50,c=60,s=8,l=3,h=2,p=3,v=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],d=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],m=.5*t;if(m>=s)return 1;var g,b=2*r.normal.cdf(m,0,1,1,0)-1;b=b>=n.exp(f/o)?n.pow(b,o):0;for(var y=m,w=(s-m)/(g=t>l?h:p),x=y+w,j=0,_=o-1,M=1;M<=g;M++){for(var k=0,q=.5*(x+y),A=.5*(x-y),P=1;P<=a;P++){var E,O=q+A*(u<P?v[(E=a-P+1)-1]:-v[(E=P)-1]),S=O*O;if(S>c)break;var N=2*r.normal.cdf(O,0,1,1,0)*.5-2*r.normal.cdf(O,t,1,1,0)*.5;N>=n.exp(i/_)&&(k+=N=d[E-1]*n.exp(-.5*S)*n.pow(N,_))}j+=k*=2*A*o/n.sqrt(2*n.PI),y=x,x+=w}return(b+=j)<=n.exp(i/e)?0:(b=n.pow(b,e))>=1?1:b}function a(r,t,e){var o=.322232421088,a=.099348462606,u=-1,i=.588581570495,f=-.342242088547,c=.531103462366,s=-.204231210125,l=.10353775285,h=-453642210148e-16,p=.0038560700634,v=.8832,d=.2368,m=1.214,g=1.208,b=1.4142,y=120,w=.5-.5*r,x=n.sqrt(n.log(1/(w*w))),j=x+((((x*h+s)*x+f)*x+u)*x+o)/((((x*p+l)*x+c)*x+i)*x+a);e<y&&(j+=(j*j*j+j)/e/4);var _=v-d*j;return e<y&&(_+=-m/e+g*j/e),j*(_*n.log(t-1)+b)}!function(n){for(var t=0;t<n.length;t++)!function(n){r[n]=function r(n,t,e){return this instanceof r?(this._a=n,this._b=t,this._c=e,this):new r(n,t,e)},r.fn[n]=function(t,e,o){var a=r[n](t,e,o);return a.data=this,a},r[n].prototype.sample=function(t){var e=this._a,o=this._b,a=this._c;return t?r.alter(t,(function(){return r[n].sample(e,o,a)})):r[n].sample(e,o,a)},function(t){for(var e=0;e<t.length;e++)!function(t){r[n].prototype[t]=function(e){var o=this._a,a=this._b,u=this._c;return e||0===e||(e=this.data),"number"!=typeof e?r.fn.map.call(e,(function(e){return r[n][t](e,o,a,u)})):r[n][t](e,o,a,u)}}(t[e])}("pdf cdf inv".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){r[n].prototype[t]=function(){return r[n][t](this._a,this._b,this._c)}}(t[e])}("mean median mode variance".split(" "))}(n[t])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),r.extend(r.beta,{pdf:function(t,e,o){return t>1||t<0?0:1==e&&1==o?1:e<512&&o<512?n.pow(t,e-1)*n.pow(1-t,o-1)/r.betafn(e,o):n.exp((e-1)*n.log(t)+(o-1)*n.log(1-t)-r.betaln(e,o))},cdf:function(n,t,e){return n>1||n<0?1*(n>1):r.ibeta(n,t,e)},inv:function(n,t,e){return r.ibetainv(n,t,e)},mean:function(r,n){return r/(r+n)},median:function(n,t){return r.ibetainv(.5,n,t)},mode:function(r,n){return(r-1)/(r+n-2)},sample:function(n,t){var e=r.randg(n);return e/(e+r.randg(t))},variance:function(r,t){return r*t/(n.pow(r+t,2)*(r+t+1))}}),r.extend(r.centralF,{pdf:function(t,e,o){var a;return t<0?0:e<=2?0===t&&e<2?1/0:0===t&&2===e?1:1/r.betafn(e/2,o/2)*n.pow(e/o,e/2)*n.pow(t,e/2-1)*n.pow(1+e/o*t,-(e+o)/2):(a=e*t/(o+t*e),e*(o/(o+t*e))/2*r.binomial.pdf((e-2)/2,(e+o-2)/2,a))},cdf:function(n,t,e){return n<0?0:r.ibeta(t*n/(t*n+e),t/2,e/2)},inv:function(n,t,e){return e/(t*(1/r.ibetainv(n,t/2,e/2)-1))},mean:function(r,n){return n>2?n/(n-2):void 0},mode:function(r,n){return r>2?n*(r-2)/(r*(n+2)):void 0},sample:function(n,t){return 2*r.randg(n/2)/n/(2*r.randg(t/2)/t)},variance:function(r,n){if(!(n<=4))return 2*n*n*(r+n-2)/(r*(n-2)*(n-2)*(n-4))}}),r.extend(r.cauchy,{pdf:function(r,t,e){return e<0?0:e/(n.pow(r-t,2)+n.pow(e,2))/n.PI},cdf:function(r,t,e){return n.atan((r-t)/e)/n.PI+.5},inv:function(r,t,e){return t+e*n.tan(n.PI*(r-.5))},median:function(r){return r},mode:function(r){return r},sample:function(t,e){return r.randn()*n.sqrt(1/(2*r.randg(.5)))*e+t}}),r.extend(r.chisquare,{pdf:function(t,e){return t<0?0:0===t&&2===e?.5:n.exp((e/2-1)*n.log(t)-t/2-e/2*n.log(2)-r.gammaln(e/2))},cdf:function(n,t){return n<0?0:r.lowRegGamma(t/2,n/2)},inv:function(n,t){return 2*r.gammapinv(n,.5*t)},mean:function(r){return r},median:function(r){return r*n.pow(1-2/(9*r),3)},mode:function(r){return r-2>0?r-2:0},sample:function(n){return 2*r.randg(n/2)},variance:function(r){return 2*r}}),r.extend(r.exponential,{pdf:function(r,t){return r<0?0:t*n.exp(-t*r)},cdf:function(r,t){return r<0?0:1-n.exp(-t*r)},inv:function(r,t){return-n.log(1-r)/t},mean:function(r){return 1/r},median:function(r){return 1/r*n.log(2)},mode:function(){return 0},sample:function(t){return-1/t*n.log(r._random_fn())},variance:function(r){return n.pow(r,-2)}}),r.extend(r.gamma,{pdf:function(t,e,o){return t<0?0:0===t&&1===e?1/o:n.exp((e-1)*n.log(t)-t/o-r.gammaln(e)-e*n.log(o))},cdf:function(n,t,e){return n<0?0:r.lowRegGamma(t,n/e)},inv:function(n,t,e){return r.gammapinv(n,t)*e},mean:function(r,n){return r*n},mode:function(r,n){if(r>1)return(r-1)*n},sample:function(n,t){return r.randg(n)*t},variance:function(r,n){return r*n*n}}),r.extend(r.invgamma,{pdf:function(t,e,o){return t<=0?0:n.exp(-(e+1)*n.log(t)-o/t-r.gammaln(e)+e*n.log(o))},cdf:function(n,t,e){return n<=0?0:1-r.lowRegGamma(t,e/n)},inv:function(n,t,e){return e/r.gammapinv(1-n,t)},mean:function(r,n){return r>1?n/(r-1):void 0},mode:function(r,n){return n/(r+1)},sample:function(n,t){return t/r.randg(n)},variance:function(r,n){if(!(r<=2))return n*n/((r-1)*(r-1)*(r-2))}}),r.extend(r.kumaraswamy,{pdf:function(r,t,e){return 0===r&&1===t?e:1===r&&1===e?t:n.exp(n.log(t)+n.log(e)+(t-1)*n.log(r)+(e-1)*n.log(1-n.pow(r,t)))},cdf:function(r,t,e){return r<0?0:r>1?1:1-n.pow(1-n.pow(r,t),e)},inv:function(r,t,e){return n.pow(1-n.pow(1-r,1/e),1/t)},mean:function(n,t){return t*r.gammafn(1+1/n)*r.gammafn(t)/r.gammafn(1+1/n+t)},median:function(r,t){return n.pow(1-n.pow(2,-1/t),1/r)},mode:function(r,t){if(r>=1&&t>=1&&1!==r&&1!==t)return n.pow((r-1)/(r*t-1),1/r)},variance:function(){throw new Error("variance not yet implemented")}}),r.extend(r.lognormal,{pdf:function(r,t,e){return r<=0?0:n.exp(-n.log(r)-.5*n.log(2*n.PI)-n.log(e)-n.pow(n.log(r)-t,2)/(2*e*e))},cdf:function(t,e,o){return t<0?0:.5+.5*r.erf((n.log(t)-e)/n.sqrt(2*o*o))},inv:function(t,e,o){return n.exp(-1.4142135623730951*o*r.erfcinv(2*t)+e)},mean:function(r,t){return n.exp(r+t*t/2)},median:function(r){return n.exp(r)},mode:function(r,t){return n.exp(r-t*t)},sample:function(t,e){return n.exp(r.randn()*e+t)},variance:function(r,t){return(n.exp(t*t)-1)*n.exp(2*r+t*t)}}),r.extend(r.noncentralt,{pdf:function(t,e,o){var a=1e-14;return n.abs(o)<a?r.studentt.pdf(t,e):n.abs(t)<a?n.exp(r.gammaln((e+1)/2)-o*o/2-.5*n.log(n.PI*e)-r.gammaln(e/2)):e/t*(r.noncentralt.cdf(t*n.sqrt(1+2/e),e+2,o)-r.noncentralt.cdf(t,e,o))},cdf:function(t,e,o){var a=1e-14,u=200;if(n.abs(o)<a)return r.studentt.cdf(t,e);var i=!1;t<0&&(i=!0,o=-o);for(var f=r.normal.cdf(-o,0,1),c=a+1,s=c,l=t*t/(t*t+e),h=0,p=n.exp(-o*o/2),v=n.exp(-o*o/2-.5*n.log(2)-r.gammaln(1.5))*o;h<u||s>a||c>a;)s=c,h>0&&(p*=o*o/(2*h),v*=o*o/(2*(h+.5))),f+=.5*(c=p*r.beta.cdf(l,h+.5,e/2)+v*r.beta.cdf(l,h+1,e/2)),h++;return i?1-f:f}}),r.extend(r.normal,{pdf:function(r,t,e){return n.exp(-.5*n.log(2*n.PI)-n.log(e)-n.pow(r-t,2)/(2*e*e))},cdf:function(t,e,o){return.5*(1+r.erf((t-e)/n.sqrt(2*o*o)))},inv:function(n,t,e){return-1.4142135623730951*e*r.erfcinv(2*n)+t},mean:function(r){return r},median:function(r){return r},mode:function(r){return r},sample:function(n,t){return r.randn()*t+n},variance:function(r,n){return n*n}}),r.extend(r.pareto,{pdf:function(r,t,e){return r<t?0:e*n.pow(t,e)/n.pow(r,e+1)},cdf:function(r,t,e){return r<t?0:1-n.pow(t/r,e)},inv:function(r,t,e){return t/n.pow(1-r,1/e)},mean:function(r,t){if(!(t<=1))return t*n.pow(r,t)/(t-1)},median:function(r,t){return r*(t*n.SQRT2)},mode:function(r){return r},variance:function(r,t){if(!(t<=2))return r*r*t/(n.pow(t-1,2)*(t-2))}}),r.extend(r.studentt,{pdf:function(t,e){return e=e>1e100?1e100:e,1/(n.sqrt(e)*r.betafn(.5,e/2))*n.pow(1+t*t/e,-(e+1)/2)},cdf:function(t,e){var o=e/2;return r.ibeta((t+n.sqrt(t*t+e))/(2*n.sqrt(t*t+e)),o,o)},inv:function(t,e){var o=r.ibetainv(2*n.min(t,1-t),.5*e,.5);return o=n.sqrt(e*(1-o)/o),t>.5?o:-o},mean:function(r){return r>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(t){return r.randn()*n.sqrt(t/(2*r.randg(t/2)))},variance:function(r){return r>2?r/(r-2):r>1?1/0:void 0}}),r.extend(r.weibull,{pdf:function(r,t,e){return r<0||t<0||e<0?0:e/t*n.pow(r/t,e-1)*n.exp(-n.pow(r/t,e))},cdf:function(r,t,e){return r<0?0:1-n.exp(-n.pow(r/t,e))},inv:function(r,t,e){return t*n.pow(-n.log(1-r),1/e)},mean:function(n,t){return n*r.gammafn(1+1/t)},median:function(r,t){return r*n.pow(n.log(2),1/t)},mode:function(r,t){return t<=1?0:r*n.pow((t-1)/t,1/t)},sample:function(t,e){return t*n.pow(-n.log(r._random_fn()),1/e)},variance:function(t,e){return t*t*r.gammafn(1+2/e)-n.pow(r.weibull.mean(t,e),2)}}),r.extend(r.uniform,{pdf:function(r,n,t){return r<n||r>t?0:1/(t-n)},cdf:function(r,n,t){return r<n?0:r<t?(r-n)/(t-n):1},inv:function(r,n,t){return n+r*(t-n)},mean:function(r,n){return.5*(r+n)},median:function(n,t){return r.mean(n,t)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(n,t){return n/2+t/2+(t/2-n/2)*(2*r._random_fn()-1)},variance:function(r,t){return n.pow(t-r,2)/12}}),r.extend(r.binomial,{pdf:function(t,e,o){return 0===o||1===o?e*o===t?1:0:r.combination(e,t)*n.pow(o,t)*n.pow(1-o,e-t)},cdf:function(e,o,a){var u,i=1e-10;if(e<0)return 0;if(e>=o)return 1;if(a<0||a>1||o<=0)return NaN;var f=a,c=(e=n.floor(e))+1,s=o-e,l=c+s,h=n.exp(r.gammaln(l)-r.gammaln(s)-r.gammaln(c)+c*n.log(f)+s*n.log(1-f));return u=f<(c+1)/(l+2)?h*t(f,c,s,i):1-h*t(1-f,s,c,i),n.round(1/i*(1-u))/(1/i)}}),r.extend(r.negbin,{pdf:function(t,e,o){return t===t>>>0&&(t<0?0:r.combination(t+e-1,e-1)*n.pow(1-o,t)*n.pow(o,e))},cdf:function(n,t,e){var o=0,a=0;if(n<0)return 0;for(;a<=n;a++)o+=r.negbin.pdf(a,t,e);return o}}),r.extend(r.hypgeom,{pdf:function(t,e,o,a){if(t!=t|0)return!1;if(t<0||t<o-(e-a))return 0;if(t>a||t>o)return 0;if(2*o>e)return 2*a>e?r.hypgeom.pdf(e-o-a+t,e,e-o,e-a):r.hypgeom.pdf(a-t,e,e-o,a);if(2*a>e)return r.hypgeom.pdf(o-t,e,o,e-a);if(o<a)return r.hypgeom.pdf(t,e,a,o);for(var u=1,i=0,f=0;f<t;f++){for(;u>1&&i<a;)u*=1-o/(e-i),i++;u*=(a-f)*(o-f)/((f+1)*(e-o-a+f+1))}for(;i<a;i++)u*=1-o/(e-i);return n.min(1,n.max(0,u))},cdf:function(t,e,o,a){if(t<0||t<o-(e-a))return 0;if(t>=a||t>=o)return 1;if(2*o>e)return 2*a>e?r.hypgeom.cdf(e-o-a+t,e,e-o,e-a):1-r.hypgeom.cdf(a-t-1,e,e-o,a);if(2*a>e)return 1-r.hypgeom.cdf(o-t-1,e,o,e-a);if(o<a)return r.hypgeom.cdf(t,e,a,o);for(var u=1,i=1,f=0,c=0;c<t;c++){for(;u>1&&f<a;){var s=1-o/(e-f);i*=s,u*=s,f++}u+=i*=(a-c)*(o-c)/((c+1)*(e-o-a+c+1))}for(;f<a;f++)u*=1-o/(e-f);return n.min(1,n.max(0,u))}}),r.extend(r.poisson,{pdf:function(t,e){return e<0||t%1!=0||t<0?0:n.pow(e,t)*n.exp(-e)/r.factorial(t)},cdf:function(n,t){var e=[],o=0;if(n<0)return 0;for(;o<=n;o++)e.push(r.poisson.pdf(o,t));return r.sum(e)},mean:function(r){return r},variance:function(r){return r},sampleSmall:function(t){var e=1,o=0,a=n.exp(-t);do{o++,e*=r._random_fn()}while(e>a);return o-1},sampleLarge:function(t){var e,o,a,u,i,f,c,s,l,h,p=t;for(u=n.sqrt(p),i=n.log(p),f=.02483*(c=.931+2.53*u)-.059,s=1.1239+1.1328/(c-3.4),l=.9277-3.6224/(c-2);;){if(o=n.random()-.5,a=n.random(),h=.5-n.abs(o),e=n.floor((2*f/h+c)*o+p+.43),h>=.07&&a<=l)return e;if(!(e<0||h<.013&&a>h)&&n.log(a)+n.log(s)-n.log(f/(h*h)+c)<=e*i-p-r.loggam(e+1))return e}},sample:function(r){return r<10?this.sampleSmall(r):this.sampleLarge(r)}}),r.extend(r.triangular,{pdf:function(r,n,t,e){return t<=n||e<n||e>t?NaN:r<n||r>t?0:r<e?2*(r-n)/((t-n)*(e-n)):r===e?2/(t-n):2*(t-r)/((t-n)*(t-e))},cdf:function(r,t,e,o){return e<=t||o<t||o>e?NaN:r<=t?0:r>=e?1:r<=o?n.pow(r-t,2)/((e-t)*(o-t)):1-n.pow(e-r,2)/((e-t)*(e-o))},inv:function(r,t,e,o){return e<=t||o<t||o>e?NaN:r<=(o-t)/(e-t)?t+(e-t)*n.sqrt(r*((o-t)/(e-t))):t+(e-t)*(1-n.sqrt((1-r)*(1-(o-t)/(e-t))))},mean:function(r,n,t){return(r+n+t)/3},median:function(r,t,e){return e<=(r+t)/2?t-n.sqrt((t-r)*(t-e))/n.sqrt(2):e>(r+t)/2?r+n.sqrt((t-r)*(e-r))/n.sqrt(2):void 0},mode:function(r,n,t){return t},sample:function(t,e,o){var a=r._random_fn();return a<(o-t)/(e-t)?t+n.sqrt(a*(e-t)*(o-t)):e-n.sqrt((1-a)*(e-t)*(e-o))},variance:function(r,n,t){return(r*r+n*n+t*t-r*n-r*t-n*t)/18}}),r.extend(r.arcsine,{pdf:function(r,t,e){return e<=t?NaN:r<=t||r>=e?0:2/n.PI*n.pow(n.pow(e-t,2)-n.pow(2*r-t-e,2),-.5)},cdf:function(r,t,e){return r<t?0:r<e?2/n.PI*n.asin(n.sqrt((r-t)/(e-t))):1},inv:function(r,t,e){return t+(.5-.5*n.cos(n.PI*r))*(e-t)},mean:function(r,n){return n<=r?NaN:(r+n)/2},median:function(r,n){return n<=r?NaN:(r+n)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(t,e){return(t+e)/2+(e-t)/2*n.sin(2*n.PI*r.uniform.sample(0,1))},variance:function(r,t){return t<=r?NaN:n.pow(t-r,2)/8}}),r.extend(r.laplace,{pdf:function(r,t,e){return e<=0?0:n.exp(-n.abs(r-t)/e)/(2*e)},cdf:function(r,t,e){return e<=0?0:r<t?.5*n.exp((r-t)/e):1-.5*n.exp(-(r-t)/e)},mean:function(r){return r},median:function(r){return r},mode:function(r){return r},variance:function(r,n){return 2*n*n},sample:function(t,o){var a=r._random_fn()-.5;return t-o*e(a)*n.log(1-2*n.abs(a))}}),r.extend(r.tukey,{cdf:function(t,e,a){var u=1,i=e,f=16,c=8,s=-30,l=1e-14,h=100,p=800,v=5e3,d=25e3,m=1,g=.5,b=.25,y=.125,w=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],x=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(t<=0)return 0;if(a<2||u<1||i<2)return NaN;if(!Number.isFinite(t))return 1;if(a>d)return o(t,u,i);var j,_=.5*a,M=_*n.log(a)-a*n.log(2)-r.gammaln(_),k=_-1,q=.25*a;j=a<=h?m:a<=p?g:a<=v?b:y,M+=n.log(j);for(var A=0,P=1;P<=50;P++){for(var E=0,O=(2*P-1)*j,S=1;S<=f;S++){var N,I;c<S?(N=S-c-1,I=M+k*n.log(O+w[N]*j)-(w[N]*j+O)*q):(N=S-1,I=M+k*n.log(O-w[N]*j)+(w[N]*j-O)*q),I>=s&&(E+=o(c<S?t*n.sqrt(.5*(w[N]*j+O)):t*n.sqrt(.5*(-w[N]*j+O)),u,i)*x[N]*n.exp(I))}if(P*j>=1&&E<=l)break;A+=E}if(E>l)throw new Error("tukey.cdf failed to converge");return A>1&&(A=1),A},inv:function(t,e,o){var u=1e-4,i=50;if(o<2||e<2)return NaN;if(t<0||t>1)return NaN;if(0===t)return 0;if(1===t)return 1/0;var f,c=a(t,e,o),s=r.tukey.cdf(c,e,o)-t;f=s>0?n.max(0,c-1):c+1;for(var l,h=r.tukey.cdf(f,e,o)-t,p=1;p<i;p++)if(l=f-h*(f-c)/(h-s),s=h,c=f,l<0&&(l=0,h=-t),h=r.tukey.cdf(l,e,o)-t,f=l,n.abs(f-c)<u)return l;throw new Error("tukey.inv failed to converge")}})}(r,Math),function(r,n){var t=Array.prototype.push,e=r.utils.isArray;function o(n){return e(n)||n instanceof r}r.extend({add:function(n,t){return o(t)?(o(t[0])||(t=[t]),r.map(n,(function(r,n,e){return r+t[n][e]}))):r.map(n,(function(r){return r+t}))},subtract:function(n,t){return o(t)?(o(t[0])||(t=[t]),r.map(n,(function(r,n,e){return r-t[n][e]||0}))):r.map(n,(function(r){return r-t}))},divide:function(n,t){return o(t)?(o(t[0])||(t=[t]),r.multiply(n,r.inv(t))):r.map(n,(function(r){return r/t}))},multiply:function(n,t){var e,a,u,i,f,c,s,l;if(void 0===n.length&&void 0===t.length)return n*t;if(f=n.length,c=n[0].length,s=r.zeros(f,u=o(t)?t[0].length:c),l=0,o(t)){for(;l<u;l++)for(e=0;e<f;e++){for(i=0,a=0;a<c;a++)i+=n[e][a]*t[a][l];s[e][l]=i}return 1===f&&1===l?s[0][0]:s}return r.map(n,(function(r){return r*t}))},outer:function(n,t){return r.multiply(n.map((function(r){return[r]})),[t])},dot:function(n,t){o(n[0])||(n=[n]),o(t[0])||(t=[t]);for(var e,a,u=1===n[0].length&&1!==n.length?r.transpose(n):n,i=1===t[0].length&&1!==t.length?r.transpose(t):t,f=[],c=0,s=u.length,l=u[0].length;c<s;c++){for(f[c]=[],e=0,a=0;a<l;a++)e+=u[c][a]*i[c][a];f[c]=e}return 1===f.length?f[0]:f},pow:function(t,e){return r.map(t,(function(r){return n.pow(r,e)}))},exp:function(t){return r.map(t,(function(r){return n.exp(r)}))},log:function(t){return r.map(t,(function(r){return n.log(r)}))},abs:function(t){return r.map(t,(function(r){return n.abs(r)}))},norm:function(r,t){var e=0,a=0;for(isNaN(t)&&(t=2),o(r[0])&&(r=r[0]);a<r.length;a++)e+=n.pow(n.abs(r[a]),t);return n.pow(e,1/t)},angle:function(t,e){return n.acos(r.dot(t,e)/(r.norm(t)*r.norm(e)))},aug:function(r,n){var e,o=[];for(e=0;e<r.length;e++)o.push(r[e].slice());for(e=0;e<o.length;e++)t.apply(o[e],n[e]);return o},inv:function(n){for(var t,e=n.length,o=n[0].length,a=r.identity(e,o),u=r.gauss_jordan(n,a),i=[],f=0;f<e;f++)for(i[f]=[],t=o;t<u[0].length;t++)i[f][t-o]=u[f][t];return i},det:function(r){var n,t=r.length,e=2*t,o=new Array(e),a=t-1,u=e-1,i=a-t+1,f=u,c=0,s=0;if(2===t)return r[0][0]*r[1][1]-r[0][1]*r[1][0];for(;c<e;c++)o[c]=1;for(c=0;c<t;c++){for(n=0;n<t;n++)o[i<0?i+t:i]*=r[c][n],o[f<t?f+t:f]*=r[c][n],i++,f--;i=--a-t+1,f=--u}for(c=0;c<t;c++)s+=o[c];for(;c<e;c++)s-=o[c];return s},gauss_elimination:function(t,e){var o,a,u,i,f=0,c=0,s=t.length,l=t[0].length,h=1,p=0,v=[];for(o=(t=r.aug(t,e))[0].length,f=0;f<s;f++){for(a=t[f][f],c=f,i=f+1;i<l;i++)a<n.abs(t[i][f])&&(a=t[i][f],c=i);if(c!=f)for(i=0;i<o;i++)u=t[f][i],t[f][i]=t[c][i],t[c][i]=u;for(c=f+1;c<s;c++)for(h=t[c][f]/t[f][f],i=f;i<o;i++)t[c][i]=t[c][i]-h*t[f][i]}for(f=s-1;f>=0;f--){for(p=0,c=f+1;c<=s-1;c++)p+=v[c]*t[f][c];v[f]=(t[f][o-1]-p)/t[f][f]}return v},gauss_jordan:function(t,e){var o,a,u,i=r.aug(t,e),f=i.length,c=i[0].length,s=0;for(a=0;a<f;a++){var l=a;for(u=a+1;u<f;u++)n.abs(i[u][a])>n.abs(i[l][a])&&(l=u);var h=i[a];for(i[a]=i[l],i[l]=h,u=a+1;u<f;u++)for(s=i[u][a]/i[a][a],o=a;o<c;o++)i[u][o]-=i[a][o]*s}for(a=f-1;a>=0;a--){for(s=i[a][a],u=0;u<a;u++)for(o=c-1;o>a-1;o--)i[u][o]-=i[a][o]*i[u][a]/s;for(i[a][a]/=s,o=f;o<c;o++)i[a][o]/=s}return i},triaUpSolve:function(n,t){var e,o=n[0].length,a=r.zeros(1,o)[0],u=!1;return null!=t[0].length&&(t=t.map((function(r){return r[0]})),u=!0),r.arange(o-1,-1,-1).forEach((function(u){e=r.arange(u+1,o).map((function(r){return a[r]*n[u][r]})),a[u]=(t[u]-r.sum(e))/n[u][u]})),u?a.map((function(r){return[r]})):a},triaLowSolve:function(n,t){var e,o=n[0].length,a=r.zeros(1,o)[0],u=!1;return null!=t[0].length&&(t=t.map((function(r){return r[0]})),u=!0),r.arange(o).forEach((function(o){e=r.arange(o).map((function(r){return n[o][r]*a[r]})),a[o]=(t[o]-r.sum(e))/n[o][o]})),u?a.map((function(r){return[r]})):a},lu:function(n){var t,e=n.length,o=r.identity(e),a=r.zeros(n.length,n[0].length);return r.arange(e).forEach((function(r){a[0][r]=n[0][r]})),r.arange(1,e).forEach((function(u){r.arange(u).forEach((function(e){t=r.arange(e).map((function(r){return o[u][r]*a[r][e]})),o[u][e]=(n[u][e]-r.sum(t))/a[e][e]})),r.arange(u,e).forEach((function(e){t=r.arange(u).map((function(r){return o[u][r]*a[r][e]})),a[u][e]=n[t.length][e]-r.sum(t)}))})),[o,a]},cholesky:function(t){var e,o=t.length,a=r.zeros(t.length,t[0].length);return r.arange(o).forEach((function(u){e=r.arange(u).map((function(r){return n.pow(a[u][r],2)})),a[u][u]=n.sqrt(t[u][u]-r.sum(e)),r.arange(u+1,o).forEach((function(n){e=r.arange(u).map((function(r){return a[u][r]*a[n][r]})),a[n][u]=(t[u][n]-r.sum(e))/a[u][u]}))})),a},gauss_jacobi:function(t,e,o,a){for(var u,i,f,c,s=0,l=0,h=t.length,p=[],v=[],d=[];s<h;s++)for(p[s]=[],v[s]=[],d[s]=[],l=0;l<h;l++)s>l?(p[s][l]=t[s][l],v[s][l]=d[s][l]=0):s<l?(v[s][l]=t[s][l],p[s][l]=d[s][l]=0):(d[s][l]=t[s][l],p[s][l]=v[s][l]=0);for(f=r.multiply(r.multiply(r.inv(d),r.add(p,v)),-1),i=r.multiply(r.inv(d),e),u=o,c=r.add(r.multiply(f,o),i),s=2;n.abs(r.norm(r.subtract(c,u)))>a;)u=c,c=r.add(r.multiply(f,u),i),s++;return c},gauss_seidel:function(t,e,o,a){for(var u,i,f,c,s,l=0,h=t.length,p=[],v=[],d=[];l<h;l++)for(p[l]=[],v[l]=[],d[l]=[],u=0;u<h;u++)l>u?(p[l][u]=t[l][u],v[l][u]=d[l][u]=0):l<u?(v[l][u]=t[l][u],p[l][u]=d[l][u]=0):(d[l][u]=t[l][u],p[l][u]=v[l][u]=0);for(c=r.multiply(r.multiply(r.inv(r.add(d,p)),v),-1),f=r.multiply(r.inv(r.add(d,p)),e),i=o,s=r.add(r.multiply(c,o),f),l=2;n.abs(r.norm(r.subtract(s,i)))>a;)i=s,s=r.add(r.multiply(c,i),f),l+=1;return s},SOR:function(t,e,o,a,u){for(var i,f,c,s,l,h=0,p=t.length,v=[],d=[],m=[];h<p;h++)for(v[h]=[],d[h]=[],m[h]=[],i=0;i<p;i++)h>i?(v[h][i]=t[h][i],d[h][i]=m[h][i]=0):h<i?(d[h][i]=t[h][i],v[h][i]=m[h][i]=0):(m[h][i]=t[h][i],v[h][i]=d[h][i]=0);for(s=r.multiply(r.inv(r.add(m,r.multiply(v,u))),r.subtract(r.multiply(m,1-u),r.multiply(d,u))),c=r.multiply(r.multiply(r.inv(r.add(m,r.multiply(v,u))),e),u),f=o,l=r.add(r.multiply(s,o),c),h=2;n.abs(r.norm(r.subtract(l,f)))>a;)f=l,l=r.add(r.multiply(s,f),c),h++;return l},householder:function(t){for(var e,o,a,u,i=t.length,f=t[0].length,c=0,s=[],l=[];c<i-1;c++){for(e=0,u=c+1;u<f;u++)e+=t[u][c]*t[u][c];for(e=(t[c+1][c]>0?-1:1)*n.sqrt(e),o=n.sqrt((e*e-t[c+1][c]*e)/2),(s=r.zeros(i,1))[c+1][0]=(t[c+1][c]-e)/(2*o),a=c+2;a<i;a++)s[a][0]=t[a][c]/(2*o);l=r.subtract(r.identity(i,f),r.multiply(r.multiply(s,r.transpose(s)),2)),t=r.multiply(l,r.multiply(t,l))}return t},QR:function(){var t=r.sum,e=r.arange;function o(o){var a,u,i,f=o.length,c=o[0].length,s=r.zeros(c,c);for(o=r.copy(o),u=0;u<c;u++){for(s[u][u]=n.sqrt(t(e(f).map((function(r){return o[r][u]*o[r][u]})))),a=0;a<f;a++)o[a][u]=o[a][u]/s[u][u];for(i=u+1;i<c;i++)for(s[u][i]=t(e(f).map((function(r){return o[r][u]*o[r][i]}))),a=0;a<f;a++)o[a][i]=o[a][i]-o[a][u]*s[u][i]}return[o,s]}return o}(),lstsq:function(){function n(n){var t=(n=r.copy(n)).length,e=r.identity(t);return r.arange(t-1,-1,-1).forEach((function(t){r.sliceAssign(e,{row:t},r.divide(r.slice(e,{row:t}),n[t][t])),r.sliceAssign(n,{row:t},r.divide(r.slice(n,{row:t}),n[t][t])),r.arange(t).forEach((function(o){var a=r.multiply(n[o][t],-1),u=r.slice(n,{row:o}),i=r.multiply(r.slice(n,{row:t}),a);r.sliceAssign(n,{row:o},r.add(u,i));var f=r.slice(e,{row:o}),c=r.multiply(r.slice(e,{row:t}),a);r.sliceAssign(e,{row:o},r.add(f,c))}))})),e}function t(t,e){var o=!1;void 0===e[0].length&&(e=e.map((function(r){return[r]})),o=!0);var a=r.QR(t),u=a[0],i=a[1],f=t[0].length,c=r.slice(u,{col:{end:f}}),s=n(r.slice(i,{row:{end:f}})),l=r.transpose(c);void 0===l[0].length&&(l=[l]);var h=r.multiply(r.multiply(s,l),e);return void 0===h.length&&(h=[[h]]),o?h.map((function(r){return r[0]})):h}return t}(),jacobi:function(t){for(var e,o,a,u,i,f,c,s=1,l=t.length,h=r.identity(l,l),p=[];1===s;){for(i=t[0][1],a=0,u=1,e=0;e<l;e++)for(o=0;o<l;o++)e!=o&&i<n.abs(t[e][o])&&(i=n.abs(t[e][o]),a=e,u=o);for(f=t[a][a]===t[u][u]?t[a][u]>0?n.PI/4:-n.PI/4:n.atan(2*t[a][u]/(t[a][a]-t[u][u]))/2,(c=r.identity(l,l))[a][a]=n.cos(f),c[a][u]=-n.sin(f),c[u][a]=n.sin(f),c[u][u]=n.cos(f),h=r.multiply(h,c),t=r.multiply(r.multiply(r.inv(c),t),c),s=0,e=1;e<l;e++)for(o=1;o<l;o++)e!=o&&n.abs(t[e][o])>.001&&(s=1)}for(e=0;e<l;e++)p.push(t[e][e]);return[h,p]},rungekutta:function(r,n,t,e,o,a){var u,i,f;if(2===a)for(;e<=t;)o+=((u=n*r(e,o))+(i=n*r(e+n,o+u)))/2,e+=n;if(4===a)for(;e<=t;)o+=((u=n*r(e,o))+2*(i=n*r(e+n/2,o+u/2))+2*(f=n*r(e+n/2,o+i/2))+n*r(e+n,o+f))/6,e+=n;return o},romberg:function(r,t,e,o){for(var a,u,i,f,c,s=0,l=(e-t)/2,h=[],p=[],v=[];s<o/2;){for(c=r(t),i=t,f=0;i<=e;i+=l,f++)h[f]=i;for(a=h.length,i=1;i<a-1;i++)c+=(i%2!=0?4:2)*r(h[i]);c=l/3*(c+r(e)),v[s]=c,l/=2,s++}for(u=v.length,a=1;1!==u;){for(i=0;i<u-1;i++)p[i]=(n.pow(4,a)*v[i+1]-v[i])/(n.pow(4,a)-1);u=p.length,v=p,p=[],a++}return v},richardson:function(r,t,e,o){function a(r,n){for(var t,e=0,o=r.length;e<o;e++)r[e]===n&&(t=e);return t}for(var u,i,f,c,s,l=n.abs(e-r[a(r,e)+1]),h=0,p=[],v=[];o>=l;)u=a(r,e+o),i=a(r,e),p[h]=(t[u]-2*t[i]+t[2*i-u])/(o*o),o/=2,h++;for(c=p.length,f=1;1!=c;){for(s=0;s<c-1;s++)v[s]=(n.pow(4,f)*p[s+1]-p[s])/(n.pow(4,f)-1);c=v.length,p=v,v=[],f++}return p},simpson:function(r,n,t,e){for(var o,a=(t-n)/e,u=r(n),i=[],f=n,c=0,s=1;f<=t;f+=a,c++)i[c]=f;for(o=i.length;s<o-1;s++)u+=(s%2!=0?4:2)*r(i[s]);return a/3*(u+r(t))},hermite:function(r,n,t,e){for(var o,a=r.length,u=0,i=0,f=[],c=[],s=[],l=[];i<a;i++){for(f[i]=1,o=0;o<a;o++)i!=o&&(f[i]*=(e-r[o])/(r[i]-r[o]));for(c[i]=0,o=0;o<a;o++)i!=o&&(c[i]+=1/(r[i]-r[o]));s[i]=(1-2*(e-r[i])*c[i])*(f[i]*f[i]),l[i]=(e-r[i])*(f[i]*f[i]),u+=s[i]*n[i]+l[i]*t[i]}return u},lagrange:function(r,n,t){for(var e,o,a=0,u=0,i=r.length;u<i;u++){for(o=n[u],e=0;e<i;e++)u!=e&&(o*=(t-r[e])/(r[u]-r[e]));a+=o}return a},cubic_spline:function(n,t,e){for(var o,a=n.length,u=0,i=[],f=[],c=[],s=[],l=[],h=[],p=[];u<a-1;u++)l[u]=n[u+1]-n[u];for(c[0]=0,u=1;u<a-1;u++)c[u]=3/l[u]*(t[u+1]-t[u])-3/l[u-1]*(t[u]-t[u-1]);for(u=1;u<a-1;u++)i[u]=[],f[u]=[],i[u][u-1]=l[u-1],i[u][u]=2*(l[u-1]+l[u]),i[u][u+1]=l[u],f[u][0]=c[u];for(s=r.multiply(r.inv(i),f),o=0;o<a-1;o++)h[o]=(t[o+1]-t[o])/l[o]-l[o]*(s[o+1][0]+2*s[o][0])/3,p[o]=(s[o+1][0]-s[o][0])/(3*l[o]);for(o=0;o<a&&!(n[o]>e);o++);return t[o-=1]+(e-n[o])*h[o]+r.sq(e-n[o])*s[o]+(e-n[o])*r.sq(e-n[o])*p[o]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(n){var t,e,o=n.length,a=n[0].length,u=0,i=[],f=[],c=[],s=[],l=[],h=[],p=[],v=[],d=[],m=[];for(u=0;u<o;u++)i[u]=r.sum(n[u])/a;for(u=0;u<a;u++)for(p[u]=[],t=0;t<o;t++)p[u][t]=n[t][u]-i[t];for(p=r.transpose(p),u=0;u<o;u++)for(v[u]=[],t=0;t<o;t++)v[u][t]=r.dot([p[u]],[p[t]])/(a-1);for(d=(c=r.jacobi(v))[0],f=c[1],m=r.transpose(d),u=0;u<f.length;u++)for(t=u;t<f.length;t++)f[u]<f[t]&&(e=f[u],f[u]=f[t],f[t]=e,s=m[u],m[u]=m[t],m[t]=s);for(h=r.transpose(p),u=0;u<o;u++)for(l[u]=[],t=0;t<h.length;t++)l[u][t]=r.dot([m[u]],[h[t]]);return[n,f,m,l]}}),function(n){for(var t=0;t<n.length;t++)!function(n){r.fn[n]=function(t,e){var o=this;return e?(setTimeout((function(){e.call(o,r.fn[n].call(o,t))}),15),this):"number"==typeof r[n](this,t)?r[n](this,t):r(r[n](this,t))}}(n[t])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(r,Math),function(r,n){var t=[].slice,e=r.utils.isNumber,o=r.utils.isArray;function a(r,t,e,o){if(r>1||e>1||r<=0||e<=0)throw new Error("Proportions should be greater than 0 and less than 1");var a=(r*t+e*o)/(t+o);return(r-e)/n.sqrt(a*(1-a)*(1/t+1/o))}r.extend({zscore:function(){var n=t.call(arguments);return e(n[1])?(n[0]-n[1])/n[2]:(n[0]-r.mean(n[1]))/r.stdev(n[1],n[2])},ztest:function(){var e,a=t.call(arguments);return o(a[1])?(e=r.zscore(a[0],a[1],a[3]),1===a[2]?r.normal.cdf(-n.abs(e),0,1):2*r.normal.cdf(-n.abs(e),0,1)):a.length>2?(e=r.zscore(a[0],a[1],a[2]),1===a[3]?r.normal.cdf(-n.abs(e),0,1):2*r.normal.cdf(-n.abs(e),0,1)):(e=a[0],1===a[1]?r.normal.cdf(-n.abs(e),0,1):2*r.normal.cdf(-n.abs(e),0,1))}}),r.extend(r.fn,{zscore:function(r,n){return(r-this.mean())/this.stdev(n)},ztest:function(t,e,o){var a=n.abs(this.zscore(t,o));return 1===e?r.normal.cdf(-a,0,1):2*r.normal.cdf(-a,0,1)}}),r.extend({tscore:function(){var e=t.call(arguments);return 4===e.length?(e[0]-e[1])/(e[2]/n.sqrt(e[3])):(e[0]-r.mean(e[1]))/(r.stdev(e[1],!0)/n.sqrt(e[1].length))},ttest:function(){var o,a=t.call(arguments);return 5===a.length?(o=n.abs(r.tscore(a[0],a[1],a[2],a[3])),1===a[4]?r.studentt.cdf(-o,a[3]-1):2*r.studentt.cdf(-o,a[3]-1)):e(a[1])?(o=n.abs(a[0]),1==a[2]?r.studentt.cdf(-o,a[1]-1):2*r.studentt.cdf(-o,a[1]-1)):(o=n.abs(r.tscore(a[0],a[1])),1==a[2]?r.studentt.cdf(-o,a[1].length-1):2*r.studentt.cdf(-o,a[1].length-1))}}),r.extend(r.fn,{tscore:function(r){return(r-this.mean())/(this.stdev(!0)/n.sqrt(this.cols()))},ttest:function(t,e){return 1===e?1-r.studentt.cdf(n.abs(this.tscore(t)),this.cols()-1):2*r.studentt.cdf(-n.abs(this.tscore(t)),this.cols()-1)}}),r.extend({anovafscore:function(){var e,o,a,u,i,f,c,s,l=t.call(arguments);if(1===l.length){for(i=new Array(l[0].length),c=0;c<l[0].length;c++)i[c]=l[0][c];l=i}for(o=new Array,c=0;c<l.length;c++)o=o.concat(l[c]);for(a=r.mean(o),e=0,c=0;c<l.length;c++)e+=l[c].length*n.pow(r.mean(l[c])-a,2);for(e/=l.length-1,f=0,c=0;c<l.length;c++)for(u=r.mean(l[c]),s=0;s<l[c].length;s++)f+=n.pow(l[c][s]-u,2);return e/(f/=o.length-l.length)},anovaftest:function(){var n,o,a,u,i=t.call(arguments);if(e(i[0]))return 1-r.centralF.cdf(i[0],i[1],i[2]);var f=r.anovafscore(i);for(n=i.length-1,a=0,u=0;u<i.length;u++)a+=i[u].length;return o=a-n-1,1-r.centralF.cdf(f,n,o)},ftest:function(n,t,e){return 1-r.centralF.cdf(n,t,e)}}),r.extend(r.fn,{anovafscore:function(){return r.anovafscore(this.toArray())},anovaftes:function(){var n,t=0;for(n=0;n<this.length;n++)t+=this[n].length;return r.ftest(this.anovafscore(),this.length-1,t-this.length)}}),r.extend({qscore:function(){var o,a,u,i,f,c=t.call(arguments);return e(c[0])?(o=c[0],a=c[1],u=c[2],i=c[3],f=c[4]):(o=r.mean(c[0]),a=r.mean(c[1]),u=c[0].length,i=c[1].length,f=c[2]),n.abs(o-a)/(f*n.sqrt((1/u+1/i)/2))},qtest:function(){var n,e=t.call(arguments);3===e.length?(n=e[0],e=e.slice(1)):7===e.length?(n=r.qscore(e[0],e[1],e[2],e[3],e[4]),e=e.slice(5)):(n=r.qscore(e[0],e[1],e[2]),e=e.slice(3));var o=e[0],a=e[1];return 1-r.tukey.cdf(n,a,o-a)},tukeyhsd:function(n){for(var t=r.pooledstdev(n),e=n.map((function(n){return r.mean(n)})),o=n.reduce((function(r,n){return r+n.length}),0),a=[],u=0;u<n.length;++u)for(var i=u+1;i<n.length;++i){var f=r.qtest(e[u],e[i],n[u].length,n[i].length,t,o,n.length);a.push([[u,i],f])}return a}}),r.extend({normalci:function(){var e,o=t.call(arguments),a=new Array(2);return e=4===o.length?n.abs(r.normal.inv(o[1]/2,0,1)*o[2]/n.sqrt(o[3])):n.abs(r.normal.inv(o[1]/2,0,1)*r.stdev(o[2])/n.sqrt(o[2].length)),a[0]=o[0]-e,a[1]=o[0]+e,a},tci:function(){var e,o=t.call(arguments),a=new Array(2);return e=4===o.length?n.abs(r.studentt.inv(o[1]/2,o[3]-1)*o[2]/n.sqrt(o[3])):n.abs(r.studentt.inv(o[1]/2,o[2].length-1)*r.stdev(o[2],!0)/n.sqrt(o[2].length)),a[0]=o[0]-e,a[1]=o[0]+e,a},significant:function(r,n){return r<n}}),r.extend(r.fn,{normalci:function(n,t){return r.normalci(n,t,this.toArray())},tci:function(n,t){return r.tci(n,t,this.toArray())}}),r.extend(r.fn,{oneSidedDifferenceOfProportions:function(n,t,e,o){var u=a(n,t,e,o);return r.ztest(u,1)},twoSidedDifferenceOfProportions:function(n,t,e,o){var u=a(n,t,e,o);return r.ztest(u,2)}})}(r,Math),r.models=function(){function n(n){var e=n[0].length;return r.arange(e).map((function(o){var a=r.arange(e).filter((function(r){return r!==o}));return t(r.col(n,o).map((function(r){return r[0]})),r.col(n,a))}))}function t(n,t){var e=n.length,o=t[0].length-1,a=e-o-1,u=r.lstsq(t,n),i=r.multiply(t,u.map((function(r){return[r]}))).map((function(r){return r[0]})),f=r.subtract(n,i),c=r.mean(n),s=r.sum(i.map((function(r){return Math.pow(r-c,2)}))),l=r.sum(n.map((function(r,n){return Math.pow(r-i[n],2)}))),h=s+l;return{exog:t,endog:n,nobs:e,df_model:o,df_resid:a,coef:u,predict:i,resid:f,ybar:c,SST:h,SSE:s,SSR:l,R2:s/h}}function e(t){var e=n(t.exog),o=Math.sqrt(t.SSR/t.df_resid),a=e.map((function(r){var n=r.SST,t=r.R2;return o/Math.sqrt(n*(1-t))})),u=t.coef.map((function(r,n){return(r-0)/a[n]})),i=u.map((function(n){var e=r.studentt.cdf(n,t.df_resid);return 2*(e>.5?1-e:e)})),f=r.studentt.inv(.975,t.df_resid),c=t.coef.map((function(r,n){var t=f*a[n];return[r-t,r+t]}));return{se:a,t:u,p:i,sigmaHat:o,interval95:c}}function o(n){var t,e,o,a=n.R2/n.df_model/((1-n.R2)/n.df_resid);return{F_statistic:a,pvalue:1-(t=a,e=n.df_model,o=n.df_resid,r.beta.cdf(t/(o/e+t),e/2,o/2))}}function a(r,n){var a=t(r,n),u=e(a),i=o(a),f=1-(1-a.R2)*((a.nobs-1)/a.df_resid);return a.t=u,a.f=i,a.adjust_R2=f,a}return{ols:a}}(),r.extend({buildxmatrix:function(){for(var n=new Array(arguments.length),t=0;t<arguments.length;t++){var e=[1];n[t]=e.concat(arguments[t])}return r(n)},builddxmatrix:function(){for(var n=new Array(arguments[0].length),t=0;t<arguments[0].length;t++){var e=[1];n[t]=e.concat(arguments[0][t])}return r(n)},buildjxmatrix:function(n){for(var t=new Array(n.length),e=0;e<n.length;e++)t[e]=n[e];return r.builddxmatrix(t)},buildymatrix:function(n){return r(n).transpose()},buildjymatrix:function(r){return r.transpose()},matrixmult:function(n,t){var e,o,a,u,i;if(n.cols()==t.rows()){if(t.rows()>1){for(u=[],e=0;e<n.rows();e++)for(u[e]=[],o=0;o<t.cols();o++){for(i=0,a=0;a<n.cols();a++)i+=n.toArray()[e][a]*t.toArray()[a][o];u[e][o]=i}return r(u)}for(u=[],e=0;e<n.rows();e++)for(u[e]=[],o=0;o<t.cols();o++){for(i=0,a=0;a<n.cols();a++)i+=n.toArray()[e][a]*t.toArray()[o];u[e][o]=i}return r(u)}},regress:function(n,t){var e=r.xtranspxinv(n),o=n.transpose(),a=r.matrixmult(r(e),o);return r.matrixmult(a,t)},regresst:function(n,t,e){var o=r.regress(n,t),a={anova:{}},u=r.jMatYBar(n,o);a.yBar=u;var i=t.mean();a.anova.residuals=r.residuals(t,u),a.anova.ssr=r.ssr(u,i),a.anova.msr=a.anova.ssr/(n[0].length-1),a.anova.sse=r.sse(t,u),a.anova.mse=a.anova.sse/(t.length-(n[0].length-1)-1),a.anova.sst=r.sst(t,i),a.anova.mst=a.anova.sst/(t.length-1),a.anova.r2=1-a.anova.sse/a.anova.sst,a.anova.r2<0&&(a.anova.r2=0),a.anova.fratio=a.anova.msr/a.anova.mse,a.anova.pvalue=r.anovaftest(a.anova.fratio,n[0].length-1,t.length-(n[0].length-1)-1),a.anova.rmse=Math.sqrt(a.anova.mse),a.anova.r2adj=1-a.anova.mse/a.anova.mst,a.anova.r2adj<0&&(a.anova.r2adj=0),a.stats=new Array(n[0].length);for(var f,c,s,l=r.xtranspxinv(n),h=0;h<o.length;h++)f=Math.sqrt(a.anova.mse*Math.abs(l[h][h])),c=Math.abs(o[h]/f),s=r.ttest(c,t.length-n[0].length-1,e),a.stats[h]=[o[h],f,c,s];return a.regress=o,a},xtranspx:function(n){return r.matrixmult(n.transpose(),n)},xtranspxinv:function(n){var t=r.matrixmult(n.transpose(),n);return r.inv(t)},jMatYBar:function(n,t){var e=r.matrixmult(n,t);return new r(e)},residuals:function(n,t){return r.matrixsubtract(n,t)},ssr:function(r,n){for(var t=0,e=0;e<r.length;e++)t+=Math.pow(r[e]-n,2);return t},sse:function(r,n){for(var t=0,e=0;e<r.length;e++)t+=Math.pow(r[e]-n[e],2);return t},sst:function(r,n){for(var t=0,e=0;e<r.length;e++)t+=Math.pow(r[e]-n,2);return t},matrixsubtract:function(n,t){for(var e=new Array(n.length),o=0;o<n.length;o++){e[o]=new Array(n[o].length);for(var a=0;a<n[o].length;a++)e[o][a]=n[o][a]-t[o][a]}return r(e)}}),r.jStat=r,r}()})),lo=so.jStat,ho={beta:{pdf:lo.beta.pdf,cdf:lo.beta.cdf,inv:lo.beta.inv},centralF:{pdf:lo.centralF.pdf,cdf:lo.centralF.cdf,inv:lo.centralF.inv},cauchy:{pdf:lo.cauchy.pdf,cdf:lo.cauchy.cdf,inv:lo.cauchy.inv},chisquare:{pdf:lo.chisquare.pdf,cdf:lo.chisquare.cdf,inv:lo.chisquare.inv},exponential:{pdf:lo.exponential.pdf,cdf:lo.exponential.cdf,inv:lo.exponential.inv},gamma:{pdf:lo.gamma.pdf,cdf:lo.gamma.cdf,inv:lo.gamma.inv},invgamma:{pdf:lo.invgamma.pdf,cdf:lo.invgamma.cdf,inv:lo.invgamma.inv},kumaraswamy:{pdf:lo.kumaraswamy.pdf,cdf:lo.kumaraswamy.cdf,inv:lo.kumaraswamy.inv},lognormal:{pdf:lo.lognormal.pdf,cdf:lo.lognormal.cdf,inv:lo.lognormal.inv},normal:{pdf:lo.normal.pdf,cdf:lo.normal.cdf,inv:lo.normal.inv},pareto:{pdf:lo.pareto.pdf,cdf:lo.pareto.cdf,inv:lo.pareto.inv},studentt:{pdf:lo.studentt.pdf,cdf:lo.studentt.cdf,inv:lo.studentt.inv},tukey:{pdf:function(r,n,t){throw new Error("invalid tukey.pdf")},cdf:lo.tukey.cdf,inv:lo.tukey.inv},weibull:{pdf:lo.weibull.pdf,cdf:lo.weibull.cdf,inv:lo.weibull.inv},uniform:{pdf:lo.uniform.pdf,cdf:lo.uniform.cdf,inv:lo.uniform.inv},binomial:{pdf:lo.binomial.pdf,cdf:lo.binomial.cdf,inv:function(r,n,t){throw new Error("invalid binomial.inv")}},negbin:{pdf:lo.negbin.pdf,cdf:lo.negbin.cdf,inv:function(r,n,t){throw new Error("invalid negbin.inv")}},hypgeom:{pdf:lo.hypgeom.pdf,cdf:lo.hypgeom.cdf,inv:function(r,n,t,e){throw new Error("invalid hypgeom.inv")}},poisson:{pdf:lo.poisson.pdf,cdf:lo.poisson.cdf,inv:function(r,n){throw new Error("invalid poisson.inv")}},triangular:{pdf:lo.triangular.pdf,cdf:lo.triangular.cdf,inv:function(r,n,t,e){throw new Error("invalid triangular.inv")}},arcsine:{pdf:lo.arcsine.pdf,cdf:lo.arcsine.cdf,inv:lo.arcsine.inv},std:function(r){return lo.stdev(r,!1)},sampleStd:function(r){return lo.stdev(r,!0)},emquantile:function(r,n){return lo.quantiles(r,[n],.4,.4)[0]},emquantiles:lo.quantiles,percentile:lo.percentile};function po(r){return Or(r)?0===kr(r)?null:(r=Vt(r,(function(r){return Ge(r)})),r=Ut(r,Je),kr(r)<=1?null:ho.sampleStd(r)):null}var vo=function(r){var n=Ze(r),t=n%1;return n==n?t?n-t:n:0};var mo=function(r){return"number"==typeof r&&r==vo(r)};function go(r){return!!Ge(r)&&(r=Je(r),mo(r))}var bo=h.isFinite,yo=Math.min;var wo=function(r){var n=Math[r];return function(r,t){if(r=Qe(r),(t=null==t?0:yo(vo(t),292))&&bo(r)){var e=(At(r)+"e").split("e"),o=n(e[0]+"e"+(+e[1]+t));return+((e=(At(o)+"e").split("e"))[0]+"e"+(+e[1]-t))}return n(r)}},xo=wo("round");function jo(r){if(!Ge(r))return 0;r=Je(r);var n=xo(r);return"0"===String(n)?0:n}function _o(r){return!!go(r)&&jo(r)>0}function Mo(r,n){return ko.apply(this,arguments)}function ko(){return(ko=eo(ao.mark((function r(n,t){var e,o;return ao.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(_o(n)){r.next=2;break}return r.abrupt("return",Promise.reject("n[".concat(n,"] is not positive integer")));case 2:if(!((n=jo(n))<=1)){r.next=5;break}return r.abrupt("return",Promise.reject("n[".concat(n,"] <= 1")));case 5:if(Ge(t)||(t=.95),!((t=Je(t))<0)){r.next=9;break}return r.abrupt("return",Promise.reject("p[".concat(t,"] < 0")));case 9:if(!(t>1)){r.next=11;break}return r.abrupt("return",Promise.reject("p[".concat(t,"] > 1")));case 11:return e=n-1,o=ho.studentt.inv(t,e),r.abrupt("return",o);case 14:case"end":return r.stop()}}),r)})))).apply(this,arguments)}function qo(r,n){return Ao.apply(this,arguments)}function Ao(){return Ao=eo(ao.mark((function r(n,t){var e,o,a,u,i,f,c,s,l,h,p=arguments;return ao.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e=p.length>2&&void 0!==p[2]?p[2]:"two-tailed",Or(n)){r.next=3;break}return r.abrupt("return",Promise.reject("arr is not an array"));case 3:if(0!==kr(n)){r.next=5;break}return r.abrupt("return",Promise.reject("arr is not an effective array"));case 5:if(Ge(t)){r.next=7;break}return r.abrupt("return",Promise.reject("p[".concat(t,"] is not a number")));case 7:if(!((t=Je(t))<0)){r.next=10;break}return r.abrupt("return",Promise.reject("p[".concat(t,"] < 0")));case 10:if(!(t>1)){r.next=12;break}return r.abrupt("return",Promise.reject("p[".concat(t,"] > 1")));case 12:if("two-tailed"===e||"upper-tail"===e||"lower-tail"===e){r.next=14;break}return r.abrupt("return",Promise.reject("mode[".concat(e,"] is not 'two-tailed', 'upper-tail' or 'lower-tail'")));case 14:if(o=ro(n),0!==(a=kr(o))){r.next=18;break}return r.abrupt("return",Promise.reject("no effective data"));case 18:if(u=no(n),i=po(n),co(u)){r.next=22;break}return r.abrupt("return",Promise.reject("avg[".concat(u,"] is not a number")));case 22:if(co(i)){r.next=24;break}return r.abrupt("return",Promise.reject("sigma[".concat(i,"] is not a number")));case 24:if(f=null,"upper-tail"!==e&&"lower-tail"!==e){r.next=32;break}return r.next=28,Mo(a,t);case 28:c=r.sent,f="upper-tail"===e?u+c*i/Math.sqrt(a):u-c*i/Math.sqrt(a),r.next=39;break;case 32:if("two-tailed"!==e){r.next=39;break}return r.next=35,Mo(a,t/2);case 35:s=r.sent,l=u-s*i/Math.sqrt(a),h=u+s*i/Math.sqrt(a),f=[l,h];case 39:return r.abrupt("return",f);case 40:case"end":return r.stop()}}),r)}))),Ao.apply(this,arguments)}function Po(){return Po=eo(ao.mark((function r(n,t){var e,o,a,u=arguments;return ao.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e=u.length>2&&void 0!==u[2]?u[2]:"two-tailed",Or(n)){r.next=3;break}return r.abrupt("return",Promise.reject("arr is not an array"));case 3:if(0!==kr(n)){r.next=5;break}return r.abrupt("return",Promise.reject("arr is not an effective array"));case 5:if(Ge(t)){r.next=7;break}return r.abrupt("return",Promise.reject("p[".concat(t,"] is not a number")));case 7:if(!((t=Je(t))<0)){r.next=10;break}return r.abrupt("return",Promise.reject("p[".concat(t,"] < 0")));case 10:if(!(t>1)){r.next=12;break}return r.abrupt("return",Promise.reject("p[".concat(t,"] > 1")));case 12:if("two-tailed"===e||"upper-tail"===e||"lower-tail"===e){r.next=14;break}return r.abrupt("return",Promise.reject("mode[".concat(e,"] is not 'two-tailed', 'upper-tail' or 'lower-tail'")));case 14:if(o=fo(n),0!==kr(o)){r.next=18;break}return r.abrupt("return",Promise.reject("no effective data"));case 18:return r.next=20,qo(o,t,e);case 20:return a=Or(a=r.sent)?[Math.exp(a[0]),Math.exp(a[1])]:Math.exp(a),r.abrupt("return",a);case 23:case"end":return r.stop()}}),r)}))),Po.apply(this,arguments)}var Eo=function(r){return"function"==typeof r?r:Pr};var Oo=function(r,n){return(ar(r)?Wt:Dt)(r,Eo(n))};var So=function(r,n,t,e){for(var o=-1,a=null==r?0:r.length;++o<a;){var u=r[o];n(e,u,t(u),r)}return e};var No=function(r,n,t,e){return Dt(r,(function(r,o,a){n(e,r,t(r),a)})),e};var Io=function(r,n){return function(t,e){var o=ar(t)?So:No,a=n?n():{};return o(t,r,Rt(e),a)}},To=Object.prototype.hasOwnProperty,Fo=Io((function(r,n,t){To.call(r,t)?r[t].push(n):Xt(r,t,[n])})),zo=p?p.isConcatSpreadable:void 0;var Lo=function(r){return ar(r)||Gn(r)||!!(zo&&r&&r[zo])};var Ro=function r(n,t,e,o,a){var u=-1,i=n.length;for(e||(e=Lo),a||(a=[]);++u<i;){var f=n[u];t>0&&e(f)?t>1?r(f,t-1,e,o,a):Pn(a,f):o||(a[a.length]=f)}return a};var Co=function(r,n){var t=r.length;for(r.sort(n);t--;)r[t]=r[t].value;return r};var Do=function(r,n){if(r!==n){var t=void 0!==r,e=null===r,o=r==r,a=dt(r),u=void 0!==n,i=null===n,f=n==n,c=dt(n);if(!i&&!c&&!a&&r>n||a&&u&&f&&!i&&!c||e&&u&&f||!t&&f||!o)return 1;if(!e&&!a&&!c&&r<n||c&&t&&o&&!e&&!a||i&&t&&o||!u&&o||!f)return-1}return 0};var Go=function(r,n,t){for(var e=-1,o=r.criteria,a=n.criteria,u=o.length,i=t.length;++e<u;){var f=Do(o[e],a[e]);if(f)return e>=i?f:f*("desc"==t[e]?-1:1)}return r.index-n.index};var Uo=function(r,n,t){n=n.length?Sr(n,(function(r){return ar(r)?function(n){return Ot(n,1===r.length?r[0]:r)}:r})):[Pr];var e=-1;n=Sr(n,Yn(Rt));var o=Gt(r,(function(r,t,o){return{criteria:Sr(n,(function(n){return n(r)})),index:++e,value:r}}));return Co(o,(function(r,n){return Go(r,n,t)}))};var Bo=function(r,n,t){switch(t.length){case 0:return r.call(n);case 1:return r.call(n,t[0]);case 2:return r.call(n,t[0],t[1]);case 3:return r.call(n,t[0],t[1],t[2])}return r.apply(n,t)},Vo=Math.max;var Wo=function(r,n,t){return n=Vo(void 0===n?r.length-1:n,0),function(){for(var e=arguments,o=-1,a=Vo(e.length-n,0),u=Array(a);++o<a;)u[o]=e[n+o];o=-1;for(var i=Array(n+1);++o<n;)i[o]=e[o];return i[n]=t(u),Bo(r,this,i)}};var $o=function(r){return function(){return r}},Xo=$t?function(r,n){return $t(r,"toString",{configurable:!0,enumerable:!1,value:$o(n),writable:!0})}:Pr,Yo=Date.now;var Ho=function(r){var n=0,t=0;return function(){var e=Yo(),o=16-(e-t);if(t=e,o>0){if(++n>=800)return arguments[0]}else n=0;return r.apply(void 0,arguments)}},Qo=Ho(Xo);var Ko=function(r,n,t){if(!_(t))return!1;var e=i(n);return!!("number"==e?or(t)&&Wn(n,t.length):"string"==e&&n in t)&&Ir(t[n],r)},Zo=function(r,n){return Qo(Wo(r,n,Pr),r+"")}((function(r,n){if(null==r)return[];var t=n.length;return t>1&&Ko(r,n[0],n[1])?n=[]:t>2&&Ko(n[0],n[1],n[2])&&(n=[n[0]]),Uo(r,Ro(n,1),[])})),Jo=Array.prototype.reverse;var ra=function(r){return null==r?r:Jo.call(r)};var na=function(r){return r&&r.length?qr(r,Pr):0};function ta(r){var n=Object.prototype.toString.call(r);return"[object Function]"===n||"[object AsyncFunction]"===n}function ea(r){var n,t=Object.prototype.toString.call(r);if(n="[object Promise]"===t)return!0;if("[object Function]"!==t)return!1;try{n="function"!=typeof r.subscribe&&"function"==typeof r.then}catch(r){}return n}function oa(r,n,t,e,o){for(var a=0;a<r.length;++a)r[a]=n*t[a]+e*o[a]}function aa(r,n){return r.y-n.y}function ua(r,n){return ia.apply(this,arguments)}function ia(){return ia=eo(ao.mark((function r(n,t){var e,o,a,u,i,f,c,s,l,h,p,v,d,m,g,b,y,w,x,j,_,M,k,q,A,P,E,O,S,N,I,T,F,z=arguments;return ao.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(m=function(){return m=eo(ao.mark((function r(){var t,e=arguments;return ao.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!ea(t=n.apply(void 0,e))){r.next=5;break}return r.next=4,t;case 4:t=r.sent;case 5:return v++,r.abrupt("return",t);case 7:case"end":return r.stop()}}),r)}))),m.apply(this,arguments)},d=function(){return m.apply(this,arguments)},e=z.length>2&&void 0!==z[2]?z[2]:{},ta(n)){r.next=5;break}return r.abrupt("return",Promise.reject("invalid fun"));case 5:if(Ce(t)){r.next=7;break}return r.abrupt("return",Promise.reject("params is not an effective array"));case 7:return o=kr(t),Ge(a=St(e,"maxIterations"))||(a=200*o),a=Je(a),Ge(u=St(e,"nonZeroDelta"))||(u=1.05),u=Je(u),Ge(i=St(e,"delta"))||(i=.001),i=Je(i),Ge(f=St(e,"minErrorDelta"))||(f=1e-6),f=Je(f),Ge(c=St(e,"minTolerance"))||(c=1e-5),c=Je(c),Ge(s=St(e,"rho"))||(s=1),s=Je(s),Ge(l=St(e,"chi"))||(l=2),l=Je(l),Ge(h=St(e,"psi"))||(h=-.5),h=Je(h),Ge(p=St(e,"sigma"))||(p=.5),p=Je(p),v=0,(g=new Array(o+1))[0]=t,r.next=40,d(t);case 40:g[0].y=r.sent,g[0].id=0,b=0;case 43:if(!(b<o)){r.next=54;break}return(y=t.slice())[b]=y[b]?y[b]*u:i,g[b+1]=y,r.next=49,d(y);case 49:g[b+1].y=r.sent,g[b+1].id=b+1;case 51:++b,r.next=43;break;case 54:w=function(r){for(var n=0;n<r.length;n++)g[o][n]=r[n];g[o].y=r.y},j=t.slice(),_=t.slice(),M=t.slice(),k=t.slice(),q=0;case 60:if(!(q<a)){r.next=113;break}for(g.sort(aa),x=0,A=0;A<o;++A)x=Math.max(x,Math.abs(g[0][A]-g[1][A]));if(!(Math.abs(g[0].y-g[o].y)<f&&x<c)){r.next=66;break}return r.abrupt("break",113);case 66:for(P=0;P<o;++P){for(j[P]=0,E=0;E<o;++E)j[P]+=g[E][P];j[P]/=o}return O=g[o],oa(_,1+s,j,-s,O),r.next=71,d(_);case 71:if(_.y=r.sent,!(_.y<g[0].y)){r.next=80;break}return oa(k,1+l,j,-l,O),r.next=76,d(k);case 76:k.y=r.sent,k.y<_.y?w(k):w(_),r.next=110;break;case 80:if(!(_.y>=g[o-1].y)){r.next=109;break}if(S=!1,!(_.y>O.y)){r.next=90;break}return oa(M,1+h,j,-h,O),r.next=86,d(M);case 86:M.y=r.sent,M.y<O.y?w(M):S=!0,r.next=95;break;case 90:return oa(M,1-h*s,j,h*s,O),r.next=93,d(M);case 93:M.y=r.sent,M.y<_.y?w(M):S=!0;case 95:if(!S){r.next=107;break}if(!(p>=1)){r.next=98;break}return r.abrupt("break",113);case 98:N=1;case 99:if(!(N<g.length)){r.next=107;break}return oa(g[N],1-p,g[0],p,g[N]),r.next=103,d(g[N]);case 103:g[N].y=r.sent;case 104:++N,r.next=99;break;case 107:r.next=110;break;case 109:w(_);case 110:++q,r.next=60;break;case 113:for(g.sort(aa),I=[],T=g[0],F=0;F<o;F++)I.push(T[F]);return r.abrupt("return",{count:v,y:g[0].y,x:I});case 118:case"end":return r.stop()}}),r)}))),ia.apply(this,arguments)}var fa=function(r,n,t){for(var e=-1,o=r.length;++e<o;){var a=r[e],u=n(a);if(null!=u&&(void 0===i?u==u&&!dt(u):t(u,i)))var i=u,f=a}return f};var ca=function(r,n){return r<n};var sa=function(r){return r&&r.length?fa(r,Pr,ca):void 0};var la=function(r,n){return r>n};var ha=function(r){return r&&r.length?fa(r,Pr,la):void 0};function pa(r,n){return!!ze(r)&&(!(!De(n)&&!Ge(n))&&n in r)}function va(r,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},e=St(t,"keyMax");De(e)||(e="max");var o=St(t,"keyMin");De(o)||(o="min");var a=St(t,"keyValue");De(a)||(a="value");var u=St(t,"keyItems");if(De(u)||(u="items"),!Ce(r))return[];if(!Ce(n))return[];var i=Fe(n);return Oo(r,(function(r,t){var f=St(r,a);Ge(f)?f=Je(f):Ge(r)&&(f=Je(r)),co(f)&&Oo(n,(function(n,t){var a=St(n,e,null),c=St(n,o,null);if(null!==a&&null!==c&&Ge(a)&&Ge(c)){var s=St(n,"maxType");"<="!==s&&"<"!==s&&(s="<=");var l,h=St(n,"minType");">="!==h&&">"!==h&&(h=">="),a=Je(a),c=Je(c),l="<="===s?f<=a:f<a,(">="===h?f>=c:f>c)&&l&&(pa(i[t],u)||(i[t][u]=[]),i[t][u].push(r))}}))})),i}function da(r,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(!Ge(r))return[];if(r=Je(r),!Ge(n))return[];n=Je(n),_o(t)||(t=1);for(var e=(n-r)/(t=jo(t)),o=r,a=[],u=0;u<=t;u++)a.push(o),o+=e;return a}function ma(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_o(n)||(n=30),n=jo(n);var e=ro(r);if(0===kr(e))return[];var o=St(t,"min",null);Ge(o)||(o=sa(e)),o=Je(o);var a=St(t,"max",null);Ge(a)||(a=ha(e));for(var u=da(o,a=Je(a),n),i=[],f=0;f<kr(u)-1;f++){var c=0===f?">=":">",s="<=",l={min:u[f],max:u[f+1],avg:(u[f]+u[f+1])/2,minType:c,maxType:s};i.push(l)}var h=va(e,i),p=Ut(h,(function(r){return{min:r.min,max:r.max,avg:r.avg,arr:St(r,"items",[])}}));return p}function ga(r){return ba.apply(this,arguments)}function ba(){return ba=eo(ao.mark((function r(n){var t,e,o,a,u,i,f,c,s,l,h,p,v,d,m,g,b=arguments;return ao.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=b.length>1&&void 0!==b[1]?b[1]:{},Or(n)){r.next=3;break}return r.abrupt("return",Promise.reject("arr is not an array"));case 3:if(0!==kr(n)){r.next=5;break}return r.abrupt("return",Promise.reject("arr is not an effective array"));case 5:if(_o(e=St(t,"n"))||(e=30),e=jo(e),o=St(t,"min",null),a=St(t,"max",null),u=ro(n),u=Vt(u,(function(r){return r>0})),0!==kr(u)){r.next=15;break}return r.abrupt("return",Promise.reject("no effective data"));case 15:if(i=ma(u,e,{min:o,max:a}),f=St(i,"0.max")-St(i,"0.min"),i=Ut(i,(function(r){return r.counts=kr(r.arr),r})),!((c=na(Ut(i,"counts"))*f)<=0)){r.next=21;break}throw new Error("r[".concat(c,"<=0]"));case 21:return i=Ut(i,(function(r){return r.pdf=r.counts/c,r})),s=function(r,n,t){return ho.gamma.pdf(r,n,t)},l=function(r,n){var t=[];return Oo(i,(function(e){var o=e.avg,a=e.pdf,u=s(o,r,n);if(!co(u))throw console.log("x",o,"shape",r,"scale",n),new Error("yf is not number");t.push([o,a,u])})),t},h=function(){var r=eo(ao.mark((function r(n){var t,e,o;return ao.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=n[0],e=n[1],o=0,Oo(l(t,e),(function(r){var n=r[1],t=r[2];o+=Math.pow(n-t,2)})),r.abrupt("return",o);case 5:case"end":return r.stop()}}),r)})));return function(n){return r.apply(this,arguments)}}(),r.next=27,ua(h,[1,1]);case 27:return p=r.sent,v=St(p,"x.0",null),d=St(p,"x.1",null),m=l(v,d),g=Ut(m,(function(r){return[r[0],r[1]*c,r[2]*c]})),r.abrupt("return",{shape:v,scale:d,arr:u,arrPdf:m,arrCounts:g,dx:f,bs:i});case 33:case"end":return r.stop()}}),r)}))),ba.apply(this,arguments)}function ya(r,n){(null==n||n>r.length)&&(n=r.length);for(var t=0,e=new Array(n);t<n;t++)e[t]=r[t];return e}function wa(r){return function(r){if(Array.isArray(r))return ya(r)}(r)||function(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||function(r,n){if(r){if("string"==typeof r)return ya(r,n);var t=Object.prototype.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?ya(r,n):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var xa=wo("floor"),ja=wo("ceil");function _a(r,n){return Ma.apply(this,arguments)}function Ma(){return Ma=eo(ao.mark((function r(n,t){var e,o,a,u,i,f,c,s,l,h,p,v,d,m,g,b,y,w,x=arguments;return ao.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e=x.length>2&&void 0!==x[2]?x[2]:{},ta(t)){r.next=3;break}throw new Error("invalid fun");case 3:if(o=ro(n),0!==kr(o)){r.next=6;break}return r.abrupt("return",null);case 6:if(_o(a=St(e,"nCurve"))||(a=100),a=jo(a),Ge(u=St(e,"dx",null))?(u=Je(u),s=sa(o),l=ha(o),f=xa(s/u)*u,c=ja(l/u)*u,i=xo(c-f)/u):(_o(i=St(e,"n"))||(i=30),i=jo(i),f=St(e,"min",null),c=St(e,"max",null)),h=ma(o,i,{min:f,max:c}),Ge(u)||(u=St(h,"0.max")-St(h,"0.min")),h=Ut(h,(function(r){return r.counts=kr(r.arr),r})),p=[].concat(wa(Ut(h,"min")),wa(Ut(h,"max"))),v=sa(p),d=ha(p),m=Ut(h,"counts"),g=na(m)*u,b=Ut(m,(function(r){return r/g})),y=da(v,d,a),!ea(w=t({arr:o,min:v,max:d,barWidth:u,bins:h,counts:m,pdfs:b,curveX:y}))){r.next=26;break}return r.next=25,w;case 25:w=r.sent;case 26:return r.abrupt("return",{arr:o,min:v,max:d,barWidth:u,bins:h,counts:m,pdfs:b,ratioForCountToPdf:1/g,curveX:y,curveY:w});case 27:case"end":return r.stop()}}),r)}))),Ma.apply(this,arguments)}function ka(){return ka=eo(ao.mark((function r(n){var t,e,o,a,u,i,f,c=arguments;return ao.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=c.length>1&&void 0!==c[1]?c[1]:{},Or(n)){r.next=3;break}return r.abrupt("return",Promise.reject("arr is not an array"));case 3:if(0!==kr(n)){r.next=5;break}return r.abrupt("return",Promise.reject("arr is not an effective array"));case 5:return e=ro(n),e=Vt(e,(function(r){return r>0})),r.next=9,ga(n,t);case 9:return o=r.sent,r.next=12,_a(e,(function(r){return Ut(r.curveX,(function(r){return ho.gamma.pdf(r,o.shape,o.scale)}))}),t);case 12:return a=r.sent,u=Ut(a.bins,(function(r,n){return r.pdf=a.pdfs[n],r})),i=Ut(a.curveX,(function(r,n){return{x:r,pdf:a.curveY[n]}})),f={shape:o.shape,scale:o.scale,arr:a.arr,min:a.min,max:a.max,barWidth:a.barWidth,ratioForCountToPdf:a.ratioForCountToPdf,bins:u,curves:i},r.abrupt("return",f);case 17:case"end":return r.stop()}}),r)}))),ka.apply(this,arguments)}function qa(r,n,t){return n in r?Object.defineProperty(r,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[n]=t,r}function Aa(r,n){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(r);n&&(e=e.filter((function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable}))),t.push.apply(t,e)}return t}function Pa(r){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Aa(Object(t),!0).forEach((function(n){qa(r,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Aa(Object(t)).forEach((function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))}))}return r}function Ea(){return Ea=eo(ao.mark((function r(n,t){var e,o,a,u,i,f,c=arguments;return ao.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e=c.length>2&&void 0!==c[2]?c[2]:{},Or(n)){r.next=3;break}return r.abrupt("return",Promise.reject("arr is not an array"));case 3:if(0!==kr(n)){r.next=5;break}return r.abrupt("return",Promise.reject("arr is not an effective array"));case 5:if(Ge(t)){r.next=7;break}return r.abrupt("return",Promise.reject("ratio[".concat(t,"] is not a number")));case 7:if(!((t=Je(t))<0)){r.next=10;break}return r.abrupt("return",Promise.reject("ratio[".concat(t,"] < 0")));case 10:if(!(t>1)){r.next=12;break}return r.abrupt("return",Promise.reject("ratio[".concat(t,"] > 1")));case 12:return _o(o=St(e,"n"))||(o=30),o=jo(o),a=St(e,"min",null),u=St(e,"max",null),r.next=19,ga(n,{n:o,min:a,max:u});case 19:return i=r.sent,f=ho.gamma.inv(t,i.shape,i.scale),r.abrupt("return",Pa({inv:f},i));case 22:case"end":return r.stop()}}),r)}))),Ea.apply(this,arguments)}function Oa(r){if(!Or(r))return null;if(0===kr(r))return null;var n=io(r),t=kr(n);if(0===t)return null;var e=0;Oo(n,(function(r){e+=Math.log(r)})),e/=t;try{e=Math.exp(e)}catch(r){return console.log(r),null}return e}function Sa(r){return Na.apply(this,arguments)}function Na(){return Na=eo(ao.mark((function r(n){var t,e,o,a,u,i,f,c=arguments;return ao.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=c.length>1&&void 0!==c[1]?c[1]:{},Or(n)){r.next=3;break}return r.abrupt("return",Promise.reject("arr is not an array"));case 3:if(0!==kr(n)){r.next=5;break}return r.abrupt("return",Promise.reject("arr is not an effective array"));case 5:return e=null,o=null,r.next=9,_a(n,(function(r){e=no(r.arr);var n=(o=po(r.arr))*Math.sqrt(2*Math.PI);return Ut(r.curveX,(function(r){var t=0;return 0!==n&&(t=1/n*Math.exp(-Math.pow(r-e,2)/(2*Math.pow(o,2)))),t}))}),t);case 9:return a=r.sent,u=Ut(a.bins,(function(r,n){return r.pdf=a.pdfs[n],r})),i=Ut(a.curveX,(function(r,n){return{x:r,pdf:a.curveY[n]}})),f={avg:e,std:o,arr:a.arr,min:a.min,max:a.max,barWidth:a.barWidth,ratioForCountToPdf:a.ratioForCountToPdf,bins:u,curves:i},r.abrupt("return",f);case 14:case"end":return r.stop()}}),r)}))),Na.apply(this,arguments)}function Ia(){return Ia=eo(ao.mark((function r(n){var t,e,o,a,u,i,f,c,s=arguments;return ao.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=s.length>1&&void 0!==s[1]?s[1]:{},Or(n)){r.next=3;break}return r.abrupt("return",Promise.reject("arr is not an array"));case 3:if(0!==kr(n)){r.next=5;break}return r.abrupt("return",Promise.reject("arr is not an effective array"));case 5:return r.next=7,Sa(n,t);case 7:return e=r.sent,o=fo(n),r.next=11,Sa(o);case 11:return a=r.sent,u=Ut(a.curves,(function(r){return{x:Math.exp(r.x),pdf:r.pdf}})),i=e.ratioForCountToPdf/a.ratioForCountToPdf,u=Ut(u,(function(r){return r.pdf*=i,r})),f=Oa(e.arr),c={avg:e.avg,std:e.std,avg_geo:f,avg_log:a.avg,std_log:a.std,arr:e.arr,min:e.min,max:e.max,barWidth:e.barWidth,ratioForCountToPdf:e.ratioForCountToPdf,bins:e.bins,curves:u},r.abrupt("return",c);case 18:case"end":return r.stop()}}),r)}))),Ia.apply(this,arguments)}function Ta(r,n){return Fa.apply(this,arguments)}function Fa(){return Fa=eo(ao.mark((function r(n,t){var e,o,a,u;return ao.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(Or(n)){r.next=2;break}return r.abrupt("return",Promise.reject("arr is not an array"));case 2:if(0!==kr(n)){r.next=4;break}return r.abrupt("return",Promise.reject("arr is not an effective array"));case 4:if(Ge(t)){r.next=6;break}return r.abrupt("return",Promise.reject("ratio[".concat(t,"] is not a number")));case 6:if(!((t=Je(t))<0)){r.next=9;break}return r.abrupt("return",Promise.reject("ratio[".concat(t,"] < 0")));case 9:if(!(t>1)){r.next=11;break}return r.abrupt("return",Promise.reject("ratio[".concat(t,"] > 1")));case 11:if(e=ro(n),0!==kr(e)){r.next=15;break}return r.abrupt("return",Promise.reject("no effective data"));case 15:if(o=no(e),a=po(e),co(o)){r.next=19;break}return r.abrupt("return",Promise.reject("avg[".concat(o,"] is not a number")));case 19:if(co(a)){r.next=21;break}return r.abrupt("return",Promise.reject("std[".concat(a,"] is not a number")));case 21:if(!(a<=0)){r.next=23;break}return r.abrupt("return",Promise.reject("std[".concat(a,"] <= 0")));case 23:return u=ho.normal.inv(t,o,a),r.abrupt("return",{inv:u,avg:o,std:a,arr:e});case 25:case"end":return r.stop()}}),r)}))),Fa.apply(this,arguments)}function za(){return za=eo(ao.mark((function r(n,t){var e,o;return ao.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(Or(n)){r.next=2;break}return r.abrupt("return",Promise.reject("arr is not an array"));case 2:if(0!==kr(n)){r.next=4;break}return r.abrupt("return",Promise.reject("arr is not an effective array"));case 4:if(Ge(t)){r.next=6;break}return r.abrupt("return",Promise.reject("ratio[".concat(t,"] is not a number")));case 6:if(!((t=Je(t))<0)){r.next=9;break}return r.abrupt("return",Promise.reject("ratio[".concat(t,"] < 0")));case 9:if(!(t>1)){r.next=11;break}return r.abrupt("return",Promise.reject("ratio[".concat(t,"] > 1")));case 11:if(e=fo(n),0!==kr(e)){r.next=15;break}return r.abrupt("return",Promise.reject("no effective data"));case 15:return r.next=17,Ta(e,t);case 17:if(o=r.sent,co(St(o,"inv"))){r.next=20;break}return r.abrupt("return",Promise.reject("invalid value from arrNormInv"));case 20:return o={inv:Math.exp(o.inv),avg:Math.exp(o.avg),std:Math.exp(o.std),arr:Ut(o.arr,(function(r){return Math.exp(r)}))},r.abrupt("return",o);case 22:case"end":return r.stop()}}),r)}))),za.apply(this,arguments)}function La(r){return!!go(r)&&jo(r)>=0}function Ra(r){if(0===r.length)return 0;var n,t=r[0],e=0;if("number"!=typeof t)return NaN;for(var o=1;o<r.length;o++){if("number"!=typeof r[o])return NaN;n=t+r[o],Math.abs(t)>=Math.abs(r[o])?e+=t-n+r[o]:e+=r[o]-n+t,t=n}return t+e}function Ca(r){if(0===r.length)throw new Error("mean requires at least one data point");return Ra(r)/r.length}function Da(r,n){var t,e,o=Ca(r),a=0;if(2===n)for(e=0;e<r.length;e++)a+=(t=r[e]-o)*t;else for(e=0;e<r.length;e++)a+=Math.pow(r[e]-o,n);return a}function Ga(r){if(0===r.length)throw new Error("variance requires at least one data point");return Da(r,2)/r.length}function Ua(r){if(1===r.length)return 0;var n=Ga(r);return Math.sqrt(n)}function Ba(r){if(0===r.length)throw new Error("mode requires at least one data point");if(1===r.length)return r[0];for(var n=r[0],t=NaN,e=0,o=1,a=1;a<r.length+1;a++)r[a]!==n?(o>e&&(e=o,t=n),o=1,n=r[a]):o++;return t}function Va(r){return r.slice().sort((function(r,n){return r-n}))}function Wa(r){if(0===r.length)throw new Error("min requires at least one data point");for(var n=r[0],t=1;t<r.length;t++)r[t]<n&&(n=r[t]);return n}function $a(r){if(0===r.length)throw new Error("max requires at least one data point");for(var n=r[0],t=1;t<r.length;t++)r[t]>n&&(n=r[t]);return n}function Xa(r){for(var n=0,t=0;t<r.length;t++){if("number"!=typeof r[t])return NaN;n+=r[t]}return n}function Ya(r,n){var t=r.length*n;if(0===r.length)throw new Error("quantile requires at least one data point.");if(n<0||n>1)throw new Error("quantiles must be between 0 and 1");return 1===n?r[r.length-1]:0===n?r[0]:t%1!=0?r[Math.ceil(t)-1]:r.length%2==0?(r[t-1]+r[t])/2:r[t]}function Ha(r,n,t,e){for(t=t||0,e=e||r.length-1;e>t;){if(e-t>600){var o=e-t+1,a=n-t+1,u=Math.log(o),i=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*i*(o-i)/o);a-o/2<0&&(f*=-1),Ha(r,n,Math.max(t,Math.floor(n-a*i/o+f)),Math.min(e,Math.floor(n+(o-a)*i/o+f)))}var c=r[n],s=t,l=e;for(Qa(r,t,n),r[e]>c&&Qa(r,t,e);s<l;){for(Qa(r,s,l),s++,l--;r[s]<c;)s++;for(;r[l]>c;)l--}r[t]===c?Qa(r,t,l):Qa(r,++l,e),l<=n&&(t=l+1),n<=l&&(e=l-1)}}function Qa(r,n,t){var e=r[n];r[n]=r[t],r[t]=e}function Ka(r,n){var t=r.slice();if(Array.isArray(n)){!function(r,n){for(var t=[0],e=0;e<n.length;e++)t.push(ru(r.length,n[e]));t.push(r.length-1),t.sort(Ja);var o=[0,t.length-1];for(;o.length;){var a=Math.ceil(o.pop()),u=Math.floor(o.pop());if(!(a-u<=1)){var i=Math.floor((u+a)/2);Za(r,t[i],Math.floor(t[u]),Math.ceil(t[a])),o.push(u,i,i,a)}}}(t,n);for(var e=[],o=0;o<n.length;o++)e[o]=Ya(t,n[o]);return e}return Za(t,ru(t.length,n),0,t.length-1),Ya(t,n)}function Za(r,n,t,e){n%1==0?Ha(r,n,t,e):(Ha(r,n=Math.floor(n),t,e),Ha(r,n+1,n+1,e))}function Ja(r,n){return r-n}function ru(r,n){var t=r*n;return 1===n?r-1:0===n?0:t%1!=0?Math.ceil(t)-1:r%2==0?t-.5:t}function nu(r,n){if(n<r[0])return 0;if(n>r[r.length-1])return 1;var t=function(r,n){var t=0,e=0,o=r.length;for(;e<o;)n<=r[t=e+o>>>1]?o=t:e=-~t;return e}(r,n);if(r[t]!==n)return t/r.length;t++;var e=function(r,n){var t=0,e=0,o=r.length;for(;e<o;)n>=r[t=e+o>>>1]?e=-~t:o=t;return e}(r,n);if(e===t)return t/r.length;var o=e-t+1;return o*(e+t)/2/o/r.length}function tu(r){var n=Ka(r,.75),t=Ka(r,.25);if("number"==typeof n&&"number"==typeof t)return n-t}function eu(r){return+Ka(r,.5)}function ou(r){for(var n=eu(r),t=[],e=0;e<r.length;e++)t.push(Math.abs(r[e]-n));return eu(t)}function au(r,n){n=n||Math.random;for(var t,e,o=r.length;o>0;)e=Math.floor(n()*o--),t=r[o],r[o]=r[e],r[e]=t;return r}function uu(r,n){return au(r.slice(),n)}function iu(r,n,t){return uu(r,t).slice(0,n)}function fu(r,n){for(var t=[],e=0;e<r;e++){for(var o=[],a=0;a<n;a++)o.push(0);t.push(o)}return t}function cu(r){for(var n,t=0,e=0;e<r.length;e++)0!==e&&r[e]===n||(n=r[e],t++);return t}function su(r,n,t,e){var o;if(r>0){var a=(t[n]-t[r-1])/(n-r+1);o=e[n]-e[r-1]-(n-r+1)*a*a}else o=e[n]-t[n]*t[n]/(n+1);return o<0?0:o}function lu(r,n,t,e,o,a,u){if(!(r>n)){var i=Math.floor((r+n)/2);e[t][i]=e[t-1][i-1],o[t][i]=i;var f=t;r>t&&(f=Math.max(f,o[t][r-1]||0)),f=Math.max(f,o[t-1][i]||0);var c,s,l,h=i-1;n<e[0].length-1&&(h=Math.min(h,o[t][n+1]||0));for(var p=h;p>=f&&!((c=su(p,i,a,u))+e[t-1][f-1]>=e[t][i]);--p)(s=su(f,i,a,u)+e[t-1][f-1])<e[t][i]&&(e[t][i]=s,o[t][i]=f),f++,(l=c+e[t-1][p-1])<e[t][i]&&(e[t][i]=l,o[t][i]=p);lu(r,i-1,t,e,o,a,u),lu(i+1,n,t,e,o,a,u)}}function hu(r,n){if(r.length!==n.length)throw new Error("sampleCovariance requires samples with equal lengths");if(r.length<2)throw new Error("sampleCovariance requires at least two data points in each sample");for(var t=Ca(r),e=Ca(n),o=0,a=0;a<r.length;a++)o+=(r[a]-t)*(n[a]-e);return o/(r.length-1)}function pu(r){if(r.length<2)throw new Error("sampleVariance requires at least two data points");return Da(r,2)/(r.length-1)}function vu(r){var n=pu(r);return Math.sqrt(n)}function du(r,n){return hu(r,n)/vu(r)/vu(n)}function mu(r,n,t,e){return(r*n+t*e)/(n+e)}function gu(r){if(0===r.length)throw new Error("meanSimple requires at least one data point");return Xa(r)/r.length}function bu(r){if(0===r.length)throw new Error("rootMeanSquare requires at least one data point");for(var n=0,t=0;t<r.length;t++)n+=Math.pow(r[t],2);return Math.sqrt(n/r.length)}var yu=function(){this.totalCount=0,this.data={}};yu.prototype.train=function(r,n){for(var t in this.data[n]||(this.data[n]={}),r){var e=r[t];void 0===this.data[n][t]&&(this.data[n][t]={}),void 0===this.data[n][t][e]&&(this.data[n][t][e]=0),this.data[n][t][e]++}this.totalCount++},yu.prototype.score=function(r){var n,t={};for(var e in r){var o=r[e];for(n in this.data)t[n]={},this.data[n][e]?t[n][e+"_"+o]=(this.data[n][e][o]||0)/this.totalCount:t[n][e+"_"+o]=0}var a={};for(n in t)for(var u in a[n]=0,t[n])a[n]+=t[n][u];return a};var wu=function(){this.weights=[],this.bias=0};wu.prototype.predict=function(r){if(r.length!==this.weights.length)return null;for(var n=0,t=0;t<this.weights.length;t++)n+=this.weights[t]*r[t];return(n+=this.bias)>0?1:0},wu.prototype.train=function(r,n){if(0!==n&&1!==n)return null;r.length!==this.weights.length&&(this.weights=r,this.bias=1);var t=this.predict(r);if("number"==typeof t&&t!==n){for(var e=n-t,o=0;o<this.weights.length;o++)this.weights[o]+=e*r[o];this.bias+=e}return this};var xu=1e-4;function ju(r){if(r<0)throw new Error("factorial requires a non-negative value");if(Math.floor(r)!==r)throw new Error("factorial requires an integer input");for(var n=1,t=2;t<=r;t++)n*=t;return n}var _u=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],Mu=Math.log(Math.sqrt(2*Math.PI));var ku={1:{.995:0,.99:0,.975:0,.95:0,.9:.02,.5:.45,.1:2.71,.05:3.84,.025:5.02,.01:6.63,.005:7.88},2:{.995:.01,.99:.02,.975:.05,.95:.1,.9:.21,.5:1.39,.1:4.61,.05:5.99,.025:7.38,.01:9.21,.005:10.6},3:{.995:.07,.99:.11,.975:.22,.95:.35,.9:.58,.5:2.37,.1:6.25,.05:7.81,.025:9.35,.01:11.34,.005:12.84},4:{.995:.21,.99:.3,.975:.48,.95:.71,.9:1.06,.5:3.36,.1:7.78,.05:9.49,.025:11.14,.01:13.28,.005:14.86},5:{.995:.41,.99:.55,.975:.83,.95:1.15,.9:1.61,.5:4.35,.1:9.24,.05:11.07,.025:12.83,.01:15.09,.005:16.75},6:{.995:.68,.99:.87,.975:1.24,.95:1.64,.9:2.2,.5:5.35,.1:10.65,.05:12.59,.025:14.45,.01:16.81,.005:18.55},7:{.995:.99,.99:1.25,.975:1.69,.95:2.17,.9:2.83,.5:6.35,.1:12.02,.05:14.07,.025:16.01,.01:18.48,.005:20.28},8:{.995:1.34,.99:1.65,.975:2.18,.95:2.73,.9:3.49,.5:7.34,.1:13.36,.05:15.51,.025:17.53,.01:20.09,.005:21.96},9:{.995:1.73,.99:2.09,.975:2.7,.95:3.33,.9:4.17,.5:8.34,.1:14.68,.05:16.92,.025:19.02,.01:21.67,.005:23.59},10:{.995:2.16,.99:2.56,.975:3.25,.95:3.94,.9:4.87,.5:9.34,.1:15.99,.05:18.31,.025:20.48,.01:23.21,.005:25.19},11:{.995:2.6,.99:3.05,.975:3.82,.95:4.57,.9:5.58,.5:10.34,.1:17.28,.05:19.68,.025:21.92,.01:24.72,.005:26.76},12:{.995:3.07,.99:3.57,.975:4.4,.95:5.23,.9:6.3,.5:11.34,.1:18.55,.05:21.03,.025:23.34,.01:26.22,.005:28.3},13:{.995:3.57,.99:4.11,.975:5.01,.95:5.89,.9:7.04,.5:12.34,.1:19.81,.05:22.36,.025:24.74,.01:27.69,.005:29.82},14:{.995:4.07,.99:4.66,.975:5.63,.95:6.57,.9:7.79,.5:13.34,.1:21.06,.05:23.68,.025:26.12,.01:29.14,.005:31.32},15:{.995:4.6,.99:5.23,.975:6.27,.95:7.26,.9:8.55,.5:14.34,.1:22.31,.05:25,.025:27.49,.01:30.58,.005:32.8},16:{.995:5.14,.99:5.81,.975:6.91,.95:7.96,.9:9.31,.5:15.34,.1:23.54,.05:26.3,.025:28.85,.01:32,.005:34.27},17:{.995:5.7,.99:6.41,.975:7.56,.95:8.67,.9:10.09,.5:16.34,.1:24.77,.05:27.59,.025:30.19,.01:33.41,.005:35.72},18:{.995:6.26,.99:7.01,.975:8.23,.95:9.39,.9:10.87,.5:17.34,.1:25.99,.05:28.87,.025:31.53,.01:34.81,.005:37.16},19:{.995:6.84,.99:7.63,.975:8.91,.95:10.12,.9:11.65,.5:18.34,.1:27.2,.05:30.14,.025:32.85,.01:36.19,.005:38.58},20:{.995:7.43,.99:8.26,.975:9.59,.95:10.85,.9:12.44,.5:19.34,.1:28.41,.05:31.41,.025:34.17,.01:37.57,.005:40},21:{.995:8.03,.99:8.9,.975:10.28,.95:11.59,.9:13.24,.5:20.34,.1:29.62,.05:32.67,.025:35.48,.01:38.93,.005:41.4},22:{.995:8.64,.99:9.54,.975:10.98,.95:12.34,.9:14.04,.5:21.34,.1:30.81,.05:33.92,.025:36.78,.01:40.29,.005:42.8},23:{.995:9.26,.99:10.2,.975:11.69,.95:13.09,.9:14.85,.5:22.34,.1:32.01,.05:35.17,.025:38.08,.01:41.64,.005:44.18},24:{.995:9.89,.99:10.86,.975:12.4,.95:13.85,.9:15.66,.5:23.34,.1:33.2,.05:36.42,.025:39.36,.01:42.98,.005:45.56},25:{.995:10.52,.99:11.52,.975:13.12,.95:14.61,.9:16.47,.5:24.34,.1:34.28,.05:37.65,.025:40.65,.01:44.31,.005:46.93},26:{.995:11.16,.99:12.2,.975:13.84,.95:15.38,.9:17.29,.5:25.34,.1:35.56,.05:38.89,.025:41.92,.01:45.64,.005:48.29},27:{.995:11.81,.99:12.88,.975:14.57,.95:16.15,.9:18.11,.5:26.34,.1:36.74,.05:40.11,.025:43.19,.01:46.96,.005:49.65},28:{.995:12.46,.99:13.57,.975:15.31,.95:16.93,.9:18.94,.5:27.34,.1:37.92,.05:41.34,.025:44.46,.01:48.28,.005:50.99},29:{.995:13.12,.99:14.26,.975:16.05,.95:17.71,.9:19.77,.5:28.34,.1:39.09,.05:42.56,.025:45.72,.01:49.59,.005:52.34},30:{.995:13.79,.99:14.95,.975:16.79,.95:18.49,.9:20.6,.5:29.34,.1:40.26,.05:43.77,.025:46.98,.01:50.89,.005:53.67},40:{.995:20.71,.99:22.16,.975:24.43,.95:26.51,.9:29.05,.5:39.34,.1:51.81,.05:55.76,.025:59.34,.01:63.69,.005:66.77},50:{.995:27.99,.99:29.71,.975:32.36,.95:34.76,.9:37.69,.5:49.33,.1:63.17,.05:67.5,.025:71.42,.01:76.15,.005:79.49},60:{.995:35.53,.99:37.48,.975:40.48,.95:43.19,.9:46.46,.5:59.33,.1:74.4,.05:79.08,.025:83.3,.01:88.38,.005:91.95},70:{.995:43.28,.99:45.44,.975:48.76,.95:51.74,.9:55.33,.5:69.33,.1:85.53,.05:90.53,.025:95.02,.01:100.42,.005:104.22},80:{.995:51.17,.99:53.54,.975:57.15,.95:60.39,.9:64.28,.5:79.33,.1:96.58,.05:101.88,.025:106.63,.01:112.33,.005:116.32},90:{.995:59.2,.99:61.75,.975:65.65,.95:69.13,.9:73.29,.5:89.33,.1:107.57,.05:113.14,.025:118.14,.01:124.12,.005:128.3},100:{.995:67.33,.99:70.06,.975:74.22,.95:77.93,.9:82.36,.5:99.33,.1:118.5,.05:124.34,.025:129.56,.01:135.81,.005:140.17}};var qu=Math.sqrt(2*Math.PI),Au={gaussian:function(r){return Math.exp(-.5*r*r)/qu}},Pu={nrd:function(r){var n=vu(r),t=tu(r);return"number"==typeof t&&(n=Math.min(n,t/1.34)),1.06*n*Math.pow(r.length,-.2)}};function Eu(r,n,t){var e,o;if(void 0===n)e=Au.gaussian;else if("string"==typeof n){if(!Au[n])throw new Error('Unknown kernel "'+n+'"');e=Au[n]}else e=n;if(void 0===t)o=Pu.nrd(r);else if("string"==typeof t){if(!Pu[t])throw new Error('Unknown bandwidth method "'+t+'"');o=Pu[t](r)}else o=t;return function(n){var t=0,a=0;for(t=0;t<r.length;t++)a+=e((n-r[t])/o);return a/o/r.length}}var Ou=Math.sqrt(2*Math.PI);function Su(r){for(var n=r,t=r,e=1;e<15;e++)n+=t*=r*r/(2*e+1);return Math.round(1e4*(.5+n/Ou*Math.exp(-r*r/2)))/1e4}for(var Nu=[],Iu=0;Iu<=3.09;Iu+=.01)Nu.push(Su(Iu));function Tu(r){var n=1/(1+.5*Math.abs(r)),t=n*Math.exp(-r*r+((((((((.17087277*n-.82215223)*n+1.48851587)*n-1.13520398)*n+.27886807)*n-.18628806)*n+.09678418)*n+.37409196)*n+1.00002368)*n-1.26551223);return r>=0?1-t:t-1}function Fu(r){var n=8*(Math.PI-3)/(3*Math.PI*(4-Math.PI)),t=Math.sqrt(Math.sqrt(Math.pow(2/(Math.PI*n)+Math.log(1-r*r)/2,2)-Math.log(1-r*r)/n)-(2/(Math.PI*n)+Math.log(1-r*r)/2));return r>=0?t:-t}function zu(r){if("number"==typeof r)return r<0?-1:0===r?0:1;throw new TypeError("not a number")}function Lu(r,n){for(var t=0,e=0;e<r.length;e++){var o=r[e]-n[e];t+=o*o}return Math.sqrt(t)}function Ru(r,n){return r.map((function(r){for(var t=Number.MAX_VALUE,e=-1,o=0;o<n.length;o++){var a=Lu(r,n[o]);a<t&&(t=a,e=o)}return e}))}function Cu(r,n,t){for(var e=r[0].length,o=fu(t,e),a=Array(t).fill(0),u=r.length,i=0;i<u;i++){for(var f=r[i],c=n[i],s=o[c],l=0;l<e;l++)s[l]+=f[l];a[c]+=1}for(var h=0;h<t;h++){if(0===a[h])throw new Error("Centroid "+h+" has no friends");for(var p=o[h],v=0;v<e;v++)p[v]/=a[h]}return o}function Du(r,n){for(var t=0,e=0;e<r.length;e++)t+=Lu(r[e],n[e]);return t}function Gu(r,n){if(r.length!==n.length)throw new Error("must have exactly as many labels as points");for(var t=function(r){for(var n=1+$a(r),t=Array(n),e=0;e<r.length;e++){var o=r[e];void 0===t[o]&&(t[o]=[]),t[o].push(e)}return t}(n),e=function(r){for(var n=r.length,t=fu(n,n),e=0;e<n;e++)for(var o=0;o<e;o++)t[e][o]=Lu(r[e],r[o]),t[o][e]=t[e][o];return t}(r),o=[],a=0;a<r.length;a++){var u=0;if(t[n[a]].length>1){var i=Bu(a,t[n[a]],e),f=Uu(a,n,t,e);u=(f-i)/Math.max(i,f)}o.push(u)}return o}function Uu(r,n,t,e){for(var o=n[r],a=Number.MAX_VALUE,u=0;u<t.length;u++)if(u!==o){var i=Bu(r,t[u],e);i<a&&(a=i)}return a}function Bu(r,n,t){for(var e=0,o=0;o<n.length;o++)e+=t[r][n[o]];return e/n.length}function Vu(r,n){return 0===r&&0===n?0:Math.abs((r-n)/n)}var Wu=Object.freeze({__proto__:null,BayesianClassifier:yu,PerceptronModel:wu,addToMean:function(r,n,t){return r+(t-r)/(n+1)},approxEqual:function(r,n,t){return void 0===t&&(t=xu),Vu(r,n)<=t},average:Ca,averageSimple:gu,bayesian:yu,bernoulliDistribution:function(r){if(r<0||r>1)throw new Error("bernoulliDistribution requires probability to be between 0 and 1 inclusive");return[1-r,r]},binomialDistribution:function(r,n){if(!(n<0||n>1||r<=0||r%1!=0)){var t=0,e=0,o=[],a=1;do{o[t]=a*Math.pow(n,t)*Math.pow(1-n,r-t),e+=o[t],a=a*(r-++t+1)/t}while(e<.9999);return o}},bisect:function(r,n,t,e,o){if("function"!=typeof r)throw new TypeError("func must be a function");for(var a=0;a<e;a++){var u=(n+t)/2;if(0===r(u)||Math.abs((t-n)/2)<o)return u;zu(r(u))===zu(r(n))?n=u:t=u}throw new Error("maximum number of iterations exceeded")},chiSquaredDistributionTable:ku,chiSquaredGoodnessOfFit:function(r,n,t){for(var e=0,o=n(Ca(r)),a=[],u=[],i=0;i<r.length;i++)void 0===a[r[i]]&&(a[r[i]]=0),a[r[i]]++;for(var f=0;f<a.length;f++)void 0===a[f]&&(a[f]=0);for(var c in o)c in a&&(u[+c]=o[c]*r.length);for(var s=u.length-1;s>=0;s--)u[s]<3&&(u[s-1]+=u[s],u.pop(),a[s-1]+=a[s],a.pop());for(var l=0;l<a.length;l++)e+=Math.pow(a[l]-u[l],2)/u[l];var h=a.length-1-1;return ku[h][t]<e},chunk:function(r,n){var t=[];if(n<1)throw new Error("chunk size must be a positive number");if(Math.floor(n)!==n)throw new Error("chunk size must be an integer");for(var e=0;e<r.length;e+=n)t.push(r.slice(e,e+n));return t},ckmeans:function(r,n){if(n>r.length)throw new Error("cannot generate more classes than there are data values");var t=Va(r);if(1===cu(t))return[t];var e=fu(n,t.length),o=fu(n,t.length);!function(r,n,t){for(var e=n[0].length,o=r[Math.floor(e/2)],a=[],u=[],i=0,f=void 0;i<e;++i)f=r[i]-o,0===i?(a.push(f),u.push(f*f)):(a.push(a[i-1]+f),u.push(u[i-1]+f*f)),n[0][i]=su(0,i,a,u),t[0][i]=0;for(var c=1;c<n.length;++c)lu(c<n.length-1?c:e-1,e-1,c,n,t,a,u)}(t,e,o);for(var a=[],u=o[0].length-1,i=o.length-1;i>=0;i--){var f=o[i][u];a[i]=t.slice(f,u+1),i>0&&(u=f-1)}return a},coefficientOfVariation:function(r){return vu(r)/Ca(r)},combinations:function r(n,t){var e,o,a,u,i=[];for(e=0;e<n.length;e++)if(1===t)i.push([n[e]]);else for(a=r(n.slice(e+1,n.length),t-1),o=0;o<a.length;o++)(u=a[o]).unshift(n[e]),i.push(u);return i},combinationsReplacement:function r(n,t){for(var e=[],o=0;o<n.length;o++)if(1===t)e.push([n[o]]);else for(var a=r(n.slice(o,n.length),t-1),u=0;u<a.length;u++)e.push([n[o]].concat(a[u]));return e},combineMeans:mu,combineVariances:function(r,n,t,e,o,a){var u=mu(n,t,o,a);return(t*(r+Math.pow(n-u,2))+a*(e+Math.pow(o-u,2)))/(t+a)},cumulativeStdLogisticProbability:function(r){return 1/(Math.exp(-r)+1)},cumulativeStdNormalProbability:function(r){var n=Math.abs(r),t=Math.min(Math.round(100*n),Nu.length-1);return r>=0?Nu[t]:+(1-Nu[t]).toFixed(4)},epsilon:xu,equalIntervalBreaks:function(r,n){if(r.length<2)return r;for(var t=Wa(r),e=$a(r),o=[t],a=(e-t)/n,u=1;u<n;u++)o.push(o[0]+a*u);return o.push(e),o},erf:Tu,errorFunction:Tu,extent:function(r){if(0===r.length)throw new Error("extent requires at least one data point");for(var n=r[0],t=r[0],e=1;e<r.length;e++)r[e]>t&&(t=r[e]),r[e]<n&&(n=r[e]);return[n,t]},extentSorted:function(r){return[r[0],r[r.length-1]]},factorial:ju,gamma:function r(n){if(Number.isInteger(n))return n<=0?NaN:ju(n-1);if(--n<0)return Math.PI/(Math.sin(Math.PI*-n)*r(-n));var t=n+1/4;return Math.pow(n/Math.E,n)*Math.sqrt(2*Math.PI*(n+1/6))*(1+1/144/Math.pow(t,2)-1/12960/Math.pow(t,3)-257/207360/Math.pow(t,4)-52/2612736/Math.pow(t,5)+5741173/9405849600/Math.pow(t,6)+37529/18811699200/Math.pow(t,7))},gammaln:function(r){if(r<=0)return 1/0;r--;for(var n=_u[0],t=1;t<15;t++)n+=_u[t]/(r+t);var e=5.2421875+r;return Mu+Math.log(n)-e+(r+.5)*Math.log(e)},geometricMean:function(r){if(0===r.length)throw new Error("geometricMean requires at least one data point");for(var n=1,t=0;t<r.length;t++){if(r[t]<0)throw new Error("geometricMean requires only non-negative numbers as input");n*=r[t]}return Math.pow(n,1/r.length)},harmonicMean:function(r){if(0===r.length)throw new Error("harmonicMean requires at least one data point");for(var n=0,t=0;t<r.length;t++){if(r[t]<=0)throw new Error("harmonicMean requires only positive numbers as input");n+=1/r[t]}return r.length/n},interquartileRange:tu,inverseErrorFunction:Fu,iqr:tu,kMeansCluster:function(r,n,t){void 0===t&&(t=Math.random);for(var e=null,o=iu(r,n,t),a=null,u=Number.MAX_VALUE;0!==u;)e=o,u=Du(o=Cu(r,a=Ru(r,o),n),e);return{labels:a,centroids:o}},kde:Eu,kernelDensityEstimation:Eu,linearRegression:function(r){var n,t,e=r.length;if(1===e)n=0,t=r[0][1];else{for(var o,a,u,i=0,f=0,c=0,s=0,l=0;l<e;l++)i+=a=(o=r[l])[0],f+=u=o[1],c+=a*a,s+=a*u;t=f/e-(n=(e*s-i*f)/(e*c-i*i))*i/e}return{m:n,b:t}},linearRegressionLine:function(r){return function(n){return r.b+r.m*n}},logAverage:function(r){if(0===r.length)throw new Error("logAverage requires at least one data point");for(var n=0,t=0;t<r.length;t++){if(r[t]<0)throw new Error("logAverage requires only non-negative numbers as input");n+=Math.log(r[t])}return Math.exp(n/r.length)},logit:function(r){if(r<=0||r>=1)throw new Error("p must be strictly between zero and one");return Math.log(r/(1-r))},mad:ou,max:$a,maxSorted:function(r){return r[r.length-1]},mean:Ca,meanSimple:gu,median:eu,medianAbsoluteDeviation:ou,medianSorted:function(r){return Ya(r,.5)},min:Wa,minSorted:function(r){return r[0]},mode:function(r){return Ba(Va(r))},modeFast:function(r){for(var n,t=new Map,e=0,o=0;o<r.length;o++){var a=t.get(r[o]);void 0===a?a=1:a++,a>e&&(n=r[o],e=a),t.set(r[o],a)}if(0===e)throw new Error("mode requires at last one data point");return n},modeSorted:Ba,numericSort:Va,perceptron:wu,permutationTest:function(r,n,t,e,o){if(void 0===e&&(e=1e4),void 0===t&&(t="two_side"),"two_side"!==t&&"greater"!==t&&"less"!==t)throw new Error("`alternative` must be either 'two_side', 'greater', or 'less'.");for(var a=Ca(r)-Ca(n),u=new Array(e),i=r.concat(n),f=Math.floor(i.length/2),c=0;c<e;c++){au(i,o);var s=i.slice(0,f),l=i.slice(f,i.length),h=Ca(s)-Ca(l);u[c]=h}var p=0;if("two_side"===t)for(var v=0;v<=e;v++)Math.abs(u[v])>=Math.abs(a)&&(p+=1);else if("greater"===t)for(var d=0;d<=e;d++)u[d]>=a&&(p+=1);else for(var m=0;m<=e;m++)u[m]<=a&&(p+=1);return p/e},permutationsHeap:function(r){for(var n=new Array(r.length),t=[r.slice()],e=0;e<r.length;e++)n[e]=0;for(var o=0;o<r.length;)if(n[o]<o){var a=0;o%2!=0&&(a=n[o]);var u=r[a];r[a]=r[o],r[o]=u,t.push(r.slice()),n[o]++,o=0}else n[o]=0,o++;return t},poissonDistribution:function(r){if(!(r<=0)){var n=0,t=0,e=[],o=1;do{e[n]=Math.exp(-r)*Math.pow(r,n)/o,t+=e[n],o*=++n}while(t<.9999);return e}},probit:function(r){return 0===r?r=xu:r>=1&&(r=.9999),Math.sqrt(2)*Fu(2*r-1)},product:function(r){for(var n=1,t=0;t<r.length;t++)n*=r[t];return n},quantile:Ka,quantileRank:function(r,n){return nu(Va(r),n)},quantileRankSorted:nu,quantileSorted:Ya,quickselect:Ha,rSquared:function(r,n){if(r.length<2)return 1;for(var t=0,e=0;e<r.length;e++)t+=r[e][1];for(var o=t/r.length,a=0,u=0;u<r.length;u++)a+=Math.pow(o-r[u][1],2);for(var i=0,f=0;f<r.length;f++)i+=Math.pow(r[f][1]-n(r[f][0]),2);return 1-i/a},relativeError:Vu,rms:bu,rootMeanSquare:bu,sample:iu,sampleCorrelation:du,sampleCovariance:hu,sampleKurtosis:function(r){var n=r.length;if(n<4)throw new Error("sampleKurtosis requires at least four data points");for(var t,e=Ca(r),o=0,a=0,u=0;u<n;u++)o+=(t=r[u]-e)*t,a+=t*t*t*t;return(n-1)/((n-2)*(n-3))*(n*(n+1)*a/(o*o)-3*(n-1))},sampleRankCorrelation:function(r,n){for(var t=r.map((function(r,n){return[r,n]})).sort((function(r,n){return r[0]-n[0]})).map((function(r){return r[1]})),e=n.map((function(r,n){return[r,n]})).sort((function(r,n){return r[0]-n[0]})).map((function(r){return r[1]})),o=Array(t.length),a=Array(t.length),u=0;u<t.length;u++)o[t[u]]=u,a[e[u]]=u;return du(o,a)},sampleSkewness:function(r){if(r.length<3)throw new Error("sampleSkewness requires at least three data points");for(var n,t=Ca(r),e=0,o=0,a=0;a<r.length;a++)e+=(n=r[a]-t)*n,o+=n*n*n;var u=r.length-1,i=Math.sqrt(e/u),f=r.length;return f*o/((f-1)*(f-2)*Math.pow(i,3))},sampleStandardDeviation:vu,sampleVariance:pu,sampleWithReplacement:function(r,n,t){if(0===r.length)return[];t=t||Math.random;for(var e=r.length,o=[],a=0;a<n;a++){var u=Math.floor(t()*e);o.push(r[u])}return o},shuffle:uu,shuffleInPlace:au,sign:zu,silhouette:Gu,silhouetteMetric:function(r,n){return $a(Gu(r,n))},standardDeviation:Ua,standardNormalTable:Nu,subtractFromMean:function(r,n,t){return(r*n-t)/(n-1)},sum:Ra,sumNthPowerDeviations:Da,sumSimple:Xa,tTest:function(r,n){return(Ca(r)-n)/(Ua(r)/Math.sqrt(r.length))},tTestTwoSample:function(r,n,t){var e=r.length,o=n.length;if(!e||!o)return null;t||(t=0);var a=Ca(r),u=Ca(n),i=pu(r),f=pu(n);if("number"==typeof a&&"number"==typeof u&&"number"==typeof i&&"number"==typeof f){var c=((e-1)*i+(o-1)*f)/(e+o-2);return(a-u-t)/Math.sqrt(c*(1/e+1/o))}},uniqueCountSorted:cu,variance:Ga,wilcoxonRankSum:function(r,n){if(!r.length||!n.length)throw new Error("Neither sample can be empty");for(var t=r.map((function(r){return{label:"x",value:r}})).concat(n.map((function(r){return{label:"y",value:r}}))).sort((function(r,n){return r.value-n.value})),e=0;e<t.length;e++)t[e].rank=e;for(var o=[t[0].rank],a=1;a<t.length;a++)t[a].value===t[a-1].value?(o.push(t[a].rank),a===t.length-1&&u(t,o)):o.length>1?u(t,o):o=[t[a].rank];function u(r,n){for(var t=(n[0]+n[n.length-1])/2,e=0;e<n.length;e++)r[n[e]].rank=t}for(var i=0,f=0;f<t.length;f++){var c=t[f];"x"===c.label&&(i+=c.rank+1)}return i},zScore:function(r,n,t){return(r-n)/t}});var $u,Xu=St($u=Wu,"default.default")?$u.default.default:St($u,"default")?$u.default:$u;var Yu=4294967295,Hu=Math.min;var Qu=function(r,n){if((r=vo(r))<1||r>9007199254740991)return[];var t=Yu,e=Hu(r,Yu);n=Eo(n),r-=Yu;for(var o=Fn(e,n);++t<r;)n(t);return o};function Ku(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;function t(r,n){var t,e;return function(){var o;if(null!=t)o=t,t=null;else do{t=2*Math.random()-1,o=2*Math.random()-1,e=t*t+o*o}while(!e||e>1);return r+n*o*Math.sqrt(-2*Math.log(e)/e)}}return t(r,n)}r.arrAverage=no,r.arrAverageWithLogNormCI=function(r,n){return Po.apply(this,arguments)},r.arrAverageWithNormCI=qo,r.arrCount=function(r){if(!Or(r))return[];if(0===kr(r))return[];var n=[];if(Oo(r,(function(r){(Ge(r)||De(r))&&n.push(function(r){if(!De(r)&&!Ge(r)&&!dt(r))return"";var n="";try{n=String(r)}catch(r){}try{n=r.toString()}catch(r){}return n}(r))})),0===kr(n))return[];n=Ut(n,(function(r){return{v:r}}));var t=Fo(n,"v");return t=Ut(t,(function(r,n){return{key:n,count:kr(r)}})),t=Zo(t,"count"),t=ra(t)},r.arrGammaFit=ga,r.arrGammaHist=function(r){return ka.apply(this,arguments)},r.arrGammaInv=function(r,n){return Ea.apply(this,arguments)},r.arrGeometricAverage=Oa,r.arrGeometricStd=function(r){if(!Or(r))return null;if(0===kr(r))return null;var n=fo(r),t=kr(n);if(0===t)return null;if(t<=1)return null;var e=po(n);return Math.exp(e)},r.arrLogNormHist=function(r){return Ia.apply(this,arguments)},r.arrLogNormInv=function(r,n){return za.apply(this,arguments)},r.arrMovingAverage=function(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Or(r))return[];if(0===kr(r))return[];var t=St(n,"selectCountHalf");La(t)||(t=2),t=jo(t);var e=kr(r);if(0===e)return[];var o=Fe(r);return Oo(r,(function(n,a){var u=a-t;u=Math.max(u,0),u=Math.min(u,e-1);var i=Math.max(a+t,0);i=Math.max(i,0),i=Math.min(i,e-1);for(var f=[],c=u;c<=i;c++)f.push(r[c]);var s=no(f);o[a]=s})),o},r.arrNormHist=Sa,r.arrNormInv=Ta,r.arrQuartile=function(r,n){if(!Or(r))return null;if(0===kr(r))return null;if(!uo(n))return null;(n=Je(n))<0&&(n=0),n>1&&(n=1);var t=ro(r);return 0===kr(t)?null:Xu.quantile(t,n)},r.arrStd=po,r.bin=ma,r.histGen=_a,r.jStat=ho,r.randNorm=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Ge(r)||(r=0),r=Je(r),Ge(n)||(n=1),(n=Je(n))<0&&(n=0);var e=St(t,"low");e=Ge(e)?Je(e):null;var o=St(t,"up");if(o=Ge(o)?Je(o):null,null!==e&&null!==o&&e>=o)throw new Error("low[".concat(e,"] >= up[").concat(o,"]"));var a=St(t,"num");(a=jo(a))<=0&&(a=1);var u=Ku(r,n),i=function r(){var n=u();return null!==e&&n<e&&(n=r()),null!==o&&n>o&&(n=r()),n},f=Ut(Qu(a),(function(){return i()}));return 1===a&&(f=f[0]),f},r.simpleStatistics=Xu,r.studentTInv=Mo,Object.defineProperty(r,"__esModule",{value:!0})}));
//# sourceMappingURL=w-statistic.umd.js.map
